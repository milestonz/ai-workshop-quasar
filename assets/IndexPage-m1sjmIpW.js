const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pinia-DbmXsomq.js","assets/index-bfaO29LJ.js","assets/index-DJuvGez9.css"])))=>i.map(i=>d[i]);
import{j2 as me,j8 as m,iM as k,jr as oe,j3 as I,j6 as w,j5 as a,j4 as s,i$ as se,ji as Q,jh as Y,jl as Le,jd as je,ju as De,j7 as T,jg as y,jf as le,jU as Te,jw as H,jx as $e,_ as ke,jV as Ne,jz as Ce,jW as ze,je as Qe,jk as Pe,jX as Ve,jY as Re,jj as ie,jZ as Ie,j_ as Fe}from"./index-bfaO29LJ.js";import{Q as Ee,l as xe,m as ee,n as Me,o as We}from"./QDialog-DKMvpy4J.js";import{Q as Ue}from"./QBanner-dEnb48N5.js";import{Q as Oe}from"./QPage-KjP7jc3I.js";import{s as b,Q as K,a as He,b as Ye}from"./useGuestAuth-ZR2tHDci.js";import{Q as Be}from"./QSpinnerDots-CSswX2p6.js";import{_ as pe}from"./_plugin-vue_export-helper-D2YY3z9m.js";import{Q as Ke}from"./QChip-CTdTy5BO.js";import{d as Ae,Q as Je}from"./marked.esm-CwGPu85X.js";import"./pinia-DbmXsomq.js";const Xe={class:"simple-slide-viewer"},Ge={key:0,class:"error"},Ze={key:1,class:"html-slide-container"},et=["innerHTML"],tt={key:2,class:"slide-iframe-container"},lt=["src"],ot={key:0,class:"loading-overlay"},st={key:3,class:"no-content"},nt=me({__name:"SimpleSlideViewer",props:{slideNumber:{},slideType:{}},setup(A){const f=A,V=m(""),p=m(!1),t=m(""),S=k(()=>f.slideNumber?`/generated/slides/slide-${f.slideNumber}.html`:""),d=async()=>{if(f.slideType==="html")try{p.value=!0;const g=await fetch(`/slides/slide-${f.slideNumber}.md`);if(g.ok){const C=await g.text();t.value=C.replace(/^@html\s*\n?/gm,"").trim(),b.log(`âœ… HTML ìŠ¬ë¼ì´ë“œ ë‚´ìš© ë¡œë“œ ì™„ë£Œ: ${f.slideNumber}`)}else V.value=`HTML ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`HTML ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì‹¤íŒ¨:`,g.status)}catch(g){V.value=`HTML ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`HTML ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì˜¤ë¥˜:`,g)}finally{p.value=!1}},E=()=>{p.value=!1,b.log(`âœ… iframe ë¡œë“œ ì™„ë£Œ: ${S.value}`)},_=g=>{V.value=`ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ:`,g),p.value=!1},P=()=>{p.value=!1,b.log(`âœ… HTML ìŠ¬ë¼ì´ë“œ ë¡œë“œ ì™„ë£Œ: ${f.slideNumber}`)};return oe(()=>f.slideNumber,g=>{g&&(p.value=!0,V.value="",f.slideType==="html"?d():(b.log(`ğŸ”„ iframe URL ë³€ê²½: ${S.value}`),setTimeout(()=>{p.value&&(p.value=!1,b.log("âš ï¸ ìŠ¬ë¼ì´ë“œ ë¡œë”© ì‹œê°„ ì´ˆê³¼"))},3e3)))},{immediate:!0}),(g,C)=>(w(),I("div",Xe,[V.value?(w(),I("div",Ge,[a(se,{name:"error",size:"50px",color:"negative"}),s("p",null,Q(V.value),1)])):g.slideType==="html"&&t.value?(w(),I("div",Ze,[s("div",{class:"html-slide-content",innerHTML:t.value,onLoad:P},null,40,et)])):S.value?(w(),I("div",tt,[s("iframe",{src:S.value,class:"slide-iframe",onLoad:E,onError:_},null,40,lt),p.value?(w(),I("div",ot,[a(Be,{size:"50px",color:"primary"}),C[0]||(C[0]=s("p",null,"ìŠ¬ë¼ì´ë“œ ë¡œë”© ì¤‘...",-1))])):Y("",!0)])):(w(),I("div",st,[a(se,{name:"slideshow",size:"50px",color:"grey"}),C[1]||(C[1]=s("p",null,"í‘œì‹œí•  ìŠ¬ë¼ì´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.",-1))]))]))}}),at=pe(nt,[["__scopeId","data-v-2a03a82a"]]),it=A=>{if(!A)return"";Ae.setOptions({breaks:!1,gfm:!0});let f=Ae(A);return typeof f=="string"&&(f=f.replace(/<p>/g,"<div>").replace(/<\/p>/g,"</div>")),typeof f=="string"?f:A},rt={class:"markdown-editor"},ut={class:"editor-header"},dt={class:"editor-actions"},ct={class:"row q-col-gutter-md"},vt={class:"col-12"},mt={key:0,class:"col-12"},pt=["src"],ft={class:"col-12"},gt={class:"col-6"},ht={class:"col-6"},yt={class:"row q-col-gutter-md"},bt={class:"col-12"},wt={key:0,class:"col-12"},St={class:"youtube-preview"},_t=["src"],$t={class:"col-12"},kt={class:"col-6"},Ct={class:"col-6"},xt={class:"editor-content"},Lt={class:"text-caption text-grey-6 q-mt-xs"},Tt=me({__name:"MarkdownEditor",props:{initialContent:{default:""},slideId:{default:""}},emits:["save","contentChange","autoUpdate"],setup(A,{expose:f,emit:V}){const p=A,t=V,S=Le(),d=m(p.initialContent),E=m(!1),_=m(!0),P=m(null),g=m(null),C=m(p.initialContent),j=m(!1),M=m(null),R=m(null),F=m(""),c=m(null),$=m(null),J=m(!1),X=m(""),U=m(""),G=m(""),D=m(null),B=m(null);k(()=>{try{return it(d.value)}catch(i){return console.error("Markdown ë Œë”ë§ ì˜¤ë¥˜:",i),d.value}});const te=()=>{t("contentChange",d.value),be()},fe=()=>{j.value=!0,v()},v=()=>{M.value=null,R.value=null,F.value="",c.value=null,$.value=null},re=i=>{if(i){M.value=i;const n=new FileReader;n.onload=r=>{R.value=r.target?.result},n.readAsDataURL(i)}},ue=()=>{j.value=!1,v()},ge=()=>{if(M.value)try{const i=new FileReader;i.onload=n=>{const r=n.target?.result;let x=`![${F.value||"ì´ë¯¸ì§€"}](${r})`;if(c.value||$.value){const O=c.value?` width="${c.value}"`:"",l=$.value?` height="${$.value}"`:"";x=`<img src="${r}" alt="${F.value||"ì´ë¯¸ì§€"}"${O}${l} style="display: block; margin: 0 auto; max-width: 100%;" />`}const W=document.querySelector(".markdown-textarea textarea");if(W){const O=W.selectionStart,l=W.selectionEnd,o=d.value.substring(0,O),u=d.value.substring(l);d.value=o+`
`+x+`
`+u,setTimeout(()=>{const e=O+x.length+2;W.setSelectionRange(e,e),W.focus()},0)}else d.value+=`
`+x+`
`;te(),j.value=!1,v(),S.notify({type:"positive",message:"ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})},i.readAsDataURL(M.value)}catch(i){console.error("ì´ë¯¸ì§€ ì‚½ì… ì˜¤ë¥˜:",i),S.notify({type:"negative",message:"ì´ë¯¸ì§€ ì‚½ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},he=()=>{J.value=!0,ne()},ne=()=>{X.value="",U.value="",G.value="",D.value=null,B.value=null},de=i=>{if(typeof i=="string"){X.value=i;const n=ce(i);U.value=n}else X.value="",U.value=""},ce=i=>{const n=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/watch\?.*v=([^&\n?#]+)/];for(const r of n){const x=i.match(r);if(x&&x[1])return x[1]}return""},ae=()=>{J.value=!1,ne()},ye=()=>{if(U.value)try{let i="";if(D.value||B.value){const r=D.value?` width="${D.value}"`:"",x=B.value?` height="${B.value}"`:"";i=`<iframe src="https://www.youtube.com/embed/${U.value}"${r}${x} frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display: block; margin: 0 auto; max-width: 100%;"></iframe>`}else i=`<div class="youtube-fullscreen">
  <iframe
    src="https://www.youtube.com/embed/${U.value}"
    width="100%"
    height="100%"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
  ></iframe>
</div>`;G.value&&(i=`## ${G.value}

${i}`);const n=document.querySelector(".markdown-textarea textarea");if(n){const r=n.selectionStart,x=n.selectionEnd,W=d.value.substring(0,r),O=d.value.substring(x);d.value=W+`
`+i+`
`+O,setTimeout(()=>{const l=r+i.length+2;n.setSelectionRange(l,l),n.focus()},0)}else d.value+=`
`+i+`
`;te(),J.value=!1,ne(),S.notify({type:"positive",message:"YouTube ì˜ìƒì´ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})}catch(i){console.error("YouTube ì‚½ì… ì˜¤ë¥˜:",i),S.notify({type:"negative",message:"YouTube ì˜ìƒ ì‚½ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},be=()=>{P.value&&clearTimeout(P.value),P.value=setTimeout(()=>{_.value&&(console.log("ğŸ” [MarkdownEditor] ìë™ ì—…ë°ì´íŠ¸"),console.log("ğŸ” [MarkdownEditor] ì—…ë°ì´íŠ¸ ë‚´ìš© ê¸¸ì´:",d.value.length),console.log("ğŸ” [MarkdownEditor] ì—…ë°ì´íŠ¸ ë‚´ìš© ëë¶€ë¶„:",JSON.stringify(d.value.substring(d.value.length-20))),console.log("ğŸ¯ ì‹¤ì‹œê°„ ë·°ì–´ ì—…ë°ì´íŠ¸:",p.slideId,"ë‚´ìš©ê¸¸ì´:",d.value.length),t("autoUpdate",d.value,p.slideId))},1e3)},we=async()=>{E.value=!0;try{console.log("ğŸ” [MarkdownEditor] ì €ì¥ ì‹œì‘"),console.log("ğŸ” [MarkdownEditor] ì €ì¥í•  ë‚´ìš© ê¸¸ì´:",d.value.length),console.log("ğŸ” [MarkdownEditor] ì €ì¥í•  ë‚´ìš© ëë¶€ë¶„:",JSON.stringify(d.value.substring(d.value.length-20))),t("save",d.value,p.slideId),setTimeout(()=>{E.value=!1},1e3)}catch(i){console.error("ì €ì¥ ì˜¤ë¥˜:",i),E.value=!1}};return oe(()=>p.initialContent,i=>{d.value=i,C.value=i}),oe(()=>p.slideId,i=>{console.log("slideId ë³€ê²½ë¨:",i),d.value=p.initialContent,C.value=p.initialContent}),je(()=>{C.value=d.value}),De(()=>{g.value&&clearTimeout(g.value)}),f({setContent:i=>{d.value=i},content:d}),(i,n)=>(w(),I("div",rt,[s("div",ut,[s("div",dt,[a(T,{flat:"",dense:"",size:"sm",icon:"image",label:"ì´ë¯¸ì§€ ì²¨ë¶€",onClick:fe,class:"q-mr-sm"}),a(T,{flat:"",dense:"",size:"sm",icon:"play_circle",label:"YouTube",onClick:he,class:"q-mr-sm"}),a(T,{flat:"",dense:"",size:"sm",icon:"save",label:"ì €ì¥",onClick:we,loading:E.value},null,8,["loading"])])]),a(Ee,{modelValue:j.value,"onUpdate:modelValue":n[4]||(n[4]=r=>j.value=r),persistent:""},{default:y(()=>[a(xe,{style:{"min-width":"400px"}},{default:y(()=>[a(ee,null,{default:y(()=>n[11]||(n[11]=[s("div",{class:"text-h6"},"ì´ë¯¸ì§€ ì²¨ë¶€",-1)])),_:1,__:[11]}),a(ee,null,{default:y(()=>[s("div",ct,[s("div",vt,[a(Je,{modelValue:M.value,"onUpdate:modelValue":[n[0]||(n[0]=r=>M.value=r),re],label:"ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ",accept:".jpg,.jpeg,.png,.gif,.webp",outlined:"",dense:""},{prepend:y(()=>[a(se,{name:"image"})]),_:1},8,["modelValue"])]),R.value?(w(),I("div",mt,[n[12]||(n[12]=s("div",{class:"text-caption q-mb-xs"},"ë¯¸ë¦¬ë³´ê¸°:",-1)),s("img",{src:R.value,alt:"ë¯¸ë¦¬ë³´ê¸°",style:{"max-width":"100%","max-height":"200px","object-fit":"contain"}},null,8,pt)])):Y("",!0),s("div",ft,[a(K,{modelValue:F.value,"onUpdate:modelValue":n[1]||(n[1]=r=>F.value=r),label:"ì´ë¯¸ì§€ ì„¤ëª… (alt í…ìŠ¤íŠ¸)",outlined:"",dense:"",placeholder:"ì´ë¯¸ì§€ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"},null,8,["modelValue"])]),s("div",gt,[a(K,{modelValue:c.value,"onUpdate:modelValue":n[2]||(n[2]=r=>c.value=r),modelModifiers:{number:!0},label:"ë„ˆë¹„ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])]),s("div",ht,[a(K,{modelValue:$.value,"onUpdate:modelValue":n[3]||(n[3]=r=>$.value=r),modelModifiers:{number:!0},label:"ë†’ì´ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])])])]),_:1}),a(Me,{align:"right"},{default:y(()=>[a(T,{flat:"",label:"ì·¨ì†Œ",onClick:ue}),a(T,{color:"primary",label:"ì‚½ì…",onClick:ge,disable:!M.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(Ee,{modelValue:J.value,"onUpdate:modelValue":n[9]||(n[9]=r=>J.value=r),persistent:""},{default:y(()=>[a(xe,{style:{"min-width":"400px"}},{default:y(()=>[a(ee,null,{default:y(()=>n[13]||(n[13]=[s("div",{class:"text-h6"},"YouTube ì˜ìƒ ì¶”ê°€",-1)])),_:1,__:[13]}),a(ee,null,{default:y(()=>[s("div",yt,[s("div",bt,[a(K,{modelValue:X.value,"onUpdate:modelValue":[n[5]||(n[5]=r=>X.value=r),de],label:"YouTube ë§í¬",outlined:"",dense:"",placeholder:"https://www.youtube.com/watch?v=..."},{prepend:y(()=>[a(se,{name:"play_circle"})]),_:1},8,["modelValue"])]),U.value?(w(),I("div",wt,[n[14]||(n[14]=s("div",{class:"text-caption q-mb-xs"},"ë¯¸ë¦¬ë³´ê¸°:",-1)),s("div",St,[s("iframe",{src:`https://www.youtube.com/embed/${U.value}`,width:"100%",height:"200",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,_t)])])):Y("",!0),s("div",$t,[a(K,{modelValue:G.value,"onUpdate:modelValue":n[6]||(n[6]=r=>G.value=r),label:"ì˜ìƒ ì œëª© (ì„ íƒì‚¬í•­)",outlined:"",dense:"",placeholder:"ì˜ìƒì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"},null,8,["modelValue"])]),s("div",kt,[a(K,{modelValue:D.value,"onUpdate:modelValue":n[7]||(n[7]=r=>D.value=r),modelModifiers:{number:!0},label:"ë„ˆë¹„ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])]),s("div",Ct,[a(K,{modelValue:B.value,"onUpdate:modelValue":n[8]||(n[8]=r=>B.value=r),modelModifiers:{number:!0},label:"ë†’ì´ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])])])]),_:1}),a(Me,{align:"right"},{default:y(()=>[a(T,{flat:"",label:"ì·¨ì†Œ",onClick:ae}),a(T,{color:"primary",label:"ì‚½ì…",onClick:ye,disable:!U.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s("div",xt,[a(K,{modelValue:d.value,"onUpdate:modelValue":[n[10]||(n[10]=r=>d.value=r),te],type:"textarea",placeholder:"Markdown ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...",rows:"15",outlined:"",dense:"",class:"markdown-textarea"},null,8,["modelValue"]),s("div",Lt,Q(d.value.length)+"ì / 10000ì",1)])]))}}),Vt=pe(Tt,[["__scopeId","data-v-3f0ce4c0"]]),It={class:"q-my-none editor-title"},Et={class:"text-caption text-grey-6 q-mt-xs"},Mt={class:"row items-center justify-between q-mb-sm"},Ut={class:"col"},At={class:"text-subtitle2 text-weight-medium"},jt={class:"text-caption text-grey-6"},Dt={class:"col-auto"},qt={class:"text-caption text-grey-6"},Nt={class:"row q-gutter-sm q-mb-md"},zt={class:"q-mt-md text-right"},Qt=me({__name:"SlideEditorSection",props:{currentSlideType:{},currentSlideInfo:{},currentLesson:{},currentSlide:{},currentSlideContent:{},isApplying:{type:Boolean}},emits:["slideContentSave","slideContentChange","slidePreview","createMarkdownFile","autoUpdate","updateTOC","addNewSlide","applySlide"],setup(A,{expose:f,emit:V}){const p=A,t=V,S=Le(),d=m(),E=m(!1),_=(c,$)=>{t("slideContentSave",c,$)},P=c=>{t("slideContentChange",c)},g=c=>{t("slidePreview",c)},C=(c,$)=>{t("createMarkdownFile",c,$)},j=(c,$)=>{t("autoUpdate",c,$)},M=async()=>{E.value=!0;try{t("updateTOC"),S.notify({type:"positive",message:"ëª©ì°¨ ì—…ë°ì´íŠ¸ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤",position:"top",timeout:2e3,icon:"refresh",actions:[{label:"í™•ì¸",color:"white"}]})}catch{S.notify({type:"negative",message:"ëª©ì°¨ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",position:"top",timeout:3e3,icon:"error",actions:[{label:"í™•ì¸",color:"white"}]})}finally{E.value=!1}},R=()=>{t("addNewSlide")},F=()=>{t("applySlide",`${p.currentLesson}-${p.currentSlide}`)};return f({markdownEditor:d}),(c,$)=>(w(),le(xe,{class:"sidebar-card q-mt-md"},{default:y(()=>[a(ee,null,{default:y(()=>[s("h6",It,Q(c.currentSlideType==="chapter"?"Chapter í¸ì§‘ê¸°":"ìŠ¬ë¼ì´ë“œ í¸ì§‘ê¸°"),1),s("div",Et,Q(c.currentSlideType==="chapter"?"Chapter ë‚´ìš©ì„ í¸ì§‘í•˜ì„¸ìš”":"ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ í¸ì§‘í•˜ì„¸ìš”"),1)]),_:1}),a(ee,{class:"q-pt-none current-slide-info-section"},{default:y(()=>[s("div",Mt,[s("div",Ut,[s("div",At,Q(c.currentSlideInfo?.lessonTitle),1),s("div",jt,Q(c.currentSlideInfo?.slideTitle),1)]),s("div",Dt,[a(Ke,{size:"sm",color:"primary","text-color":"white",label:`${c.currentSlideInfo?.slideIndex}/${c.currentSlideInfo?.totalSlides}`},null,8,["label"])])]),s("div",qt," ê°•ì˜ "+Q(c.currentSlideInfo?.lessonNumber)+"/"+Q(c.currentSlideInfo?.totalLessons),1)]),_:1}),a(ee,{class:"q-pt-none"},{default:y(()=>[s("div",Nt,[a(T,{icon:"refresh",label:"ëª©ì°¨ ì—…ë°ì´íŠ¸",onClick:M,loading:E.value,color:"primary"},null,8,["loading"]),a(T,{icon:"add",label:"ìƒˆ ìŠ¬ë¼ì´ë“œ",onClick:R,color:"positive"})]),(w(),le(Vt,{key:`${c.currentLesson}-${c.currentSlide}`,"initial-content":c.currentSlideContent,"slide-id":`${c.currentLesson}-${c.currentSlide}`,onSave:_,onContentChange:P,onPreview:g,onCreateMarkdown:C,onAutoUpdate:j,ref_key:"markdownEditor",ref:d},null,8,["initial-content","slide-id"])),s("div",zt,[a(T,{color:"accent",icon:"check_circle",label:"ìŠ¬ë¼ì´ë“œ ë°˜ì˜",onClick:F,loading:c.isApplying,disable:c.isApplying},null,8,["loading","disable"])])]),_:1})]),_:1}))}}),Pt=pe(Qt,[["__scopeId","data-v-cda91fc6"]]),Rt={class:"main-content"},Ft={key:2,class:"navigation-controls"},Wt={class:"slide-info"},Ot={class:"slide-counter"},Ht={key:3,class:"editor-mode-notice"},Yt=20,Bt=80,Kt=me({__name:"IndexPage",setup(A){const{userRole:f}=Te(),V=k(()=>f.value==="admin"),p=Le();Qe(),Pe();const t=He();Te(),Ye();const S=m(!1),d=k(()=>t.currentLesson),E=k(()=>t.currentSlide),_=k(()=>t.isPresentationMode);oe(()=>_.value,async l=>{if(console.log(`ğŸ­ í¸ì§‘ê¸° ëª¨ë“œ ë³€ê²½: ${l?"í”„ë ˆì  í…Œì´ì…˜":"í¸ì§‘ê¸°"}`),!l)try{const o=t.currentLesson,u=t.currentSlide;console.log(`ğŸ“‚ í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ: ${o}-${u}`);const e=await t.loadSlideContentForEditing(o,u);console.log("âœ… í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì™„ë£Œ:",{contentLength:e.length,contentPreview:e.substring(0,100)}),g.value=e}catch(o){console.error("âŒ í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹¤íŒ¨:",o);const u=t.currentLesson,e=t.currentSlide;g.value=`# ìŠ¬ë¼ì´ë“œ ${u}-${e}

ìƒˆë¡œìš´ ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”.`}}),oe([()=>t.currentLesson,()=>t.currentSlide],async()=>{await re(t.currentLesson,t.currentSlide),j.value&&setTimeout(()=>{M()},500)});const P=m(),g=m(""),C=k(()=>({lessonTitle:`ê°•ì˜ ${t.currentLesson+1}`,slideTitle:`ìŠ¬ë¼ì´ë“œ ${t.currentSlide+1}`,slideIndex:t.currentSlide+1,totalSlides:t.currentLessonData?.slides||0,lessonNumber:t.currentLesson+1,totalLessons:t.lessons.length})),j=k(()=>`${t.currentLesson}-${t.currentSlide}`.startsWith("1-1")&&t.currentSlide>=13),M=()=>{j.value&&setTimeout(()=>{try{const l=document.querySelector(".slide-iframe");if(l&&l.contentDocument){const o=l.contentDocument.querySelectorAll(".quiz-option");o.forEach(u=>{u.removeEventListener("click",R),u.addEventListener("click",R),u.style.cursor="pointer",u.style.transition="all 0.2s ease"}),b.log(`âœ… Quiz ì´ë²¤íŠ¸ ì£¼ì… ì™„ë£Œ: ${o.length}ê°œ ì˜µì…˜`)}}catch(l){b.warn("âš ï¸ Quiz ì´ë²¤íŠ¸ ì£¼ì… ì‹¤íŒ¨:",l)}},200)},R=l=>{l.preventDefault(),l.stopPropagation();const o=l.target,u=o.getAttribute("data-idx"),e=document.querySelector(".slide-iframe");if(e&&e.contentDocument){const h=e.contentDocument.getElementById("quiz-answer-data"),L=e.contentDocument.querySelectorAll(".quiz-option");h&&(h.style.display="block"),L.forEach(q=>q.classList.remove("selected")),o.classList.add("selected"),b.log(`ğŸ¯ Quiz ì˜µì…˜ í´ë¦­: ${u}ë²ˆ ì„ íƒ, ì •ë‹µ í‘œì‹œ`)}},F=l=>{b.log("ìŠ¬ë¼ì´ë“œ ë‚´ìš© ì €ì¥:",l),g.value=l},c=l=>{b.log("ìŠ¬ë¼ì´ë“œ ë‚´ìš© ë³€ê²½:",l),g.value=l},$=()=>{b.log("ìŠ¬ë¼ì´ë“œ ë¯¸ë¦¬ë³´ê¸°")},J=()=>{console.log("ë§ˆí¬ë‹¤ìš´ íŒŒì¼ ìƒì„±")},X=()=>{console.log("ìë™ ì—…ë°ì´íŠ¸")},U=()=>{console.log("ëª©ì°¨ ì—…ë°ì´íŠ¸")},G=()=>{b.log("ìƒˆ ìŠ¬ë¼ì´ë“œ ì¶”ê°€")},D=m(!1),B=async l=>{D.value=!0;try{b.log("ğŸ”„ ìŠ¬ë¼ì´ë“œ ë°˜ì˜ ì‹œì‘:",l);const[o="0",u="0"]=(l||"0-0").split("-"),e=`${o}-${u}`;if(await t.saveSlideToFirebaseStorage(e,g.value)){console.log("âœ… Firebase Storageì— MD íŒŒì¼ ì €ì¥ ì™„ë£Œ:",e),te.value++,p.notify({type:"positive",message:"ìŠ¬ë¼ì´ë“œê°€ Firebase Storageì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!",position:"top",timeout:3e3,icon:"cloud_done",actions:[{label:"í™•ì¸",color:"white"}]});const L=new Blob([g.value],{type:"text/markdown"}),q=URL.createObjectURL(L),N=document.createElement("a");N.href=q,N.download=`slide-${e}.md`,document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(q),console.log("ğŸ“ ë¡œì»¬ ë°±ì—… íŒŒì¼ë„ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.")}else throw new Error("Firebase Storage ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");b.log("ğŸ‰ ìŠ¬ë¼ì´ë“œ ë°˜ì˜ ì™„ë£Œ")}catch(o){b.error("âŒ Firebase Storage ì €ì¥ ì‹¤íŒ¨:",o),p.notify({type:"negative",message:"Firebase Storageì— ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",position:"top",timeout:5e3,icon:"cloud_off",actions:[{label:"í™•ì¸",color:"white"}]})}finally{D.value=!1}},te=m(0);k(()=>t.lessons.reduce((l,o)=>l+o.slides,0));const fe=k(()=>`${t.currentLesson}-${t.currentSlide}`),v=m("lecture"),re=async(l,o)=>{try{const u=await fetch(`/slides/slide-${l}-${o}.md`);if(u.ok){const e=await u.text();if(e.trim().startsWith("@html"))v.value="html";else if(e.includes("@cover")||e.includes("ì»¤ë²„"))v.value="cover";else if(e.includes("@toc")||e.includes("ëª©ì°¨"))v.value="toc";else if(e.includes("@poll")||e.includes("íˆ¬í‘œ"))v.value="poll";else if(e.includes("@stats")||e.includes("í†µê³„"))v.value="stats";else if(e.includes("@interactive")||e.includes("ì¸í„°ë™í‹°ë¸Œ"))v.value="interactive";else if(e.includes("@example")||e.includes("ì˜ˆì‹œ"))v.value="example";else if(e.includes("@challenge")||e.includes("ë„ì „"))v.value="challenge";else if(e.includes("@timeline")||e.includes("íƒ€ì„ë¼ì¸"))v.value="timeline";else if(e.includes("@profile")||e.includes("í”„ë¡œí•„"))v.value="profile";else if(e.includes("@lecture")||e.includes("ê°•ì˜"))v.value="lecture";else if(e.includes("@chapter")||e.includes("ì±•í„°"))v.value="chapter";else{const h=`${l}-${o}`;h==="0-0"?v.value="cover":h==="0-1"?v.value="index":h==="0-2"?v.value="profile":h.endsWith("-0")?v.value="chapter":h.startsWith("2-")&&h!=="2-0"?v.value="example":h.startsWith("3-")&&h!=="3-0"?v.value="challenge":v.value="lecture"}}}catch(u){console.error(`ìŠ¬ë¼ì´ë“œ íƒ€ì… ê°ì§€ ì‹¤íŒ¨: ${l}-${o}`,u);const e=`${l}-${o}`;e==="0-0"?v.value="cover":e==="0-1"?v.value="index":e==="0-2"?v.value="profile":e.endsWith("-0")?v.value="chapter":e.startsWith("2-")&&e!=="2-0"?v.value="example":e.startsWith("3-")&&e!=="3-0"?v.value="challenge":v.value="lecture"}},ue=k(()=>v.value!=="poll"?"":`poll-${t.currentLesson}-${t.currentSlide}`),ge=async l=>{try{if(!V.value||!l||!await p.dialog({title:"ê²°ê³¼ ì´ˆê¸°í™”",message:`í•´ë‹¹ íˆ¬í‘œì˜ ë‚˜ì˜ ì„ íƒ(LocalStorage)ê³¼ RTDBì˜ í‘œê¸°ë¥¼ ì‚­ì œí• ê¹Œìš”?
ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,cancel:!0,ok:{label:"ì´ˆê¸°í™”",color:"negative"}}).onOk(()=>!0).onCancel(()=>!1))return;try{Object.keys(localStorage).filter(e=>e.toLowerCase().includes("poll")).forEach(e=>localStorage.removeItem(e))}catch{}const u=H?$e(H):null;if(u){const{getAuth:e}=await ke(async()=>{const{getAuth:L}=await import("./pinia-DbmXsomq.js").then(q=>q.i);return{getAuth:L}},__vite__mapDeps([0,1,2])),h=e(H).currentUser?.uid;h&&await Fe(Ce(u,`polls/${l}/userVotes/${h}`)).catch(()=>{})}try{document.querySelector(".slide-iframe")?.contentWindow?.postMessage({type:"poll-state",pollId:l,optionId:""},"*")}catch{}p.notify({type:"positive",message:"íˆ¬í‘œ ê²°ê³¼ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})}catch{p.notify({type:"negative",message:"ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},he=k(()=>t.currentLesson===0&&t.currentSlide===0),ne=k(()=>{const l=t.lessons.length-1,o=t.lessons[l];return t.currentLesson===l&&t.currentSlide===(o?.slides||0)-1}),de=m(60),ce=m(40),ae=m(!1),ye=k(()=>_.value?{}:{flex:`0 0 ${de.value}%`}),be=k(()=>_.value?{}:{flex:`0 0 ${ce.value}%`}),we=l=>{ae.value=!0,document.body.style.cursor="col-resize"},Se=()=>{ae.value=!1,document.body.style.cursor=""},i=l=>{if(!ae.value)return;const o=document.querySelector(".main-content");if(!o)return;const u=o.getBoundingClientRect(),h=(l.clientX-u.left)/u.width*100;h>Yt&&h<Bt&&(de.value=h,ce.value=100-h)},n=()=>{t.prevSlide()},r=()=>{t.nextSlide()},x=()=>{t.setCurrentLesson(0),t.setCurrentSlide(0)},W=()=>{const l=t.lessons.length-1,o=t.lessons[l];o&&(t.setCurrentLesson(l),t.setCurrentSlide(o.slides-1))},O=l=>{if(_.value)switch(l.key){case"ArrowLeft":l.preventDefault(),n();break;case"ArrowRight":case" ":l.preventDefault(),r();break;case"Home":l.preventDefault(),x();break;case"End":l.preventDefault(),W();break;case"?":l.preventDefault(),S.value=!S.value;break}};return je(async()=>{await re(t.currentLesson,t.currentSlide),document.addEventListener("keydown",O),window.addEventListener("mousemove",i),window.addEventListener("mouseup",Se);const l=async u=>{try{if(f.value!=="admin")return;const e=u.data||{};if(e&&e.type==="poll-vote"){const h=H?$e(H):null;if(!h)return;const{pollId:L,optionId:q,text:N}=e;if(!L)return;const{getAuth:ve}=await ke(async()=>{const{getAuth:_e}=await import("./pinia-DbmXsomq.js").then(qe=>qe.i);return{getAuth:_e}},__vite__mapDeps([0,1,2])),Z=ve(H).currentUser?.uid;if(!Z)return;const z=N||String(q||"");await Ne(Ce(h,`polls/${L}/userVotes/${Z}`),z),b.log("ğŸ—³ï¸ admin saved(userVotes):",{pollId:L,valueToSave:z})}if(e&&e.type==="poll-ready"){const h=H?$e(H):null;if(!h)return;const{pollId:L}=e;if(!L)return;const{getAuth:q}=await ke(async()=>{const{getAuth:z}=await import("./pinia-DbmXsomq.js").then(_e=>_e.i);return{getAuth:z}},__vite__mapDeps([0,1,2])),N=q(H).currentUser?.uid;if(!N)return;const ve=await ze(Ce(h,`polls/${L}/userVotes/${N}`)),Z=document.querySelector(".slide-iframe");if(!Z||!Z.contentWindow)return;if(ve.exists()){const z=ve.val();typeof z=="string"&&/^\d+$/.test(z)?Z.contentWindow.postMessage({type:"poll-state",pollId:L,optionId:String(z)},"*"):z&&Z.contentWindow.postMessage({type:"poll-state",pollId:L,text:String(z)},"*")}}}catch(e){b.error("ğŸ—³ï¸ admin poll sync error:",e)}};window.addEventListener("message",l);const o=new Image;o.onload=()=>{console.log("âœ… ë°°ê²½ ì´ë¯¸ì§€ ë¡œë”© ì„±ê³µ:",o.src)},o.onerror=()=>{console.error("âŒ ë°°ê²½ ì´ë¯¸ì§€ ë¡œë”© ì‹¤íŒ¨:",o.src)},o.src="/images/20250806_1231_churchtech.png"}),oe(()=>[t.currentLesson,t.currentSlide],async([l,o])=>{if(l!==void 0&&o!==void 0&&(console.log(`ğŸ”„ IndexPage - ìŠ¤í† ì–´ ë³€ê²½ ê°ì§€: lesson=${l}, slide=${o}`),!_.value))try{console.log(`ğŸ“‚ í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹œì‘: ${l}-${o}`);const u=await t.loadSlideContentForEditing(l,o);console.log("âœ… í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì™„ë£Œ:",{contentLength:u.length,contentPreview:u.substring(0,100)}),g.value=u}catch(u){console.error("âŒ í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹¤íŒ¨:",u),g.value=`# ìŠ¬ë¼ì´ë“œ ${l}-${o}

ìƒˆë¡œìš´ ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”.`}},{immediate:!0}),De(()=>{document.removeEventListener("keydown",O),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",Se)}),(l,o)=>(w(),le(Oe,{class:"index-page"},{default:y(()=>[o[5]||(o[5]=s("div",{class:"login-background"},null,-1)),s("div",Rt,[s("div",{class:Re(["slide-viewer-container",{"with-editor":!_.value}]),style:Ve(ye.value)},[(w(),le(at,{key:te.value,"slide-number":fe.value,"slide-type":v.value},null,8,["slide-number","slide-type"])),V.value&&v.value==="poll"?(w(),le(T,{key:0,class:"poll-admin-fab",round:"",color:"negative",icon:"delete",disable:!ue.value,onClick:o[0]||(o[0]=u=>ge(ue.value))},{default:y(()=>[a(We,null,{default:y(()=>o[2]||(o[2]=[ie("ê²°ê³¼ ì´ˆê¸°í™”",-1)])),_:1,__:[2]})]),_:1},8,["disable"])):Y("",!0)],6),_.value?Y("",!0):(w(),I("div",{key:0,class:"resizer-bar",onMousedown:we},null,32)),_.value?Y("",!0):(w(),I("div",{key:1,class:"editor-container",style:Ve(be.value)},[a(Pt,{"current-slide-type":v.value,"current-slide-info":C.value,"current-lesson":d.value,"current-slide":E.value,"current-slide-content":g.value,"is-applying":D.value,onSlideContentSave:F,onSlideContentChange:c,onSlidePreview:$,onCreateMarkdownFile:J,onAutoUpdate:X,onUpdateToc:U,onAddNewSlide:G,onApplySlide:B,ref_key:"slideEditorSection",ref:P},null,8,["current-slide-type","current-slide-info","current-lesson","current-slide","current-slide-content","is-applying"])],4)),_.value?(w(),I("div",Ft,[a(T,{disable:he.value,onClick:n,color:"blue","text-color":"white",icon:"chevron_left",round:"",size:"lg",class:"nav-btn"},null,8,["disable"]),s("div",Wt,[s("span",Ot,Q(Ie(t).currentLesson)+"-"+Q(Ie(t).currentSlide+1),1)]),a(T,{disable:ne.value,onClick:r,color:"blue","text-color":"white",icon:"chevron_right",round:"",size:"lg",class:"nav-btn"},null,8,["disable"])])):Y("",!0),_.value?Y("",!0):(w(),I("div",Ht,[a(Ue,{class:"bg-orange text-white",rounded:""},{avatar:y(()=>[a(se,{name:"edit"})]),default:y(()=>[o[3]||(o[3]=s("div",{class:"text-body2"},[s("strong",null,"í¸ì§‘ê¸° ëª¨ë“œ"),s("br"),ie(" í˜„ì¬ í¸ì§‘ê¸° ëª¨ë“œì…ë‹ˆë‹¤. í”„ë ˆì  í…Œì´ì…˜ ëª¨ë“œë¡œ ì „í™˜í•˜ë ¤ë©´ ìƒë‹¨ì˜ í¸ì§‘ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”. ")],-1))]),_:1,__:[3]})]))]),S.value&&_.value?(w(),le(Ue,{key:0,class:"bg-info text-white keyboard-help",rounded:""},{avatar:y(()=>[a(se,{name:"keyboard"})]),action:y(()=>[a(T,{flat:"",color:"white",label:"ë‹«ê¸°",onClick:o[1]||(o[1]=u=>S.value=!1)})]),default:y(()=>[o[4]||(o[4]=s("div",{class:"text-body2"},[s("strong",null,"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤:"),s("br"),ie(" â† â†’ : ì´ì „/ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ | Space : ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ"),s("br"),ie(" Home/End : ì²˜ìŒ/ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œ | F11 : ì „ì²´í™”ë©´"),s("br"),ie(" ESC : í¸ì§‘ê¸° ëª¨ë“œ | ? : ë„ì›€ë§ í† ê¸€ ")],-1))]),_:1,__:[4]})):Y("",!0)]),_:1,__:[5]}))}}),al=pe(Kt,[["__scopeId","data-v-8399d9a2"]]);export{al as default};
