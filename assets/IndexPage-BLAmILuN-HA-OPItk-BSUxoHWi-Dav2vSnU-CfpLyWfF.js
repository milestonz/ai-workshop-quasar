const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm-Dz7aj0ta-DJp4I3dk.js","assets/index-bfaO29LJ.js","assets/index-DJuvGez9.css"])))=>i.map(i=>d[i]);
import{e as he,q as f,H as T,a as E,g as ae,M as S,j as n,F as o,f as oe,x as W,Y as Q,c as Ae,S as Re,A as Fe,T as D,L as y,W as te,h as Ue,C as Qe,o as Je,D as Ne,I as Ze,K as ie,b as ze,E as P,G as Ce,P as Te,R as Me,U as De,X as Ee,_ as Ve,a0 as Be,a1 as Ie,a2 as Ye,a3 as Xe}from"./index-bfaO29LJ.js";import{t as qe,Q as ee,e as We,o as je,W as Ke}from"./QDialog-CXn2kBax-C53UdG9D-kpCzhlJn-Ct8CcPim-C14yZ5bv.js";import{m as He}from"./QBanner-BY0ggvyL-C3yUuPRa-BwL-ftRS-cN7vJrVL-BjnZ2Mn0.js";import{m as Ge}from"./QPage-B1iJaq8H-BMxUDXKn-BbD7X6VY-Dn1durxV-DWHOfzTo.js";import{Q as w,e as B,t as el,l as ll}from"./useGuestAuth-Mxd3jo-z-qhm8zfOu-DqDS1hTw-Cc0JXHbt-OFDxhl0U.js";import{Q as tl}from"./QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm-Dz7aj0ta-DJp4I3dk.js";import{d as be}from"./_plugin-vue_export-helper-DXafCR7g-cPVpln50-BTORSsEs-W54BP04g-B7ga8-1f.js";import{J as al}from"./QChip-BJIOjoIv-Djywe0kj-DBt41SH2-XBnHkNao-C4tEq5Mn.js";import{M as ol,b as Oe}from"./marked.esm-mI6KSz_d-CXpNVb3h-Dfg0gaKB-BbWEG7lg-CMpNtlPl.js";import"./pinia-DRC1X92K-CVhvq81r-C7Q22G7M-BcPAhq85-BnAtjUhT.js";const me=($,r=me,h=r.f||(r.f=["assets/QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm-Dz7aj0ta.js","assets/index-CyCqcZIQ.js","assets/index-D7VONvhQ.css"]))=>$.map(c=>h[c]),fe=($,r=fe,h=r.f||(r.f=["assets/QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm.js","assets/index-D1vT6N3s.js","assets/index-C_LQcHkP.css"]))=>$.map(c=>h[c]),ge=($,r=ge,h=r.f||(r.f=["assets/QSpinnerDots-DmD6LJEW-mqbZkDZd.js","assets/index-Bw1AfG2u.js","assets/index-B0WZdqPn.css"]))=>$.map(c=>h[c]),ye=($,r=ye,h=r.f||(r.f=["assets/QSpinnerDots-DmD6LJEW.js","assets/index-BynyowXf.js","assets/index-BOcY-vOO.css"]))=>$.map(c=>h[c]),sl={class:"simple-slide-viewer"},nl={key:0,class:"error"},il={key:1,class:"html-slide-container"},rl=["innerHTML"],ul={key:2,class:"slide-iframe-container"},cl=["src"],dl={key:0,class:"loading-overlay"},vl={key:3,class:"no-content"},pl=he({__name:"SimpleSlideViewer",props:{slideNumber:{},slideType:{}},setup($){const r=$,h=f(""),c=f(!1),e=f(""),_=T(()=>r.slideNumber?`/generated/slides/slide-${r.slideNumber}.html`:""),v=async()=>{if(r.slideType==="html")try{c.value=!0;const g=await fetch(`/slides/slide-${r.slideNumber}.md`);if(g.ok){const M=await g.text();e.value=M.replace(/^@html\s*\n?/gm,"").trim(),w.log(`‚úÖ HTML Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö© Î°úÎìú ÏôÑÎ£å: ${r.slideNumber}`)}else h.value=`HTML Ïä¨ÎùºÏù¥Îìú ${r.slideNumber} Î°úÎî© Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.`,w.error(`HTML Ïä¨ÎùºÏù¥Îìú ${r.slideNumber} Î°úÎî© Ïã§Ìå®:`,g.status)}catch(g){h.value=`HTML Ïä¨ÎùºÏù¥Îìú ${r.slideNumber} Î°úÎî© Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.`,w.error(`HTML Ïä¨ÎùºÏù¥Îìú ${r.slideNumber} Î°úÎî© Ïò§Î•ò:`,g)}finally{c.value=!1}},V=()=>{c.value=!1,w.log(`‚úÖ iframe Î°úÎìú ÏôÑÎ£å: ${_.value}`)},x=g=>{h.value=`Ïä¨ÎùºÏù¥Îìú ${r.slideNumber} Î°úÎî© Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.`,w.error(`Ïä¨ÎùºÏù¥Îìú ${r.slideNumber} Î°úÎî© Ï§ë Ïò§Î•ò Î∞úÏÉù:`,g),c.value=!1},j=()=>{c.value=!1,w.log(`‚úÖ HTML Ïä¨ÎùºÏù¥Îìú Î°úÎìú ÏôÑÎ£å: ${r.slideNumber}`)};return ae(()=>r.slideNumber,g=>{g&&(c.value=!0,h.value="",r.slideType==="html"?v():(w.log(`üîÑ iframe URL Î≥ÄÍ≤Ω: ${_.value}`),setTimeout(()=>{c.value&&(c.value=!1,w.log("‚ö†Ô∏è Ïä¨ÎùºÏù¥Îìú Î°úÎî© ÏãúÍ∞Ñ Ï¥àÍ≥º"))},3e3)))},{immediate:!0}),(g,M)=>(S(),E("div",sl,[h.value?(S(),E("div",nl,[n(oe,{name:"error",size:"50px",color:"negative"}),o("p",null,W(h.value),1)])):g.slideType==="html"&&e.value?(S(),E("div",il,[o("div",{class:"html-slide-content",innerHTML:e.value,onLoad:j},null,40,rl)])):_.value?(S(),E("div",ul,[o("iframe",{src:_.value,class:"slide-iframe",onLoad:V,onError:x},null,40,cl),c.value?(S(),E("div",dl,[n(tl,{size:"50px",color:"primary"}),M[0]||(M[0]=o("p",null,"Ïä¨ÎùºÏù¥Îìú Î°úÎî© Ï§ë...",-1))])):Q("",!0)])):(S(),E("div",vl,[n(oe,{name:"slideshow",size:"50px",color:"grey"}),M[1]||(M[1]=o("p",null,"ÌëúÏãúÌï† Ïä¨ÎùºÏù¥ÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§.",-1))]))]))}}),ml=be(pl,[["__scopeId","data-v-2a03a82a"]]),fl=$=>{if(!$)return"";Oe.setOptions({breaks:!1,gfm:!0});let r=Oe($);return typeof r=="string"&&(r=r.replace(/<p>/g,"<div>").replace(/<\/p>/g,"</div>")),typeof r=="string"?r:$},gl={class:"markdown-editor"},yl={class:"editor-header"},hl={class:"editor-actions"},bl={class:"row q-col-gutter-md"},wl={class:"col-12"},Sl={key:0,class:"col-12"},$l=["src"],_l={class:"col-12"},xl={class:"col-6"},kl={class:"col-6"},Ll={class:"row q-col-gutter-md"},Cl={class:"col-12"},Tl={key:0,class:"col-12"},Ml={class:"youtube-preview"},Dl=["src"],El={class:"col-12"},Vl={class:"col-6"},Il={class:"col-6"},ql={class:"editor-content"},Al={class:"text-caption text-grey-6 q-mt-xs"},Ul=he({__name:"MarkdownEditor",props:{initialContent:{default:""},slideId:{default:""}},emits:["save","contentChange","autoUpdate"],setup($,{expose:r,emit:h}){const c=$,e=h,_=Ae(),v=f(c.initialContent),V=f(!1),x=f(!0),j=f(null),g=f(null),M=f(c.initialContent),U=f(!1),I=f(null),H=f(null),O=f(""),p=f(null),k=f(null),Y=f(!1),X=f(""),q=f(""),K=f(""),N=f(null),J=f(null);T(()=>{try{return fl(v.value)}catch(u){return console.error("Markdown Î†åÎçîÎßÅ Ïò§Î•ò:",u),v.value}});const le=()=>{e("contentChange",v.value),xe()},we=()=>{U.value=!0,m()},m=()=>{I.value=null,H.value=null,O.value="",p.value=null,k.value=null},re=u=>{if(u){I.value=u;const s=new FileReader;s.onload=d=>{H.value=d.target?.result},s.readAsDataURL(u)}},ue=()=>{U.value=!1,m()},Se=()=>{if(I.value)try{const u=new FileReader;u.onload=s=>{const d=s.target?.result;let L=`![${O.value||"Ïù¥ÎØ∏ÏßÄ"}](${d})`;if(p.value||k.value){const Z=p.value?` width="${p.value}"`:"",F=k.value?` height="${k.value}"`:"";L=`<img src="${d}" alt="${O.value||"Ïù¥ÎØ∏ÏßÄ"}"${Z}${F} style="display: block; margin: 0 auto; max-width: 100%;" />`}const R=document.querySelector(".markdown-textarea textarea");if(R){const Z=R.selectionStart,F=R.selectionEnd,t=v.value.substring(0,Z),a=v.value.substring(F);v.value=t+`
`+L+`
`+a,setTimeout(()=>{const i=Z+L.length+2;R.setSelectionRange(i,i),R.focus()},0)}else v.value+=`
`+L+`
`;le(),U.value=!1,m(),_.notify({type:"positive",message:"Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÇΩÏûÖÎêòÏóàÏäµÎãàÎã§.",position:"top"})},u.readAsDataURL(I.value)}catch(u){console.error("Ïù¥ÎØ∏ÏßÄ ÏÇΩÏûÖ Ïò§Î•ò:",u),_.notify({type:"negative",message:"Ïù¥ÎØ∏ÏßÄ ÏÇΩÏûÖ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",position:"top"})}},$e=()=>{Y.value=!0,se()},se=()=>{X.value="",q.value="",K.value="",N.value=null,J.value=null},ce=u=>{if(typeof u=="string"){X.value=u;const s=de(u);q.value=s}else X.value="",q.value=""},de=u=>{const s=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/watch\?.*v=([^&\n?#]+)/];for(const d of s){const L=u.match(d);if(L&&L[1])return L[1]}return""},ne=()=>{Y.value=!1,se()},_e=()=>{if(q.value)try{let u="";if(N.value||J.value){const d=N.value?` width="${N.value}"`:"",L=J.value?` height="${J.value}"`:"";u=`<iframe src="https://www.youtube.com/embed/${q.value}"${d}${L} frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display: block; margin: 0 auto; max-width: 100%;"></iframe>`}else u=`<div class="youtube-fullscreen">
  <iframe
    src="https://www.youtube.com/embed/${q.value}"
    width="100%"
    height="100%"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
  ></iframe>
</div>`;K.value&&(u=`## ${K.value}

${u}`);const s=document.querySelector(".markdown-textarea textarea");if(s){const d=s.selectionStart,L=s.selectionEnd,R=v.value.substring(0,d),Z=v.value.substring(L);v.value=R+`
`+u+`
`+Z,setTimeout(()=>{const F=d+u.length+2;s.setSelectionRange(F,F),s.focus()},0)}else v.value+=`
`+u+`
`;le(),Y.value=!1,se(),_.notify({type:"positive",message:"YouTube ÏòÅÏÉÅÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÇΩÏûÖÎêòÏóàÏäµÎãàÎã§.",position:"top"})}catch(u){console.error("YouTube ÏÇΩÏûÖ Ïò§Î•ò:",u),_.notify({type:"negative",message:"YouTube ÏòÅÏÉÅ ÏÇΩÏûÖ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",position:"top"})}},xe=()=>{j.value&&clearTimeout(j.value),j.value=setTimeout(()=>{x.value&&(console.log("üîç [MarkdownEditor] ÏûêÎèô ÏóÖÎç∞Ïù¥Ìä∏"),console.log("üîç [MarkdownEditor] ÏóÖÎç∞Ïù¥Ìä∏ ÎÇ¥Ïö© Í∏∏Ïù¥:",v.value.length),console.log("üîç [MarkdownEditor] ÏóÖÎç∞Ïù¥Ìä∏ ÎÇ¥Ïö© ÎÅùÎ∂ÄÎ∂Ñ:",JSON.stringify(v.value.substring(v.value.length-20))),console.log("üéØ Ïã§ÏãúÍ∞Ñ Î∑∞Ïñ¥ ÏóÖÎç∞Ïù¥Ìä∏:",c.slideId,"ÎÇ¥Ïö©Í∏∏Ïù¥:",v.value.length),e("autoUpdate",v.value,c.slideId))},1e3)},ke=async()=>{V.value=!0;try{console.log("üîç [MarkdownEditor] Ï†ÄÏû• ÏãúÏûë"),console.log("üîç [MarkdownEditor] Ï†ÄÏû•Ìï† ÎÇ¥Ïö© Í∏∏Ïù¥:",v.value.length),console.log("üîç [MarkdownEditor] Ï†ÄÏû•Ìï† ÎÇ¥Ïö© ÎÅùÎ∂ÄÎ∂Ñ:",JSON.stringify(v.value.substring(v.value.length-20))),e("save",v.value,c.slideId),setTimeout(()=>{V.value=!1},1e3)}catch(u){console.error("Ï†ÄÏû• Ïò§Î•ò:",u),V.value=!1}};return ae(()=>c.initialContent,u=>{v.value=u,M.value=u}),ae(()=>c.slideId,u=>{console.log("slideId Î≥ÄÍ≤ΩÎê®:",u),v.value=c.initialContent,M.value=c.initialContent}),Re(()=>{M.value=v.value}),Fe(()=>{g.value&&clearTimeout(g.value)}),r({setContent:u=>{v.value=u},content:v}),(u,s)=>(S(),E("div",gl,[o("div",yl,[o("div",hl,[n(D,{flat:"",dense:"",size:"sm",icon:"image",label:"Ïù¥ÎØ∏ÏßÄ Ï≤®Î∂Ä",onClick:we,class:"q-mr-sm"}),n(D,{flat:"",dense:"",size:"sm",icon:"play_circle",label:"YouTube",onClick:$e,class:"q-mr-sm"}),n(D,{flat:"",dense:"",size:"sm",icon:"save",label:"Ï†ÄÏû•",onClick:ke,loading:V.value},null,8,["loading"])])]),n(je,{modelValue:U.value,"onUpdate:modelValue":s[4]||(s[4]=d=>U.value=d),persistent:""},{default:y(()=>[n(qe,{style:{"min-width":"400px"}},{default:y(()=>[n(ee,null,{default:y(()=>s[11]||(s[11]=[o("div",{class:"text-h6"},"Ïù¥ÎØ∏ÏßÄ Ï≤®Î∂Ä",-1)])),_:1,__:[11]}),n(ee,null,{default:y(()=>[o("div",bl,[o("div",wl,[n(ol,{modelValue:I.value,"onUpdate:modelValue":[s[0]||(s[0]=d=>I.value=d),re],label:"Ïù¥ÎØ∏ÏßÄ ÌååÏùº ÏÑ†ÌÉù",accept:".jpg,.jpeg,.png,.gif,.webp",outlined:"",dense:""},{prepend:y(()=>[n(oe,{name:"image"})]),_:1},8,["modelValue"])]),H.value?(S(),E("div",Sl,[s[12]||(s[12]=o("div",{class:"text-caption q-mb-xs"},"ÎØ∏Î¶¨Î≥¥Í∏∞:",-1)),o("img",{src:H.value,alt:"ÎØ∏Î¶¨Î≥¥Í∏∞",style:{"max-width":"100%","max-height":"200px","object-fit":"contain"}},null,8,$l)])):Q("",!0),o("div",_l,[n(B,{modelValue:O.value,"onUpdate:modelValue":s[1]||(s[1]=d=>O.value=d),label:"Ïù¥ÎØ∏ÏßÄ ÏÑ§Î™Ö (alt ÌÖçÏä§Ìä∏)",outlined:"",dense:"",placeholder:"Ïù¥ÎØ∏ÏßÄÏóê ÎåÄÌïú ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"},null,8,["modelValue"])]),o("div",xl,[n(B,{modelValue:p.value,"onUpdate:modelValue":s[2]||(s[2]=d=>p.value=d),modelModifiers:{number:!0},label:"ÎÑàÎπÑ (px)",type:"number",outlined:"",dense:"",placeholder:"ÏûêÎèô"},null,8,["modelValue"])]),o("div",kl,[n(B,{modelValue:k.value,"onUpdate:modelValue":s[3]||(s[3]=d=>k.value=d),modelModifiers:{number:!0},label:"ÎÜíÏù¥ (px)",type:"number",outlined:"",dense:"",placeholder:"ÏûêÎèô"},null,8,["modelValue"])])])]),_:1}),n(We,{align:"right"},{default:y(()=>[n(D,{flat:"",label:"Ï∑®ÏÜå",onClick:ue}),n(D,{color:"primary",label:"ÏÇΩÏûÖ",onClick:Se,disable:!I.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(je,{modelValue:Y.value,"onUpdate:modelValue":s[9]||(s[9]=d=>Y.value=d),persistent:""},{default:y(()=>[n(qe,{style:{"min-width":"400px"}},{default:y(()=>[n(ee,null,{default:y(()=>s[13]||(s[13]=[o("div",{class:"text-h6"},"YouTube ÏòÅÏÉÅ Ï∂îÍ∞Ä",-1)])),_:1,__:[13]}),n(ee,null,{default:y(()=>[o("div",Ll,[o("div",Cl,[n(B,{modelValue:X.value,"onUpdate:modelValue":[s[5]||(s[5]=d=>X.value=d),ce],label:"YouTube ÎßÅÌÅ¨",outlined:"",dense:"",placeholder:"https://www.youtube.com/watch?v=..."},{prepend:y(()=>[n(oe,{name:"play_circle"})]),_:1},8,["modelValue"])]),q.value?(S(),E("div",Tl,[s[14]||(s[14]=o("div",{class:"text-caption q-mb-xs"},"ÎØ∏Î¶¨Î≥¥Í∏∞:",-1)),o("div",Ml,[o("iframe",{src:`https://www.youtube.com/embed/${q.value}`,width:"100%",height:"200",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,Dl)])])):Q("",!0),o("div",El,[n(B,{modelValue:K.value,"onUpdate:modelValue":s[6]||(s[6]=d=>K.value=d),label:"ÏòÅÏÉÅ Ï†úÎ™© (ÏÑ†ÌÉùÏÇ¨Ìï≠)",outlined:"",dense:"",placeholder:"ÏòÅÏÉÅÏóê ÎåÄÌïú ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"},null,8,["modelValue"])]),o("div",Vl,[n(B,{modelValue:N.value,"onUpdate:modelValue":s[7]||(s[7]=d=>N.value=d),modelModifiers:{number:!0},label:"ÎÑàÎπÑ (px)",type:"number",outlined:"",dense:"",placeholder:"ÏûêÎèô"},null,8,["modelValue"])]),o("div",Il,[n(B,{modelValue:J.value,"onUpdate:modelValue":s[8]||(s[8]=d=>J.value=d),modelModifiers:{number:!0},label:"ÎÜíÏù¥ (px)",type:"number",outlined:"",dense:"",placeholder:"ÏûêÎèô"},null,8,["modelValue"])])])]),_:1}),n(We,{align:"right"},{default:y(()=>[n(D,{flat:"",label:"Ï∑®ÏÜå",onClick:ne}),n(D,{color:"primary",label:"ÏÇΩÏûÖ",onClick:_e,disable:!q.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o("div",ql,[n(B,{modelValue:v.value,"onUpdate:modelValue":[s[10]||(s[10]=d=>v.value=d),le],type:"textarea",placeholder:"Markdown ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...",rows:"15",outlined:"",dense:"",class:"markdown-textarea"},null,8,["modelValue"]),o("div",Al,W(v.value.length)+"Ïûê / 10000Ïûê",1)])]))}}),Nl=be(Ul,[["__scopeId","data-v-3f0ce4c0"]]),zl={class:"q-my-none editor-title"},Wl={class:"text-caption text-grey-6 q-mt-xs"},jl={class:"row items-center justify-between q-mb-sm"},Hl={class:"col"},Ol={class:"text-subtitle2 text-weight-medium"},Rl={class:"text-caption text-grey-6"},Fl={class:"col-auto"},Pl={class:"text-caption text-grey-6"},Ql={class:"row q-gutter-sm q-mb-md"},Jl={class:"q-mt-md text-right"},Zl=he({__name:"SlideEditorSection",props:{currentSlideType:{},currentSlideInfo:{},currentLesson:{},currentSlide:{},currentSlideContent:{},isApplying:{type:Boolean}},emits:["slideContentSave","slideContentChange","slidePreview","createMarkdownFile","autoUpdate","updateTOC","addNewSlide","applySlide"],setup($,{expose:r,emit:h}){const c=$,e=h,_=Ae(),v=f(),V=f(!1),x=(p,k)=>{e("slideContentSave",p,k)},j=p=>{e("slideContentChange",p)},g=p=>{e("slidePreview",p)},M=(p,k)=>{e("createMarkdownFile",p,k)},U=(p,k)=>{e("autoUpdate",p,k)},I=async()=>{V.value=!0;try{e("updateTOC"),_.notify({type:"positive",message:"Î™©Ï∞® ÏóÖÎç∞Ïù¥Ìä∏Í∞Ä ÏãúÏûëÎêòÏóàÏäµÎãàÎã§",position:"top",timeout:2e3,icon:"refresh",actions:[{label:"ÌôïÏù∏",color:"white"}]})}catch{_.notify({type:"negative",message:"Î™©Ï∞® ÏóÖÎç∞Ïù¥Ìä∏ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§",position:"top",timeout:3e3,icon:"error",actions:[{label:"ÌôïÏù∏",color:"white"}]})}finally{V.value=!1}},H=()=>{e("addNewSlide")},O=()=>{e("applySlide",`${c.currentLesson}-${c.currentSlide}`)};return r({markdownEditor:v}),(p,k)=>(S(),te(qe,{class:"sidebar-card q-mt-md"},{default:y(()=>[n(ee,null,{default:y(()=>[o("h6",zl,W(p.currentSlideType==="chapter"?"Chapter Ìé∏ÏßëÍ∏∞":"Ïä¨ÎùºÏù¥Îìú Ìé∏ÏßëÍ∏∞"),1),o("div",Wl,W(p.currentSlideType==="chapter"?"Chapter ÎÇ¥Ïö©ÏùÑ Ìé∏ÏßëÌïòÏÑ∏Ïöî":"Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö©ÏùÑ Ìé∏ÏßëÌïòÏÑ∏Ïöî"),1)]),_:1}),n(ee,{class:"q-pt-none current-slide-info-section"},{default:y(()=>[o("div",jl,[o("div",Hl,[o("div",Ol,W(p.currentSlideInfo?.lessonTitle),1),o("div",Rl,W(p.currentSlideInfo?.slideTitle),1)]),o("div",Fl,[n(al,{size:"sm",color:"primary","text-color":"white",label:`${p.currentSlideInfo?.slideIndex}/${p.currentSlideInfo?.totalSlides}`},null,8,["label"])])]),o("div",Pl," Í∞ïÏùò "+W(p.currentSlideInfo?.lessonNumber)+"/"+W(p.currentSlideInfo?.totalLessons),1)]),_:1}),n(ee,{class:"q-pt-none"},{default:y(()=>[o("div",Ql,[n(D,{icon:"refresh",label:"Î™©Ï∞® ÏóÖÎç∞Ïù¥Ìä∏",onClick:I,loading:V.value,color:"primary"},null,8,["loading"]),n(D,{icon:"add",label:"ÏÉà Ïä¨ÎùºÏù¥Îìú",onClick:H,color:"positive"})]),(S(),te(Nl,{key:`${p.currentLesson}-${p.currentSlide}`,"initial-content":p.currentSlideContent,"slide-id":`${p.currentLesson}-${p.currentSlide}`,onSave:x,onContentChange:j,onPreview:g,onCreateMarkdown:M,onAutoUpdate:U,ref_key:"markdownEditor",ref:v},null,8,["initial-content","slide-id"])),o("div",Jl,[n(D,{color:"accent",icon:"check_circle",label:"Ïä¨ÎùºÏù¥Îìú Î∞òÏòÅ",onClick:O,loading:p.isApplying,disable:p.isApplying},null,8,["loading","disable"])])]),_:1})]),_:1}))}}),Bl=be(Zl,[["__scopeId","data-v-cda91fc6"]]),Yl={class:"main-content"},Xl={key:2,class:"navigation-controls"},Kl={class:"slide-info"},Gl={class:"slide-counter"},et={key:3,class:"editor-mode-notice"},lt=20,tt=80,at=he({__name:"IndexPage",setup($){const{userRole:r}=Ue(),h=T(()=>r.value==="admin"),c=Ae();Qe(),Je();const e=el();Ue(),ll();const _=f(!1),v=T(()=>e.currentLesson),V=T(()=>e.currentSlide),x=T(()=>e.isPresentationMode);ae(()=>x.value,async t=>{if(console.log(`üé≠ Ìé∏ÏßëÍ∏∞ Î™®Îìú Î≥ÄÍ≤Ω: ${t?"ÌîÑÎ†àÏ††ÌÖåÏù¥ÏÖò":"Ìé∏ÏßëÍ∏∞"}`),!t)try{const a=e.currentLesson,i=e.currentSlide;console.log(`üìÇ Ìé∏ÏßëÍ∏∞ Î™®Îìú Ï†ÑÌôò - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú: ${a}-${i}`);const l=await e.loadSlideContentForEditing(a,i);console.log("‚úÖ Ìé∏ÏßëÍ∏∞ Î™®Îìú Ï†ÑÌôò - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú ÏôÑÎ£å:",{contentLength:l.length,contentPreview:l.substring(0,100)}),g.value=l}catch(a){console.error("‚ùå Ìé∏ÏßëÍ∏∞ Î™®Îìú Ï†ÑÌôò - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú Ïã§Ìå®:",a);const i=e.currentLesson,l=e.currentSlide;g.value=`# Ïä¨ÎùºÏù¥Îìú ${i}-${l}

ÏÉàÎ°úÏö¥ Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî.`}}),ae([()=>e.currentLesson,()=>e.currentSlide],async()=>{await re(e.currentLesson,e.currentSlide),U.value&&setTimeout(()=>{I()},500)});const j=f(),g=f(""),M=T(()=>({lessonTitle:`Í∞ïÏùò ${e.currentLesson+1}`,slideTitle:`Ïä¨ÎùºÏù¥Îìú ${e.currentSlide+1}`,slideIndex:e.currentSlide+1,totalSlides:e.currentLessonData?.slides||0,lessonNumber:e.currentLesson+1,totalLessons:e.lessons.length})),U=T(()=>`${e.currentLesson}-${e.currentSlide}`.startsWith("1-1")&&e.currentSlide>=13),I=()=>{U.value&&setTimeout(()=>{try{const t=document.querySelector(".slide-iframe");if(t&&t.contentDocument){const a=t.contentDocument.querySelectorAll(".quiz-option");a.forEach(i=>{i.removeEventListener("click",H),i.addEventListener("click",H),i.style.cursor="pointer",i.style.transition="all 0.2s ease"}),w.log(`‚úÖ Quiz Ïù¥Î≤§Ìä∏ Ï£ºÏûÖ ÏôÑÎ£å: ${a.length}Í∞ú ÏòµÏÖò`)}}catch(t){w.warn("‚ö†Ô∏è Quiz Ïù¥Î≤§Ìä∏ Ï£ºÏûÖ Ïã§Ìå®:",t)}},200)},H=t=>{t.preventDefault(),t.stopPropagation();const a=t.target,i=a.getAttribute("data-idx"),l=document.querySelector(".slide-iframe");if(l&&l.contentDocument){const b=l.contentDocument.getElementById("quiz-answer-data"),C=l.contentDocument.querySelectorAll(".quiz-option");b&&(b.style.display="block"),C.forEach(A=>A.classList.remove("selected")),a.classList.add("selected"),w.log(`üéØ Quiz ÏòµÏÖò ÌÅ¥Î¶≠: ${i}Î≤à ÏÑ†ÌÉù, Ï†ïÎãµ ÌëúÏãú`)}},O=t=>{w.log("Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö© Ï†ÄÏû•:",t),g.value=t},p=t=>{w.log("Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö© Î≥ÄÍ≤Ω:",t),g.value=t},k=()=>{w.log("Ïä¨ÎùºÏù¥Îìú ÎØ∏Î¶¨Î≥¥Í∏∞")},Y=()=>{console.log("ÎßàÌÅ¨Îã§Ïö¥ ÌååÏùº ÏÉùÏÑ±")},X=()=>{console.log("ÏûêÎèô ÏóÖÎç∞Ïù¥Ìä∏")},q=()=>{console.log("Î™©Ï∞® ÏóÖÎç∞Ïù¥Ìä∏")},K=()=>{w.log("ÏÉà Ïä¨ÎùºÏù¥Îìú Ï∂îÍ∞Ä")},N=f(!1),J=async t=>{N.value=!0;try{w.log("üîÑ Ïä¨ÎùºÏù¥Îìú Î∞òÏòÅ ÏãúÏûë:",t);const[a="0",i="0"]=(t||"0-0").split("-"),l=`${a}-${i}`;if(await e.saveSlideToFirebaseStorage(l,g.value)){console.log("‚úÖ Firebase StorageÏóê MD ÌååÏùº Ï†ÄÏû• ÏôÑÎ£å:",l),le.value++,c.notify({type:"positive",message:"Ïä¨ÎùºÏù¥ÎìúÍ∞Ä Firebase StorageÏóê ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!",position:"top",timeout:3e3,icon:"cloud_done",actions:[{label:"ÌôïÏù∏",color:"white"}]});const b=new Blob([g.value],{type:"text/markdown"}),C=URL.createObjectURL(b),A=document.createElement("a");A.href=C,A.download=`slide-${l}.md`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(C),console.log("üìÅ Î°úÏª¨ Î∞±ÏóÖ ÌååÏùºÎèÑ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§.")}else throw new Error("Firebase Storage Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");w.log("üéâ Ïä¨ÎùºÏù¥Îìú Î∞òÏòÅ ÏôÑÎ£å")}catch(a){w.error("‚ùå Firebase Storage Ï†ÄÏû• Ïã§Ìå®:",a),c.notify({type:"negative",message:"Firebase StorageÏóê Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.",position:"top",timeout:5e3,icon:"cloud_off",actions:[{label:"ÌôïÏù∏",color:"white"}]})}finally{N.value=!1}},le=f(0);T(()=>e.lessons.reduce((t,a)=>t+a.slides,0));const we=T(()=>`${e.currentLesson}-${e.currentSlide}`),m=f("lecture"),re=async(t,a)=>{try{const i=await fetch(`/slides/slide-${t}-${a}.md`);if(i.ok){const l=await i.text();if(l.trim().startsWith("@html"))m.value="html";else if(l.includes("@cover")||l.includes("Ïª§Î≤Ñ"))m.value="cover";else if(l.includes("@toc")||l.includes("Î™©Ï∞®"))m.value="toc";else if(l.includes("@poll")||l.includes("Ìà¨Ìëú"))m.value="poll";else if(l.includes("@stats")||l.includes("ÌÜµÍ≥Ñ"))m.value="stats";else if(l.includes("@interactive")||l.includes("Ïù∏ÌÑ∞ÎûôÌã∞Î∏å"))m.value="interactive";else if(l.includes("@example")||l.includes("ÏòàÏãú"))m.value="example";else if(l.includes("@challenge")||l.includes("ÎèÑÏ†Ñ"))m.value="challenge";else if(l.includes("@timeline")||l.includes("ÌÉÄÏûÑÎùºÏù∏"))m.value="timeline";else if(l.includes("@profile")||l.includes("ÌîÑÎ°úÌïÑ"))m.value="profile";else if(l.includes("@lecture")||l.includes("Í∞ïÏùò"))m.value="lecture";else if(l.includes("@chapter")||l.includes("Ï±ïÌÑ∞"))m.value="chapter";else{const b=`${t}-${a}`;b==="0-0"?m.value="cover":b==="0-1"?m.value="index":b==="0-2"?m.value="profile":b.endsWith("-0")?m.value="chapter":b.startsWith("2-")&&b!=="2-0"?m.value="example":b.startsWith("3-")&&b!=="3-0"?m.value="challenge":m.value="lecture"}}}catch(i){console.error(`Ïä¨ÎùºÏù¥Îìú ÌÉÄÏûÖ Í∞êÏßÄ Ïã§Ìå®: ${t}-${a}`,i);const l=`${t}-${a}`;l==="0-0"?m.value="cover":l==="0-1"?m.value="index":l==="0-2"?m.value="profile":l.endsWith("-0")?m.value="chapter":l.startsWith("2-")&&l!=="2-0"?m.value="example":l.startsWith("3-")&&l!=="3-0"?m.value="challenge":m.value="lecture"}},ue=T(()=>m.value!=="poll"?"":`poll-${e.currentLesson}-${e.currentSlide}`),Se=async t=>{try{if(!h.value||!t||!await c.dialog({title:"Í≤∞Í≥º Ï¥àÍ∏∞Ìôî",message:`Ìï¥Îãπ Ìà¨ÌëúÏùò ÎÇòÏùò ÏÑ†ÌÉù(LocalStorage)Í≥º RTDBÏùò ÌëúÍ∏∞Î•º ÏÇ≠Ï†úÌï†ÍπåÏöî?
Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.`,cancel:!0,ok:{label:"Ï¥àÍ∏∞Ìôî",color:"negative"}}).onOk(()=>!0).onCancel(()=>!1))return;try{Object.keys(localStorage).filter(i=>i.toLowerCase().includes("poll")).forEach(i=>localStorage.removeItem(i))}catch{}const a=P?Ce(P):null;if(a){const{getAuth:i}=await Te(async()=>{const{getAuth:b}=await Me(()=>De(()=>Ee(()=>Ve(()=>import("./QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm-Dz7aj0ta-DJp4I3dk.js"),__vite__mapDeps([0,1,2])),me([0,1,2])),fe([0,1,2])),ge([0,1,2])).then(C=>C.i);return{getAuth:b}},ye([0,1,2])),l=i(P).currentUser?.uid;l&&await Be(Ie(a,`polls/${t}/userVotes/${l}`)).catch(()=>{})}try{document.querySelector(".slide-iframe")?.contentWindow?.postMessage({type:"poll-state",pollId:t,optionId:""},"*")}catch{}c.notify({type:"positive",message:"Ìà¨Ìëú Í≤∞Í≥ºÍ∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.",position:"top"})}catch{c.notify({type:"negative",message:"Ï¥àÍ∏∞Ìôî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",position:"top"})}},$e=T(()=>e.currentLesson===0&&e.currentSlide===0),se=T(()=>{const t=e.lessons.length-1,a=e.lessons[t];return e.currentLesson===t&&e.currentSlide===(a?.slides||0)-1}),ce=f(60),de=f(40),ne=f(!1),_e=T(()=>x.value?{}:{flex:`0 0 ${ce.value}%`}),xe=T(()=>x.value?{}:{flex:`0 0 ${de.value}%`}),ke=t=>{ne.value=!0,document.body.style.cursor="col-resize"},u=()=>{ne.value=!1,document.body.style.cursor=""},s=t=>{if(!ne.value)return;const a=document.querySelector(".main-content");if(!a)return;const i=a.getBoundingClientRect(),l=(t.clientX-i.left)/i.width*100;l>lt&&l<tt&&(ce.value=l,de.value=100-l)},d=()=>{e.prevSlide()},L=()=>{e.nextSlide()},R=()=>{e.setCurrentLesson(0),e.setCurrentSlide(0)},Z=()=>{const t=e.lessons.length-1,a=e.lessons[t];a&&(e.setCurrentLesson(t),e.setCurrentSlide(a.slides-1))},F=t=>{if(x.value)switch(t.key){case"ArrowLeft":t.preventDefault(),d();break;case"ArrowRight":case" ":t.preventDefault(),L();break;case"Home":t.preventDefault(),R();break;case"End":t.preventDefault(),Z();break;case"?":t.preventDefault(),_.value=!_.value;break}};return Re(async()=>{await re(e.currentLesson,e.currentSlide),document.addEventListener("keydown",F),window.addEventListener("mousemove",s),window.addEventListener("mouseup",u);const t=async i=>{try{if(r.value!=="admin")return;const l=i.data||{};if(l&&l.type==="poll-vote"){const b=P?Ce(P):null;if(!b)return;const{pollId:C,optionId:A,text:ve}=l;if(!C)return;const{getAuth:pe}=await Te(async()=>{const{getAuth:Le}=await Me(()=>De(()=>Ee(()=>Ve(()=>import("./QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm-Dz7aj0ta-DJp4I3dk.js"),__vite__mapDeps([0,1,2])),me([0,1,2])),fe([0,1,2])),ge([0,1,2])).then(Pe=>Pe.i);return{getAuth:Le}},ye([0,1,2])),G=pe(P).currentUser?.uid;if(!G)return;const z=ve||String(A||"");await Ye(Ie(b,`polls/${C}/userVotes/${G}`),z),w.log("üó≥Ô∏è admin saved(userVotes):",{pollId:C,valueToSave:z})}if(l&&l.type==="poll-ready"){const b=P?Ce(P):null;if(!b)return;const{pollId:C}=l;if(!C)return;const{getAuth:A}=await Te(async()=>{const{getAuth:z}=await Me(()=>De(()=>Ee(()=>Ve(()=>import("./QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm-Dz7aj0ta-DJp4I3dk.js"),__vite__mapDeps([0,1,2])),me([0,1,2])),fe([0,1,2])),ge([0,1,2])).then(Le=>Le.i);return{getAuth:z}},ye([0,1,2])),ve=A(P).currentUser?.uid;if(!ve)return;const pe=await Xe(Ie(b,`polls/${C}/userVotes/${ve}`)),G=document.querySelector(".slide-iframe");if(!G||!G.contentWindow)return;if(pe.exists()){const z=pe.val();typeof z=="string"&&/^\d+$/.test(z)?G.contentWindow.postMessage({type:"poll-state",pollId:C,optionId:String(z)},"*"):z&&G.contentWindow.postMessage({type:"poll-state",pollId:C,text:String(z)},"*")}}}catch(l){w.error("üó≥Ô∏è admin poll sync error:",l)}};window.addEventListener("message",t);const a=new Image;a.onload=()=>{console.log("‚úÖ Î∞∞Í≤Ω Ïù¥ÎØ∏ÏßÄ Î°úÎî© ÏÑ±Í≥µ:",a.src)},a.onerror=()=>{console.error("‚ùå Î∞∞Í≤Ω Ïù¥ÎØ∏ÏßÄ Î°úÎî© Ïã§Ìå®:",a.src)},a.src="/images/20250806_1231_churchtech.png"}),ae(()=>[e.currentLesson,e.currentSlide],async([t,a])=>{if(t!==void 0&&a!==void 0&&(console.log(`üîÑ IndexPage - Ïä§ÌÜ†Ïñ¥ Î≥ÄÍ≤Ω Í∞êÏßÄ: lesson=${t}, slide=${a}`),!x.value))try{console.log(`üìÇ Ìé∏ÏßëÍ∏∞ Î™®Îìú - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú ÏãúÏûë: ${t}-${a}`);const i=await e.loadSlideContentForEditing(t,a);console.log("‚úÖ Ìé∏ÏßëÍ∏∞ Î™®Îìú - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú ÏôÑÎ£å:",{contentLength:i.length,contentPreview:i.substring(0,100)}),g.value=i}catch(i){console.error("‚ùå Ìé∏ÏßëÍ∏∞ Î™®Îìú - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú Ïã§Ìå®:",i),g.value=`# Ïä¨ÎùºÏù¥Îìú ${t}-${a}

ÏÉàÎ°úÏö¥ Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî.`}},{immediate:!0}),Fe(()=>{document.removeEventListener("keydown",F),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",u)}),(t,a)=>(S(),te(Ge,{class:"index-page"},{default:y(()=>[a[5]||(a[5]=o("div",{class:"login-background"},null,-1)),o("div",Yl,[o("div",{class:Ze(["slide-viewer-container",{"with-editor":!x.value}]),style:Ne(_e.value)},[(S(),te(ml,{key:le.value,"slide-number":we.value,"slide-type":m.value},null,8,["slide-number","slide-type"])),h.value&&m.value==="poll"?(S(),te(D,{key:0,class:"poll-admin-fab",round:"",color:"negative",icon:"delete",disable:!ue.value,onClick:a[0]||(a[0]=i=>Se(ue.value))},{default:y(()=>[n(Ke,null,{default:y(()=>a[2]||(a[2]=[ie("Í≤∞Í≥º Ï¥àÍ∏∞Ìôî",-1)])),_:1,__:[2]})]),_:1},8,["disable"])):Q("",!0)],6),x.value?Q("",!0):(S(),E("div",{key:0,class:"resizer-bar",onMousedown:ke},null,32)),x.value?Q("",!0):(S(),E("div",{key:1,class:"editor-container",style:Ne(xe.value)},[n(Bl,{"current-slide-type":m.value,"current-slide-info":M.value,"current-lesson":v.value,"current-slide":V.value,"current-slide-content":g.value,"is-applying":N.value,onSlideContentSave:O,onSlideContentChange:p,onSlidePreview:k,onCreateMarkdownFile:Y,onAutoUpdate:X,onUpdateToc:q,onAddNewSlide:K,onApplySlide:J,ref_key:"slideEditorSection",ref:j},null,8,["current-slide-type","current-slide-info","current-lesson","current-slide","current-slide-content","is-applying"])],4)),x.value?(S(),E("div",Xl,[n(D,{disable:$e.value,onClick:d,color:"blue","text-color":"white",icon:"chevron_left",round:"",size:"lg",class:"nav-btn"},null,8,["disable"]),o("div",Kl,[o("span",Gl,W(ze(e).currentLesson)+"-"+W(ze(e).currentSlide+1),1)]),n(D,{disable:se.value,onClick:L,color:"blue","text-color":"white",icon:"chevron_right",round:"",size:"lg",class:"nav-btn"},null,8,["disable"])])):Q("",!0),x.value?Q("",!0):(S(),E("div",et,[n(He,{class:"bg-orange text-white",rounded:""},{avatar:y(()=>[n(oe,{name:"edit"})]),default:y(()=>[a[3]||(a[3]=o("div",{class:"text-body2"},[o("strong",null,"Ìé∏ÏßëÍ∏∞ Î™®Îìú"),o("br"),ie(" ÌòÑÏû¨ Ìé∏ÏßëÍ∏∞ Î™®ÎìúÏûÖÎãàÎã§. ÌîÑÎ†àÏ††ÌÖåÏù¥ÏÖò Î™®ÎìúÎ°ú Ï†ÑÌôòÌïòÎ†§Î©¥ ÏÉÅÎã®Ïùò Ìé∏Ïßë Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî. ")],-1))]),_:1,__:[3]})]))]),_.value&&x.value?(S(),te(He,{key:0,class:"bg-info text-white keyboard-help",rounded:""},{avatar:y(()=>[n(oe,{name:"keyboard"})]),action:y(()=>[n(D,{flat:"",color:"white",label:"Îã´Í∏∞",onClick:a[1]||(a[1]=i=>_.value=!1)})]),default:y(()=>[a[4]||(a[4]=o("div",{class:"text-body2"},[o("strong",null,"ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§:"),o("br"),ie(" ‚Üê ‚Üí : Ïù¥Ï†Ñ/Îã§Ïùå Ïä¨ÎùºÏù¥Îìú | Space : Îã§Ïùå Ïä¨ÎùºÏù¥Îìú"),o("br"),ie(" Home/End : Ï≤òÏùå/ÎßàÏßÄÎßâ Ïä¨ÎùºÏù¥Îìú | F11 : Ï†ÑÏ≤¥ÌôîÎ©¥"),o("br"),ie(" ESC : Ìé∏ÏßëÍ∏∞ Î™®Îìú | ? : ÎèÑÏõÄÎßê ÌÜ†Í∏Ä ")],-1))]),_:1,__:[4]})):Q("",!0)]),_:1,__:[5]}))}}),mt=be(at,[["__scopeId","data-v-8399d9a2"]]);export{mt as default};
