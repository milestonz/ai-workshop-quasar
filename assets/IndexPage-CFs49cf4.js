const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QSpinnerDots-55T99jjC.js","assets/index-Bw1AfG2u.js","assets/index-B0WZdqPn.css"])))=>i.map(i=>d[i]);
import{c2 as me,bz as m,bJ as k,bF as oe,c3 as I,c6 as w,c5 as a,c4 as s,b$ as se,ch as P,cg as B,ck as Le,cc as De,cq as qe,c7 as T,cf as y,ce as le,cP as Te,cs as Y,ct as $e,_ as ke,cQ as ze,cv as Ce,cR as Qe,cd as Pe,cj as Re,cS as Ve,cT as Fe,ci as ie,cU as Ie,cV as Oe}from"./index-Bw1AfG2u.js";import{Q as Ee,l as xe,m as ee,n as Me,o as We}from"./QDialog-Dn9VjDcM.js";import{Q as Ue}from"./QBanner-DKpXtl0l.js";import{Q as He}from"./QPage-CLbIAi8L.js";import{s as b,Q as K,a as Ye,b as Be}from"./useGuestAuth-BRpWhMZD.js";import{Q as je}from"./QSpinnerDots-55T99jjC.js";import{_ as pe}from"./_plugin-vue_export-helper-DdgHTl4p.js";import{Q as Ke}from"./QChip-DM6F31S0.js";import{d as Ae,Q as Je}from"./marked.esm-CTrcEICt.js";import"./pinia-CUn_f_AT.js";const Ge={class:"simple-slide-viewer"},Xe={key:0,class:"error"},Ze={key:1,class:"html-slide-container"},et=["innerHTML"],tt={key:2,class:"slide-iframe-container"},lt=["src"],ot={key:0,class:"loading-overlay"},st={key:3,class:"no-content"},nt=me({__name:"SimpleSlideViewer",props:{slideNumber:{},slideType:{}},setup(A){const f=A,V=m(""),p=m(!1),t=m(""),S=k(()=>f.slideNumber?`/generated/slides/slide-${f.slideNumber}.html`:""),c=async()=>{if(f.slideType==="html")try{p.value=!0;const g=await fetch(`/slides/slide-${f.slideNumber}.md`);if(g.ok){const C=await g.text();t.value=C.replace(/^@html\s*\n?/gm,"").trim(),b.log(`âœ… HTML ìŠ¬ë¼ì´ë“œ ë‚´ìš© ë¡œë“œ ì™„ë£Œ: ${f.slideNumber}`)}else V.value=`HTML ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`HTML ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì‹¤íŒ¨:`,g.status)}catch(g){V.value=`HTML ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`HTML ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì˜¤ë¥˜:`,g)}finally{p.value=!1}},E=()=>{p.value=!1,b.log(`âœ… iframe ë¡œë“œ ì™„ë£Œ: ${S.value}`)},_=g=>{V.value=`ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`ìŠ¬ë¼ì´ë“œ ${f.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ:`,g),p.value=!1},R=()=>{p.value=!1,b.log(`âœ… HTML ìŠ¬ë¼ì´ë“œ ë¡œë“œ ì™„ë£Œ: ${f.slideNumber}`)};return oe(()=>f.slideNumber,g=>{g&&(p.value=!0,V.value="",f.slideType==="html"?c():(b.log(`ğŸ”„ iframe URL ë³€ê²½: ${S.value}`),setTimeout(()=>{p.value&&(p.value=!1,b.log("âš ï¸ ìŠ¬ë¼ì´ë“œ ë¡œë”© ì‹œê°„ ì´ˆê³¼"))},3e3)))},{immediate:!0}),(g,C)=>(w(),I("div",Ge,[V.value?(w(),I("div",Xe,[a(se,{name:"error",size:"50px",color:"negative"}),s("p",null,P(V.value),1)])):g.slideType==="html"&&t.value?(w(),I("div",Ze,[s("div",{class:"html-slide-content",innerHTML:t.value,onLoad:R},null,40,et)])):S.value?(w(),I("div",tt,[s("iframe",{src:S.value,class:"slide-iframe",onLoad:E,onError:_},null,40,lt),p.value?(w(),I("div",ot,[a(je,{size:"50px",color:"primary"}),C[0]||(C[0]=s("p",null,"ìŠ¬ë¼ì´ë“œ ë¡œë”© ì¤‘...",-1))])):B("",!0)])):(w(),I("div",st,[a(se,{name:"slideshow",size:"50px",color:"grey"}),C[1]||(C[1]=s("p",null,"í‘œì‹œí•  ìŠ¬ë¼ì´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.",-1))]))]))}}),at=pe(nt,[["__scopeId","data-v-2a03a82a"]]),it=A=>{if(!A)return"";Ae.setOptions({breaks:!1,gfm:!0});let f=Ae(A);return typeof f=="string"&&(f=f.replace(/<p>/g,"<div>").replace(/<\/p>/g,"</div>")),typeof f=="string"?f:A},rt={class:"markdown-editor"},ut={class:"editor-header"},ct={class:"editor-actions"},dt={class:"row q-col-gutter-md"},vt={class:"col-12"},mt={key:0,class:"col-12"},pt=["src"],ft={class:"col-12"},gt={class:"col-6"},ht={class:"col-6"},yt={class:"row q-col-gutter-md"},bt={class:"col-12"},wt={key:0,class:"col-12"},St={class:"youtube-preview"},_t=["src"],$t={class:"col-12"},kt={class:"col-6"},Ct={class:"col-6"},xt={class:"editor-content"},Lt={class:"text-caption text-grey-6 q-mt-xs"},Tt=me({__name:"MarkdownEditor",props:{initialContent:{default:""},slideId:{default:""}},emits:["save","contentChange","autoUpdate"],setup(A,{expose:f,emit:V}){const p=A,t=V,S=Le(),c=m(p.initialContent),E=m(!1),_=m(!0),R=m(null),g=m(null),C=m(p.initialContent),D=m(!1),M=m(null),F=m(null),O=m(""),d=m(null),$=m(null),J=m(!1),G=m(""),U=m(""),X=m(""),q=m(null),j=m(null);k(()=>{try{return it(c.value)}catch(i){return console.error("Markdown ë Œë”ë§ ì˜¤ë¥˜:",i),c.value}});const te=()=>{t("contentChange",c.value),be()},fe=()=>{D.value=!0,v()},v=()=>{M.value=null,F.value=null,O.value="",d.value=null,$.value=null},re=i=>{if(i){M.value=i;const n=new FileReader;n.onload=r=>{F.value=r.target?.result},n.readAsDataURL(i)}},ue=()=>{D.value=!1,v()},ge=()=>{if(M.value)try{const i=new FileReader;i.onload=n=>{const r=n.target?.result;let x=`![${O.value||"ì´ë¯¸ì§€"}](${r})`;if(d.value||$.value){const H=d.value?` width="${d.value}"`:"",l=$.value?` height="${$.value}"`:"";x=`<img src="${r}" alt="${O.value||"ì´ë¯¸ì§€"}"${H}${l} style="display: block; margin: 0 auto; max-width: 100%;" />`}const W=document.querySelector(".markdown-textarea textarea");if(W){const H=W.selectionStart,l=W.selectionEnd,o=c.value.substring(0,H),u=c.value.substring(l);c.value=o+`
`+x+`
`+u,setTimeout(()=>{const e=H+x.length+2;W.setSelectionRange(e,e),W.focus()},0)}else c.value+=`
`+x+`
`;te(),D.value=!1,v(),S.notify({type:"positive",message:"ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})},i.readAsDataURL(M.value)}catch(i){console.error("ì´ë¯¸ì§€ ì‚½ì… ì˜¤ë¥˜:",i),S.notify({type:"negative",message:"ì´ë¯¸ì§€ ì‚½ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},he=()=>{J.value=!0,ne()},ne=()=>{G.value="",U.value="",X.value="",q.value=null,j.value=null},ce=i=>{if(typeof i=="string"){G.value=i;const n=de(i);U.value=n}else G.value="",U.value=""},de=i=>{const n=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/watch\?.*v=([^&\n?#]+)/];for(const r of n){const x=i.match(r);if(x&&x[1])return x[1]}return""},ae=()=>{J.value=!1,ne()},ye=()=>{if(U.value)try{let i="";if(q.value||j.value){const r=q.value?` width="${q.value}"`:"",x=j.value?` height="${j.value}"`:"";i=`<iframe src="https://www.youtube.com/embed/${U.value}"${r}${x} frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display: block; margin: 0 auto; max-width: 100%;"></iframe>`}else i=`<div class="youtube-fullscreen">
  <iframe
    src="https://www.youtube.com/embed/${U.value}"
    width="100%"
    height="100%"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
  ></iframe>
</div>`;X.value&&(i=`## ${X.value}

${i}`);const n=document.querySelector(".markdown-textarea textarea");if(n){const r=n.selectionStart,x=n.selectionEnd,W=c.value.substring(0,r),H=c.value.substring(x);c.value=W+`
`+i+`
`+H,setTimeout(()=>{const l=r+i.length+2;n.setSelectionRange(l,l),n.focus()},0)}else c.value+=`
`+i+`
`;te(),J.value=!1,ne(),S.notify({type:"positive",message:"YouTube ì˜ìƒì´ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})}catch(i){console.error("YouTube ì‚½ì… ì˜¤ë¥˜:",i),S.notify({type:"negative",message:"YouTube ì˜ìƒ ì‚½ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},be=()=>{R.value&&clearTimeout(R.value),R.value=setTimeout(()=>{_.value&&(console.log("ğŸ” [MarkdownEditor] ìë™ ì—…ë°ì´íŠ¸"),console.log("ğŸ” [MarkdownEditor] ì—…ë°ì´íŠ¸ ë‚´ìš© ê¸¸ì´:",c.value.length),console.log("ğŸ” [MarkdownEditor] ì—…ë°ì´íŠ¸ ë‚´ìš© ëë¶€ë¶„:",JSON.stringify(c.value.substring(c.value.length-20))),console.log("ğŸ¯ ì‹¤ì‹œê°„ ë·°ì–´ ì—…ë°ì´íŠ¸:",p.slideId,"ë‚´ìš©ê¸¸ì´:",c.value.length),t("autoUpdate",c.value,p.slideId))},1e3)},we=async()=>{E.value=!0;try{console.log("ğŸ” [MarkdownEditor] ì €ì¥ ì‹œì‘"),console.log("ğŸ” [MarkdownEditor] ì €ì¥í•  ë‚´ìš© ê¸¸ì´:",c.value.length),console.log("ğŸ” [MarkdownEditor] ì €ì¥í•  ë‚´ìš© ëë¶€ë¶„:",JSON.stringify(c.value.substring(c.value.length-20))),t("save",c.value,p.slideId),setTimeout(()=>{E.value=!1},1e3)}catch(i){console.error("ì €ì¥ ì˜¤ë¥˜:",i),E.value=!1}};return oe(()=>p.initialContent,i=>{c.value=i,C.value=i}),oe(()=>p.slideId,i=>{console.log("slideId ë³€ê²½ë¨:",i),c.value=p.initialContent,C.value=p.initialContent}),De(()=>{C.value=c.value}),qe(()=>{g.value&&clearTimeout(g.value)}),f({setContent:i=>{c.value=i},content:c}),(i,n)=>(w(),I("div",rt,[s("div",ut,[s("div",ct,[a(T,{flat:"",dense:"",size:"sm",icon:"image",label:"ì´ë¯¸ì§€ ì²¨ë¶€",onClick:fe,class:"q-mr-sm"}),a(T,{flat:"",dense:"",size:"sm",icon:"play_circle",label:"YouTube",onClick:he,class:"q-mr-sm"}),a(T,{flat:"",dense:"",size:"sm",icon:"save",label:"ì €ì¥",onClick:we,loading:E.value},null,8,["loading"])])]),a(Ee,{modelValue:D.value,"onUpdate:modelValue":n[4]||(n[4]=r=>D.value=r),persistent:""},{default:y(()=>[a(xe,{style:{"min-width":"400px"}},{default:y(()=>[a(ee,null,{default:y(()=>n[11]||(n[11]=[s("div",{class:"text-h6"},"ì´ë¯¸ì§€ ì²¨ë¶€",-1)])),_:1,__:[11]}),a(ee,null,{default:y(()=>[s("div",dt,[s("div",vt,[a(Je,{modelValue:M.value,"onUpdate:modelValue":[n[0]||(n[0]=r=>M.value=r),re],label:"ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ",accept:".jpg,.jpeg,.png,.gif,.webp",outlined:"",dense:""},{prepend:y(()=>[a(se,{name:"image"})]),_:1},8,["modelValue"])]),F.value?(w(),I("div",mt,[n[12]||(n[12]=s("div",{class:"text-caption q-mb-xs"},"ë¯¸ë¦¬ë³´ê¸°:",-1)),s("img",{src:F.value,alt:"ë¯¸ë¦¬ë³´ê¸°",style:{"max-width":"100%","max-height":"200px","object-fit":"contain"}},null,8,pt)])):B("",!0),s("div",ft,[a(K,{modelValue:O.value,"onUpdate:modelValue":n[1]||(n[1]=r=>O.value=r),label:"ì´ë¯¸ì§€ ì„¤ëª… (alt í…ìŠ¤íŠ¸)",outlined:"",dense:"",placeholder:"ì´ë¯¸ì§€ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"},null,8,["modelValue"])]),s("div",gt,[a(K,{modelValue:d.value,"onUpdate:modelValue":n[2]||(n[2]=r=>d.value=r),modelModifiers:{number:!0},label:"ë„ˆë¹„ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])]),s("div",ht,[a(K,{modelValue:$.value,"onUpdate:modelValue":n[3]||(n[3]=r=>$.value=r),modelModifiers:{number:!0},label:"ë†’ì´ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])])])]),_:1}),a(Me,{align:"right"},{default:y(()=>[a(T,{flat:"",label:"ì·¨ì†Œ",onClick:ue}),a(T,{color:"primary",label:"ì‚½ì…",onClick:ge,disable:!M.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(Ee,{modelValue:J.value,"onUpdate:modelValue":n[9]||(n[9]=r=>J.value=r),persistent:""},{default:y(()=>[a(xe,{style:{"min-width":"400px"}},{default:y(()=>[a(ee,null,{default:y(()=>n[13]||(n[13]=[s("div",{class:"text-h6"},"YouTube ì˜ìƒ ì¶”ê°€",-1)])),_:1,__:[13]}),a(ee,null,{default:y(()=>[s("div",yt,[s("div",bt,[a(K,{modelValue:G.value,"onUpdate:modelValue":[n[5]||(n[5]=r=>G.value=r),ce],label:"YouTube ë§í¬",outlined:"",dense:"",placeholder:"https://www.youtube.com/watch?v=..."},{prepend:y(()=>[a(se,{name:"play_circle"})]),_:1},8,["modelValue"])]),U.value?(w(),I("div",wt,[n[14]||(n[14]=s("div",{class:"text-caption q-mb-xs"},"ë¯¸ë¦¬ë³´ê¸°:",-1)),s("div",St,[s("iframe",{src:`https://www.youtube.com/embed/${U.value}`,width:"100%",height:"200",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,_t)])])):B("",!0),s("div",$t,[a(K,{modelValue:X.value,"onUpdate:modelValue":n[6]||(n[6]=r=>X.value=r),label:"ì˜ìƒ ì œëª© (ì„ íƒì‚¬í•­)",outlined:"",dense:"",placeholder:"ì˜ìƒì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"},null,8,["modelValue"])]),s("div",kt,[a(K,{modelValue:q.value,"onUpdate:modelValue":n[7]||(n[7]=r=>q.value=r),modelModifiers:{number:!0},label:"ë„ˆë¹„ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])]),s("div",Ct,[a(K,{modelValue:j.value,"onUpdate:modelValue":n[8]||(n[8]=r=>j.value=r),modelModifiers:{number:!0},label:"ë†’ì´ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])])])]),_:1}),a(Me,{align:"right"},{default:y(()=>[a(T,{flat:"",label:"ì·¨ì†Œ",onClick:ae}),a(T,{color:"primary",label:"ì‚½ì…",onClick:ye,disable:!U.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s("div",xt,[a(K,{modelValue:c.value,"onUpdate:modelValue":[n[10]||(n[10]=r=>c.value=r),te],type:"textarea",placeholder:"Markdown ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...",rows:"15",outlined:"",dense:"",class:"markdown-textarea"},null,8,["modelValue"]),s("div",Lt,P(c.value.length)+"ì / 10000ì",1)])]))}}),Vt=pe(Tt,[["__scopeId","data-v-3f0ce4c0"]]),It={class:"q-my-none editor-title"},Et={class:"text-caption text-grey-6 q-mt-xs"},Mt={class:"row items-center justify-between q-mb-sm"},Ut={class:"col"},At={class:"text-subtitle2 text-weight-medium"},Dt={class:"text-caption text-grey-6"},qt={class:"col-auto"},Nt={class:"text-caption text-grey-6"},zt={class:"row q-gutter-sm q-mb-md"},Qt={class:"q-mt-md text-right"},Pt=me({__name:"SlideEditorSection",props:{currentSlideType:{},currentSlideInfo:{},currentLesson:{},currentSlide:{},currentSlideContent:{},isApplying:{type:Boolean}},emits:["slideContentSave","slideContentChange","slidePreview","createMarkdownFile","autoUpdate","updateTOC","addNewSlide","applySlide"],setup(A,{expose:f,emit:V}){const p=A,t=V,S=Le(),c=m(),E=m(!1),_=(d,$)=>{t("slideContentSave",d,$)},R=d=>{t("slideContentChange",d)},g=d=>{t("slidePreview",d)},C=(d,$)=>{t("createMarkdownFile",d,$)},D=(d,$)=>{t("autoUpdate",d,$)},M=async()=>{E.value=!0;try{t("updateTOC"),S.notify({type:"positive",message:"ëª©ì°¨ ì—…ë°ì´íŠ¸ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤",position:"top",timeout:2e3,icon:"refresh",actions:[{label:"í™•ì¸",color:"white"}]})}catch{S.notify({type:"negative",message:"ëª©ì°¨ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",position:"top",timeout:3e3,icon:"error",actions:[{label:"í™•ì¸",color:"white"}]})}finally{E.value=!1}},F=()=>{t("addNewSlide")},O=()=>{t("applySlide",`${p.currentLesson}-${p.currentSlide}`)};return f({markdownEditor:c}),(d,$)=>(w(),le(xe,{class:"sidebar-card q-mt-md"},{default:y(()=>[a(ee,null,{default:y(()=>[s("h6",It,P(d.currentSlideType==="chapter"?"Chapter í¸ì§‘ê¸°":"ìŠ¬ë¼ì´ë“œ í¸ì§‘ê¸°"),1),s("div",Et,P(d.currentSlideType==="chapter"?"Chapter ë‚´ìš©ì„ í¸ì§‘í•˜ì„¸ìš”":"ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ í¸ì§‘í•˜ì„¸ìš”"),1)]),_:1}),a(ee,{class:"q-pt-none current-slide-info-section"},{default:y(()=>[s("div",Mt,[s("div",Ut,[s("div",At,P(d.currentSlideInfo?.lessonTitle),1),s("div",Dt,P(d.currentSlideInfo?.slideTitle),1)]),s("div",qt,[a(Ke,{size:"sm",color:"primary","text-color":"white",label:`${d.currentSlideInfo?.slideIndex}/${d.currentSlideInfo?.totalSlides}`},null,8,["label"])])]),s("div",Nt," ê°•ì˜ "+P(d.currentSlideInfo?.lessonNumber)+"/"+P(d.currentSlideInfo?.totalLessons),1)]),_:1}),a(ee,{class:"q-pt-none"},{default:y(()=>[s("div",zt,[a(T,{icon:"refresh",label:"ëª©ì°¨ ì—…ë°ì´íŠ¸",onClick:M,loading:E.value,color:"primary"},null,8,["loading"]),a(T,{icon:"add",label:"ìƒˆ ìŠ¬ë¼ì´ë“œ",onClick:F,color:"positive"})]),(w(),le(Vt,{key:`${d.currentLesson}-${d.currentSlide}`,"initial-content":d.currentSlideContent,"slide-id":`${d.currentLesson}-${d.currentSlide}`,onSave:_,onContentChange:R,onPreview:g,onCreateMarkdown:C,onAutoUpdate:D,ref_key:"markdownEditor",ref:c},null,8,["initial-content","slide-id"])),s("div",Qt,[a(T,{color:"accent",icon:"check_circle",label:"ìŠ¬ë¼ì´ë“œ ë°˜ì˜",onClick:O,loading:d.isApplying,disable:d.isApplying},null,8,["loading","disable"])])]),_:1})]),_:1}))}}),Rt=pe(Pt,[["__scopeId","data-v-cda91fc6"]]),Ft={class:"main-content"},Ot={key:2,class:"navigation-controls"},Wt={class:"slide-info"},Ht={class:"slide-counter"},Yt={key:3,class:"editor-mode-notice"},Bt=20,jt=80,Kt=me({__name:"IndexPage",setup(A){const{userRole:f}=Te(),V=k(()=>f.value==="admin"),p=Le();Pe(),Re();const t=Ye();Te(),Be();const S=m(!1),c=k(()=>t.currentLesson),E=k(()=>t.currentSlide),_=k(()=>t.isPresentationMode);oe(()=>_.value,async l=>{if(console.log(`ğŸ­ í¸ì§‘ê¸° ëª¨ë“œ ë³€ê²½: ${l?"í”„ë ˆì  í…Œì´ì…˜":"í¸ì§‘ê¸°"}`),!l)try{const o=t.currentLesson,u=t.currentSlide;console.log(`ğŸ“‚ í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ: ${o}-${u}`);const e=await t.loadSlideContentForEditing(o,u);console.log("âœ… í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì™„ë£Œ:",{contentLength:e.length,contentPreview:e.substring(0,100)}),g.value=e}catch(o){console.error("âŒ í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹¤íŒ¨:",o);const u=t.currentLesson,e=t.currentSlide;g.value=`# ìŠ¬ë¼ì´ë“œ ${u}-${e}

ìƒˆë¡œìš´ ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”.`}}),oe([()=>t.currentLesson,()=>t.currentSlide],async()=>{await re(t.currentLesson,t.currentSlide),D.value&&setTimeout(()=>{M()},500)});const R=m(),g=m(""),C=k(()=>({lessonTitle:`ê°•ì˜ ${t.currentLesson+1}`,slideTitle:`ìŠ¬ë¼ì´ë“œ ${t.currentSlide+1}`,slideIndex:t.currentSlide+1,totalSlides:t.currentLessonData?.slides||0,lessonNumber:t.currentLesson+1,totalLessons:t.lessons.length})),D=k(()=>`${t.currentLesson}-${t.currentSlide}`.startsWith("1-1")&&t.currentSlide>=13),M=()=>{D.value&&setTimeout(()=>{try{const l=document.querySelector(".slide-iframe");if(l&&l.contentDocument){const o=l.contentDocument.querySelectorAll(".quiz-option");o.forEach(u=>{u.removeEventListener("click",F),u.addEventListener("click",F),u.style.cursor="pointer",u.style.transition="all 0.2s ease"}),b.log(`âœ… Quiz ì´ë²¤íŠ¸ ì£¼ì… ì™„ë£Œ: ${o.length}ê°œ ì˜µì…˜`)}}catch(l){b.warn("âš ï¸ Quiz ì´ë²¤íŠ¸ ì£¼ì… ì‹¤íŒ¨:",l)}},200)},F=l=>{l.preventDefault(),l.stopPropagation();const o=l.target,u=o.getAttribute("data-idx"),e=document.querySelector(".slide-iframe");if(e&&e.contentDocument){const h=e.contentDocument.getElementById("quiz-answer-data"),L=e.contentDocument.querySelectorAll(".quiz-option");h&&(h.style.display="block"),L.forEach(N=>N.classList.remove("selected")),o.classList.add("selected"),b.log(`ğŸ¯ Quiz ì˜µì…˜ í´ë¦­: ${u}ë²ˆ ì„ íƒ, ì •ë‹µ í‘œì‹œ`)}},O=l=>{b.log("ìŠ¬ë¼ì´ë“œ ë‚´ìš© ì €ì¥:",l),g.value=l},d=l=>{b.log("ìŠ¬ë¼ì´ë“œ ë‚´ìš© ë³€ê²½:",l),g.value=l},$=()=>{b.log("ìŠ¬ë¼ì´ë“œ ë¯¸ë¦¬ë³´ê¸°")},J=()=>{console.log("ë§ˆí¬ë‹¤ìš´ íŒŒì¼ ìƒì„±")},G=()=>{console.log("ìë™ ì—…ë°ì´íŠ¸")},U=()=>{console.log("ëª©ì°¨ ì—…ë°ì´íŠ¸")},X=()=>{b.log("ìƒˆ ìŠ¬ë¼ì´ë“œ ì¶”ê°€")},q=m(!1),j=async l=>{q.value=!0;try{b.log("ğŸ”„ ìŠ¬ë¼ì´ë“œ ë°˜ì˜ ì‹œì‘:",l);const[o="0",u="0"]=(l||"0-0").split("-"),e=`${o}-${u}`;if(await t.saveSlideToFirebaseStorage(e,g.value)){console.log("âœ… Firebase Storageì— MD íŒŒì¼ ì €ì¥ ì™„ë£Œ:",e),te.value++,p.notify({type:"positive",message:"ìŠ¬ë¼ì´ë“œê°€ Firebase Storageì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!",position:"top",timeout:3e3,icon:"cloud_done",actions:[{label:"í™•ì¸",color:"white"}]});const L=new Blob([g.value],{type:"text/markdown"}),N=URL.createObjectURL(L),z=document.createElement("a");z.href=N,z.download=`slide-${e}.md`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(N),console.log("ğŸ“ ë¡œì»¬ ë°±ì—… íŒŒì¼ë„ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.")}else throw new Error("Firebase Storage ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");b.log("ğŸ‰ ìŠ¬ë¼ì´ë“œ ë°˜ì˜ ì™„ë£Œ")}catch(o){b.error("âŒ Firebase Storage ì €ì¥ ì‹¤íŒ¨:",o),p.notify({type:"negative",message:"Firebase Storageì— ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",position:"top",timeout:5e3,icon:"cloud_off",actions:[{label:"í™•ì¸",color:"white"}]})}finally{q.value=!1}},te=m(0);k(()=>t.lessons.reduce((l,o)=>l+o.slides,0));const fe=k(()=>`${t.currentLesson}-${t.currentSlide}`),v=m("lecture"),re=async(l,o)=>{try{const u=await fetch(`/slides/slide-${l}-${o}.md`);if(u.ok){const e=await u.text();if(e.trim().startsWith("@html"))v.value="html";else if(e.includes("@cover")||e.includes("ì»¤ë²„"))v.value="cover";else if(e.includes("@toc")||e.includes("ëª©ì°¨"))v.value="toc";else if(e.includes("@poll")||e.includes("íˆ¬í‘œ"))v.value="poll";else if(e.includes("@stats")||e.includes("í†µê³„"))v.value="stats";else if(e.includes("@interactive")||e.includes("ì¸í„°ë™í‹°ë¸Œ"))v.value="interactive";else if(e.includes("@example")||e.includes("ì˜ˆì‹œ"))v.value="example";else if(e.includes("@challenge")||e.includes("ë„ì „"))v.value="challenge";else if(e.includes("@timeline")||e.includes("íƒ€ì„ë¼ì¸"))v.value="timeline";else if(e.includes("@profile")||e.includes("í”„ë¡œí•„"))v.value="profile";else if(e.includes("@lecture")||e.includes("ê°•ì˜"))v.value="lecture";else if(e.includes("@chapter")||e.includes("ì±•í„°"))v.value="chapter";else{const h=`${l}-${o}`;h==="0-0"?v.value="cover":h==="0-1"?v.value="index":h==="0-2"?v.value="profile":h.endsWith("-0")?v.value="chapter":h.startsWith("2-")&&h!=="2-0"?v.value="example":h.startsWith("3-")&&h!=="3-0"?v.value="challenge":v.value="lecture"}}}catch(u){console.error(`ìŠ¬ë¼ì´ë“œ íƒ€ì… ê°ì§€ ì‹¤íŒ¨: ${l}-${o}`,u);const e=`${l}-${o}`;e==="0-0"?v.value="cover":e==="0-1"?v.value="index":e==="0-2"?v.value="profile":e.endsWith("-0")?v.value="chapter":e.startsWith("2-")&&e!=="2-0"?v.value="example":e.startsWith("3-")&&e!=="3-0"?v.value="challenge":v.value="lecture"}},ue=k(()=>v.value!=="poll"?"":`poll-${t.currentLesson}-${t.currentSlide}`),ge=async l=>{try{if(!V.value||!l||!await p.dialog({title:"ê²°ê³¼ ì´ˆê¸°í™”",message:`í•´ë‹¹ íˆ¬í‘œì˜ ë‚˜ì˜ ì„ íƒ(LocalStorage)ê³¼ RTDBì˜ í‘œê¸°ë¥¼ ì‚­ì œí• ê¹Œìš”?
ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,cancel:!0,ok:{label:"ì´ˆê¸°í™”",color:"negative"}}).onOk(()=>!0).onCancel(()=>!1))return;try{Object.keys(localStorage).filter(e=>e.toLowerCase().includes("poll")).forEach(e=>localStorage.removeItem(e))}catch{}const u=Y?$e(Y):null;if(u){const{getAuth:e}=await ke(async()=>{const{getAuth:L}=await import("./QSpinnerDots-55T99jjC.js").then(N=>N.i);return{getAuth:L}},__vite__mapDeps([0,1,2])),h=e(Y).currentUser?.uid;h&&await Oe(Ce(u,`polls/${l}/userVotes/${h}`)).catch(()=>{})}try{document.querySelector(".slide-iframe")?.contentWindow?.postMessage({type:"poll-state",pollId:l,optionId:""},"*")}catch{}p.notify({type:"positive",message:"íˆ¬í‘œ ê²°ê³¼ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})}catch{p.notify({type:"negative",message:"ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},he=k(()=>t.currentLesson===0&&t.currentSlide===0),ne=k(()=>{const l=t.lessons.length-1,o=t.lessons[l];return t.currentLesson===l&&t.currentSlide===(o?.slides||0)-1}),ce=m(60),de=m(40),ae=m(!1),ye=k(()=>_.value?{}:{flex:`0 0 ${ce.value}%`}),be=k(()=>_.value?{}:{flex:`0 0 ${de.value}%`}),we=l=>{ae.value=!0,document.body.style.cursor="col-resize"},Se=()=>{ae.value=!1,document.body.style.cursor=""},i=l=>{if(!ae.value)return;const o=document.querySelector(".main-content");if(!o)return;const u=o.getBoundingClientRect(),h=(l.clientX-u.left)/u.width*100;h>Bt&&h<jt&&(ce.value=h,de.value=100-h)},n=()=>{t.prevSlide()},r=()=>{t.nextSlide()},x=()=>{t.setCurrentLesson(0),t.setCurrentSlide(0)},W=()=>{const l=t.lessons.length-1,o=t.lessons[l];o&&(t.setCurrentLesson(l),t.setCurrentSlide(o.slides-1))},H=l=>{if(_.value)switch(l.key){case"ArrowLeft":l.preventDefault(),n();break;case"ArrowRight":case" ":l.preventDefault(),r();break;case"Home":l.preventDefault(),x();break;case"End":l.preventDefault(),W();break;case"?":l.preventDefault(),S.value=!S.value;break}};return De(async()=>{await re(t.currentLesson,t.currentSlide),document.addEventListener("keydown",H),window.addEventListener("mousemove",i),window.addEventListener("mouseup",Se);const l=async u=>{try{if(f.value!=="admin")return;const e=u.data||{};if(e&&e.type==="poll-vote"){const h=Y?$e(Y):null;if(!h)return;const{pollId:L,optionId:N,text:z}=e;if(!L)return;const{getAuth:ve}=await ke(async()=>{const{getAuth:_e}=await import("./QSpinnerDots-55T99jjC.js").then(Ne=>Ne.i);return{getAuth:_e}},__vite__mapDeps([0,1,2])),Z=ve(Y).currentUser?.uid;if(!Z)return;const Q=z||String(N||"");await ze(Ce(h,`polls/${L}/userVotes/${Z}`),Q),b.log("ğŸ—³ï¸ admin saved(userVotes):",{pollId:L,valueToSave:Q})}if(e&&e.type==="poll-ready"){const h=Y?$e(Y):null;if(!h)return;const{pollId:L}=e;if(!L)return;const{getAuth:N}=await ke(async()=>{const{getAuth:Q}=await import("./QSpinnerDots-55T99jjC.js").then(_e=>_e.i);return{getAuth:Q}},__vite__mapDeps([0,1,2])),z=N(Y).currentUser?.uid;if(!z)return;const ve=await Qe(Ce(h,`polls/${L}/userVotes/${z}`)),Z=document.querySelector(".slide-iframe");if(!Z||!Z.contentWindow)return;if(ve.exists()){const Q=ve.val();typeof Q=="string"&&/^\d+$/.test(Q)?Z.contentWindow.postMessage({type:"poll-state",pollId:L,optionId:String(Q)},"*"):Q&&Z.contentWindow.postMessage({type:"poll-state",pollId:L,text:String(Q)},"*")}}}catch(e){b.error("ğŸ—³ï¸ admin poll sync error:",e)}};window.addEventListener("message",l);const o=new Image;o.onload=()=>{console.log("âœ… ë°°ê²½ ì´ë¯¸ì§€ ë¡œë”© ì„±ê³µ:",o.src)},o.onerror=()=>{console.error("âŒ ë°°ê²½ ì´ë¯¸ì§€ ë¡œë”© ì‹¤íŒ¨:",o.src)},o.src="/images/20250806_1231_churchtech.png"}),oe(()=>[t.currentLesson,t.currentSlide],async([l,o])=>{if(l!==void 0&&o!==void 0&&(console.log(`ğŸ”„ IndexPage - ìŠ¤í† ì–´ ë³€ê²½ ê°ì§€: lesson=${l}, slide=${o}`),!_.value))try{console.log(`ğŸ“‚ í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹œì‘: ${l}-${o}`);const u=await t.loadSlideContentForEditing(l,o);console.log("âœ… í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì™„ë£Œ:",{contentLength:u.length,contentPreview:u.substring(0,100)}),g.value=u}catch(u){console.error("âŒ í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹¤íŒ¨:",u),g.value=`# ìŠ¬ë¼ì´ë“œ ${l}-${o}

ìƒˆë¡œìš´ ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”.`}},{immediate:!0}),qe(()=>{document.removeEventListener("keydown",H),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",Se)}),(l,o)=>(w(),le(He,{class:"index-page"},{default:y(()=>[o[5]||(o[5]=s("div",{class:"login-background"},null,-1)),s("div",Ft,[s("div",{class:Fe(["slide-viewer-container",{"with-editor":!_.value}]),style:Ve(ye.value)},[(w(),le(at,{key:te.value,"slide-number":fe.value,"slide-type":v.value},null,8,["slide-number","slide-type"])),V.value&&v.value==="poll"?(w(),le(T,{key:0,class:"poll-admin-fab",round:"",color:"negative",icon:"delete",disable:!ue.value,onClick:o[0]||(o[0]=u=>ge(ue.value))},{default:y(()=>[a(We,null,{default:y(()=>o[2]||(o[2]=[ie("ê²°ê³¼ ì´ˆê¸°í™”",-1)])),_:1,__:[2]})]),_:1},8,["disable"])):B("",!0)],6),_.value?B("",!0):(w(),I("div",{key:0,class:"resizer-bar",onMousedown:we},null,32)),_.value?B("",!0):(w(),I("div",{key:1,class:"editor-container",style:Ve(be.value)},[a(Rt,{"current-slide-type":v.value,"current-slide-info":C.value,"current-lesson":c.value,"current-slide":E.value,"current-slide-content":g.value,"is-applying":q.value,onSlideContentSave:O,onSlideContentChange:d,onSlidePreview:$,onCreateMarkdownFile:J,onAutoUpdate:G,onUpdateToc:U,onAddNewSlide:X,onApplySlide:j,ref_key:"slideEditorSection",ref:R},null,8,["current-slide-type","current-slide-info","current-lesson","current-slide","current-slide-content","is-applying"])],4)),_.value?(w(),I("div",Ot,[a(T,{disable:he.value,onClick:n,color:"blue","text-color":"white",icon:"chevron_left",round:"",size:"lg",class:"nav-btn"},null,8,["disable"]),s("div",Wt,[s("span",Ht,P(Ie(t).currentLesson)+"-"+P(Ie(t).currentSlide+1),1)]),a(T,{disable:ne.value,onClick:r,color:"blue","text-color":"white",icon:"chevron_right",round:"",size:"lg",class:"nav-btn"},null,8,["disable"])])):B("",!0),_.value?B("",!0):(w(),I("div",Yt,[a(Ue,{class:"bg-orange text-white",rounded:""},{avatar:y(()=>[a(se,{name:"edit"})]),default:y(()=>[o[3]||(o[3]=s("div",{class:"text-body2"},[s("strong",null,"í¸ì§‘ê¸° ëª¨ë“œ"),s("br"),ie(" í˜„ì¬ í¸ì§‘ê¸° ëª¨ë“œì…ë‹ˆë‹¤. í”„ë ˆì  í…Œì´ì…˜ ëª¨ë“œë¡œ ì „í™˜í•˜ë ¤ë©´ ìƒë‹¨ì˜ í¸ì§‘ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”. ")],-1))]),_:1,__:[3]})]))]),S.value&&_.value?(w(),le(Ue,{key:0,class:"bg-info text-white keyboard-help",rounded:""},{avatar:y(()=>[a(se,{name:"keyboard"})]),action:y(()=>[a(T,{flat:"",color:"white",label:"ë‹«ê¸°",onClick:o[1]||(o[1]=u=>S.value=!1)})]),default:y(()=>[o[4]||(o[4]=s("div",{class:"text-body2"},[s("strong",null,"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤:"),s("br"),ie(" â† â†’ : ì´ì „/ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ | Space : ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ"),s("br"),ie(" Home/End : ì²˜ìŒ/ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œ | F11 : ì „ì²´í™”ë©´"),s("br"),ie(" ESC : í¸ì§‘ê¸° ëª¨ë“œ | ? : ë„ì›€ë§ í† ê¸€ ")],-1))]),_:1,__:[4]})):B("",!0)]),_:1,__:[5]}))}}),al=pe(Kt,[["__scopeId","data-v-8399d9a2"]]);export{al as default};
