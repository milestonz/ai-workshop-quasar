const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm.js","assets/index-D1vT6N3s.js","assets/index-C_LQcHkP.css"])))=>i.map(i=>d[i]);
import{D as ge,j as f,b as C,A as V,H as ae,a as w,c as s,T as o,p as oe,f as P,F as j,N as Ve,M as Pe,K as Re,Q as M,G as y,k as te,x as Ie,L as Oe,g as ze,P as De,m as He,e as ie,d as qe,S as Y,U as xe,W as Le,Y as Ce,_ as Te,Z as Ye,$ as Ee,a0 as je,a1 as Be}from"./index-D1vT6N3s.js";import{t as Me,U as ee,e as Ue,o as Ae,W as Qe}from"./QDialog-CXn2kBax-C53UdG9D-kpCzhlJn.js";import{f as Ne}from"./QBanner-BY0ggvyL-C3yUuPRa-BwL-ftRS.js";import{m as Ze}from"./QPage-B1iJaq8H-BMxUDXKn-BbD7X6VY.js";import{Q as b,X as Z,W as Xe,Y as Ge}from"./useGuestAuth-Mxd3jo-z-qhm8zfOu-DqDS1hTw.js";import{Q as Je}from"./QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm.js";import{d as ye}from"./_plugin-vue_export-helper-DXafCR7g-cPVpln50-BTORSsEs.js";import{Z as Ke}from"./QChip-BJIOjoIv-Djywe0kj-DBt41SH2.js";import{M as el,b as We}from"./marked.esm-mI6KSz_d-CXpNVb3h-Dfg0gaKB.js";import"./pinia-DRC1X92K-CVhvq81r-C7Q22G7M.js";const pe=(T,m=pe,S=m.f||(m.f=["assets/QSpinnerDots-DmD6LJEW-mqbZkDZd.js","assets/index-Bw1AfG2u.js","assets/index-B0WZdqPn.css"]))=>T.map(p=>S[p]),fe=(T,m=fe,S=m.f||(m.f=["assets/QSpinnerDots-DmD6LJEW.js","assets/index-BynyowXf.js","assets/index-BOcY-vOO.css"]))=>T.map(p=>S[p]),ll={class:"simple-slide-viewer"},tl={key:0,class:"error"},al={key:1,class:"html-slide-container"},ol=["innerHTML"],nl={key:2,class:"slide-iframe-container"},sl=["src"],il={key:0,class:"loading-overlay"},rl={key:3,class:"no-content"},ul=ge({__name:"SimpleSlideViewer",props:{slideNumber:{},slideType:{}},setup(T){const m=T,S=f(""),p=f(!1),e=f(""),$=C(()=>m.slideNumber?`/generated/slides/slide-${m.slideNumber}.html`:""),c=async()=>{if(m.slideType==="html")try{p.value=!0;const g=await fetch(`/slides/slide-${m.slideNumber}.md`);if(g.ok){const E=await g.text();e.value=E.replace(/^@html\s*\n?/gm,"").trim(),b.log(`‚úÖ HTML Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö© Î°úÎìú ÏôÑÎ£å: ${m.slideNumber}`)}else S.value=`HTML Ïä¨ÎùºÏù¥Îìú ${m.slideNumber} Î°úÎî© Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.`,b.error(`HTML Ïä¨ÎùºÏù¥Îìú ${m.slideNumber} Î°úÎî© Ïã§Ìå®:`,g.status)}catch(g){S.value=`HTML Ïä¨ÎùºÏù¥Îìú ${m.slideNumber} Î°úÎî© Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.`,b.error(`HTML Ïä¨ÎùºÏù¥Îìú ${m.slideNumber} Î°úÎî© Ïò§Î•ò:`,g)}finally{p.value=!1}},I=()=>{p.value=!1,b.log(`‚úÖ iframe Î°úÎìú ÏôÑÎ£å: ${$.value}`)},_=g=>{S.value=`Ïä¨ÎùºÏù¥Îìú ${m.slideNumber} Î°úÎî© Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.`,b.error(`Ïä¨ÎùºÏù¥Îìú ${m.slideNumber} Î°úÎî© Ï§ë Ïò§Î•ò Î∞úÏÉù:`,g),p.value=!1},R=()=>{p.value=!1,b.log(`‚úÖ HTML Ïä¨ÎùºÏù¥Îìú Î°úÎìú ÏôÑÎ£å: ${m.slideNumber}`)};return ae(()=>m.slideNumber,g=>{g&&(p.value=!0,S.value="",m.slideType==="html"?c():(b.log(`üîÑ iframe URL Î≥ÄÍ≤Ω: ${$.value}`),setTimeout(()=>{p.value&&(p.value=!1,b.log("‚ö†Ô∏è Ïä¨ÎùºÏù¥Îìú Î°úÎî© ÏãúÍ∞Ñ Ï¥àÍ≥º"))},3e3)))},{immediate:!0}),(g,E)=>(w(),V("div",ll,[S.value?(w(),V("div",tl,[s(oe,{name:"error",size:"50px",color:"negative"}),o("p",null,P(S.value),1)])):g.slideType==="html"&&e.value?(w(),V("div",al,[o("div",{class:"html-slide-content",innerHTML:e.value,onLoad:R},null,40,ol)])):$.value?(w(),V("div",nl,[o("iframe",{src:$.value,class:"slide-iframe",onLoad:I,onError:_},null,40,sl),p.value?(w(),V("div",il,[s(Je,{size:"50px",color:"primary"}),E[0]||(E[0]=o("p",null,"Ïä¨ÎùºÏù¥Îìú Î°úÎî© Ï§ë...",-1))])):j("",!0)])):(w(),V("div",rl,[s(oe,{name:"slideshow",size:"50px",color:"grey"}),E[1]||(E[1]=o("p",null,"ÌëúÏãúÌï† Ïä¨ÎùºÏù¥ÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§.",-1))]))]))}}),cl=ye(ul,[["__scopeId","data-v-2a03a82a"]]),dl=T=>{if(!T)return"";We.setOptions({breaks:!1,gfm:!0});let m=We(T);return typeof m=="string"&&(m=m.replace(/<p>/g,"<div>").replace(/<\/p>/g,"</div>")),typeof m=="string"?m:T},vl={class:"markdown-editor"},ml={class:"editor-header"},pl={class:"editor-actions"},fl={class:"row q-col-gutter-md"},gl={class:"col-12"},yl={key:0,class:"col-12"},hl=["src"],bl={class:"col-12"},wl={class:"col-6"},Sl={class:"col-6"},$l={class:"row q-col-gutter-md"},_l={class:"col-12"},kl={key:0,class:"col-12"},xl={class:"youtube-preview"},Ll=["src"],Cl={class:"col-12"},Tl={class:"col-6"},El={class:"col-6"},Ml={class:"editor-content"},Vl={class:"text-caption text-grey-6 q-mt-xs"},Il=ge({__name:"MarkdownEditor",props:{initialContent:{default:""},slideId:{default:""}},emits:["save","contentChange","autoUpdate"],setup(T,{expose:m,emit:S}){const p=T,e=S,$=Ve(),c=f(p.initialContent),I=f(!1),_=f(!0),R=f(null),g=f(null),E=f(p.initialContent),A=f(!1),D=f(null),F=f(null),O=f(""),d=f(null),k=f(null),X=f(!1),G=f(""),q=f(""),J=f(""),N=f(null),B=f(null);C(()=>{try{return dl(c.value)}catch(r){return console.error("Markdown Î†åÎçîÎßÅ Ïò§Î•ò:",r),c.value}});const le=()=>{e("contentChange",c.value),$e()},he=()=>{A.value=!0,v()},v=()=>{D.value=null,F.value=null,O.value="",d.value=null,k.value=null},re=r=>{if(r){D.value=r;const n=new FileReader;n.onload=u=>{F.value=u.target?.result},n.readAsDataURL(r)}},ue=()=>{A.value=!1,v()},be=()=>{if(D.value)try{const r=new FileReader;r.onload=n=>{const u=n.target?.result;let x=`![${O.value||"Ïù¥ÎØ∏ÏßÄ"}](${u})`;if(d.value||k.value){const Q=d.value?` width="${d.value}"`:"",H=k.value?` height="${k.value}"`:"";x=`<img src="${u}" alt="${O.value||"Ïù¥ÎØ∏ÏßÄ"}"${Q}${H} style="display: block; margin: 0 auto; max-width: 100%;" />`}const z=document.querySelector(".markdown-textarea textarea");if(z){const Q=z.selectionStart,H=z.selectionEnd,t=c.value.substring(0,Q),a=c.value.substring(H);c.value=t+`
`+x+`
`+a,setTimeout(()=>{const i=Q+x.length+2;z.setSelectionRange(i,i),z.focus()},0)}else c.value+=`
`+x+`
`;le(),A.value=!1,v(),$.notify({type:"positive",message:"Ïù¥ÎØ∏ÏßÄÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÇΩÏûÖÎêòÏóàÏäµÎãàÎã§.",position:"top"})},r.readAsDataURL(D.value)}catch(r){console.error("Ïù¥ÎØ∏ÏßÄ ÏÇΩÏûÖ Ïò§Î•ò:",r),$.notify({type:"negative",message:"Ïù¥ÎØ∏ÏßÄ ÏÇΩÏûÖ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",position:"top"})}},we=()=>{X.value=!0,ne()},ne=()=>{G.value="",q.value="",J.value="",N.value=null,B.value=null},ce=r=>{if(typeof r=="string"){G.value=r;const n=de(r);q.value=n}else G.value="",q.value=""},de=r=>{const n=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/watch\?.*v=([^&\n?#]+)/];for(const u of n){const x=r.match(u);if(x&&x[1])return x[1]}return""},se=()=>{X.value=!1,ne()},Se=()=>{if(q.value)try{let r="";if(N.value||B.value){const u=N.value?` width="${N.value}"`:"",x=B.value?` height="${B.value}"`:"";r=`<iframe src="https://www.youtube.com/embed/${q.value}"${u}${x} frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display: block; margin: 0 auto; max-width: 100%;"></iframe>`}else r=`<div class="youtube-fullscreen">
  <iframe
    src="https://www.youtube.com/embed/${q.value}"
    width="100%"
    height="100%"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
  ></iframe>
</div>`;J.value&&(r=`## ${J.value}

${r}`);const n=document.querySelector(".markdown-textarea textarea");if(n){const u=n.selectionStart,x=n.selectionEnd,z=c.value.substring(0,u),Q=c.value.substring(x);c.value=z+`
`+r+`
`+Q,setTimeout(()=>{const H=u+r.length+2;n.setSelectionRange(H,H),n.focus()},0)}else c.value+=`
`+r+`
`;le(),X.value=!1,ne(),$.notify({type:"positive",message:"YouTube ÏòÅÏÉÅÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÇΩÏûÖÎêòÏóàÏäµÎãàÎã§.",position:"top"})}catch(r){console.error("YouTube ÏÇΩÏûÖ Ïò§Î•ò:",r),$.notify({type:"negative",message:"YouTube ÏòÅÏÉÅ ÏÇΩÏûÖ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",position:"top"})}},$e=()=>{R.value&&clearTimeout(R.value),R.value=setTimeout(()=>{_.value&&(console.log("üîç [MarkdownEditor] ÏûêÎèô ÏóÖÎç∞Ïù¥Ìä∏"),console.log("üîç [MarkdownEditor] ÏóÖÎç∞Ïù¥Ìä∏ ÎÇ¥Ïö© Í∏∏Ïù¥:",c.value.length),console.log("üîç [MarkdownEditor] ÏóÖÎç∞Ïù¥Ìä∏ ÎÇ¥Ïö© ÎÅùÎ∂ÄÎ∂Ñ:",JSON.stringify(c.value.substring(c.value.length-20))),console.log("üéØ Ïã§ÏãúÍ∞Ñ Î∑∞Ïñ¥ ÏóÖÎç∞Ïù¥Ìä∏:",p.slideId,"ÎÇ¥Ïö©Í∏∏Ïù¥:",c.value.length),e("autoUpdate",c.value,p.slideId))},1e3)},_e=async()=>{I.value=!0;try{console.log("üîç [MarkdownEditor] Ï†ÄÏû• ÏãúÏûë"),console.log("üîç [MarkdownEditor] Ï†ÄÏû•Ìï† ÎÇ¥Ïö© Í∏∏Ïù¥:",c.value.length),console.log("üîç [MarkdownEditor] Ï†ÄÏû•Ìï† ÎÇ¥Ïö© ÎÅùÎ∂ÄÎ∂Ñ:",JSON.stringify(c.value.substring(c.value.length-20))),e("save",c.value,p.slideId),setTimeout(()=>{I.value=!1},1e3)}catch(r){console.error("Ï†ÄÏû• Ïò§Î•ò:",r),I.value=!1}};return ae(()=>p.initialContent,r=>{c.value=r,E.value=r}),ae(()=>p.slideId,r=>{console.log("slideId Î≥ÄÍ≤ΩÎê®:",r),c.value=p.initialContent,E.value=p.initialContent}),Pe(()=>{E.value=c.value}),Re(()=>{g.value&&clearTimeout(g.value)}),m({setContent:r=>{c.value=r},content:c}),(r,n)=>(w(),V("div",vl,[o("div",ml,[o("div",pl,[s(M,{flat:"",dense:"",size:"sm",icon:"image",label:"Ïù¥ÎØ∏ÏßÄ Ï≤®Î∂Ä",onClick:he,class:"q-mr-sm"}),s(M,{flat:"",dense:"",size:"sm",icon:"play_circle",label:"YouTube",onClick:we,class:"q-mr-sm"}),s(M,{flat:"",dense:"",size:"sm",icon:"save",label:"Ï†ÄÏû•",onClick:_e,loading:I.value},null,8,["loading"])])]),s(Ae,{modelValue:A.value,"onUpdate:modelValue":n[4]||(n[4]=u=>A.value=u),persistent:""},{default:y(()=>[s(Me,{style:{"min-width":"400px"}},{default:y(()=>[s(ee,null,{default:y(()=>n[11]||(n[11]=[o("div",{class:"text-h6"},"Ïù¥ÎØ∏ÏßÄ Ï≤®Î∂Ä",-1)])),_:1,__:[11]}),s(ee,null,{default:y(()=>[o("div",fl,[o("div",gl,[s(el,{modelValue:D.value,"onUpdate:modelValue":[n[0]||(n[0]=u=>D.value=u),re],label:"Ïù¥ÎØ∏ÏßÄ ÌååÏùº ÏÑ†ÌÉù",accept:".jpg,.jpeg,.png,.gif,.webp",outlined:"",dense:""},{prepend:y(()=>[s(oe,{name:"image"})]),_:1},8,["modelValue"])]),F.value?(w(),V("div",yl,[n[12]||(n[12]=o("div",{class:"text-caption q-mb-xs"},"ÎØ∏Î¶¨Î≥¥Í∏∞:",-1)),o("img",{src:F.value,alt:"ÎØ∏Î¶¨Î≥¥Í∏∞",style:{"max-width":"100%","max-height":"200px","object-fit":"contain"}},null,8,hl)])):j("",!0),o("div",bl,[s(Z,{modelValue:O.value,"onUpdate:modelValue":n[1]||(n[1]=u=>O.value=u),label:"Ïù¥ÎØ∏ÏßÄ ÏÑ§Î™Ö (alt ÌÖçÏä§Ìä∏)",outlined:"",dense:"",placeholder:"Ïù¥ÎØ∏ÏßÄÏóê ÎåÄÌïú ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"},null,8,["modelValue"])]),o("div",wl,[s(Z,{modelValue:d.value,"onUpdate:modelValue":n[2]||(n[2]=u=>d.value=u),modelModifiers:{number:!0},label:"ÎÑàÎπÑ (px)",type:"number",outlined:"",dense:"",placeholder:"ÏûêÎèô"},null,8,["modelValue"])]),o("div",Sl,[s(Z,{modelValue:k.value,"onUpdate:modelValue":n[3]||(n[3]=u=>k.value=u),modelModifiers:{number:!0},label:"ÎÜíÏù¥ (px)",type:"number",outlined:"",dense:"",placeholder:"ÏûêÎèô"},null,8,["modelValue"])])])]),_:1}),s(Ue,{align:"right"},{default:y(()=>[s(M,{flat:"",label:"Ï∑®ÏÜå",onClick:ue}),s(M,{color:"primary",label:"ÏÇΩÏûÖ",onClick:be,disable:!D.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(Ae,{modelValue:X.value,"onUpdate:modelValue":n[9]||(n[9]=u=>X.value=u),persistent:""},{default:y(()=>[s(Me,{style:{"min-width":"400px"}},{default:y(()=>[s(ee,null,{default:y(()=>n[13]||(n[13]=[o("div",{class:"text-h6"},"YouTube ÏòÅÏÉÅ Ï∂îÍ∞Ä",-1)])),_:1,__:[13]}),s(ee,null,{default:y(()=>[o("div",$l,[o("div",_l,[s(Z,{modelValue:G.value,"onUpdate:modelValue":[n[5]||(n[5]=u=>G.value=u),ce],label:"YouTube ÎßÅÌÅ¨",outlined:"",dense:"",placeholder:"https://www.youtube.com/watch?v=..."},{prepend:y(()=>[s(oe,{name:"play_circle"})]),_:1},8,["modelValue"])]),q.value?(w(),V("div",kl,[n[14]||(n[14]=o("div",{class:"text-caption q-mb-xs"},"ÎØ∏Î¶¨Î≥¥Í∏∞:",-1)),o("div",xl,[o("iframe",{src:`https://www.youtube.com/embed/${q.value}`,width:"100%",height:"200",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,Ll)])])):j("",!0),o("div",Cl,[s(Z,{modelValue:J.value,"onUpdate:modelValue":n[6]||(n[6]=u=>J.value=u),label:"ÏòÅÏÉÅ Ï†úÎ™© (ÏÑ†ÌÉùÏÇ¨Ìï≠)",outlined:"",dense:"",placeholder:"ÏòÅÏÉÅÏóê ÎåÄÌïú ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"},null,8,["modelValue"])]),o("div",Tl,[s(Z,{modelValue:N.value,"onUpdate:modelValue":n[7]||(n[7]=u=>N.value=u),modelModifiers:{number:!0},label:"ÎÑàÎπÑ (px)",type:"number",outlined:"",dense:"",placeholder:"ÏûêÎèô"},null,8,["modelValue"])]),o("div",El,[s(Z,{modelValue:B.value,"onUpdate:modelValue":n[8]||(n[8]=u=>B.value=u),modelModifiers:{number:!0},label:"ÎÜíÏù¥ (px)",type:"number",outlined:"",dense:"",placeholder:"ÏûêÎèô"},null,8,["modelValue"])])])]),_:1}),s(Ue,{align:"right"},{default:y(()=>[s(M,{flat:"",label:"Ï∑®ÏÜå",onClick:se}),s(M,{color:"primary",label:"ÏÇΩÏûÖ",onClick:Se,disable:!q.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o("div",Ml,[s(Z,{modelValue:c.value,"onUpdate:modelValue":[n[10]||(n[10]=u=>c.value=u),le],type:"textarea",placeholder:"Markdown ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...",rows:"15",outlined:"",dense:"",class:"markdown-textarea"},null,8,["modelValue"]),o("div",Vl,P(c.value.length)+"Ïûê / 10000Ïûê",1)])]))}}),Dl=ye(Il,[["__scopeId","data-v-3f0ce4c0"]]),ql={class:"q-my-none editor-title"},Ul={class:"text-caption text-grey-6 q-mt-xs"},Al={class:"row items-center justify-between q-mb-sm"},Nl={class:"col"},Wl={class:"text-subtitle2 text-weight-medium"},Pl={class:"text-caption text-grey-6"},Rl={class:"col-auto"},Fl={class:"text-caption text-grey-6"},Ol={class:"row q-gutter-sm q-mb-md"},zl={class:"q-mt-md text-right"},Hl=ge({__name:"SlideEditorSection",props:{currentSlideType:{},currentSlideInfo:{},currentLesson:{},currentSlide:{},currentSlideContent:{},isApplying:{type:Boolean}},emits:["slideContentSave","slideContentChange","slidePreview","createMarkdownFile","autoUpdate","updateTOC","addNewSlide","applySlide"],setup(T,{expose:m,emit:S}){const p=T,e=S,$=Ve(),c=f(),I=f(!1),_=(d,k)=>{e("slideContentSave",d,k)},R=d=>{e("slideContentChange",d)},g=d=>{e("slidePreview",d)},E=(d,k)=>{e("createMarkdownFile",d,k)},A=(d,k)=>{e("autoUpdate",d,k)},D=async()=>{I.value=!0;try{e("updateTOC"),$.notify({type:"positive",message:"Î™©Ï∞® ÏóÖÎç∞Ïù¥Ìä∏Í∞Ä ÏãúÏûëÎêòÏóàÏäµÎãàÎã§",position:"top",timeout:2e3,icon:"refresh",actions:[{label:"ÌôïÏù∏",color:"white"}]})}catch{$.notify({type:"negative",message:"Î™©Ï∞® ÏóÖÎç∞Ïù¥Ìä∏ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§",position:"top",timeout:3e3,icon:"error",actions:[{label:"ÌôïÏù∏",color:"white"}]})}finally{I.value=!1}},F=()=>{e("addNewSlide")},O=()=>{e("applySlide",`${p.currentLesson}-${p.currentSlide}`)};return m({markdownEditor:c}),(d,k)=>(w(),te(Me,{class:"sidebar-card q-mt-md"},{default:y(()=>[s(ee,null,{default:y(()=>[o("h6",ql,P(d.currentSlideType==="chapter"?"Chapter Ìé∏ÏßëÍ∏∞":"Ïä¨ÎùºÏù¥Îìú Ìé∏ÏßëÍ∏∞"),1),o("div",Ul,P(d.currentSlideType==="chapter"?"Chapter ÎÇ¥Ïö©ÏùÑ Ìé∏ÏßëÌïòÏÑ∏Ïöî":"Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö©ÏùÑ Ìé∏ÏßëÌïòÏÑ∏Ïöî"),1)]),_:1}),s(ee,{class:"q-pt-none current-slide-info-section"},{default:y(()=>[o("div",Al,[o("div",Nl,[o("div",Wl,P(d.currentSlideInfo?.lessonTitle),1),o("div",Pl,P(d.currentSlideInfo?.slideTitle),1)]),o("div",Rl,[s(Ke,{size:"sm",color:"primary","text-color":"white",label:`${d.currentSlideInfo?.slideIndex}/${d.currentSlideInfo?.totalSlides}`},null,8,["label"])])]),o("div",Fl," Í∞ïÏùò "+P(d.currentSlideInfo?.lessonNumber)+"/"+P(d.currentSlideInfo?.totalLessons),1)]),_:1}),s(ee,{class:"q-pt-none"},{default:y(()=>[o("div",Ol,[s(M,{icon:"refresh",label:"Î™©Ï∞® ÏóÖÎç∞Ïù¥Ìä∏",onClick:D,loading:I.value,color:"primary"},null,8,["loading"]),s(M,{icon:"add",label:"ÏÉà Ïä¨ÎùºÏù¥Îìú",onClick:F,color:"positive"})]),(w(),te(Dl,{key:`${d.currentLesson}-${d.currentSlide}`,"initial-content":d.currentSlideContent,"slide-id":`${d.currentLesson}-${d.currentSlide}`,onSave:_,onContentChange:R,onPreview:g,onCreateMarkdown:E,onAutoUpdate:A,ref_key:"markdownEditor",ref:c},null,8,["initial-content","slide-id"])),o("div",zl,[s(M,{color:"accent",icon:"check_circle",label:"Ïä¨ÎùºÏù¥Îìú Î∞òÏòÅ",onClick:O,loading:d.isApplying,disable:d.isApplying},null,8,["loading","disable"])])]),_:1})]),_:1}))}}),Yl=ye(Hl,[["__scopeId","data-v-cda91fc6"]]),jl={class:"main-content"},Bl={key:2,class:"navigation-controls"},Ql={class:"slide-info"},Zl={class:"slide-counter"},Xl={key:3,class:"editor-mode-notice"},Gl=20,Jl=80,Kl=ge({__name:"IndexPage",setup(T){const{userRole:m}=Ie(),S=C(()=>m.value==="admin"),p=Ve();Oe(),ze();const e=Xe();Ie(),Ge();const $=f(!1),c=C(()=>e.currentLesson),I=C(()=>e.currentSlide),_=C(()=>e.isPresentationMode);ae(()=>_.value,async t=>{if(console.log(`üé≠ Ìé∏ÏßëÍ∏∞ Î™®Îìú Î≥ÄÍ≤Ω: ${t?"ÌîÑÎ†àÏ††ÌÖåÏù¥ÏÖò":"Ìé∏ÏßëÍ∏∞"}`),!t)try{const a=e.currentLesson,i=e.currentSlide;console.log(`üìÇ Ìé∏ÏßëÍ∏∞ Î™®Îìú Ï†ÑÌôò - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú: ${a}-${i}`);const l=await e.loadSlideContentForEditing(a,i);console.log("‚úÖ Ìé∏ÏßëÍ∏∞ Î™®Îìú Ï†ÑÌôò - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú ÏôÑÎ£å:",{contentLength:l.length,contentPreview:l.substring(0,100)}),g.value=l}catch(a){console.error("‚ùå Ìé∏ÏßëÍ∏∞ Î™®Îìú Ï†ÑÌôò - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú Ïã§Ìå®:",a);const i=e.currentLesson,l=e.currentSlide;g.value=`# Ïä¨ÎùºÏù¥Îìú ${i}-${l}

ÏÉàÎ°úÏö¥ Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî.`}}),ae([()=>e.currentLesson,()=>e.currentSlide],async()=>{await re(e.currentLesson,e.currentSlide),A.value&&setTimeout(()=>{D()},500)});const R=f(),g=f(""),E=C(()=>({lessonTitle:`Í∞ïÏùò ${e.currentLesson+1}`,slideTitle:`Ïä¨ÎùºÏù¥Îìú ${e.currentSlide+1}`,slideIndex:e.currentSlide+1,totalSlides:e.currentLessonData?.slides||0,lessonNumber:e.currentLesson+1,totalLessons:e.lessons.length})),A=C(()=>`${e.currentLesson}-${e.currentSlide}`.startsWith("1-1")&&e.currentSlide>=13),D=()=>{A.value&&setTimeout(()=>{try{const t=document.querySelector(".slide-iframe");if(t&&t.contentDocument){const a=t.contentDocument.querySelectorAll(".quiz-option");a.forEach(i=>{i.removeEventListener("click",F),i.addEventListener("click",F),i.style.cursor="pointer",i.style.transition="all 0.2s ease"}),b.log(`‚úÖ Quiz Ïù¥Î≤§Ìä∏ Ï£ºÏûÖ ÏôÑÎ£å: ${a.length}Í∞ú ÏòµÏÖò`)}}catch(t){b.warn("‚ö†Ô∏è Quiz Ïù¥Î≤§Ìä∏ Ï£ºÏûÖ Ïã§Ìå®:",t)}},200)},F=t=>{t.preventDefault(),t.stopPropagation();const a=t.target,i=a.getAttribute("data-idx"),l=document.querySelector(".slide-iframe");if(l&&l.contentDocument){const h=l.contentDocument.getElementById("quiz-answer-data"),L=l.contentDocument.querySelectorAll(".quiz-option");h&&(h.style.display="block"),L.forEach(U=>U.classList.remove("selected")),a.classList.add("selected"),b.log(`üéØ Quiz ÏòµÏÖò ÌÅ¥Î¶≠: ${i}Î≤à ÏÑ†ÌÉù, Ï†ïÎãµ ÌëúÏãú`)}},O=t=>{b.log("Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö© Ï†ÄÏû•:",t),g.value=t},d=t=>{b.log("Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö© Î≥ÄÍ≤Ω:",t),g.value=t},k=()=>{b.log("Ïä¨ÎùºÏù¥Îìú ÎØ∏Î¶¨Î≥¥Í∏∞")},X=()=>{console.log("ÎßàÌÅ¨Îã§Ïö¥ ÌååÏùº ÏÉùÏÑ±")},G=()=>{console.log("ÏûêÎèô ÏóÖÎç∞Ïù¥Ìä∏")},q=()=>{console.log("Î™©Ï∞® ÏóÖÎç∞Ïù¥Ìä∏")},J=()=>{b.log("ÏÉà Ïä¨ÎùºÏù¥Îìú Ï∂îÍ∞Ä")},N=f(!1),B=async t=>{N.value=!0;try{b.log("üîÑ Ïä¨ÎùºÏù¥Îìú Î∞òÏòÅ ÏãúÏûë:",t);const[a="0",i="0"]=(t||"0-0").split("-"),l=`${a}-${i}`;if(await e.saveSlideToFirebaseStorage(l,g.value)){console.log("‚úÖ Firebase StorageÏóê MD ÌååÏùº Ï†ÄÏû• ÏôÑÎ£å:",l),le.value++,p.notify({type:"positive",message:"Ïä¨ÎùºÏù¥ÎìúÍ∞Ä Firebase StorageÏóê ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!",position:"top",timeout:3e3,icon:"cloud_done",actions:[{label:"ÌôïÏù∏",color:"white"}]});const h=new Blob([g.value],{type:"text/markdown"}),L=URL.createObjectURL(h),U=document.createElement("a");U.href=L,U.download=`slide-${l}.md`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(L),console.log("üìÅ Î°úÏª¨ Î∞±ÏóÖ ÌååÏùºÎèÑ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§.")}else throw new Error("Firebase Storage Ï†ÄÏû•Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");b.log("üéâ Ïä¨ÎùºÏù¥Îìú Î∞òÏòÅ ÏôÑÎ£å")}catch(a){b.error("‚ùå Firebase Storage Ï†ÄÏû• Ïã§Ìå®:",a),p.notify({type:"negative",message:"Firebase StorageÏóê Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Ïù∏ÌÑ∞ÎÑ∑ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.",position:"top",timeout:5e3,icon:"cloud_off",actions:[{label:"ÌôïÏù∏",color:"white"}]})}finally{N.value=!1}},le=f(0);C(()=>e.lessons.reduce((t,a)=>t+a.slides,0));const he=C(()=>`${e.currentLesson}-${e.currentSlide}`),v=f("lecture"),re=async(t,a)=>{try{const i=await fetch(`/slides/slide-${t}-${a}.md`);if(i.ok){const l=await i.text();if(l.trim().startsWith("@html"))v.value="html";else if(l.includes("@cover")||l.includes("Ïª§Î≤Ñ"))v.value="cover";else if(l.includes("@toc")||l.includes("Î™©Ï∞®"))v.value="toc";else if(l.includes("@poll")||l.includes("Ìà¨Ìëú"))v.value="poll";else if(l.includes("@stats")||l.includes("ÌÜµÍ≥Ñ"))v.value="stats";else if(l.includes("@interactive")||l.includes("Ïù∏ÌÑ∞ÎûôÌã∞Î∏å"))v.value="interactive";else if(l.includes("@example")||l.includes("ÏòàÏãú"))v.value="example";else if(l.includes("@challenge")||l.includes("ÎèÑÏ†Ñ"))v.value="challenge";else if(l.includes("@timeline")||l.includes("ÌÉÄÏûÑÎùºÏù∏"))v.value="timeline";else if(l.includes("@profile")||l.includes("ÌîÑÎ°úÌïÑ"))v.value="profile";else if(l.includes("@lecture")||l.includes("Í∞ïÏùò"))v.value="lecture";else if(l.includes("@chapter")||l.includes("Ï±ïÌÑ∞"))v.value="chapter";else{const h=`${t}-${a}`;h==="0-0"?v.value="cover":h==="0-1"?v.value="index":h==="0-2"?v.value="profile":h.endsWith("-0")?v.value="chapter":h.startsWith("2-")&&h!=="2-0"?v.value="example":h.startsWith("3-")&&h!=="3-0"?v.value="challenge":v.value="lecture"}}}catch(i){console.error(`Ïä¨ÎùºÏù¥Îìú ÌÉÄÏûÖ Í∞êÏßÄ Ïã§Ìå®: ${t}-${a}`,i);const l=`${t}-${a}`;l==="0-0"?v.value="cover":l==="0-1"?v.value="index":l==="0-2"?v.value="profile":l.endsWith("-0")?v.value="chapter":l.startsWith("2-")&&l!=="2-0"?v.value="example":l.startsWith("3-")&&l!=="3-0"?v.value="challenge":v.value="lecture"}},ue=C(()=>v.value!=="poll"?"":`poll-${e.currentLesson}-${e.currentSlide}`),be=async t=>{try{if(!S.value||!t||!await p.dialog({title:"Í≤∞Í≥º Ï¥àÍ∏∞Ìôî",message:`Ìï¥Îãπ Ìà¨ÌëúÏùò ÎÇòÏùò ÏÑ†ÌÉù(LocalStorage)Í≥º RTDBÏùò ÌëúÍ∏∞Î•º ÏÇ≠Ï†úÌï†ÍπåÏöî?
Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.`,cancel:!0,ok:{label:"Ï¥àÍ∏∞Ìôî",color:"negative"}}).onOk(()=>!0).onCancel(()=>!1))return;try{Object.keys(localStorage).filter(i=>i.toLowerCase().includes("poll")).forEach(i=>localStorage.removeItem(i))}catch{}const a=Y?xe(Y):null;if(a){const{getAuth:i}=await Le(async()=>{const{getAuth:h}=await Ce(()=>Te(()=>import("./QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm.js"),__vite__mapDeps([0,1,2])),pe([0,1,2])).then(L=>L.i);return{getAuth:h}},fe([0,1,2])),l=i(Y).currentUser?.uid;l&&await Ye(Ee(a,`polls/${t}/userVotes/${l}`)).catch(()=>{})}try{document.querySelector(".slide-iframe")?.contentWindow?.postMessage({type:"poll-state",pollId:t,optionId:""},"*")}catch{}p.notify({type:"positive",message:"Ìà¨Ìëú Í≤∞Í≥ºÍ∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.",position:"top"})}catch{p.notify({type:"negative",message:"Ï¥àÍ∏∞Ìôî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.",position:"top"})}},we=C(()=>e.currentLesson===0&&e.currentSlide===0),ne=C(()=>{const t=e.lessons.length-1,a=e.lessons[t];return e.currentLesson===t&&e.currentSlide===(a?.slides||0)-1}),ce=f(60),de=f(40),se=f(!1),Se=C(()=>_.value?{}:{flex:`0 0 ${ce.value}%`}),$e=C(()=>_.value?{}:{flex:`0 0 ${de.value}%`}),_e=t=>{se.value=!0,document.body.style.cursor="col-resize"},r=()=>{se.value=!1,document.body.style.cursor=""},n=t=>{if(!se.value)return;const a=document.querySelector(".main-content");if(!a)return;const i=a.getBoundingClientRect(),l=(t.clientX-i.left)/i.width*100;l>Gl&&l<Jl&&(ce.value=l,de.value=100-l)},u=()=>{e.prevSlide()},x=()=>{e.nextSlide()},z=()=>{e.setCurrentLesson(0),e.setCurrentSlide(0)},Q=()=>{const t=e.lessons.length-1,a=e.lessons[t];a&&(e.setCurrentLesson(t),e.setCurrentSlide(a.slides-1))},H=t=>{if(_.value)switch(t.key){case"ArrowLeft":t.preventDefault(),u();break;case"ArrowRight":case" ":t.preventDefault(),x();break;case"Home":t.preventDefault(),z();break;case"End":t.preventDefault(),Q();break;case"?":t.preventDefault(),$.value=!$.value;break}};return Pe(async()=>{await re(e.currentLesson,e.currentSlide),document.addEventListener("keydown",H),window.addEventListener("mousemove",n),window.addEventListener("mouseup",r);const t=async i=>{try{if(m.value!=="admin")return;const l=i.data||{};if(l&&l.type==="poll-vote"){const h=Y?xe(Y):null;if(!h)return;const{pollId:L,optionId:U,text:ve}=l;if(!L)return;const{getAuth:me}=await Le(async()=>{const{getAuth:ke}=await Ce(()=>Te(()=>import("./QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm.js"),__vite__mapDeps([0,1,2])),pe([0,1,2])).then(Fe=>Fe.i);return{getAuth:ke}},fe([0,1,2])),K=me(Y).currentUser?.uid;if(!K)return;const W=ve||String(U||"");await je(Ee(h,`polls/${L}/userVotes/${K}`),W),b.log("üó≥Ô∏è admin saved(userVotes):",{pollId:L,valueToSave:W})}if(l&&l.type==="poll-ready"){const h=Y?xe(Y):null;if(!h)return;const{pollId:L}=l;if(!L)return;const{getAuth:U}=await Le(async()=>{const{getAuth:W}=await Ce(()=>Te(()=>import("./QSpinnerDots-DmD6LJEW-mqbZkDZd-DEZvrJgm.js"),__vite__mapDeps([0,1,2])),pe([0,1,2])).then(ke=>ke.i);return{getAuth:W}},fe([0,1,2])),ve=U(Y).currentUser?.uid;if(!ve)return;const me=await Be(Ee(h,`polls/${L}/userVotes/${ve}`)),K=document.querySelector(".slide-iframe");if(!K||!K.contentWindow)return;if(me.exists()){const W=me.val();typeof W=="string"&&/^\d+$/.test(W)?K.contentWindow.postMessage({type:"poll-state",pollId:L,optionId:String(W)},"*"):W&&K.contentWindow.postMessage({type:"poll-state",pollId:L,text:String(W)},"*")}}}catch(l){b.error("üó≥Ô∏è admin poll sync error:",l)}};window.addEventListener("message",t);const a=new Image;a.onload=()=>{console.log("‚úÖ Î∞∞Í≤Ω Ïù¥ÎØ∏ÏßÄ Î°úÎî© ÏÑ±Í≥µ:",a.src)},a.onerror=()=>{console.error("‚ùå Î∞∞Í≤Ω Ïù¥ÎØ∏ÏßÄ Î°úÎî© Ïã§Ìå®:",a.src)},a.src="/images/20250806_1231_churchtech.png"}),ae(()=>[e.currentLesson,e.currentSlide],async([t,a])=>{if(t!==void 0&&a!==void 0&&(console.log(`üîÑ IndexPage - Ïä§ÌÜ†Ïñ¥ Î≥ÄÍ≤Ω Í∞êÏßÄ: lesson=${t}, slide=${a}`),!_.value))try{console.log(`üìÇ Ìé∏ÏßëÍ∏∞ Î™®Îìú - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú ÏãúÏûë: ${t}-${a}`);const i=await e.loadSlideContentForEditing(t,a);console.log("‚úÖ Ìé∏ÏßëÍ∏∞ Î™®Îìú - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú ÏôÑÎ£å:",{contentLength:i.length,contentPreview:i.substring(0,100)}),g.value=i}catch(i){console.error("‚ùå Ìé∏ÏßëÍ∏∞ Î™®Îìú - MD ÌååÏùº ÎÇ¥Ïö© Î°úÎìú Ïã§Ìå®:",i),g.value=`# Ïä¨ÎùºÏù¥Îìú ${t}-${a}

ÏÉàÎ°úÏö¥ Ïä¨ÎùºÏù¥Îìú ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±ÌïòÏÑ∏Ïöî.`}},{immediate:!0}),Re(()=>{document.removeEventListener("keydown",H),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r)}),(t,a)=>(w(),te(Ze,{class:"index-page"},{default:y(()=>[a[5]||(a[5]=o("div",{class:"login-background"},null,-1)),o("div",jl,[o("div",{class:He(["slide-viewer-container",{"with-editor":!_.value}]),style:De(Se.value)},[(w(),te(cl,{key:le.value,"slide-number":he.value,"slide-type":v.value},null,8,["slide-number","slide-type"])),S.value&&v.value==="poll"?(w(),te(M,{key:0,class:"poll-admin-fab",round:"",color:"negative",icon:"delete",disable:!ue.value,onClick:a[0]||(a[0]=i=>be(ue.value))},{default:y(()=>[s(Qe,null,{default:y(()=>a[2]||(a[2]=[ie("Í≤∞Í≥º Ï¥àÍ∏∞Ìôî",-1)])),_:1,__:[2]})]),_:1},8,["disable"])):j("",!0)],6),_.value?j("",!0):(w(),V("div",{key:0,class:"resizer-bar",onMousedown:_e},null,32)),_.value?j("",!0):(w(),V("div",{key:1,class:"editor-container",style:De($e.value)},[s(Yl,{"current-slide-type":v.value,"current-slide-info":E.value,"current-lesson":c.value,"current-slide":I.value,"current-slide-content":g.value,"is-applying":N.value,onSlideContentSave:O,onSlideContentChange:d,onSlidePreview:k,onCreateMarkdownFile:X,onAutoUpdate:G,onUpdateToc:q,onAddNewSlide:J,onApplySlide:B,ref_key:"slideEditorSection",ref:R},null,8,["current-slide-type","current-slide-info","current-lesson","current-slide","current-slide-content","is-applying"])],4)),_.value?(w(),V("div",Bl,[s(M,{disable:we.value,onClick:u,color:"blue","text-color":"white",icon:"chevron_left",round:"",size:"lg",class:"nav-btn"},null,8,["disable"]),o("div",Ql,[o("span",Zl,P(qe(e).currentLesson)+"-"+P(qe(e).currentSlide+1),1)]),s(M,{disable:ne.value,onClick:x,color:"blue","text-color":"white",icon:"chevron_right",round:"",size:"lg",class:"nav-btn"},null,8,["disable"])])):j("",!0),_.value?j("",!0):(w(),V("div",Xl,[s(Ne,{class:"bg-orange text-white",rounded:""},{avatar:y(()=>[s(oe,{name:"edit"})]),default:y(()=>[a[3]||(a[3]=o("div",{class:"text-body2"},[o("strong",null,"Ìé∏ÏßëÍ∏∞ Î™®Îìú"),o("br"),ie(" ÌòÑÏû¨ Ìé∏ÏßëÍ∏∞ Î™®ÎìúÏûÖÎãàÎã§. ÌîÑÎ†àÏ††ÌÖåÏù¥ÏÖò Î™®ÎìúÎ°ú Ï†ÑÌôòÌïòÎ†§Î©¥ ÏÉÅÎã®Ïùò Ìé∏Ïßë Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî. ")],-1))]),_:1,__:[3]})]))]),$.value&&_.value?(w(),te(Ne,{key:0,class:"bg-info text-white keyboard-help",rounded:""},{avatar:y(()=>[s(oe,{name:"keyboard"})]),action:y(()=>[s(M,{flat:"",color:"white",label:"Îã´Í∏∞",onClick:a[1]||(a[1]=i=>$.value=!1)})]),default:y(()=>[a[4]||(a[4]=o("div",{class:"text-body2"},[o("strong",null,"ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§:"),o("br"),ie(" ‚Üê ‚Üí : Ïù¥Ï†Ñ/Îã§Ïùå Ïä¨ÎùºÏù¥Îìú | Space : Îã§Ïùå Ïä¨ÎùºÏù¥Îìú"),o("br"),ie(" Home/End : Ï≤òÏùå/ÎßàÏßÄÎßâ Ïä¨ÎùºÏù¥Îìú | F11 : Ï†ÑÏ≤¥ÌôîÎ©¥"),o("br"),ie(" ESC : Ìé∏ÏßëÍ∏∞ Î™®Îìú | ? : ÎèÑÏõÄÎßê ÌÜ†Í∏Ä ")],-1))]),_:1,__:[4]})):j("",!0)]),_:1,__:[5]}))}}),ct=ye(Kl,[["__scopeId","data-v-8399d9a2"]]);export{ct as default};
