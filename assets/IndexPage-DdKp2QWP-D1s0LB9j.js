const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QSpinnerDots-CW_TS37f-DHTnbCLH.js","assets/index-CyCqcZIQ.js","assets/index-D7VONvhQ.css"])))=>i.map(i=>d[i]);
import{dZ as fe,e1 as p,e2 as C,en as M,e4 as ae,e9 as w,el as n,es as o,eA as oe,er as R,em as Y,d_ as Ee,e5 as Ne,eF as ze,eo as E,ea as y,e8 as te,e0 as Me,eG as He,d$ as Fe,eH as Ve,ew as Oe,eq as ie,ep as Ie,eI as W,eJ as ke,X as xe,Y as Le,eK as je,eL as Ce,eM as Pe,eN as We}from"./index-CyCqcZIQ.js";import{t as Te,j as ee,e as qe,o as De,D as Ye}from"./QDialog-DCVptsUO-BjjrB4_Q.js";import{_ as Ue}from"./QBanner-DSaL6E1A-Cv2hl2L_.js";import{C as Qe}from"./QPage-CATcdJAM-BLG2WZ4G.js";import{K as b,H as B,q as Ge,Y as Be}from"./useGuestAuth-B3dUk0QH-BQz37ZyD.js";import{Q as Je}from"./QSpinnerDots-CW_TS37f-DHTnbCLH.js";import{k as ge}from"./_plugin-vue_export-helper-CJfoBXcF-BV1JEARH.js";import{G as Xe}from"./QChip-nX3S8ibB-BQad_HXT.js";import{H as Ze,b as Ae}from"./marked.esm-ChVohG0P-BAM_JNgt.js";import"./pinia-CwhW7gbT-DgIwZFmV.js";const me=(V,m=me,$=m.f||(m.f=["assets/QSpinnerDots-CW_TS37f.js","assets/index-D1vT6N3s.js","assets/index-C_LQcHkP.css"]))=>V.map(f=>$[f]),Ke={class:"simple-slide-viewer"},el={key:0,class:"error"},ll={key:1,class:"html-slide-container"},tl=["innerHTML"],al={key:2,class:"slide-iframe-container"},ol=["src"],sl={key:0,class:"loading-overlay"},nl={key:3,class:"no-content"},il=fe({__name:"SimpleSlideViewer",props:{slideNumber:{},slideType:{}},setup(V){const m=V,$=p(""),f=p(!1),e=p(""),S=C(()=>m.slideNumber?`/generated/slides/slide-${m.slideNumber}.html`:""),c=async()=>{if(m.slideType==="html")try{f.value=!0;const g=await fetch(`/slides/slide-${m.slideNumber}.md`);if(g.ok){const T=await g.text();e.value=T.replace(/^@html\s*\n?/gm,"").trim(),b.log(`âœ… HTML ìŠ¬ë¼ì´ë“œ ë‚´ìš© ë¡œë“œ ì™„ë£Œ: ${m.slideNumber}`)}else $.value=`HTML ìŠ¬ë¼ì´ë“œ ${m.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`HTML ìŠ¬ë¼ì´ë“œ ${m.slideNumber} ë¡œë”© ì‹¤íŒ¨:`,g.status)}catch(g){$.value=`HTML ìŠ¬ë¼ì´ë“œ ${m.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`HTML ìŠ¬ë¼ì´ë“œ ${m.slideNumber} ë¡œë”© ì˜¤ë¥˜:`,g)}finally{f.value=!1}},I=()=>{f.value=!1,b.log(`âœ… iframe ë¡œë“œ ì™„ë£Œ: ${S.value}`)},_=g=>{$.value=`ìŠ¬ë¼ì´ë“œ ${m.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`,b.error(`ìŠ¬ë¼ì´ë“œ ${m.slideNumber} ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ:`,g),f.value=!1},H=()=>{f.value=!1,b.log(`âœ… HTML ìŠ¬ë¼ì´ë“œ ë¡œë“œ ì™„ë£Œ: ${m.slideNumber}`)};return ae(()=>m.slideNumber,g=>{g&&(f.value=!0,$.value="",m.slideType==="html"?c():(b.log(`ğŸ”„ iframe URL ë³€ê²½: ${S.value}`),setTimeout(()=>{f.value&&(f.value=!1,b.log("âš ï¸ ìŠ¬ë¼ì´ë“œ ë¡œë”© ì‹œê°„ ì´ˆê³¼"))},3e3)))},{immediate:!0}),(g,T)=>(w(),M("div",Ke,[$.value?(w(),M("div",el,[n(oe,{name:"error",size:"50px",color:"negative"}),o("p",null,R($.value),1)])):g.slideType==="html"&&e.value?(w(),M("div",ll,[o("div",{class:"html-slide-content",innerHTML:e.value,onLoad:H},null,40,tl)])):S.value?(w(),M("div",al,[o("iframe",{src:S.value,class:"slide-iframe",onLoad:I,onError:_},null,40,ol),f.value?(w(),M("div",sl,[n(Je,{size:"50px",color:"primary"}),T[0]||(T[0]=o("p",null,"ìŠ¬ë¼ì´ë“œ ë¡œë”© ì¤‘...",-1))])):Y("",!0)])):(w(),M("div",nl,[n(oe,{name:"slideshow",size:"50px",color:"grey"}),T[1]||(T[1]=o("p",null,"í‘œì‹œí•  ìŠ¬ë¼ì´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.",-1))]))]))}}),rl=ge(il,[["__scopeId","data-v-2a03a82a"]]),ul=V=>{if(!V)return"";Ae.setOptions({breaks:!1,gfm:!0});let m=Ae(V);return typeof m=="string"&&(m=m.replace(/<p>/g,"<div>").replace(/<\/p>/g,"</div>")),typeof m=="string"?m:V},cl={class:"markdown-editor"},dl={class:"editor-header"},vl={class:"editor-actions"},pl={class:"row q-col-gutter-md"},ml={class:"col-12"},fl={key:0,class:"col-12"},gl=["src"],yl={class:"col-12"},hl={class:"col-6"},bl={class:"col-6"},wl={class:"row q-col-gutter-md"},Sl={class:"col-12"},_l={key:0,class:"col-12"},$l={class:"youtube-preview"},kl=["src"],xl={class:"col-12"},Ll={class:"col-6"},Cl={class:"col-6"},Tl={class:"editor-content"},El={class:"text-caption text-grey-6 q-mt-xs"},Ml=fe({__name:"MarkdownEditor",props:{initialContent:{default:""},slideId:{default:""}},emits:["save","contentChange","autoUpdate"],setup(V,{expose:m,emit:$}){const f=V,e=$,S=Ee(),c=p(f.initialContent),I=p(!1),_=p(!0),H=p(null),g=p(null),T=p(f.initialContent),A=p(!1),q=p(null),F=p(null),O=p(""),d=p(null),k=p(null),J=p(!1),X=p(""),D=p(""),Z=p(""),N=p(null),Q=p(null);C(()=>{try{return ul(c.value)}catch(r){return console.error("Markdown ë Œë”ë§ ì˜¤ë¥˜:",r),c.value}});const le=()=>{e("contentChange",c.value),Se()},ye=()=>{A.value=!0,v()},v=()=>{q.value=null,F.value=null,O.value="",d.value=null,k.value=null},re=r=>{if(r){q.value=r;const s=new FileReader;s.onload=u=>{F.value=u.target?.result},s.readAsDataURL(r)}},ue=()=>{A.value=!1,v()},he=()=>{if(q.value)try{const r=new FileReader;r.onload=s=>{const u=s.target?.result;let x=`![${O.value||"ì´ë¯¸ì§€"}](${u})`;if(d.value||k.value){const G=d.value?` width="${d.value}"`:"",P=k.value?` height="${k.value}"`:"";x=`<img src="${u}" alt="${O.value||"ì´ë¯¸ì§€"}"${G}${P} style="display: block; margin: 0 auto; max-width: 100%;" />`}const j=document.querySelector(".markdown-textarea textarea");if(j){const G=j.selectionStart,P=j.selectionEnd,t=c.value.substring(0,G),a=c.value.substring(P);c.value=t+`
`+x+`
`+a,setTimeout(()=>{const i=G+x.length+2;j.setSelectionRange(i,i),j.focus()},0)}else c.value+=`
`+x+`
`;le(),A.value=!1,v(),S.notify({type:"positive",message:"ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})},r.readAsDataURL(q.value)}catch(r){console.error("ì´ë¯¸ì§€ ì‚½ì… ì˜¤ë¥˜:",r),S.notify({type:"negative",message:"ì´ë¯¸ì§€ ì‚½ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},be=()=>{J.value=!0,se()},se=()=>{X.value="",D.value="",Z.value="",N.value=null,Q.value=null},ce=r=>{if(typeof r=="string"){X.value=r;const s=de(r);D.value=s}else X.value="",D.value=""},de=r=>{const s=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/watch\?.*v=([^&\n?#]+)/];for(const u of s){const x=r.match(u);if(x&&x[1])return x[1]}return""},ne=()=>{J.value=!1,se()},we=()=>{if(D.value)try{let r="";if(N.value||Q.value){const u=N.value?` width="${N.value}"`:"",x=Q.value?` height="${Q.value}"`:"";r=`<iframe src="https://www.youtube.com/embed/${D.value}"${u}${x} frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="display: block; margin: 0 auto; max-width: 100%;"></iframe>`}else r=`<div class="youtube-fullscreen">
  <iframe
    src="https://www.youtube.com/embed/${D.value}"
    width="100%"
    height="100%"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
  ></iframe>
</div>`;Z.value&&(r=`## ${Z.value}

${r}`);const s=document.querySelector(".markdown-textarea textarea");if(s){const u=s.selectionStart,x=s.selectionEnd,j=c.value.substring(0,u),G=c.value.substring(x);c.value=j+`
`+r+`
`+G,setTimeout(()=>{const P=u+r.length+2;s.setSelectionRange(P,P),s.focus()},0)}else c.value+=`
`+r+`
`;le(),J.value=!1,se(),S.notify({type:"positive",message:"YouTube ì˜ìƒì´ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})}catch(r){console.error("YouTube ì‚½ì… ì˜¤ë¥˜:",r),S.notify({type:"negative",message:"YouTube ì˜ìƒ ì‚½ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},Se=()=>{H.value&&clearTimeout(H.value),H.value=setTimeout(()=>{_.value&&(console.log("ğŸ” [MarkdownEditor] ìë™ ì—…ë°ì´íŠ¸"),console.log("ğŸ” [MarkdownEditor] ì—…ë°ì´íŠ¸ ë‚´ìš© ê¸¸ì´:",c.value.length),console.log("ğŸ” [MarkdownEditor] ì—…ë°ì´íŠ¸ ë‚´ìš© ëë¶€ë¶„:",JSON.stringify(c.value.substring(c.value.length-20))),console.log("ğŸ¯ ì‹¤ì‹œê°„ ë·°ì–´ ì—…ë°ì´íŠ¸:",f.slideId,"ë‚´ìš©ê¸¸ì´:",c.value.length),e("autoUpdate",c.value,f.slideId))},1e3)},_e=async()=>{I.value=!0;try{console.log("ğŸ” [MarkdownEditor] ì €ì¥ ì‹œì‘"),console.log("ğŸ” [MarkdownEditor] ì €ì¥í•  ë‚´ìš© ê¸¸ì´:",c.value.length),console.log("ğŸ” [MarkdownEditor] ì €ì¥í•  ë‚´ìš© ëë¶€ë¶„:",JSON.stringify(c.value.substring(c.value.length-20))),e("save",c.value,f.slideId),setTimeout(()=>{I.value=!1},1e3)}catch(r){console.error("ì €ì¥ ì˜¤ë¥˜:",r),I.value=!1}};return ae(()=>f.initialContent,r=>{c.value=r,T.value=r}),ae(()=>f.slideId,r=>{console.log("slideId ë³€ê²½ë¨:",r),c.value=f.initialContent,T.value=f.initialContent}),Ne(()=>{T.value=c.value}),ze(()=>{g.value&&clearTimeout(g.value)}),m({setContent:r=>{c.value=r},content:c}),(r,s)=>(w(),M("div",cl,[o("div",dl,[o("div",vl,[n(E,{flat:"",dense:"",size:"sm",icon:"image",label:"ì´ë¯¸ì§€ ì²¨ë¶€",onClick:ye,class:"q-mr-sm"}),n(E,{flat:"",dense:"",size:"sm",icon:"play_circle",label:"YouTube",onClick:be,class:"q-mr-sm"}),n(E,{flat:"",dense:"",size:"sm",icon:"save",label:"ì €ì¥",onClick:_e,loading:I.value},null,8,["loading"])])]),n(De,{modelValue:A.value,"onUpdate:modelValue":s[4]||(s[4]=u=>A.value=u),persistent:""},{default:y(()=>[n(Te,{style:{"min-width":"400px"}},{default:y(()=>[n(ee,null,{default:y(()=>s[11]||(s[11]=[o("div",{class:"text-h6"},"ì´ë¯¸ì§€ ì²¨ë¶€",-1)])),_:1,__:[11]}),n(ee,null,{default:y(()=>[o("div",pl,[o("div",ml,[n(Ze,{modelValue:q.value,"onUpdate:modelValue":[s[0]||(s[0]=u=>q.value=u),re],label:"ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ",accept:".jpg,.jpeg,.png,.gif,.webp",outlined:"",dense:""},{prepend:y(()=>[n(oe,{name:"image"})]),_:1},8,["modelValue"])]),F.value?(w(),M("div",fl,[s[12]||(s[12]=o("div",{class:"text-caption q-mb-xs"},"ë¯¸ë¦¬ë³´ê¸°:",-1)),o("img",{src:F.value,alt:"ë¯¸ë¦¬ë³´ê¸°",style:{"max-width":"100%","max-height":"200px","object-fit":"contain"}},null,8,gl)])):Y("",!0),o("div",yl,[n(B,{modelValue:O.value,"onUpdate:modelValue":s[1]||(s[1]=u=>O.value=u),label:"ì´ë¯¸ì§€ ì„¤ëª… (alt í…ìŠ¤íŠ¸)",outlined:"",dense:"",placeholder:"ì´ë¯¸ì§€ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"},null,8,["modelValue"])]),o("div",hl,[n(B,{modelValue:d.value,"onUpdate:modelValue":s[2]||(s[2]=u=>d.value=u),modelModifiers:{number:!0},label:"ë„ˆë¹„ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])]),o("div",bl,[n(B,{modelValue:k.value,"onUpdate:modelValue":s[3]||(s[3]=u=>k.value=u),modelModifiers:{number:!0},label:"ë†’ì´ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])])])]),_:1}),n(qe,{align:"right"},{default:y(()=>[n(E,{flat:"",label:"ì·¨ì†Œ",onClick:ue}),n(E,{color:"primary",label:"ì‚½ì…",onClick:he,disable:!q.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(De,{modelValue:J.value,"onUpdate:modelValue":s[9]||(s[9]=u=>J.value=u),persistent:""},{default:y(()=>[n(Te,{style:{"min-width":"400px"}},{default:y(()=>[n(ee,null,{default:y(()=>s[13]||(s[13]=[o("div",{class:"text-h6"},"YouTube ì˜ìƒ ì¶”ê°€",-1)])),_:1,__:[13]}),n(ee,null,{default:y(()=>[o("div",wl,[o("div",Sl,[n(B,{modelValue:X.value,"onUpdate:modelValue":[s[5]||(s[5]=u=>X.value=u),ce],label:"YouTube ë§í¬",outlined:"",dense:"",placeholder:"https://www.youtube.com/watch?v=..."},{prepend:y(()=>[n(oe,{name:"play_circle"})]),_:1},8,["modelValue"])]),D.value?(w(),M("div",_l,[s[14]||(s[14]=o("div",{class:"text-caption q-mb-xs"},"ë¯¸ë¦¬ë³´ê¸°:",-1)),o("div",$l,[o("iframe",{src:`https://www.youtube.com/embed/${D.value}`,width:"100%",height:"200",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,kl)])])):Y("",!0),o("div",xl,[n(B,{modelValue:Z.value,"onUpdate:modelValue":s[6]||(s[6]=u=>Z.value=u),label:"ì˜ìƒ ì œëª© (ì„ íƒì‚¬í•­)",outlined:"",dense:"",placeholder:"ì˜ìƒì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"},null,8,["modelValue"])]),o("div",Ll,[n(B,{modelValue:N.value,"onUpdate:modelValue":s[7]||(s[7]=u=>N.value=u),modelModifiers:{number:!0},label:"ë„ˆë¹„ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])]),o("div",Cl,[n(B,{modelValue:Q.value,"onUpdate:modelValue":s[8]||(s[8]=u=>Q.value=u),modelModifiers:{number:!0},label:"ë†’ì´ (px)",type:"number",outlined:"",dense:"",placeholder:"ìë™"},null,8,["modelValue"])])])]),_:1}),n(qe,{align:"right"},{default:y(()=>[n(E,{flat:"",label:"ì·¨ì†Œ",onClick:ne}),n(E,{color:"primary",label:"ì‚½ì…",onClick:we,disable:!D.value},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o("div",Tl,[n(B,{modelValue:c.value,"onUpdate:modelValue":[s[10]||(s[10]=u=>c.value=u),le],type:"textarea",placeholder:"Markdown ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...",rows:"15",outlined:"",dense:"",class:"markdown-textarea"},null,8,["modelValue"]),o("div",El,R(c.value.length)+"ì / 10000ì",1)])]))}}),Vl=ge(Ml,[["__scopeId","data-v-3f0ce4c0"]]),Il={class:"q-my-none editor-title"},ql={class:"text-caption text-grey-6 q-mt-xs"},Dl={class:"row items-center justify-between q-mb-sm"},Ul={class:"col"},Al={class:"text-subtitle2 text-weight-medium"},Nl={class:"text-caption text-grey-6"},zl={class:"col-auto"},Rl={class:"text-caption text-grey-6"},Hl={class:"row q-gutter-sm q-mb-md"},Fl={class:"q-mt-md text-right"},Ol=fe({__name:"SlideEditorSection",props:{currentSlideType:{},currentSlideInfo:{},currentLesson:{},currentSlide:{},currentSlideContent:{},isApplying:{type:Boolean}},emits:["slideContentSave","slideContentChange","slidePreview","createMarkdownFile","autoUpdate","updateTOC","addNewSlide","applySlide"],setup(V,{expose:m,emit:$}){const f=V,e=$,S=Ee(),c=p(),I=p(!1),_=(d,k)=>{e("slideContentSave",d,k)},H=d=>{e("slideContentChange",d)},g=d=>{e("slidePreview",d)},T=(d,k)=>{e("createMarkdownFile",d,k)},A=(d,k)=>{e("autoUpdate",d,k)},q=async()=>{I.value=!0;try{e("updateTOC"),S.notify({type:"positive",message:"ëª©ì°¨ ì—…ë°ì´íŠ¸ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤",position:"top",timeout:2e3,icon:"refresh",actions:[{label:"í™•ì¸",color:"white"}]})}catch{S.notify({type:"negative",message:"ëª©ì°¨ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",position:"top",timeout:3e3,icon:"error",actions:[{label:"í™•ì¸",color:"white"}]})}finally{I.value=!1}},F=()=>{e("addNewSlide")},O=()=>{e("applySlide",`${f.currentLesson}-${f.currentSlide}`)};return m({markdownEditor:c}),(d,k)=>(w(),te(Te,{class:"sidebar-card q-mt-md"},{default:y(()=>[n(ee,null,{default:y(()=>[o("h6",Il,R(d.currentSlideType==="chapter"?"Chapter í¸ì§‘ê¸°":"ìŠ¬ë¼ì´ë“œ í¸ì§‘ê¸°"),1),o("div",ql,R(d.currentSlideType==="chapter"?"Chapter ë‚´ìš©ì„ í¸ì§‘í•˜ì„¸ìš”":"ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ í¸ì§‘í•˜ì„¸ìš”"),1)]),_:1}),n(ee,{class:"q-pt-none current-slide-info-section"},{default:y(()=>[o("div",Dl,[o("div",Ul,[o("div",Al,R(d.currentSlideInfo?.lessonTitle),1),o("div",Nl,R(d.currentSlideInfo?.slideTitle),1)]),o("div",zl,[n(Xe,{size:"sm",color:"primary","text-color":"white",label:`${d.currentSlideInfo?.slideIndex}/${d.currentSlideInfo?.totalSlides}`},null,8,["label"])])]),o("div",Rl," ê°•ì˜ "+R(d.currentSlideInfo?.lessonNumber)+"/"+R(d.currentSlideInfo?.totalLessons),1)]),_:1}),n(ee,{class:"q-pt-none"},{default:y(()=>[o("div",Hl,[n(E,{icon:"refresh",label:"ëª©ì°¨ ì—…ë°ì´íŠ¸",onClick:q,loading:I.value,color:"primary"},null,8,["loading"]),n(E,{icon:"add",label:"ìƒˆ ìŠ¬ë¼ì´ë“œ",onClick:F,color:"positive"})]),(w(),te(Vl,{key:`${d.currentLesson}-${d.currentSlide}`,"initial-content":d.currentSlideContent,"slide-id":`${d.currentLesson}-${d.currentSlide}`,onSave:_,onContentChange:H,onPreview:g,onCreateMarkdown:T,onAutoUpdate:A,ref_key:"markdownEditor",ref:c},null,8,["initial-content","slide-id"])),o("div",Fl,[n(E,{color:"accent",icon:"check_circle",label:"ìŠ¬ë¼ì´ë“œ ë°˜ì˜",onClick:O,loading:d.isApplying,disable:d.isApplying},null,8,["loading","disable"])])]),_:1})]),_:1}))}}),jl=ge(Ol,[["__scopeId","data-v-cda91fc6"]]),Pl={class:"main-content"},Wl={key:2,class:"navigation-controls"},Yl={class:"slide-info"},Ql={class:"slide-counter"},Gl={key:3,class:"editor-mode-notice"},Bl=20,Jl=80,Xl=fe({__name:"IndexPage",setup(V){const{userRole:m}=Me(),$=C(()=>m.value==="admin"),f=Ee();He(),Fe();const e=Ge();Me(),Be();const S=p(!1),c=C(()=>e.currentLesson),I=C(()=>e.currentSlide),_=C(()=>e.isPresentationMode);ae(()=>_.value,async t=>{if(console.log(`ğŸ­ í¸ì§‘ê¸° ëª¨ë“œ ë³€ê²½: ${t?"í”„ë ˆì  í…Œì´ì…˜":"í¸ì§‘ê¸°"}`),!t)try{const a=e.currentLesson,i=e.currentSlide;console.log(`ğŸ“‚ í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ: ${a}-${i}`);const l=await e.loadSlideContentForEditing(a,i);console.log("âœ… í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì™„ë£Œ:",{contentLength:l.length,contentPreview:l.substring(0,100)}),g.value=l}catch(a){console.error("âŒ í¸ì§‘ê¸° ëª¨ë“œ ì „í™˜ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹¤íŒ¨:",a);const i=e.currentLesson,l=e.currentSlide;g.value=`# ìŠ¬ë¼ì´ë“œ ${i}-${l}

ìƒˆë¡œìš´ ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”.`}}),ae([()=>e.currentLesson,()=>e.currentSlide],async()=>{await re(e.currentLesson,e.currentSlide),A.value&&setTimeout(()=>{q()},500)});const H=p(),g=p(""),T=C(()=>({lessonTitle:`ê°•ì˜ ${e.currentLesson+1}`,slideTitle:`ìŠ¬ë¼ì´ë“œ ${e.currentSlide+1}`,slideIndex:e.currentSlide+1,totalSlides:e.currentLessonData?.slides||0,lessonNumber:e.currentLesson+1,totalLessons:e.lessons.length})),A=C(()=>`${e.currentLesson}-${e.currentSlide}`.startsWith("1-1")&&e.currentSlide>=13),q=()=>{A.value&&setTimeout(()=>{try{const t=document.querySelector(".slide-iframe");if(t&&t.contentDocument){const a=t.contentDocument.querySelectorAll(".quiz-option");a.forEach(i=>{i.removeEventListener("click",F),i.addEventListener("click",F),i.style.cursor="pointer",i.style.transition="all 0.2s ease"}),b.log(`âœ… Quiz ì´ë²¤íŠ¸ ì£¼ì… ì™„ë£Œ: ${a.length}ê°œ ì˜µì…˜`)}}catch(t){b.warn("âš ï¸ Quiz ì´ë²¤íŠ¸ ì£¼ì… ì‹¤íŒ¨:",t)}},200)},F=t=>{t.preventDefault(),t.stopPropagation();const a=t.target,i=a.getAttribute("data-idx"),l=document.querySelector(".slide-iframe");if(l&&l.contentDocument){const h=l.contentDocument.getElementById("quiz-answer-data"),L=l.contentDocument.querySelectorAll(".quiz-option");h&&(h.style.display="block"),L.forEach(U=>U.classList.remove("selected")),a.classList.add("selected"),b.log(`ğŸ¯ Quiz ì˜µì…˜ í´ë¦­: ${i}ë²ˆ ì„ íƒ, ì •ë‹µ í‘œì‹œ`)}},O=t=>{b.log("ìŠ¬ë¼ì´ë“œ ë‚´ìš© ì €ì¥:",t),g.value=t},d=t=>{b.log("ìŠ¬ë¼ì´ë“œ ë‚´ìš© ë³€ê²½:",t),g.value=t},k=()=>{b.log("ìŠ¬ë¼ì´ë“œ ë¯¸ë¦¬ë³´ê¸°")},J=()=>{console.log("ë§ˆí¬ë‹¤ìš´ íŒŒì¼ ìƒì„±")},X=()=>{console.log("ìë™ ì—…ë°ì´íŠ¸")},D=()=>{console.log("ëª©ì°¨ ì—…ë°ì´íŠ¸")},Z=()=>{b.log("ìƒˆ ìŠ¬ë¼ì´ë“œ ì¶”ê°€")},N=p(!1),Q=async t=>{N.value=!0;try{b.log("ğŸ”„ ìŠ¬ë¼ì´ë“œ ë°˜ì˜ ì‹œì‘:",t);const[a="0",i="0"]=(t||"0-0").split("-"),l=`${a}-${i}`;if(await e.saveSlideToFirebaseStorage(l,g.value)){console.log("âœ… Firebase Storageì— MD íŒŒì¼ ì €ì¥ ì™„ë£Œ:",l),le.value++,f.notify({type:"positive",message:"ìŠ¬ë¼ì´ë“œê°€ Firebase Storageì— ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!",position:"top",timeout:3e3,icon:"cloud_done",actions:[{label:"í™•ì¸",color:"white"}]});const h=new Blob([g.value],{type:"text/markdown"}),L=URL.createObjectURL(h),U=document.createElement("a");U.href=L,U.download=`slide-${l}.md`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(L),console.log("ğŸ“ ë¡œì»¬ ë°±ì—… íŒŒì¼ë„ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.")}else throw new Error("Firebase Storage ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");b.log("ğŸ‰ ìŠ¬ë¼ì´ë“œ ë°˜ì˜ ì™„ë£Œ")}catch(a){b.error("âŒ Firebase Storage ì €ì¥ ì‹¤íŒ¨:",a),f.notify({type:"negative",message:"Firebase Storageì— ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",position:"top",timeout:5e3,icon:"cloud_off",actions:[{label:"í™•ì¸",color:"white"}]})}finally{N.value=!1}},le=p(0);C(()=>e.lessons.reduce((t,a)=>t+a.slides,0));const ye=C(()=>`${e.currentLesson}-${e.currentSlide}`),v=p("lecture"),re=async(t,a)=>{try{const i=await fetch(`/slides/slide-${t}-${a}.md`);if(i.ok){const l=await i.text();if(l.trim().startsWith("@html"))v.value="html";else if(l.includes("@cover")||l.includes("ì»¤ë²„"))v.value="cover";else if(l.includes("@toc")||l.includes("ëª©ì°¨"))v.value="toc";else if(l.includes("@poll")||l.includes("íˆ¬í‘œ"))v.value="poll";else if(l.includes("@stats")||l.includes("í†µê³„"))v.value="stats";else if(l.includes("@interactive")||l.includes("ì¸í„°ë™í‹°ë¸Œ"))v.value="interactive";else if(l.includes("@example")||l.includes("ì˜ˆì‹œ"))v.value="example";else if(l.includes("@challenge")||l.includes("ë„ì „"))v.value="challenge";else if(l.includes("@timeline")||l.includes("íƒ€ì„ë¼ì¸"))v.value="timeline";else if(l.includes("@profile")||l.includes("í”„ë¡œí•„"))v.value="profile";else if(l.includes("@lecture")||l.includes("ê°•ì˜"))v.value="lecture";else if(l.includes("@chapter")||l.includes("ì±•í„°"))v.value="chapter";else{const h=`${t}-${a}`;h==="0-0"?v.value="cover":h==="0-1"?v.value="index":h==="0-2"?v.value="profile":h.endsWith("-0")?v.value="chapter":h.startsWith("2-")&&h!=="2-0"?v.value="example":h.startsWith("3-")&&h!=="3-0"?v.value="challenge":v.value="lecture"}}}catch(i){console.error(`ìŠ¬ë¼ì´ë“œ íƒ€ì… ê°ì§€ ì‹¤íŒ¨: ${t}-${a}`,i);const l=`${t}-${a}`;l==="0-0"?v.value="cover":l==="0-1"?v.value="index":l==="0-2"?v.value="profile":l.endsWith("-0")?v.value="chapter":l.startsWith("2-")&&l!=="2-0"?v.value="example":l.startsWith("3-")&&l!=="3-0"?v.value="challenge":v.value="lecture"}},ue=C(()=>v.value!=="poll"?"":`poll-${e.currentLesson}-${e.currentSlide}`),he=async t=>{try{if(!$.value||!t||!await f.dialog({title:"ê²°ê³¼ ì´ˆê¸°í™”",message:`í•´ë‹¹ íˆ¬í‘œì˜ ë‚˜ì˜ ì„ íƒ(LocalStorage)ê³¼ RTDBì˜ í‘œê¸°ë¥¼ ì‚­ì œí• ê¹Œìš”?
ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,cancel:!0,ok:{label:"ì´ˆê¸°í™”",color:"negative"}}).onOk(()=>!0).onCancel(()=>!1))return;try{Object.keys(localStorage).filter(i=>i.toLowerCase().includes("poll")).forEach(i=>localStorage.removeItem(i))}catch{}const a=W?ke(W):null;if(a){const{getAuth:i}=await xe(async()=>{const{getAuth:h}=await Le(()=>import("./QSpinnerDots-CW_TS37f-DHTnbCLH.js"),__vite__mapDeps([0,1,2])).then(L=>L.i);return{getAuth:h}},me([0,1,2])),l=i(W).currentUser?.uid;l&&await je(Ce(a,`polls/${t}/userVotes/${l}`)).catch(()=>{})}try{document.querySelector(".slide-iframe")?.contentWindow?.postMessage({type:"poll-state",pollId:t,optionId:""},"*")}catch{}f.notify({type:"positive",message:"íˆ¬í‘œ ê²°ê³¼ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.",position:"top"})}catch{f.notify({type:"negative",message:"ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",position:"top"})}},be=C(()=>e.currentLesson===0&&e.currentSlide===0),se=C(()=>{const t=e.lessons.length-1,a=e.lessons[t];return e.currentLesson===t&&e.currentSlide===(a?.slides||0)-1}),ce=p(60),de=p(40),ne=p(!1),we=C(()=>_.value?{}:{flex:`0 0 ${ce.value}%`}),Se=C(()=>_.value?{}:{flex:`0 0 ${de.value}%`}),_e=t=>{ne.value=!0,document.body.style.cursor="col-resize"},r=()=>{ne.value=!1,document.body.style.cursor=""},s=t=>{if(!ne.value)return;const a=document.querySelector(".main-content");if(!a)return;const i=a.getBoundingClientRect(),l=(t.clientX-i.left)/i.width*100;l>Bl&&l<Jl&&(ce.value=l,de.value=100-l)},u=()=>{e.prevSlide()},x=()=>{e.nextSlide()},j=()=>{e.setCurrentLesson(0),e.setCurrentSlide(0)},G=()=>{const t=e.lessons.length-1,a=e.lessons[t];a&&(e.setCurrentLesson(t),e.setCurrentSlide(a.slides-1))},P=t=>{if(_.value)switch(t.key){case"ArrowLeft":t.preventDefault(),u();break;case"ArrowRight":case" ":t.preventDefault(),x();break;case"Home":t.preventDefault(),j();break;case"End":t.preventDefault(),G();break;case"?":t.preventDefault(),S.value=!S.value;break}};return Ne(async()=>{await re(e.currentLesson,e.currentSlide),document.addEventListener("keydown",P),window.addEventListener("mousemove",s),window.addEventListener("mouseup",r);const t=async i=>{try{if(m.value!=="admin")return;const l=i.data||{};if(l&&l.type==="poll-vote"){const h=W?ke(W):null;if(!h)return;const{pollId:L,optionId:U,text:ve}=l;if(!L)return;const{getAuth:pe}=await xe(async()=>{const{getAuth:$e}=await Le(()=>import("./QSpinnerDots-CW_TS37f-DHTnbCLH.js"),__vite__mapDeps([0,1,2])).then(Re=>Re.i);return{getAuth:$e}},me([0,1,2])),K=pe(W).currentUser?.uid;if(!K)return;const z=ve||String(U||"");await Pe(Ce(h,`polls/${L}/userVotes/${K}`),z),b.log("ğŸ—³ï¸ admin saved(userVotes):",{pollId:L,valueToSave:z})}if(l&&l.type==="poll-ready"){const h=W?ke(W):null;if(!h)return;const{pollId:L}=l;if(!L)return;const{getAuth:U}=await xe(async()=>{const{getAuth:z}=await Le(()=>import("./QSpinnerDots-CW_TS37f-DHTnbCLH.js"),__vite__mapDeps([0,1,2])).then($e=>$e.i);return{getAuth:z}},me([0,1,2])),ve=U(W).currentUser?.uid;if(!ve)return;const pe=await We(Ce(h,`polls/${L}/userVotes/${ve}`)),K=document.querySelector(".slide-iframe");if(!K||!K.contentWindow)return;if(pe.exists()){const z=pe.val();typeof z=="string"&&/^\d+$/.test(z)?K.contentWindow.postMessage({type:"poll-state",pollId:L,optionId:String(z)},"*"):z&&K.contentWindow.postMessage({type:"poll-state",pollId:L,text:String(z)},"*")}}}catch(l){b.error("ğŸ—³ï¸ admin poll sync error:",l)}};window.addEventListener("message",t);const a=new Image;a.onload=()=>{console.log("âœ… ë°°ê²½ ì´ë¯¸ì§€ ë¡œë”© ì„±ê³µ:",a.src)},a.onerror=()=>{console.error("âŒ ë°°ê²½ ì´ë¯¸ì§€ ë¡œë”© ì‹¤íŒ¨:",a.src)},a.src="/images/20250806_1231_churchtech.png"}),ae(()=>[e.currentLesson,e.currentSlide],async([t,a])=>{if(t!==void 0&&a!==void 0&&(console.log(`ğŸ”„ IndexPage - ìŠ¤í† ì–´ ë³€ê²½ ê°ì§€: lesson=${t}, slide=${a}`),!_.value))try{console.log(`ğŸ“‚ í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹œì‘: ${t}-${a}`);const i=await e.loadSlideContentForEditing(t,a);console.log("âœ… í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì™„ë£Œ:",{contentLength:i.length,contentPreview:i.substring(0,100)}),g.value=i}catch(i){console.error("âŒ í¸ì§‘ê¸° ëª¨ë“œ - MD íŒŒì¼ ë‚´ìš© ë¡œë“œ ì‹¤íŒ¨:",i),g.value=`# ìŠ¬ë¼ì´ë“œ ${t}-${a}

ìƒˆë¡œìš´ ìŠ¬ë¼ì´ë“œ ë‚´ìš©ì„ ì‘ì„±í•˜ì„¸ìš”.`}},{immediate:!0}),ze(()=>{document.removeEventListener("keydown",P),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",r)}),(t,a)=>(w(),te(Qe,{class:"index-page"},{default:y(()=>[a[5]||(a[5]=o("div",{class:"login-background"},null,-1)),o("div",Pl,[o("div",{class:Oe(["slide-viewer-container",{"with-editor":!_.value}]),style:Ve(we.value)},[(w(),te(rl,{key:le.value,"slide-number":ye.value,"slide-type":v.value},null,8,["slide-number","slide-type"])),$.value&&v.value==="poll"?(w(),te(E,{key:0,class:"poll-admin-fab",round:"",color:"negative",icon:"delete",disable:!ue.value,onClick:a[0]||(a[0]=i=>he(ue.value))},{default:y(()=>[n(Ye,null,{default:y(()=>a[2]||(a[2]=[ie("ê²°ê³¼ ì´ˆê¸°í™”",-1)])),_:1,__:[2]})]),_:1},8,["disable"])):Y("",!0)],6),_.value?Y("",!0):(w(),M("div",{key:0,class:"resizer-bar",onMousedown:_e},null,32)),_.value?Y("",!0):(w(),M("div",{key:1,class:"editor-container",style:Ve(Se.value)},[n(jl,{"current-slide-type":v.value,"current-slide-info":T.value,"current-lesson":c.value,"current-slide":I.value,"current-slide-content":g.value,"is-applying":N.value,onSlideContentSave:O,onSlideContentChange:d,onSlidePreview:k,onCreateMarkdownFile:J,onAutoUpdate:X,onUpdateToc:D,onAddNewSlide:Z,onApplySlide:Q,ref_key:"slideEditorSection",ref:H},null,8,["current-slide-type","current-slide-info","current-lesson","current-slide","current-slide-content","is-applying"])],4)),_.value?(w(),M("div",Wl,[n(E,{disable:be.value,onClick:u,color:"blue","text-color":"white",icon:"chevron_left",round:"",size:"lg",class:"nav-btn"},null,8,["disable"]),o("div",Yl,[o("span",Ql,R(Ie(e).currentLesson)+"-"+R(Ie(e).currentSlide+1),1)]),n(E,{disable:se.value,onClick:x,color:"blue","text-color":"white",icon:"chevron_right",round:"",size:"lg",class:"nav-btn"},null,8,["disable"])])):Y("",!0),_.value?Y("",!0):(w(),M("div",Gl,[n(Ue,{class:"bg-orange text-white",rounded:""},{avatar:y(()=>[n(oe,{name:"edit"})]),default:y(()=>[a[3]||(a[3]=o("div",{class:"text-body2"},[o("strong",null,"í¸ì§‘ê¸° ëª¨ë“œ"),o("br"),ie(" í˜„ì¬ í¸ì§‘ê¸° ëª¨ë“œì…ë‹ˆë‹¤. í”„ë ˆì  í…Œì´ì…˜ ëª¨ë“œë¡œ ì „í™˜í•˜ë ¤ë©´ ìƒë‹¨ì˜ í¸ì§‘ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”. ")],-1))]),_:1,__:[3]})]))]),S.value&&_.value?(w(),te(Ue,{key:0,class:"bg-info text-white keyboard-help",rounded:""},{avatar:y(()=>[n(oe,{name:"keyboard"})]),action:y(()=>[n(E,{flat:"",color:"white",label:"ë‹«ê¸°",onClick:a[1]||(a[1]=i=>S.value=!1)})]),default:y(()=>[a[4]||(a[4]=o("div",{class:"text-body2"},[o("strong",null,"í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤:"),o("br"),ie(" â† â†’ : ì´ì „/ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ | Space : ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ"),o("br"),ie(" Home/End : ì²˜ìŒ/ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œ | F11 : ì „ì²´í™”ë©´"),o("br"),ie(" ESC : í¸ì§‘ê¸° ëª¨ë“œ | ? : ë„ì›€ë§ í† ê¸€ ")],-1))]),_:1,__:[4]})):Y("",!0)]),_:1,__:[5]}))}}),rt=ge(Xl,[["__scopeId","data-v-8399d9a2"]]);export{rt as default};
