const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MainLayout-CbUPrBs9-h46N59WV.js","assets/QDialog-CXn2kBax-C53UdG9D.js","assets/QChip-BJIOjoIv-Djywe0kj.js","assets/_plugin-vue_export-helper-DXafCR7g-cPVpln50.js","assets/QLayout-s6SDzMwt-C7GQ1361.js","assets/use-checkbox-Hdp5Jlzs-BYBvyloL.js","assets/QSeparator-Chi7pIZw-Dfi-b9On.js","assets/GuestLoginDialog-C7xr6EXW-B9BOrQev.js","assets/useGuestAuth-Mxd3jo-z-qhm8zfOu.js","assets/pinia-DRC1X92K-CVhvq81r.js","assets/QBanner-BY0ggvyL-C3yUuPRa.js","assets/marked.esm-mI6KSz_d-CXpNVb3h.js","assets/IndexPage-BLAmILuN-HA-OPItk.js","assets/QPage-B1iJaq8H-BMxUDXKn.js","assets/QSpinnerDots-DmD6LJEW-mqbZkDZd.js","assets/SurveyResults-DhayuQfj-D0iteWpb.js","assets/survey-DXHWirsQ-BJaxGuvV.js","assets/PollResultBar-Bydgm1gR-BKNOXBq3.js","assets/LogoutPage-D1GfaPnm-1CZDGcS4.js","assets/PollResultPage-B3rDVM-7-BRBHzC5g.js","assets/StudentView-ZIAbzNqK-CBiLqkGJ.js","assets/pinia-CU9SUkzn-Dk66cb7x.js","assets/MainLayout-Bwj2wsFm.js","assets/QDialog-Dn9VjDcM.js","assets/QChip-DM6F31S0.js","assets/_plugin-vue_export-helper-DdgHTl4p.js","assets/QLayout-BQ9g_6yu.js","assets/use-checkbox-ClSmRWjY.js","assets/QSeparator-BcYH26Md.js","assets/GuestLoginDialog-6vHhwSmg.js","assets/useGuestAuth-BRpWhMZD.js","assets/pinia-CUn_f_AT.js","assets/QBanner-DKpXtl0l.js","assets/GuestLoginDialog-CO-sD7Pe.css","assets/marked.esm-CTrcEICt.js","assets/MainLayout-iA6VSpwX.css","assets/IndexPage-CFs49cf4.js","assets/QPage-CLbIAi8L.js","assets/QSpinnerDots-55T99jjC.js","assets/IndexPage-BrNRmG7v.css","assets/SurveyResults-DvN0U2_L.js","assets/survey-DsL-eoSy.js","assets/PollResultBar-CeuqJwy4.js","assets/PollResultBar-C3-Zmgie.css","assets/LogoutPage-CtCownZv.js","assets/LogoutPage-DiXRWHA0.css","assets/PollResultPage-BsZ27FdJ.js","assets/PollResultPage-CzQ9mg6m.css","assets/StudentView-EHbgIK-q.js","assets/StudentView-B_NZFY6r.css","assets/pinia-F5TpqEXP.js"])))=>i.map(i=>d[i]);
const Y3=function(){const e=typeof document<"u"&&document.createElement("link").relList;return e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}(),X3=function(t){return"/"+t},gk={},os=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){let o=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=a?.nonce||a?.getAttribute("nonce");r=o(n.map(u=>{if(u=X3(u),u in gk)return;gk[u]=!0;const h=u.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":Y3,h||(p.as="script"),p.crossOrigin="",p.href=u,c&&p.setAttribute("nonce",c),document.head.appendChild(p),h)return new Promise((m,w)=>{p.addEventListener("load",m),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},_a=(t,e=_a,n=e.f||(e.f=["assets/MainLayout-CbUPrBs9.js","assets/QDialog-CXn2kBax.js","assets/QChip-BJIOjoIv.js","assets/_plugin-vue_export-helper-DXafCR7g.js","assets/QLayout-s6SDzMwt.js","assets/use-checkbox-Hdp5Jlzs.js","assets/QSeparator-Chi7pIZw.js","assets/GuestLoginDialog-C7xr6EXW.js","assets/useGuestAuth-Mxd3jo-z.js","assets/pinia-DRC1X92K.js","assets/QBanner-BY0ggvyL.js","assets/GuestLoginDialog-CO-sD7Pe.css","assets/marked.esm-mI6KSz_d.js","assets/MainLayout-iA6VSpwX.css","assets/IndexPage-BLAmILuN.js","assets/QPage-B1iJaq8H.js","assets/QSpinnerDots-DmD6LJEW.js","assets/IndexPage-BrNRmG7v.css","assets/SurveyResults-DhayuQfj.js","assets/survey-DXHWirsQ.js","assets/PollResultBar-Bydgm1gR.js","assets/PollResultBar-C3-Zmgie.css","assets/LogoutPage-D1GfaPnm.js","assets/LogoutPage-DiXRWHA0.css","assets/PollResultPage-B3rDVM-7.js","assets/PollResultPage-CzQ9mg6m.css","assets/StudentView-ZIAbzNqK.js","assets/StudentView-B_NZFY6r.css","assets/pinia-CU9SUkzn.js"]))=>t.map(s=>n[s]),J3=function(){const t=typeof document<"u"&&document.createElement("link").relList;return t&&t.supports&&t.supports("modulepreload")?"modulepreload":"preload"}(),Z3=function(t){return"/"+t},mk={},Eo=function(t,e,n){let s=Promise.resolve();if(e&&e.length>0){let i=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=i(e.map(c=>{if(c=Z3(c),c in mk)return;mk[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":J3,u||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((p,m)=>{d.addEventListener("load",p),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&r(o.reason);return t().catch(r)})};/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function nS(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const At={},ju=[],Ri=()=>{},e$=()=>!1,Iv=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),sS=t=>t.startsWith("onUpdate:"),xn=Object.assign,rS=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},t$=Object.prototype.hasOwnProperty,vt=(t,e)=>t$.call(t,e),Ne=Array.isArray,$u=t=>Sv(t)==="[object Map]",mL=t=>Sv(t)==="[object Set]",je=t=>typeof t=="function",rn=t=>typeof t=="string",Al=t=>typeof t=="symbol",$t=t=>t!==null&&typeof t=="object",_L=t=>($t(t)||je(t))&&je(t.then)&&je(t.catch),yL=Object.prototype.toString,Sv=t=>yL.call(t),n$=t=>Sv(t).slice(8,-1),vL=t=>Sv(t)==="[object Object]",iS=t=>rn(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Vf=nS(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Rv=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},s$=/-(\w)/g,vr=Rv(t=>t.replace(s$,(e,n)=>n?n.toUpperCase():"")),r$=/\B([A-Z])/g,nu=Rv(t=>t.replace(r$,"-$1").toLowerCase()),Av=Rv(t=>t.charAt(0).toUpperCase()+t.slice(1)),ib=Rv(t=>t?`on${Av(t)}`:""),La=(t,e)=>!Object.is(t,e),ob=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},LT=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},i$=t=>{const e=parseFloat(t);return isNaN(e)?t:e},o$=t=>{const e=rn(t)?Number(t):NaN;return isNaN(e)?t:e};let _k;const kv=()=>_k||(_k=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Pv(t){if(Ne(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=rn(s)?u$(s):Pv(s);if(r)for(const i in r)e[i]=r[i]}return e}else if(rn(t)||$t(t))return t}const a$=/;(?![^(]*\))/g,l$=/:([^]+)/,c$=/\/\*[^]*?\*\//g;function u$(t){const e={};return t.replace(c$,"").split(a$).forEach(n=>{if(n){const s=n.split(l$);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Nv(t){let e="";if(rn(t))e=t;else if(Ne(t))for(let n=0;n<t.length;n++){const s=Nv(t[n]);s&&(e+=s+" ")}else if($t(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const h$="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",d$=nS(h$);function wL(t){return!!t||t===""}const EL=t=>!!(t&&t.__v_isRef===!0),bL=t=>rn(t)?t:t==null?"":Ne(t)||$t(t)&&(t.toString===yL||!je(t.toString))?EL(t)?bL(t.value):JSON.stringify(t,TL,2):String(t),TL=(t,e)=>EL(e)?TL(t,e.value):$u(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r],i)=>(n[ab(s,i)+" =>"]=r,n),{})}:mL(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>ab(n))}:Al(e)?ab(e):$t(e)&&!Ne(e)&&!vL(e)?String(e):e,ab=(t,e="")=>{var n;return Al(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ns;class CL{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ns,!e&&ns&&(this.index=(ns.scopes||(ns.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=ns;try{return ns=this,e()}finally{ns=n}}}on(){++this._on===1&&(this.prevScope=ns,ns=this)}off(){this._on>0&&--this._on===0&&(ns=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function f$(t){return new CL(t)}function IL(){return ns}function p$(t,e=!1){ns&&ns.cleanups.push(t)}let xt;const lb=new WeakSet;class SL{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ns&&ns.active&&ns.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,lb.has(this)&&(lb.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||AL(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,yk(this),kL(this);const e=xt,n=Gr;xt=this,Gr=!0;try{return this.fn()}finally{PL(this),xt=e,Gr=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)lS(e);this.deps=this.depsTail=void 0,yk(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?lb.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){MT(this)&&this.run()}get dirty(){return MT(this)}}let RL=0,Ff,Uf;function AL(t,e=!1){if(t.flags|=8,e){t.next=Uf,Uf=t;return}t.next=Ff,Ff=t}function oS(){RL++}function aS(){if(--RL>0)return;if(Uf){let e=Uf;for(Uf=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Ff;){let e=Ff;for(Ff=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function kL(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function PL(t){let e,n=t.depsTail,s=n;for(;s;){const r=s.prevDep;s.version===-1?(s===n&&(n=r),lS(s),g$(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}t.deps=e,t.depsTail=n}function MT(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(NL(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function NL(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===kp)||(t.globalVersion=kp,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!MT(t))))return;t.flags|=2;const e=t.dep,n=xt,s=Gr;xt=t,Gr=!0;try{kL(t);const r=t.fn(t._value);(e.version===0||La(r,t._value))&&(t.flags|=128,t._value=r,e.version++)}catch(r){throw e.version++,r}finally{xt=n,Gr=s,PL(t),t.flags&=-3}}function lS(t,e=!1){const{dep:n,prevSub:s,nextSub:r}=t;if(s&&(s.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)lS(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function g$(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let Gr=!0;const xL=[];function qo(){xL.push(Gr),Gr=!1}function Bo(){const t=xL.pop();Gr=t===void 0?!0:t}function yk(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=xt;xt=void 0;try{e()}finally{xt=n}}}let kp=0;class m${constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class cS{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!xt||!Gr||xt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==xt)n=this.activeLink=new m$(xt,this),xt.deps?(n.prevDep=xt.depsTail,xt.depsTail.nextDep=n,xt.depsTail=n):xt.deps=xt.depsTail=n,DL(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=xt.depsTail,n.nextDep=void 0,xt.depsTail.nextDep=n,xt.depsTail=n,xt.deps===n&&(xt.deps=s)}return n}trigger(e){this.version++,kp++,this.notify(e)}notify(e){oS();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{aS()}}}function DL(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)DL(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const L_=new WeakMap,Cc=Symbol(""),VT=Symbol(""),Pp=Symbol("");function as(t,e,n){if(Gr&&xt){let s=L_.get(t);s||L_.set(t,s=new Map);let r=s.get(n);r||(s.set(n,r=new cS),r.map=s,r.key=n),r.track()}}function Co(t,e,n,s,r,i){const o=L_.get(t);if(!o){kp++;return}const a=c=>{c&&c.trigger()};if(oS(),e==="clear")o.forEach(a);else{const c=Ne(t),u=c&&iS(n);if(c&&n==="length"){const h=Number(s);o.forEach((d,p)=>{(p==="length"||p===Pp||!Al(p)&&p>=h)&&a(d)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),u&&a(o.get(Pp)),e){case"add":c?u&&a(o.get("length")):(a(o.get(Cc)),$u(t)&&a(o.get(VT)));break;case"delete":c||(a(o.get(Cc)),$u(t)&&a(o.get(VT)));break;case"set":$u(t)&&a(o.get(Cc));break}}aS()}function _$(t,e){const n=L_.get(t);return n&&n.get(e)}function du(t){const e=lt(t);return e===t?e:(as(e,"iterate",Pp),pr(t)?e:e.map(Wn))}function xv(t){return as(t=lt(t),"iterate",Pp),t}const y$={__proto__:null,[Symbol.iterator](){return cb(this,Symbol.iterator,Wn)},concat(...t){return du(this).concat(...t.map(e=>Ne(e)?du(e):e))},entries(){return cb(this,"entries",t=>(t[1]=Wn(t[1]),t))},every(t,e){return go(this,"every",t,e,void 0,arguments)},filter(t,e){return go(this,"filter",t,e,n=>n.map(Wn),arguments)},find(t,e){return go(this,"find",t,e,Wn,arguments)},findIndex(t,e){return go(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return go(this,"findLast",t,e,Wn,arguments)},findLastIndex(t,e){return go(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return go(this,"forEach",t,e,void 0,arguments)},includes(...t){return ub(this,"includes",t)},indexOf(...t){return ub(this,"indexOf",t)},join(t){return du(this).join(t)},lastIndexOf(...t){return ub(this,"lastIndexOf",t)},map(t,e){return go(this,"map",t,e,void 0,arguments)},pop(){return ef(this,"pop")},push(...t){return ef(this,"push",t)},reduce(t,...e){return vk(this,"reduce",t,e)},reduceRight(t,...e){return vk(this,"reduceRight",t,e)},shift(){return ef(this,"shift")},some(t,e){return go(this,"some",t,e,void 0,arguments)},splice(...t){return ef(this,"splice",t)},toReversed(){return du(this).toReversed()},toSorted(t){return du(this).toSorted(t)},toSpliced(...t){return du(this).toSpliced(...t)},unshift(...t){return ef(this,"unshift",t)},values(){return cb(this,"values",Wn)}};function cb(t,e,n){const s=xv(t),r=s[e]();return s!==t&&!pr(t)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.value&&(i.value=n(i.value)),i}),r}const v$=Array.prototype;function go(t,e,n,s,r,i){const o=xv(t),a=o!==t&&!pr(t),c=o[e];if(c!==v$[e]){const d=c.apply(t,i);return a?Wn(d):d}let u=n;o!==t&&(a?u=function(d,p){return n.call(this,Wn(d),p,t)}:n.length>2&&(u=function(d,p){return n.call(this,d,p,t)}));const h=c.call(o,u,s);return a&&r?r(h):h}function vk(t,e,n,s){const r=xv(t);let i=n;return r!==t&&(pr(t)?n.length>3&&(i=function(o,a,c){return n.call(this,o,a,c,t)}):i=function(o,a,c){return n.call(this,o,Wn(a),c,t)}),r[e](i,...s)}function ub(t,e,n){const s=lt(t);as(s,"iterate",Pp);const r=s[e](...n);return(r===-1||r===!1)&&fS(n[0])?(n[0]=lt(n[0]),s[e](...n)):r}function ef(t,e,n=[]){qo(),oS();const s=lt(t)[e].apply(t,n);return aS(),Bo(),s}const w$=nS("__proto__,__v_isRef,__isVue"),OL=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Al));function E$(t){Al(t)||(t=String(t));const e=lt(this);return as(e,"has",t),e.hasOwnProperty(t)}class LL{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return i;if(n==="__v_raw")return s===(r?i?N$:UL:i?FL:VL).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=Ne(e);if(!r){let c;if(o&&(c=y$[n]))return c;if(n==="hasOwnProperty")return E$}const a=Reflect.get(e,n,qn(e)?e:s);return(Al(n)?OL.has(n):w$(n))||(r||as(e,"get",n),i)?a:qn(a)?o&&iS(n)?a:a.value:$t(a)?r?qL(a):su(a):a}}class ML extends LL{constructor(e=!1){super(!1,e)}set(e,n,s,r){let i=e[n];if(!this._isShallow){const c=Ja(i);if(!pr(s)&&!Ja(s)&&(i=lt(i),s=lt(s)),!Ne(e)&&qn(i)&&!qn(s))return c?!1:(i.value=s,!0)}const o=Ne(e)&&iS(n)?Number(n)<e.length:vt(e,n),a=Reflect.set(e,n,s,qn(e)?e:r);return e===lt(r)&&(o?La(s,i)&&Co(e,"set",n,s):Co(e,"add",n,s)),a}deleteProperty(e,n){const s=vt(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&s&&Co(e,"delete",n,void 0),r}has(e,n){const s=Reflect.has(e,n);return(!Al(n)||!OL.has(n))&&as(e,"has",n),s}ownKeys(e){return as(e,"iterate",Ne(e)?"length":Cc),Reflect.ownKeys(e)}}class b$ extends LL{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const T$=new ML,C$=new b$,I$=new ML(!0),FT=t=>t,wm=t=>Reflect.getPrototypeOf(t);function S$(t,e,n){return function(...s){const r=this.__v_raw,i=lt(r),o=$u(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=r[t](...s),h=n?FT:e?M_:Wn;return!e&&as(i,"iterate",c?VT:Cc),{next(){const{value:d,done:p}=u.next();return p?{value:d,done:p}:{value:a?[h(d[0]),h(d[1])]:h(d),done:p}},[Symbol.iterator](){return this}}}}function Em(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function R$(t,e){const n={get(s){const r=this.__v_raw,i=lt(r),o=lt(s);t||(La(s,o)&&as(i,"get",s),as(i,"get",o));const{has:a}=wm(i),c=e?FT:t?M_:Wn;if(a.call(i,s))return c(r.get(s));if(a.call(i,o))return c(r.get(o));r!==i&&r.get(s)},get size(){const s=this.__v_raw;return!t&&as(lt(s),"iterate",Cc),Reflect.get(s,"size",s)},has(s){const r=this.__v_raw,i=lt(r),o=lt(s);return t||(La(s,o)&&as(i,"has",s),as(i,"has",o)),s===o?r.has(s):r.has(s)||r.has(o)},forEach(s,r){const i=this,o=i.__v_raw,a=lt(o),c=e?FT:t?M_:Wn;return!t&&as(a,"iterate",Cc),o.forEach((u,h)=>s.call(r,c(u),c(h),i))}};return xn(n,t?{add:Em("add"),set:Em("set"),delete:Em("delete"),clear:Em("clear")}:{add(s){!e&&!pr(s)&&!Ja(s)&&(s=lt(s));const r=lt(this);return wm(r).has.call(r,s)||(r.add(s),Co(r,"add",s,s)),this},set(s,r){!e&&!pr(r)&&!Ja(r)&&(r=lt(r));const i=lt(this),{has:o,get:a}=wm(i);let c=o.call(i,s);c||(s=lt(s),c=o.call(i,s));const u=a.call(i,s);return i.set(s,r),c?La(r,u)&&Co(i,"set",s,r):Co(i,"add",s,r),this},delete(s){const r=lt(this),{has:i,get:o}=wm(r);let a=i.call(r,s);a||(s=lt(s),a=i.call(r,s)),o&&o.call(r,s);const c=r.delete(s);return a&&Co(r,"delete",s,void 0),c},clear(){const s=lt(this),r=s.size!==0,i=s.clear();return r&&Co(s,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=S$(s,t,e)}),n}function uS(t,e){const n=R$(t,e);return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(vt(n,r)&&r in s?n:s,r,i)}const A$={get:uS(!1,!1)},k$={get:uS(!1,!0)},P$={get:uS(!0,!1)},VL=new WeakMap,FL=new WeakMap,UL=new WeakMap,N$=new WeakMap;function x$(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function D$(t){return t.__v_skip||!Object.isExtensible(t)?0:x$(n$(t))}function su(t){return Ja(t)?t:dS(t,!1,T$,A$,VL)}function hS(t){return dS(t,!1,I$,k$,FL)}function qL(t){return dS(t,!0,C$,P$,UL)}function dS(t,e,n,s,r){if(!$t(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=D$(t);if(i===0)return t;const o=r.get(t);if(o)return o;const a=new Proxy(t,i===2?s:n);return r.set(t,a),a}function Ic(t){return Ja(t)?Ic(t.__v_raw):!!(t&&t.__v_isReactive)}function Ja(t){return!!(t&&t.__v_isReadonly)}function pr(t){return!!(t&&t.__v_isShallow)}function fS(t){return t?!!t.__v_raw:!1}function lt(t){const e=t&&t.__v_raw;return e?lt(e):t}function qh(t){return!vt(t,"__v_skip")&&Object.isExtensible(t)&&LT(t,"__v_skip",!0),t}const Wn=t=>$t(t)?su(t):t,M_=t=>$t(t)?qL(t):t;function qn(t){return t?t.__v_isRef===!0:!1}function jo(t){return BL(t,!1)}function O$(t){return BL(t,!0)}function BL(t,e){return qn(t)?t:new L$(t,e)}class L${constructor(e,n){this.dep=new cS,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:lt(e),this._value=n?e:Wn(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||pr(e)||Ja(e);e=s?e:lt(e),La(e,n)&&(this._rawValue=e,this._value=s?e:Wn(e),this.dep.trigger())}}function Ma(t){return qn(t)?t.value:t}const M$={get:(t,e,n)=>e==="__v_raw"?t:Ma(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return qn(r)&&!qn(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function jL(t){return Ic(t)?t:new Proxy(t,M$)}function V$(t){const e=Ne(t)?new Array(t.length):{};for(const n in t)e[n]=U$(t,n);return e}class F${constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return _$(lt(this._object),this._key)}}function U$(t,e,n){const s=t[e];return qn(s)?s:new F$(t,e,n)}class q${constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new cS(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=kp-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&xt!==this)return AL(this,!0),!0}get value(){const e=this.dep.track();return NL(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function B$(t,e,n=!1){let s,r;return je(t)?s=t:(s=t.get,r=t.set),new q$(s,r,n)}const bm={},V_=new WeakMap;let ic;function j$(t,e=!1,n=ic){if(n){let s=V_.get(n);s||V_.set(n,s=[]),s.push(t)}}function $$(t,e,n=At){const{immediate:s,deep:r,once:i,scheduler:o,augmentJob:a,call:c}=n,u=q=>r?q:pr(q)||r===!1||r===0?Io(q,1):Io(q);let h,d,p,m,w=!1,R=!1;if(qn(t)?(d=()=>t.value,w=pr(t)):Ic(t)?(d=()=>u(t),w=!0):Ne(t)?(R=!0,w=t.some(q=>Ic(q)||pr(q)),d=()=>t.map(q=>{if(qn(q))return q.value;if(Ic(q))return u(q);if(je(q))return c?c(q,2):q()})):je(t)?e?d=c?()=>c(t,2):t:d=()=>{if(p){qo();try{p()}finally{Bo()}}const q=ic;ic=h;try{return c?c(t,3,[m]):t(m)}finally{ic=q}}:d=Ri,e&&r){const q=d,H=r===!0?1/0:r;d=()=>Io(q(),H)}const k=IL(),O=()=>{h.stop(),k&&k.active&&rS(k.effects,h)};if(i&&e){const q=e;e=(...H)=>{q(...H),O()}}let M=R?new Array(t.length).fill(bm):bm;const F=q=>{if(!(!(h.flags&1)||!h.dirty&&!q))if(e){const H=h.run();if(r||w||(R?H.some((J,I)=>La(J,M[I])):La(H,M))){p&&p();const J=ic;ic=h;try{const I=[H,M===bm?void 0:R&&M[0]===bm?[]:M,m];M=H,c?c(e,3,I):e(...I)}finally{ic=J}}}else h.run()};return a&&a(F),h=new SL(d),h.scheduler=o?()=>o(F,!1):F,m=q=>j$(q,!1,h),p=h.onStop=()=>{const q=V_.get(h);if(q){if(c)c(q,4);else for(const H of q)H();V_.delete(h)}},e?s?F(!0):M=h.run():o?o(F.bind(null,!0),!0):h.run(),O.pause=h.pause.bind(h),O.resume=h.resume.bind(h),O.stop=O,O}function Io(t,e=1/0,n){if(e<=0||!$t(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,qn(t))Io(t.value,e,n);else if(Ne(t))for(let s=0;s<t.length;s++)Io(t[s],e,n);else if(mL(t)||$u(t))t.forEach(s=>{Io(s,e,n)});else if(vL(t)){for(const s in t)Io(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Io(t[s],e,n)}return t}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function xg(t,e,n,s){try{return s?t(...s):t()}catch(r){Dv(r,e,n)}}function oi(t,e,n,s){if(je(t)){const r=xg(t,e,n,s);return r&&_L(r)&&r.catch(i=>{Dv(i,e,n)}),r}if(Ne(t)){const r=[];for(let i=0;i<t.length;i++)r.push(oi(t[i],e,n,s));return r}}function Dv(t,e,n,s=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||At;if(e){let a=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](t,c,u)===!1)return}a=a.parent}if(i){qo(),xg(i,null,10,[t,c,u]),Bo();return}}z$(t,n,r,s,o)}function z$(t,e,n,s=!0,r=!1){if(r)throw t;console.error(t)}const ks=[];let _i=-1;const zu=[];let ya=null,Iu=0;const $L=Promise.resolve();let F_=null;function pS(t){const e=F_||$L;return t?e.then(this?t.bind(this):t):e}function H$(t){let e=_i+1,n=ks.length;for(;e<n;){const s=e+n>>>1,r=ks[s],i=Np(r);i<t||i===t&&r.flags&2?e=s+1:n=s}return e}function gS(t){if(!(t.flags&1)){const e=Np(t),n=ks[ks.length-1];!n||!(t.flags&2)&&e>=Np(n)?ks.push(t):ks.splice(H$(e),0,t),t.flags|=1,zL()}}function zL(){F_||(F_=$L.then(WL))}function W$(t){Ne(t)?zu.push(...t):ya&&t.id===-1?ya.splice(Iu+1,0,t):t.flags&1||(zu.push(t),t.flags|=1),zL()}function wk(t,e,n=_i+1){for(;n<ks.length;n++){const s=ks[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;ks.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function HL(t){if(zu.length){const e=[...new Set(zu)].sort((n,s)=>Np(n)-Np(s));if(zu.length=0,ya){ya.push(...e);return}for(ya=e,Iu=0;Iu<ya.length;Iu++){const n=ya[Iu];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}ya=null,Iu=0}}const Np=t=>t.id==null?t.flags&2?-1:1/0:t.id;function WL(t){try{for(_i=0;_i<ks.length;_i++){const e=ks[_i];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),xg(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;_i<ks.length;_i++){const e=ks[_i];e&&(e.flags&=-2)}_i=-1,ks.length=0,HL(),F_=null,(ks.length||zu.length)&&WL()}}let tr=null,KL=null;function U_(t){const e=tr;return tr=t,KL=t&&t.type.__scopeId||null,e}function GL(t,e=tr,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&Ok(-1);const i=U_(e);let o;try{o=t(...r)}finally{U_(i),s._d&&Ok(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function mS(t,e){if(tr===null)return t;const n=Bv(tr),s=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,a,c=At]=e[r];i&&(je(i)&&(i={mounted:i,updated:i}),i.deep&&Io(o),s.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:c}))}return t}function Xl(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let c=a.dir[s];c&&(qo(),oi(c,n,8,[t.el,a,t,e]),Bo())}}const QL=Symbol("_vte"),YL=t=>t.__isTeleport,qf=t=>t&&(t.disabled||t.disabled===""),Ek=t=>t&&(t.defer||t.defer===""),bk=t=>typeof SVGElement<"u"&&t instanceof SVGElement,Tk=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,UT=(t,e)=>{const n=t&&t.to;return rn(n)?e?e(n):null:n},XL={name:"Teleport",__isTeleport:!0,process(t,e,n,s,r,i,o,a,c,u){const{mc:h,pc:d,pbc:p,o:{insert:m,querySelector:w,createText:R,createComment:k}}=u,O=qf(e.props);let{shapeFlag:M,children:F,dynamicChildren:q}=e;if(t==null){const H=e.el=R(""),J=e.anchor=R("");m(H,n,s),m(J,n,s);const I=(y,C)=>{M&16&&(r&&r.isCE&&(r.ce._teleportTarget=y),h(F,y,C,r,i,o,a,c))},v=()=>{const y=e.target=UT(e.props,w),C=JL(y,e,R,m);y&&(o!=="svg"&&bk(y)?o="svg":o!=="mathml"&&Tk(y)&&(o="mathml"),O||(I(y,C),Jm(e,!1)))};O&&(I(n,J),Jm(e,!0)),Ek(e.props)?(e.el.__isMounted=!1,Rs(()=>{v(),delete e.el.__isMounted},i)):v()}else{if(Ek(e.props)&&t.el.__isMounted===!1){Rs(()=>{XL.process(t,e,n,s,r,i,o,a,c,u)},i);return}e.el=t.el,e.targetStart=t.targetStart;const H=e.anchor=t.anchor,J=e.target=t.target,I=e.targetAnchor=t.targetAnchor,v=qf(t.props),y=v?n:J,C=v?H:I;if(o==="svg"||bk(J)?o="svg":(o==="mathml"||Tk(J))&&(o="mathml"),q?(p(t.dynamicChildren,q,y,r,i,o,a),ES(t,e,!0)):c||d(t,e,y,C,r,i,o,a,!1),O)v?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Tm(e,n,H,u,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const S=e.target=UT(e.props,w);S&&Tm(e,S,null,u,0)}else v&&Tm(e,J,I,u,1);Jm(e,O)}},remove(t,e,n,{um:s,o:{remove:r}},i){const{shapeFlag:o,children:a,anchor:c,targetStart:u,targetAnchor:h,target:d,props:p}=t;if(d&&(r(u),r(h)),i&&r(c),o&16){const m=i||!qf(p);for(let w=0;w<a.length;w++){const R=a[w];s(R,e,n,m,!!R.dynamicChildren)}}},move:Tm,hydrate:K$};function Tm(t,e,n,{o:{insert:s},m:r},i=2){i===0&&s(t.targetAnchor,e,n);const{el:o,anchor:a,shapeFlag:c,children:u,props:h}=t,d=i===2;if(d&&s(o,e,n),(!d||qf(h))&&c&16)for(let p=0;p<u.length;p++)r(u[p],e,n,2);d&&s(a,e,n)}function K$(t,e,n,s,r,i,{o:{nextSibling:o,parentNode:a,querySelector:c,insert:u,createText:h}},d){const p=e.target=UT(e.props,c);if(p){const m=qf(e.props),w=p._lpa||p.firstChild;if(e.shapeFlag&16)if(m)e.anchor=d(o(t),e,a(t),n,s,r,i),e.targetStart=w,e.targetAnchor=w&&o(w);else{e.anchor=o(t);let R=w;for(;R;){if(R&&R.nodeType===8){if(R.data==="teleport start anchor")e.targetStart=R;else if(R.data==="teleport anchor"){e.targetAnchor=R,p._lpa=e.targetAnchor&&o(e.targetAnchor);break}}R=o(R)}e.targetAnchor||JL(p,e,h,u),d(w&&o(w),e,p,n,s,r,i)}Jm(e,m)}return e.anchor&&o(e.anchor)}const G$=XL;function Jm(t,e){const n=t.ctx;if(n&&n.ut){let s,r;for(e?(s=t.el,r=t.anchor):(s=t.targetStart,r=t.targetAnchor);s&&s!==r;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function JL(t,e,n,s){const r=e.targetStart=n(""),i=e.targetAnchor=n("");return r[QL]=i,t&&(s(r,t),s(i,t)),i}const va=Symbol("_leaveCb"),Cm=Symbol("_enterCb");function ZL(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Mv(()=>{t.isMounted=!0}),Vv(()=>{t.isUnmounting=!0}),t}const ar=[Function,Array],eM={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ar,onEnter:ar,onAfterEnter:ar,onEnterCancelled:ar,onBeforeLeave:ar,onLeave:ar,onAfterLeave:ar,onLeaveCancelled:ar,onBeforeAppear:ar,onAppear:ar,onAfterAppear:ar,onAppearCancelled:ar},tM=t=>{const e=t.subTree;return e.component?tM(e.component):e},Q$={name:"BaseTransition",props:eM,setup(t,{slots:e}){const n=kl(),s=ZL();return()=>{const r=e.default&&_S(e.default(),!0);if(!r||!r.length)return;const i=nM(r),o=lt(t),{mode:a}=o;if(s.isLeaving)return hb(i);const c=Ck(i);if(!c)return hb(i);let u=xp(c,o,s,n,d=>u=d);c.type!==Ns&&Mc(c,u);let h=n.subTree&&Ck(n.subTree);if(h&&h.type!==Ns&&!dc(c,h)&&tM(n).type!==Ns){let d=xp(h,o,s,n);if(Mc(h,d),a==="out-in"&&c.type!==Ns)return s.isLeaving=!0,d.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete d.afterLeave,h=void 0},hb(i);a==="in-out"&&c.type!==Ns?d.delayLeave=(p,m,w)=>{const R=sM(s,h);R[String(h.key)]=h,p[va]=()=>{m(),p[va]=void 0,delete u.delayedLeave,h=void 0},u.delayedLeave=()=>{w(),delete u.delayedLeave,h=void 0}}:h=void 0}else h&&(h=void 0);return i}}};function nM(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==Ns){e=n;break}}return e}const Y$=Q$;function sM(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function xp(t,e,n,s,r){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:h,onEnterCancelled:d,onBeforeLeave:p,onLeave:m,onAfterLeave:w,onLeaveCancelled:R,onBeforeAppear:k,onAppear:O,onAfterAppear:M,onAppearCancelled:F}=e,q=String(t.key),H=sM(n,t),J=(y,C)=>{y&&oi(y,s,9,C)},I=(y,C)=>{const S=C[1];J(y,C),Ne(y)?y.every(T=>T.length<=1)&&S():y.length<=1&&S()},v={mode:o,persisted:a,beforeEnter(y){let C=c;if(!n.isMounted)if(i)C=k||c;else return;y[va]&&y[va](!0);const S=H[q];S&&dc(t,S)&&S.el[va]&&S.el[va](),J(C,[y])},enter(y){let C=u,S=h,T=d;if(!n.isMounted)if(i)C=O||u,S=M||h,T=F||d;else return;let E=!1;const K=y[Cm]=oe=>{E||(E=!0,oe?J(T,[y]):J(S,[y]),v.delayedLeave&&v.delayedLeave(),y[Cm]=void 0)};C?I(C,[y,K]):K()},leave(y,C){const S=String(t.key);if(y[Cm]&&y[Cm](!0),n.isUnmounting)return C();J(p,[y]);let T=!1;const E=y[va]=K=>{T||(T=!0,C(),K?J(R,[y]):J(w,[y]),y[va]=void 0,H[S]===t&&delete H[S])};H[S]=t,m?I(m,[y,E]):E()},clone(y){const C=xp(y,e,n,s,r);return r&&r(C),C}};return v}function hb(t){if(Ov(t))return t=Za(t),t.children=null,t}function Ck(t){if(!Ov(t))return YL(t.type)&&t.children?nM(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&je(n.default))return n.default()}}function Mc(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Mc(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function _S(t,e=!1,n){let s=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===hr?(o.patchFlag&128&&r++,s=s.concat(_S(o.children,e,a))):(e||o.type!==Ns)&&s.push(a!=null?Za(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function Dg(t,e){return je(t)?xn({name:t.name},e,{setup:t}):t}function rM(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Bf(t,e,n,s,r=!1){if(Ne(t)){t.forEach((w,R)=>Bf(w,e&&(Ne(e)?e[R]:e),n,s,r));return}if(jf(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Bf(t,e,n,s.component.subTree);return}const i=s.shapeFlag&4?Bv(s.component):s.el,o=r?null:i,{i:a,r:c}=t,u=e&&e.r,h=a.refs===At?a.refs={}:a.refs,d=a.setupState,p=lt(d),m=d===At?()=>!1:w=>vt(p,w);if(u!=null&&u!==c&&(rn(u)?(h[u]=null,m(u)&&(d[u]=null)):qn(u)&&(u.value=null)),je(c))xg(c,a,12,[o,h]);else{const w=rn(c),R=qn(c);if(w||R){const k=()=>{if(t.f){const O=w?m(c)?d[c]:h[c]:c.value;r?Ne(O)&&rS(O,i):Ne(O)?O.includes(i)||O.push(i):w?(h[c]=[i],m(c)&&(d[c]=h[c])):(c.value=[i],t.k&&(h[t.k]=c.value))}else w?(h[c]=o,m(c)&&(d[c]=o)):R&&(c.value=o,t.k&&(h[t.k]=o))};o?(k.id=-1,Rs(k,n)):k()}}}kv().requestIdleCallback;kv().cancelIdleCallback;const jf=t=>!!t.type.__asyncLoader,Ov=t=>t.type.__isKeepAlive;function iM(t,e){aM(t,"a",e)}function oM(t,e){aM(t,"da",e)}function aM(t,e,n=fs){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Lv(e,s,n),n){let r=n.parent;for(;r&&r.parent;)Ov(r.parent.vnode)&&X$(s,e,n,r),r=r.parent}}function X$(t,e,n,s){const r=Lv(e,t,s,!0);Fv(()=>{rS(s[e],r)},n)}function Lv(t,e,n=fs,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{qo();const a=Og(n),c=oi(e,n,t,o);return a(),Bo(),c});return s?r.unshift(i):r.push(i),i}}const sa=t=>(e,n=fs)=>{(!Op||t==="sp")&&Lv(t,(...s)=>e(...s),n)},lM=sa("bm"),Mv=sa("m"),cM=sa("bu"),yS=sa("u"),Vv=sa("bum"),Fv=sa("um"),J$=sa("sp"),Z$=sa("rtg"),e5=sa("rtc");function t5(t,e=fs){Lv("ec",t,e)}const n5="components";function uM(t,e){return r5(n5,t,!0,e)||t}const s5=Symbol.for("v-ndc");function r5(t,e,n=!0,s=!1){const r=tr||fs;if(r){const i=r.type;{const a=K5(i,!1);if(a&&(a===e||a===vr(e)||a===Av(vr(e))))return i}const o=Ik(r[t]||i[t],e)||Ik(r.appContext[t],e);return!o&&s?i:o}}function Ik(t,e){return t&&(t[e]||t[vr(e)]||t[Av(vr(e))])}function i5(t,e,n,s){let r;const i=n,o=Ne(t);if(o||rn(t)){const a=o&&Ic(t);let c=!1,u=!1;a&&(c=!pr(t),u=Ja(t),t=xv(t)),r=new Array(t.length);for(let h=0,d=t.length;h<d;h++)r[h]=e(c?u?M_(Wn(t[h])):Wn(t[h]):t[h],h,void 0,i)}else if(typeof t=="number"){r=new Array(t);for(let a=0;a<t;a++)r[a]=e(a+1,a,void 0,i)}else if($t(t))if(t[Symbol.iterator])r=Array.from(t,(a,c)=>e(a,c,void 0,i));else{const a=Object.keys(t);r=new Array(a.length);for(let c=0,u=a.length;c<u;c++){const h=a[c];r[c]=e(t[h],h,c,i)}}else r=[];return r}const qT=t=>t?xM(t)?Bv(t):qT(t.parent):null,$f=xn(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>qT(t.parent),$root:t=>qT(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>dM(t),$forceUpdate:t=>t.f||(t.f=()=>{gS(t.update)}),$nextTick:t=>t.n||(t.n=pS.bind(t.proxy)),$watch:t=>R5.bind(t)}),db=(t,e)=>t!==At&&!t.__isScriptSetup&&vt(t,e),o5={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:c}=t;let u;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(db(s,e))return o[e]=1,s[e];if(r!==At&&vt(r,e))return o[e]=2,r[e];if((u=t.propsOptions[0])&&vt(u,e))return o[e]=3,i[e];if(n!==At&&vt(n,e))return o[e]=4,n[e];BT&&(o[e]=0)}}const h=$f[e];let d,p;if(h)return e==="$attrs"&&as(t.attrs,"get",""),h(t);if((d=a.__cssModules)&&(d=d[e]))return d;if(n!==At&&vt(n,e))return o[e]=4,n[e];if(p=c.config.globalProperties,vt(p,e))return p[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return db(r,e)?(r[e]=n,!0):s!==At&&vt(s,e)?(s[e]=n,!0):vt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!n[o]||t!==At&&vt(t,o)||db(e,o)||(a=i[0])&&vt(a,o)||vt(s,o)||vt($f,o)||vt(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:vt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Sk(t){return Ne(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let BT=!0;function a5(t){const e=dM(t),n=t.proxy,s=t.ctx;BT=!1,e.beforeCreate&&Rk(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:c,inject:u,created:h,beforeMount:d,mounted:p,beforeUpdate:m,updated:w,activated:R,deactivated:k,beforeDestroy:O,beforeUnmount:M,destroyed:F,unmounted:q,render:H,renderTracked:J,renderTriggered:I,errorCaptured:v,serverPrefetch:y,expose:C,inheritAttrs:S,components:T,directives:E,filters:K}=e;if(u&&l5(u,s,null),o)for(const ge in o){const de=o[ge];je(de)&&(s[ge]=de.bind(n))}if(r){const ge=r.call(n,n);$t(ge)&&(t.data=su(ge))}if(BT=!0,i)for(const ge in i){const de=i[ge],ve=je(de)?de.bind(n,n):je(de.get)?de.get.bind(n,n):Ri,Kt=!je(de)&&je(de.set)?de.set.bind(n):Ri,Ht=be({get:ve,set:Kt});Object.defineProperty(s,ge,{enumerable:!0,configurable:!0,get:()=>Ht.value,set:Wt=>Ht.value=Wt})}if(a)for(const ge in a)hM(a[ge],s,n,ge);if(c){const ge=je(c)?c.call(n):c;Reflect.ownKeys(ge).forEach(de=>{zf(de,ge[de])})}h&&Rk(h,t,"c");function oe(ge,de){Ne(de)?de.forEach(ve=>ge(ve.bind(n))):de&&ge(de.bind(n))}if(oe(lM,d),oe(Mv,p),oe(cM,m),oe(yS,w),oe(iM,R),oe(oM,k),oe(t5,v),oe(e5,J),oe(Z$,I),oe(Vv,M),oe(Fv,q),oe(J$,y),Ne(C))if(C.length){const ge=t.exposed||(t.exposed={});C.forEach(de=>{Object.defineProperty(ge,de,{get:()=>n[de],set:ve=>n[de]=ve,enumerable:!0})})}else t.exposed||(t.exposed={});H&&t.render===Ri&&(t.render=H),S!=null&&(t.inheritAttrs=S),T&&(t.components=T),E&&(t.directives=E),y&&rM(t)}function l5(t,e,n=Ri){Ne(t)&&(t=jT(t));for(const s in t){const r=t[s];let i;$t(r)?"default"in r?i=or(r.from||s,r.default,!0):i=or(r.from||s):i=or(r),qn(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function Rk(t,e,n){oi(Ne(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function hM(t,e,n,s){let r=s.includes(".")?CM(n,s):()=>n[s];if(rn(t)){const i=e[t];je(i)&&Hu(r,i)}else if(je(t))Hu(r,t.bind(n));else if($t(t))if(Ne(t))t.forEach(i=>hM(i,e,n,s));else{const i=je(t.handler)?t.handler.bind(n):e[t.handler];je(i)&&Hu(r,i,t)}}function dM(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!r.length&&!n&&!s?c=e:(c={},r.length&&r.forEach(u=>q_(c,u,o,!0)),q_(c,e,o)),$t(e)&&i.set(e,c),c}function q_(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&q_(t,i,n,!0),r&&r.forEach(o=>q_(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=c5[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const c5={data:Ak,props:kk,emits:kk,methods:bf,computed:bf,beforeCreate:Is,created:Is,beforeMount:Is,mounted:Is,beforeUpdate:Is,updated:Is,beforeDestroy:Is,beforeUnmount:Is,destroyed:Is,unmounted:Is,activated:Is,deactivated:Is,errorCaptured:Is,serverPrefetch:Is,components:bf,directives:bf,watch:h5,provide:Ak,inject:u5};function Ak(t,e){return e?t?function(){return xn(je(t)?t.call(this,this):t,je(e)?e.call(this,this):e)}:e:t}function u5(t,e){return bf(jT(t),jT(e))}function jT(t){if(Ne(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Is(t,e){return t?[...new Set([].concat(t,e))]:e}function bf(t,e){return t?xn(Object.create(null),t,e):e}function kk(t,e){return t?Ne(t)&&Ne(e)?[...new Set([...t,...e])]:xn(Object.create(null),Sk(t),Sk(e??{})):e}function h5(t,e){if(!t)return e;if(!e)return t;const n=xn(Object.create(null),t);for(const s in e)n[s]=Is(t[s],e[s]);return n}function fM(){return{app:null,config:{isNativeTag:e$,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let d5=0;function f5(t,e){return function(n,s=null){je(n)||(n=xn({},n)),s!=null&&!$t(s)&&(s=null);const r=fM(),i=new WeakSet,o=[];let a=!1;const c=r.app={_uid:d5++,_component:n,_props:s,_container:null,_context:r,_instance:null,version:Q5,get config(){return r.config},set config(u){},use(u,...h){return i.has(u)||(u&&je(u.install)?(i.add(u),u.install(c,...h)):je(u)&&(i.add(u),u(c,...h))),c},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),c},component(u,h){return h?(r.components[u]=h,c):r.components[u]},directive(u,h){return h?(r.directives[u]=h,c):r.directives[u]},mount(u,h,d){if(!a){const p=c._ceVNode||gs(n,s);return p.appContext=r,d===!0?d="svg":d===!1&&(d=void 0),t(p,u,d),a=!0,c._container=u,u.__vue_app__=c,Bv(p.component)}},onUnmount(u){o.push(u)},unmount(){a&&(oi(o,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,h){return r.provides[u]=h,c},runWithContext(u){const h=Sc;Sc=c;try{return u()}finally{Sc=h}}};return c}}let Sc=null;function zf(t,e){if(fs){let n=fs.provides;const s=fs.parent&&fs.parent.provides;s===n&&(n=fs.provides=Object.create(s)),n[t]=e}}function or(t,e,n=!1){const s=kl();if(s||Sc){let r=Sc?Sc._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&je(e)?e.call(s&&s.proxy):e}}function p5(){return!!(kl()||Sc)}const pM={},gM=()=>Object.create(pM),mM=t=>Object.getPrototypeOf(t)===pM;function g5(t,e,n,s=!1){const r={},i=gM();t.propsDefaults=Object.create(null),_M(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:hS(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function m5(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=lt(r),[c]=t.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let d=0;d<h.length;d++){let p=h[d];if(Uv(t.emitsOptions,p))continue;const m=e[p];if(c)if(vt(i,p))m!==i[p]&&(i[p]=m,u=!0);else{const w=vr(p);r[w]=$T(c,a,w,m,t,!1)}else m!==i[p]&&(i[p]=m,u=!0)}}}else{_M(t,e,r,i)&&(u=!0);let h;for(const d in a)(!e||!vt(e,d)&&((h=nu(d))===d||!vt(e,h)))&&(c?n&&(n[d]!==void 0||n[h]!==void 0)&&(r[d]=$T(c,a,d,void 0,t,!0)):delete r[d]);if(i!==a)for(const d in i)(!e||!vt(e,d))&&(delete i[d],u=!0)}u&&Co(t.attrs,"set","")}function _M(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(Vf(c))continue;const u=e[c];let h;r&&vt(r,h=vr(c))?!i||!i.includes(h)?n[h]=u:(a||(a={}))[h]=u:Uv(t.emitsOptions,c)||(!(c in s)||u!==s[c])&&(s[c]=u,o=!0)}if(i){const c=lt(n),u=a||At;for(let h=0;h<i.length;h++){const d=i[h];n[d]=$T(r,c,d,u[d],t,!vt(u,d))}}return o}function $T(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=vt(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&je(c)){const{propsDefaults:u}=r;if(n in u)s=u[n];else{const h=Og(r);s=u[n]=c.call(null,e),h()}}else s=c;r.ce&&r.ce._setProp(n,s)}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===nu(n))&&(s=!0))}return s}const _5=new WeakMap;function yM(t,e,n=!1){const s=n?_5:e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let c=!1;if(!je(t)){const h=d=>{c=!0;const[p,m]=yM(d,e,!0);xn(o,p),m&&a.push(...m)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!i&&!c)return $t(t)&&s.set(t,ju),ju;if(Ne(i))for(let h=0;h<i.length;h++){const d=vr(i[h]);Pk(d)&&(o[d]=At)}else if(i)for(const h in i){const d=vr(h);if(Pk(d)){const p=i[h],m=o[d]=Ne(p)||je(p)?{type:p}:xn({},p),w=m.type;let R=!1,k=!0;if(Ne(w))for(let O=0;O<w.length;++O){const M=w[O],F=je(M)&&M.name;if(F==="Boolean"){R=!0;break}else F==="String"&&(k=!1)}else R=je(w)&&w.name==="Boolean";m[0]=R,m[1]=k,(R||vt(m,"default"))&&a.push(d)}}const u=[o,a];return $t(t)&&s.set(t,u),u}function Pk(t){return t[0]!=="$"&&!Vf(t)}const vS=t=>t==="_"||t==="__"||t==="_ctx"||t==="$stable",wS=t=>Ne(t)?t.map(bi):[bi(t)],y5=(t,e,n)=>{if(e._n)return e;const s=GL((...r)=>wS(e(...r)),n);return s._c=!1,s},vM=(t,e,n)=>{const s=t._ctx;for(const r in t){if(vS(r))continue;const i=t[r];if(je(i))e[r]=y5(r,i,s);else if(i!=null){const o=wS(i);e[r]=()=>o}}},wM=(t,e)=>{const n=wS(e);t.slots.default=()=>n},EM=(t,e,n)=>{for(const s in e)(n||!vS(s))&&(t[s]=e[s])},v5=(t,e,n)=>{const s=t.slots=gM();if(t.vnode.shapeFlag&32){const r=e.__;r&&LT(s,"__",r,!0);const i=e._;i?(EM(s,e,n),n&&LT(s,"_",i,!0)):vM(e,s)}else e&&wM(t,e)},w5=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=At;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:EM(r,e,n):(i=!e.$stable,vM(e,r)),o=e}else e&&(wM(t,e),o={default:1});if(i)for(const a in r)!vS(a)&&o[a]==null&&delete r[a]},Rs=O5;function E5(t){return b5(t)}function b5(t,e){const n=kv();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:c,setText:u,setElementText:h,parentNode:d,nextSibling:p,setScopeId:m=Ri,insertStaticContent:w}=t,R=(x,b,A,N=null,L=null,U=null,B=void 0,G=null,$=!!b.dynamicChildren)=>{if(x===b)return;x&&!dc(x,b)&&(N=V(x),Fe(x,L,U,!0),x=null),b.patchFlag===-2&&($=!1,b.dynamicChildren=null);const{type:j,ref:W,shapeFlag:Z}=b;switch(j){case qv:k(x,b,A,N);break;case Ns:O(x,b,A,N);break;case pb:x==null&&M(b,A,N,B);break;case hr:T(x,b,A,N,L,U,B,G,$);break;default:Z&1?H(x,b,A,N,L,U,B,G,$):Z&6?E(x,b,A,N,L,U,B,G,$):(Z&64||Z&128)&&j.process(x,b,A,N,L,U,B,G,$,ee)}W!=null&&L?Bf(W,x&&x.ref,U,b||x,!b):W==null&&x&&x.ref!=null&&Bf(x.ref,null,U,x,!0)},k=(x,b,A,N)=>{if(x==null)s(b.el=a(b.children),A,N);else{const L=b.el=x.el;b.children!==x.children&&u(L,b.children)}},O=(x,b,A,N)=>{x==null?s(b.el=c(b.children||""),A,N):b.el=x.el},M=(x,b,A,N)=>{[x.el,x.anchor]=w(x.children,b,A,N,x.el,x.anchor)},F=({el:x,anchor:b},A,N)=>{let L;for(;x&&x!==b;)L=p(x),s(x,A,N),x=L;s(b,A,N)},q=({el:x,anchor:b})=>{let A;for(;x&&x!==b;)A=p(x),r(x),x=A;r(b)},H=(x,b,A,N,L,U,B,G,$)=>{b.type==="svg"?B="svg":b.type==="math"&&(B="mathml"),x==null?J(b,A,N,L,U,B,G,$):y(x,b,L,U,B,G,$)},J=(x,b,A,N,L,U,B,G)=>{let $,j;const{props:W,shapeFlag:Z,transition:X,dirs:ne}=x;if($=x.el=o(x.type,U,W&&W.is,W),Z&8?h($,x.children):Z&16&&v(x.children,$,null,N,L,fb(x,U),B,G),ne&&Xl(x,null,N,"created"),I($,x,x.scopeId,B,N),W){for(const ae in W)ae!=="value"&&!Vf(ae)&&i($,ae,null,W[ae],U,N);"value"in W&&i($,"value",null,W.value,U),(j=W.onVnodeBeforeMount)&&hi(j,N,x)}ne&&Xl(x,null,N,"beforeMount");const ce=T5(L,X);ce&&X.beforeEnter($),s($,b,A),((j=W&&W.onVnodeMounted)||ce||ne)&&Rs(()=>{j&&hi(j,N,x),ce&&X.enter($),ne&&Xl(x,null,N,"mounted")},L)},I=(x,b,A,N,L)=>{if(A&&m(x,A),N)for(let U=0;U<N.length;U++)m(x,N[U]);if(L){let U=L.subTree;if(b===U||SM(U.type)&&(U.ssContent===b||U.ssFallback===b)){const B=L.vnode;I(x,B,B.scopeId,B.slotScopeIds,L.parent)}}},v=(x,b,A,N,L,U,B,G,$=0)=>{for(let j=$;j<x.length;j++){const W=x[j]=G?wa(x[j]):bi(x[j]);R(null,W,b,A,N,L,U,B,G)}},y=(x,b,A,N,L,U,B)=>{const G=b.el=x.el;let{patchFlag:$,dynamicChildren:j,dirs:W}=b;$|=x.patchFlag&16;const Z=x.props||At,X=b.props||At;let ne;if(A&&Jl(A,!1),(ne=X.onVnodeBeforeUpdate)&&hi(ne,A,b,x),W&&Xl(b,x,A,"beforeUpdate"),A&&Jl(A,!0),(Z.innerHTML&&X.innerHTML==null||Z.textContent&&X.textContent==null)&&h(G,""),j?C(x.dynamicChildren,j,G,A,N,fb(b,L),U):B||ve(x,b,G,null,A,N,fb(b,L),U,!1),$>0){if($&16)S(G,Z,X,A,L);else if($&2&&Z.class!==X.class&&i(G,"class",null,X.class,L),$&4&&i(G,"style",Z.style,X.style,L),$&8){const ce=b.dynamicProps;for(let ae=0;ae<ce.length;ae++){const le=ce[ae],we=Z[le],rt=X[le];(rt!==we||le==="value")&&i(G,le,we,rt,L,A)}}$&1&&x.children!==b.children&&h(G,b.children)}else!B&&j==null&&S(G,Z,X,A,L);((ne=X.onVnodeUpdated)||W)&&Rs(()=>{ne&&hi(ne,A,b,x),W&&Xl(b,x,A,"updated")},N)},C=(x,b,A,N,L,U,B)=>{for(let G=0;G<b.length;G++){const $=x[G],j=b[G],W=$.el&&($.type===hr||!dc($,j)||$.shapeFlag&198)?d($.el):A;R($,j,W,null,N,L,U,B,!0)}},S=(x,b,A,N,L)=>{if(b!==A){if(b!==At)for(const U in b)!Vf(U)&&!(U in A)&&i(x,U,b[U],null,L,N);for(const U in A){if(Vf(U))continue;const B=A[U],G=b[U];B!==G&&U!=="value"&&i(x,U,G,B,L,N)}"value"in A&&i(x,"value",b.value,A.value,L)}},T=(x,b,A,N,L,U,B,G,$)=>{const j=b.el=x?x.el:a(""),W=b.anchor=x?x.anchor:a("");let{patchFlag:Z,dynamicChildren:X,slotScopeIds:ne}=b;ne&&(G=G?G.concat(ne):ne),x==null?(s(j,A,N),s(W,A,N),v(b.children||[],A,W,L,U,B,G,$)):Z>0&&Z&64&&X&&x.dynamicChildren?(C(x.dynamicChildren,X,A,L,U,B,G),(b.key!=null||L&&b===L.subTree)&&ES(x,b,!0)):ve(x,b,A,W,L,U,B,G,$)},E=(x,b,A,N,L,U,B,G,$)=>{b.slotScopeIds=G,x==null?b.shapeFlag&512?L.ctx.activate(b,A,N,B,$):K(b,A,N,L,U,B,$):oe(x,b,$)},K=(x,b,A,N,L,U,B)=>{const G=x.component=j5(x,N,L);if(Ov(x)&&(G.ctx.renderer=ee),$5(G,!1,B),G.asyncDep){if(L&&L.registerDep(G,ge,B),!x.el){const $=G.subTree=gs(Ns);O(null,$,b,A),x.placeholder=$.el}}else ge(G,x,b,A,L,U,B)},oe=(x,b,A)=>{const N=b.component=x.component;if(x5(x,b,A))if(N.asyncDep&&!N.asyncResolved){de(N,b,A);return}else N.next=b,N.update();else b.el=x.el,N.vnode=b},ge=(x,b,A,N,L,U,B)=>{const G=()=>{if(x.isMounted){let{next:Z,bu:X,u:ne,parent:ce,vnode:ae}=x;{const Mt=bM(x);if(Mt){Z&&(Z.el=ae.el,de(x,Z,B)),Mt.asyncDep.then(()=>{x.isUnmounted||G()});return}}let le=Z,we;Jl(x,!1),Z?(Z.el=ae.el,de(x,Z,B)):Z=ae,X&&ob(X),(we=Z.props&&Z.props.onVnodeBeforeUpdate)&&hi(we,ce,Z,ae),Jl(x,!0);const rt=xk(x),pt=x.subTree;x.subTree=rt,R(pt,rt,d(pt.el),V(pt),x,L,U),Z.el=rt.el,le===null&&D5(x,rt.el),ne&&Rs(ne,L),(we=Z.props&&Z.props.onVnodeUpdated)&&Rs(()=>hi(we,ce,Z,ae),L)}else{let Z;const{el:X,props:ne}=b,{bm:ce,m:ae,parent:le,root:we,type:rt}=x,pt=jf(b);Jl(x,!1),ce&&ob(ce),!pt&&(Z=ne&&ne.onVnodeBeforeMount)&&hi(Z,le,b),Jl(x,!0);{we.ce&&we.ce._def.shadowRoot!==!1&&we.ce._injectChildStyle(rt);const Mt=x.subTree=xk(x);R(null,Mt,A,N,x,L,U),b.el=Mt.el}if(ae&&Rs(ae,L),!pt&&(Z=ne&&ne.onVnodeMounted)){const Mt=b;Rs(()=>hi(Z,le,Mt),L)}(b.shapeFlag&256||le&&jf(le.vnode)&&le.vnode.shapeFlag&256)&&x.a&&Rs(x.a,L),x.isMounted=!0,b=A=N=null}};x.scope.on();const $=x.effect=new SL(G);x.scope.off();const j=x.update=$.run.bind($),W=x.job=$.runIfDirty.bind($);W.i=x,W.id=x.uid,$.scheduler=()=>gS(W),Jl(x,!0),j()},de=(x,b,A)=>{b.component=x;const N=x.vnode.props;x.vnode=b,x.next=null,m5(x,b.props,N,A),w5(x,b.children,A),qo(),wk(x),Bo()},ve=(x,b,A,N,L,U,B,G,$=!1)=>{const j=x&&x.children,W=x?x.shapeFlag:0,Z=b.children,{patchFlag:X,shapeFlag:ne}=b;if(X>0){if(X&128){Ht(j,Z,A,N,L,U,B,G,$);return}else if(X&256){Kt(j,Z,A,N,L,U,B,G,$);return}}ne&8?(W&16&&Tt(j,L,U),Z!==j&&h(A,Z)):W&16?ne&16?Ht(j,Z,A,N,L,U,B,G,$):Tt(j,L,U,!0):(W&8&&h(A,""),ne&16&&v(Z,A,N,L,U,B,G,$))},Kt=(x,b,A,N,L,U,B,G,$)=>{x=x||ju,b=b||ju;const j=x.length,W=b.length,Z=Math.min(j,W);let X;for(X=0;X<Z;X++){const ne=b[X]=$?wa(b[X]):bi(b[X]);R(x[X],ne,A,null,L,U,B,G,$)}j>W?Tt(x,L,U,!0,!1,Z):v(b,A,N,L,U,B,G,$,Z)},Ht=(x,b,A,N,L,U,B,G,$)=>{let j=0;const W=b.length;let Z=x.length-1,X=W-1;for(;j<=Z&&j<=X;){const ne=x[j],ce=b[j]=$?wa(b[j]):bi(b[j]);if(dc(ne,ce))R(ne,ce,A,null,L,U,B,G,$);else break;j++}for(;j<=Z&&j<=X;){const ne=x[Z],ce=b[X]=$?wa(b[X]):bi(b[X]);if(dc(ne,ce))R(ne,ce,A,null,L,U,B,G,$);else break;Z--,X--}if(j>Z){if(j<=X){const ne=X+1,ce=ne<W?b[ne].el:N;for(;j<=X;)R(null,b[j]=$?wa(b[j]):bi(b[j]),A,ce,L,U,B,G,$),j++}}else if(j>X)for(;j<=Z;)Fe(x[j],L,U,!0),j++;else{const ne=j,ce=j,ae=new Map;for(j=ce;j<=X;j++){const Jt=b[j]=$?wa(b[j]):bi(b[j]);Jt.key!=null&&ae.set(Jt.key,j)}let le,we=0;const rt=X-ce+1;let pt=!1,Mt=0;const Ct=new Array(rt);for(j=0;j<rt;j++)Ct[j]=0;for(j=ne;j<=Z;j++){const Jt=x[j];if(we>=rt){Fe(Jt,L,U,!0);continue}let ht;if(Jt.key!=null)ht=ae.get(Jt.key);else for(le=ce;le<=X;le++)if(Ct[le-ce]===0&&dc(Jt,b[le])){ht=le;break}ht===void 0?Fe(Jt,L,U,!0):(Ct[ht-ce]=j+1,ht>=Mt?Mt=ht:pt=!0,R(Jt,b[ht],A,null,L,U,B,G,$),we++)}const Us=pt?C5(Ct):ju;for(le=Us.length-1,j=rt-1;j>=0;j--){const Jt=ce+j,ht=b[Jt],jn=b[Jt+1],Ji=Jt+1<W?jn.el||jn.placeholder:N;Ct[j]===0?R(null,ht,A,Ji,L,U,B,G,$):pt&&(le<0||j!==Us[le]?Wt(ht,A,Ji,2):le--)}}},Wt=(x,b,A,N,L=null)=>{const{el:U,type:B,transition:G,children:$,shapeFlag:j}=x;if(j&6){Wt(x.component.subTree,b,A,N);return}if(j&128){x.suspense.move(b,A,N);return}if(j&64){B.move(x,b,A,ee);return}if(B===hr){s(U,b,A);for(let W=0;W<$.length;W++)Wt($[W],b,A,N);s(x.anchor,b,A);return}if(B===pb){F(x,b,A);return}if(N!==2&&j&1&&G)if(N===0)G.beforeEnter(U),s(U,b,A),Rs(()=>G.enter(U),L);else{const{leave:W,delayLeave:Z,afterLeave:X}=G,ne=()=>{x.ctx.isUnmounted?r(U):s(U,b,A)},ce=()=>{W(U,()=>{ne(),X&&X()})};Z?Z(U,ne,ce):ce()}else s(U,b,A)},Fe=(x,b,A,N=!1,L=!1)=>{const{type:U,props:B,ref:G,children:$,dynamicChildren:j,shapeFlag:W,patchFlag:Z,dirs:X,cacheIndex:ne}=x;if(Z===-2&&(L=!1),G!=null&&(qo(),Bf(G,null,A,x,!0),Bo()),ne!=null&&(b.renderCache[ne]=void 0),W&256){b.ctx.deactivate(x);return}const ce=W&1&&X,ae=!jf(x);let le;if(ae&&(le=B&&B.onVnodeBeforeUnmount)&&hi(le,b,x),W&6)hn(x.component,A,N);else{if(W&128){x.suspense.unmount(A,N);return}ce&&Xl(x,null,b,"beforeUnmount"),W&64?x.type.remove(x,b,A,ee,N):j&&!j.hasOnce&&(U!==hr||Z>0&&Z&64)?Tt(j,b,A,!1,!0):(U===hr&&Z&384||!L&&W&16)&&Tt($,b,A),N&&De(x)}(ae&&(le=B&&B.onVnodeUnmounted)||ce)&&Rs(()=>{le&&hi(le,b,x),ce&&Xl(x,null,b,"unmounted")},A)},De=x=>{const{type:b,el:A,anchor:N,transition:L}=x;if(b===hr){Bn(A,N);return}if(b===pb){q(x);return}const U=()=>{r(A),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(x.shapeFlag&1&&L&&!L.persisted){const{leave:B,delayLeave:G}=L,$=()=>B(A,U);G?G(x.el,U,$):$()}else U()},Bn=(x,b)=>{let A;for(;x!==b;)A=p(x),r(x),x=A;r(b)},hn=(x,b,A)=>{const{bum:N,scope:L,job:U,subTree:B,um:G,m:$,a:j,parent:W,slots:{__:Z}}=x;Nk($),Nk(j),N&&ob(N),W&&Ne(Z)&&Z.forEach(X=>{W.renderCache[X]=void 0}),L.stop(),U&&(U.flags|=8,Fe(B,x,b,A)),G&&Rs(G,b),Rs(()=>{x.isUnmounted=!0},b),b&&b.pendingBranch&&!b.isUnmounted&&x.asyncDep&&!x.asyncResolved&&x.suspenseId===b.pendingId&&(b.deps--,b.deps===0&&b.resolve())},Tt=(x,b,A,N=!1,L=!1,U=0)=>{for(let B=U;B<x.length;B++)Fe(x[B],b,A,N,L)},V=x=>{if(x.shapeFlag&6)return V(x.component.subTree);if(x.shapeFlag&128)return x.suspense.next();const b=p(x.anchor||x.el),A=b&&b[QL];return A?p(A):b};let Y=!1;const Q=(x,b,A)=>{x==null?b._vnode&&Fe(b._vnode,null,null,!0):R(b._vnode||null,x,b,null,null,null,A),b._vnode=x,Y||(Y=!0,wk(),HL(),Y=!1)},ee={p:R,um:Fe,m:Wt,r:De,mt:K,mc:v,pc:ve,pbc:C,n:V,o:t};return{render:Q,hydrate:void 0,createApp:f5(Q)}}function fb({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Jl({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function T5(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function ES(t,e,n=!1){const s=t.children,r=e.children;if(Ne(s)&&Ne(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=wa(r[i]),a.el=o.el),!n&&a.patchFlag!==-2&&ES(o,a)),a.type===qv&&(a.el=o.el),a.type===Ns&&!a.el&&(a.el=o.el)}}function C5(t){const e=t.slice(),n=[0];let s,r,i,o,a;const c=t.length;for(s=0;s<c;s++){const u=t[s];if(u!==0){if(r=n[n.length-1],t[r]<u){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<u?i=a+1:o=a;u<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function bM(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:bM(e)}function Nk(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const I5=Symbol.for("v-scx"),S5=()=>or(I5);function Hu(t,e,n){return TM(t,e,n)}function TM(t,e,n=At){const{immediate:s,deep:r,flush:i,once:o}=n,a=xn({},n),c=e&&s||!e&&i!=="post";let u;if(Op){if(i==="sync"){const m=S5();u=m.__watcherHandles||(m.__watcherHandles=[])}else if(!c){const m=()=>{};return m.stop=Ri,m.resume=Ri,m.pause=Ri,m}}const h=fs;a.call=(m,w,R)=>oi(m,h,w,R);let d=!1;i==="post"?a.scheduler=m=>{Rs(m,h&&h.suspense)}:i!=="sync"&&(d=!0,a.scheduler=(m,w)=>{w?m():gS(m)}),a.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,h&&(m.id=h.uid,m.i=h))};const p=$$(t,e,a);return Op&&(u?u.push(p):c&&p()),p}function R5(t,e,n){const s=this.proxy,r=rn(t)?t.includes(".")?CM(s,t):()=>s[t]:t.bind(s,s);let i;je(e)?i=e:(i=e.handler,n=e);const o=Og(this),a=TM(r,i.bind(s),n);return o(),a}function CM(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}const A5=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${vr(e)}Modifiers`]||t[`${nu(e)}Modifiers`];function k5(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||At;let r=n;const i=e.startsWith("update:"),o=i&&A5(s,e.slice(7));o&&(o.trim&&(r=n.map(h=>rn(h)?h.trim():h)),o.number&&(r=n.map(i$)));let a,c=s[a=ib(e)]||s[a=ib(vr(e))];!c&&i&&(c=s[a=ib(nu(e))]),c&&oi(c,t,6,r);const u=s[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,oi(u,t,6,r)}}function IM(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!je(t)){const c=u=>{const h=IM(u,e,!0);h&&(a=!0,xn(o,h))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?($t(t)&&s.set(t,null),null):(Ne(i)?i.forEach(c=>o[c]=null):xn(o,i),$t(t)&&s.set(t,o),o)}function Uv(t,e){return!t||!Iv(e)?!1:(e=e.slice(2).replace(/Once$/,""),vt(t,e[0].toLowerCase()+e.slice(1))||vt(t,nu(e))||vt(t,e))}function xk(t){const{type:e,vnode:n,proxy:s,withProxy:r,propsOptions:[i],slots:o,attrs:a,emit:c,render:u,renderCache:h,props:d,data:p,setupState:m,ctx:w,inheritAttrs:R}=t,k=U_(t);let O,M;try{if(n.shapeFlag&4){const q=r||s,H=q;O=bi(u.call(H,q,h,d,m,p,w)),M=a}else{const q=e;O=bi(q.length>1?q(d,{attrs:a,slots:o,emit:c}):q(d,null)),M=e.props?a:P5(a)}}catch(q){Hf.length=0,Dv(q,t,1),O=gs(Ns)}let F=O;if(M&&R!==!1){const q=Object.keys(M),{shapeFlag:H}=F;q.length&&H&7&&(i&&q.some(sS)&&(M=N5(M,i)),F=Za(F,M,!1,!0))}return n.dirs&&(F=Za(F,null,!1,!0),F.dirs=F.dirs?F.dirs.concat(n.dirs):n.dirs),n.transition&&Mc(F,n.transition),O=F,U_(k),O}const P5=t=>{let e;for(const n in t)(n==="class"||n==="style"||Iv(n))&&((e||(e={}))[n]=t[n]);return e},N5=(t,e)=>{const n={};for(const s in t)(!sS(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function x5(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?Dk(s,o,u):!!o;if(c&8){const h=e.dynamicProps;for(let d=0;d<h.length;d++){const p=h[d];if(o[p]!==s[p]&&!Uv(u,p))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?Dk(s,o,u):!0:!!o;return!1}function Dk(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!Uv(n,i))return!0}return!1}function D5({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const SM=t=>t.__isSuspense;function O5(t,e){e&&e.pendingBranch?Ne(t)?e.effects.push(...t):e.effects.push(t):W$(t)}const hr=Symbol.for("v-fgt"),qv=Symbol.for("v-txt"),Ns=Symbol.for("v-cmt"),pb=Symbol.for("v-stc"),Hf=[];let nr=null;function bS(t=!1){Hf.push(nr=t?null:[])}function L5(){Hf.pop(),nr=Hf[Hf.length-1]||null}let Dp=1;function Ok(t,e=!1){Dp+=t,t<0&&nr&&e&&(nr.hasOnce=!0)}function RM(t){return t.dynamicChildren=Dp>0?nr||ju:null,L5(),Dp>0&&nr&&nr.push(t),t}function AM(t,e,n,s,r,i){return RM(TS(t,e,n,s,r,i,!0))}function kM(t,e,n,s,r){return RM(gs(t,e,n,s,r,!0))}function B_(t){return t?t.__v_isVNode===!0:!1}function dc(t,e){return t.type===e.type&&t.key===e.key}const PM=({key:t})=>t??null,Zm=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?rn(t)||qn(t)||je(t)?{i:tr,r:t,k:e,f:!!n}:t:null);function TS(t,e=null,n=null,s=0,r=null,i=t===hr?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&PM(e),ref:e&&Zm(e),scopeId:KL,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:tr};return a?(CS(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=rn(n)?8:16),Dp>0&&!o&&nr&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&nr.push(c),c}const gs=M5;function M5(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===s5)&&(t=Ns),B_(t)){const a=Za(t,e,!0);return n&&CS(a,n),Dp>0&&!i&&nr&&(a.shapeFlag&6?nr[nr.indexOf(t)]=a:nr.push(a)),a.patchFlag=-2,a}if(G5(t)&&(t=t.__vccOpts),e){e=V5(e);let{class:a,style:c}=e;a&&!rn(a)&&(e.class=Nv(a)),$t(c)&&(fS(c)&&!Ne(c)&&(c=xn({},c)),e.style=Pv(c))}const o=rn(t)?1:SM(t)?128:YL(t)?64:$t(t)?4:je(t)?2:0;return TS(t,e,n,s,r,o,i,!0)}function V5(t){return t?fS(t)||mM(t)?xn({},t):t:null}function Za(t,e,n=!1,s=!1){const{props:r,ref:i,patchFlag:o,children:a,transition:c}=t,u=e?U5(r||{},e):r,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&PM(u),ref:e&&e.ref?n&&i?Ne(i)?i.concat(Zm(e)):[i,Zm(e)]:Zm(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==hr?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Za(t.ssContent),ssFallback:t.ssFallback&&Za(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&s&&Mc(h,c.clone(h)),h}function NM(t=" ",e=0){return gs(qv,null,t,e)}function F5(t="",e=!1){return e?(bS(),kM(Ns,null,t)):gs(Ns,null,t)}function bi(t){return t==null||typeof t=="boolean"?gs(Ns):Ne(t)?gs(hr,null,t.slice()):B_(t)?wa(t):gs(qv,null,String(t))}function wa(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Za(t)}function CS(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(Ne(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),CS(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!mM(e)?e._ctx=tr:r===3&&tr&&(tr.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else je(e)?(e={default:e,_ctx:tr},n=32):(e=String(e),s&64?(n=16,e=[NM(e)]):n=8);t.children=e,t.shapeFlag|=n}function U5(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=Nv([e.class,s.class]));else if(r==="style")e.style=Pv([e.style,s.style]);else if(Iv(r)){const i=e[r],o=s[r];o&&i!==o&&!(Ne(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function hi(t,e,n,s=null){oi(t,e,7,[n,s])}const q5=fM();let B5=0;function j5(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||q5,i={uid:B5++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new CL(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:yM(s,r),emitsOptions:IM(s,r),emit:null,emitted:null,propsDefaults:At,inheritAttrs:s.inheritAttrs,ctx:At,data:At,props:At,attrs:At,slots:At,refs:At,setupState:At,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=k5.bind(null,i),t.ce&&t.ce(i),i}let fs=null;const kl=()=>fs||tr;let j_,zT;{const t=kv(),e=(n,s)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(s),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};j_=e("__VUE_INSTANCE_SETTERS__",n=>fs=n),zT=e("__VUE_SSR_SETTERS__",n=>Op=n)}const Og=t=>{const e=fs;return j_(t),t.scope.on(),()=>{t.scope.off(),j_(e)}},Lk=()=>{fs&&fs.scope.off(),j_(null)};function xM(t){return t.vnode.shapeFlag&4}let Op=!1;function $5(t,e=!1,n=!1){e&&zT(e);const{props:s,children:r}=t.vnode,i=xM(t);g5(t,s,i,e),v5(t,r,n||e);const o=i?z5(t,e):void 0;return e&&zT(!1),o}function z5(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,o5);const{setup:s}=n;if(s){qo();const r=t.setupContext=s.length>1?W5(t):null,i=Og(t),o=xg(s,t,0,[t.props,r]),a=_L(o);if(Bo(),i(),(a||t.sp)&&!jf(t)&&rM(t),a){if(o.then(Lk,Lk),e)return o.then(c=>{Mk(t,c)}).catch(c=>{Dv(c,t,0)});t.asyncDep=o}else Mk(t,o)}else DM(t)}function Mk(t,e,n){je(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:$t(e)&&(t.setupState=jL(e)),DM(t)}function DM(t,e,n){const s=t.type;t.render||(t.render=s.render||Ri);{const r=Og(t);qo();try{a5(t)}finally{Bo(),r()}}}const H5={get(t,e){return as(t,"get",""),t[e]}};function W5(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,H5),slots:t.slots,emit:t.emit,expose:e}}function Bv(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(jL(qh(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in $f)return $f[n](t)},has(e,n){return n in e||n in $f}})):t.proxy}function K5(t,e=!0){return je(t)?t.displayName||t.name:t.name||e&&t.__name}function G5(t){return je(t)&&"__vccOpts"in t}const be=(t,e)=>B$(t,e,Op);function Oe(t,e,n){const s=arguments.length;return s===2?$t(e)&&!Ne(e)?B_(e)?gs(t,null,[e]):gs(t,e):gs(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&B_(n)&&(n=[n]),gs(t,e,n))}const Q5="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let HT;const Vk=typeof window<"u"&&window.trustedTypes;if(Vk)try{HT=Vk.createPolicy("vue",{createHTML:t=>t})}catch{}const OM=HT?t=>HT.createHTML(t):t=>t,Y5="http://www.w3.org/2000/svg",X5="http://www.w3.org/1998/Math/MathML",bo=typeof document<"u"?document:null,Fk=bo&&bo.createElement("template"),J5={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e==="svg"?bo.createElementNS(Y5,t):e==="mathml"?bo.createElementNS(X5,t):n?bo.createElement(t,{is:n}):bo.createElement(t);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>bo.createTextNode(t),createComment:t=>bo.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>bo.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{Fk.innerHTML=OM(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const a=Fk.content;if(s==="svg"||s==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},ca="transition",tf="animation",uh=Symbol("_vtc"),LM={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},MM=xn({},eM,LM),Z5=t=>(t.displayName="Transition",t.props=MM,t),VM=Z5((t,{slots:e})=>Oe(Y$,FM(t),e)),Zl=(t,e=[])=>{Ne(t)?t.forEach(n=>n(...e)):t&&t(...e)},Uk=t=>t?Ne(t)?t.some(e=>e.length>1):t.length>1:!1;function FM(t){const e={};for(const T in t)T in LM||(e[T]=t[T]);if(t.css===!1)return e;const{name:n="v",type:s,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:u=o,appearToClass:h=a,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:m=`${n}-leave-to`}=t,w=ez(r),R=w&&w[0],k=w&&w[1],{onBeforeEnter:O,onEnter:M,onEnterCancelled:F,onLeave:q,onLeaveCancelled:H,onBeforeAppear:J=O,onAppear:I=M,onAppearCancelled:v=F}=e,y=(T,E,K,oe)=>{T._enterCancelled=oe,ga(T,E?h:a),ga(T,E?u:o),K&&K()},C=(T,E)=>{T._isLeaving=!1,ga(T,d),ga(T,m),ga(T,p),E&&E()},S=T=>(E,K)=>{const oe=T?I:M,ge=()=>y(E,T,K);Zl(oe,[E,ge]),qk(()=>{ga(E,T?c:i),gi(E,T?h:a),Uk(oe)||Bk(E,s,R,ge)})};return xn(e,{onBeforeEnter(T){Zl(O,[T]),gi(T,i),gi(T,o)},onBeforeAppear(T){Zl(J,[T]),gi(T,c),gi(T,u)},onEnter:S(!1),onAppear:S(!0),onLeave(T,E){T._isLeaving=!0;const K=()=>C(T,E);gi(T,d),T._enterCancelled?(gi(T,p),WT()):(WT(),gi(T,p)),qk(()=>{T._isLeaving&&(ga(T,d),gi(T,m),Uk(q)||Bk(T,s,k,K))}),Zl(q,[T,K])},onEnterCancelled(T){y(T,!1,void 0,!0),Zl(F,[T])},onAppearCancelled(T){y(T,!0,void 0,!0),Zl(v,[T])},onLeaveCancelled(T){C(T),Zl(H,[T])}})}function ez(t){if(t==null)return null;if($t(t))return[gb(t.enter),gb(t.leave)];{const e=gb(t);return[e,e]}}function gb(t){return o$(t)}function gi(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[uh]||(t[uh]=new Set)).add(e)}function ga(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const n=t[uh];n&&(n.delete(e),n.size||(t[uh]=void 0))}function qk(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let tz=0;function Bk(t,e,n,s){const r=t._endId=++tz,i=()=>{r===t._endId&&s()};if(n!=null)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=UM(t,e);if(!o)return s();const u=o+"end";let h=0;const d=()=>{t.removeEventListener(u,p),i()},p=m=>{m.target===t&&++h>=c&&d()};setTimeout(()=>{h<c&&d()},a+1),t.addEventListener(u,p)}function UM(t,e){const n=window.getComputedStyle(t),s=w=>(n[w]||"").split(", "),r=s(`${ca}Delay`),i=s(`${ca}Duration`),o=jk(r,i),a=s(`${tf}Delay`),c=s(`${tf}Duration`),u=jk(a,c);let h=null,d=0,p=0;e===ca?o>0&&(h=ca,d=o,p=i.length):e===tf?u>0&&(h=tf,d=u,p=c.length):(d=Math.max(o,u),h=d>0?o>u?ca:tf:null,p=h?h===ca?i.length:c.length:0);const m=h===ca&&/\b(transform|all)(,|$)/.test(s(`${ca}Property`).toString());return{type:h,timeout:d,propCount:p,hasTransform:m}}function jk(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>$k(n)+$k(t[s])))}function $k(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function WT(){return document.body.offsetHeight}function nz(t,e,n){const s=t[uh];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const $_=Symbol("_vod"),qM=Symbol("_vsh"),sz={beforeMount(t,{value:e},{transition:n}){t[$_]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):nf(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:s}){!e!=!n&&(s?e?(s.beforeEnter(t),nf(t,!0),s.enter(t)):s.leave(t,()=>{nf(t,!1)}):nf(t,e))},beforeUnmount(t,{value:e}){nf(t,e)}};function nf(t,e){t.style.display=e?t[$_]:"none",t[qM]=!e}const rz=Symbol(""),iz=/(^|;)\s*display\s*:/;function oz(t,e,n){const s=t.style,r=rn(n);let i=!1;if(n&&!r){if(e)if(rn(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&e_(s,a,"")}else for(const o in e)n[o]==null&&e_(s,o,"");for(const o in n)o==="display"&&(i=!0),e_(s,o,n[o])}else if(r){if(e!==n){const o=s[rz];o&&(n+=";"+o),s.cssText=n,i=iz.test(n)}}else e&&t.removeAttribute("style");$_ in t&&(t[$_]=i?s.display:"",t[qM]&&(s.display="none"))}const zk=/\s*!important$/;function e_(t,e,n){if(Ne(n))n.forEach(s=>e_(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=az(t,e);zk.test(n)?t.setProperty(nu(s),n.replace(zk,""),"important"):t[s]=n}}const Hk=["Webkit","Moz","ms"],mb={};function az(t,e){const n=mb[e];if(n)return n;let s=vr(e);if(s!=="filter"&&s in t)return mb[e]=s;s=Av(s);for(let r=0;r<Hk.length;r++){const i=Hk[r]+s;if(i in t)return mb[e]=i}return e}const Wk="http://www.w3.org/1999/xlink";function Kk(t,e,n,s,r,i=d$(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Wk,e.slice(6,e.length)):t.setAttributeNS(Wk,e,n):n==null||i&&!wL(n)?t.removeAttribute(e):t.setAttribute(e,i?"":Al(n)?String(n):n)}function Gk(t,e,n,s,r){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?OM(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(a!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=wL(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(r||e)}function lz(t,e,n,s){t.addEventListener(e,n,s)}function cz(t,e,n,s){t.removeEventListener(e,n,s)}const Qk=Symbol("_vei");function uz(t,e,n,s,r=null){const i=t[Qk]||(t[Qk]={}),o=i[e];if(s&&o)o.value=s;else{const[a,c]=hz(e);if(s){const u=i[e]=pz(s,r);lz(t,a,u,c)}else o&&(cz(t,a,o,c),i[e]=void 0)}}const Yk=/(?:Once|Passive|Capture)$/;function hz(t){let e;if(Yk.test(t)){e={};let n;for(;n=t.match(Yk);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):nu(t.slice(2)),e]}let _b=0;const dz=Promise.resolve(),fz=()=>_b||(dz.then(()=>_b=0),_b=Date.now());function pz(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;oi(gz(s,n.value),e,5,[s])};return n.value=t,n.attached=fz(),n}function gz(t,e){if(Ne(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Xk=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,mz=(t,e,n,s,r,i)=>{const o=r==="svg";e==="class"?nz(t,s,o):e==="style"?oz(t,n,s):Iv(e)?sS(e)||uz(t,e,n,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):_z(t,e,s,o))?(Gk(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Kk(t,e,s,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!rn(s))?Gk(t,vr(e),s,i,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Kk(t,e,s,o))};function _z(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Xk(e)&&je(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Xk(e)&&rn(n)?!1:e in t}const BM=new WeakMap,jM=new WeakMap,z_=Symbol("_moveCb"),Jk=Symbol("_enterCb"),yz=t=>(delete t.props.mode,t),vz=yz({name:"TransitionGroup",props:xn({},MM,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=kl(),s=ZL();let r,i;return yS(()=>{if(!r.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!Cz(r[0].el,n.vnode.el,o)){r=[];return}r.forEach(Ez),r.forEach(bz);const a=r.filter(Tz);WT(),a.forEach(c=>{const u=c.el,h=u.style;gi(u,o),h.transform=h.webkitTransform=h.transitionDuration="";const d=u[z_]=p=>{p&&p.target!==u||(!p||/transform$/.test(p.propertyName))&&(u.removeEventListener("transitionend",d),u[z_]=null,ga(u,o))};u.addEventListener("transitionend",d)}),r=[]}),()=>{const o=lt(t),a=FM(o);let c=o.tag||hr;if(r=[],i)for(let u=0;u<i.length;u++){const h=i[u];h.el&&h.el instanceof Element&&(r.push(h),Mc(h,xp(h,a,s,n)),BM.set(h,h.el.getBoundingClientRect()))}i=e.default?_S(e.default()):[];for(let u=0;u<i.length;u++){const h=i[u];h.key!=null&&Mc(h,xp(h,a,s,n))}return gs(c,null,i)}}}),wz=vz;function Ez(t){const e=t.el;e[z_]&&e[z_](),e[Jk]&&e[Jk]()}function bz(t){jM.set(t,t.el.getBoundingClientRect())}function Tz(t){const e=BM.get(t),n=jM.get(t),s=e.left-n.left,r=e.top-n.top;if(s||r){const i=t.el.style;return i.transform=i.webkitTransform=`translate(${s}px,${r}px)`,i.transitionDuration="0s",t}}function Cz(t,e,n){const s=t.cloneNode(),r=t[uh];r&&r.forEach(a=>{a.split(/\s+/).forEach(c=>c&&s.classList.remove(c))}),n.split(/\s+/).forEach(a=>a&&s.classList.add(a)),s.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(s);const{hasTransform:o}=UM(s);return i.removeChild(s),o}const Iz=["ctrl","shift","alt","meta"],Sz={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Iz.some(n=>t[`${n}Key`]&&!e.includes(n))},Rz=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=(r,...i)=>{for(let o=0;o<e.length;o++){const a=Sz[e[o]];if(a&&a(r,e))return}return t(r,...i)})},Az=xn({patchProp:mz},J5);let Zk;function kz(){return Zk||(Zk=E5(Az))}const $M=(...t)=>{const e=kz().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=Nz(s);if(!r)return;const i=e._component;!je(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,Pz(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function Pz(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Nz(t){return rn(t)?document.querySelector(t):t}function Lg(t,e,n,s){return Object.defineProperty(t,e,{get:n,set:s,enumerable:!0}),t}function xz(t,e){for(const n in e)Lg(t,n,e[n]);return t}const el=jo(!1);let KT;function Dz(t,e){const n=/(edg|edge|edga|edgios)\/([\w.]+)/.exec(t)||/(opr)[\/]([\w.]+)/.exec(t)||/(vivaldi)[\/]([\w.]+)/.exec(t)||/(chrome|crios)[\/]([\w.]+)/.exec(t)||/(version)(applewebkit)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(t)||/(webkit)[\/]([\w.]+).*(version)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(t)||/(firefox|fxios)[\/]([\w.]+)/.exec(t)||/(webkit)[\/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[\/]([\w.]+)/.exec(t)||[];return{browser:n[5]||n[3]||n[1]||"",version:n[4]||n[2]||"0",platform:e[0]||""}}function Oz(t){return/(ipad)/.exec(t)||/(ipod)/.exec(t)||/(windows phone)/.exec(t)||/(iphone)/.exec(t)||/(kindle)/.exec(t)||/(silk)/.exec(t)||/(android)/.exec(t)||/(win)/.exec(t)||/(mac)/.exec(t)||/(linux)/.exec(t)||/(cros)/.exec(t)||/(playbook)/.exec(t)||/(bb)/.exec(t)||/(blackberry)/.exec(t)||[]}const zM="ontouchstart"in window||window.navigator.maxTouchPoints>0;function Lz(t){const e=t.toLowerCase(),n=Oz(e),s=Dz(e,n),r={mobile:!1,desktop:!1,cordova:!1,capacitor:!1,nativeMobile:!1,electron:!1,bex:!1,linux:!1,mac:!1,win:!1,cros:!1,chrome:!1,firefox:!1,opera:!1,safari:!1,vivaldi:!1,edge:!1,edgeChromium:!1,ie:!1,webkit:!1,android:!1,ios:!1,ipad:!1,iphone:!1,ipod:!1,kindle:!1,winphone:!1,blackberry:!1,playbook:!1,silk:!1};s.browser&&(r[s.browser]=!0,r.version=s.version,r.versionNumber=parseInt(s.version,10)),s.platform&&(r[s.platform]=!0);const i=r.android||r.ios||r.bb||r.blackberry||r.ipad||r.iphone||r.ipod||r.kindle||r.playbook||r.silk||r["windows phone"];if(i===!0||e.indexOf("mobile")!==-1?r.mobile=!0:r.desktop=!0,r["windows phone"]&&(r.winphone=!0,delete r["windows phone"]),r.edga||r.edgios||r.edg?(r.edge=!0,s.browser="edge"):r.crios?(r.chrome=!0,s.browser="chrome"):r.fxios&&(r.firefox=!0,s.browser="firefox"),(r.ipod||r.ipad||r.iphone)&&(r.ios=!0),r.vivaldi&&(s.browser="vivaldi",r.vivaldi=!0),(r.chrome||r.opr||r.safari||r.vivaldi||r.mobile===!0&&r.ios!==!0&&i!==!0)&&(r.webkit=!0),r.opr&&(s.browser="opera",r.opera=!0),r.safari&&(r.blackberry||r.bb?(s.browser="blackberry",r.blackberry=!0):r.playbook?(s.browser="playbook",r.playbook=!0):r.android?(s.browser="android",r.android=!0):r.kindle?(s.browser="kindle",r.kindle=!0):r.silk&&(s.browser="silk",r.silk=!0)),r.name=s.browser,r.platform=s.platform,e.indexOf("electron")!==-1)r.electron=!0;else if(document.location.href.indexOf("-extension://")!==-1)r.bex=!0;else{if(window.Capacitor!==void 0?(r.capacitor=!0,r.nativeMobile=!0,r.nativeMobileWrapper="capacitor"):(window._cordovaNative!==void 0||window.cordova!==void 0)&&(r.cordova=!0,r.nativeMobile=!0,r.nativeMobileWrapper="cordova"),el.value===!0&&(KT={is:{...r}}),zM===!0&&r.mac===!0&&(r.desktop===!0&&r.safari===!0||r.nativeMobile===!0&&r.android!==!0&&r.ios!==!0&&r.ipad!==!0)){delete r.mac,delete r.desktop;const o=Math.min(window.innerHeight,window.innerWidth)>414?"ipad":"iphone";Object.assign(r,{mobile:!0,ios:!0,platform:o,[o]:!0})}r.mobile!==!0&&window.navigator.userAgentData&&window.navigator.userAgentData.mobile&&(delete r.desktop,r.mobile=!0)}return r}const eP=navigator.userAgent||navigator.vendor||window.opera,Mz={has:{touch:!1,webStorage:!1},within:{iframe:!1}},Qr={userAgent:eP,is:Lz(eP),has:{touch:zM},within:{iframe:window.self!==window.top}},H_={install(t){const{$q:e}=t;el.value===!0?(t.onSSRHydrated.push(()=>{Object.assign(e.platform,Qr),el.value=!1}),e.platform=su(this)):e.platform=this}};{let t;Lg(Qr.has,"webStorage",()=>{if(t!==void 0)return t;try{if(window.localStorage)return t=!0,!0}catch{}return t=!1,!1}),Object.assign(H_,Qr),el.value===!0&&(Object.assign(H_,KT,Mz),KT=null)}function Bh(t){return qh(Dg(t))}function HM(t){return qh(t)}const jv=(t,e)=>{const n=su(t);for(const s in t)Lg(e,s,()=>n[s],r=>{n[s]=r});return e},tl={hasPassive:!1,passiveCapture:!0,notPassiveCapture:!0};try{const t=Object.defineProperty({},"passive",{get(){Object.assign(tl,{hasPassive:!0,passive:{passive:!0},notPassive:{passive:!1},passiveCapture:{passive:!0,capture:!0},notPassiveCapture:{passive:!1,capture:!0}})}});window.addEventListener("qtest",null,t),window.removeEventListener("qtest",null,t)}catch{}function hh(){}function Vz(t){return t.button===0}function WM(t){return t.touches&&t.touches[0]?t=t.touches[0]:t.changedTouches&&t.changedTouches[0]?t=t.changedTouches[0]:t.targetTouches&&t.targetTouches[0]&&(t=t.targetTouches[0]),{top:t.clientY,left:t.clientX}}function Fz(t){if(t.path)return t.path;if(t.composedPath)return t.composedPath();const e=[];let n=t.target;for(;n;){if(e.push(n),n.tagName==="HTML")return e.push(document),e.push(window),e;n=n.parentElement}}function IS(t){t.stopPropagation()}function W_(t){t.cancelable!==!1&&t.preventDefault()}function oc(t){t.cancelable!==!1&&t.preventDefault(),t.stopPropagation()}function Uz(t,e){if(t===void 0||e===!0&&t.__dragPrevented===!0)return;const n=e===!0?s=>{s.__dragPrevented=!0,s.addEventListener("dragstart",W_,tl.notPassiveCapture)}:s=>{delete s.__dragPrevented,s.removeEventListener("dragstart",W_,tl.notPassiveCapture)};t.querySelectorAll("a, img").forEach(n)}function KM(t,e,n){const s=`__q_${e}_evt`;t[s]=t[s]!==void 0?t[s].concat(n):n,n.forEach(r=>{r[0].addEventListener(r[1],t[r[2]],tl[r[3]])})}function GM(t,e){const n=`__q_${e}_evt`;t[n]!==void 0&&(t[n].forEach(s=>{s[0].removeEventListener(s[1],t[s[2]],tl[s[3]])}),t[n]=void 0)}function QM(t,e=250,n){let s=null;function r(){const i=arguments,o=()=>{s=null,t.apply(this,i)};s!==null&&clearTimeout(s),s=setTimeout(o,e)}return r.cancel=()=>{s!==null&&clearTimeout(s)},r}const yb=["sm","md","lg","xl"],{passive:tP}=tl,qz=jv({width:0,height:0,name:"xs",sizes:{sm:600,md:1024,lg:1440,xl:1920},lt:{sm:!0,md:!0,lg:!0,xl:!0},gt:{xs:!1,sm:!1,md:!1,lg:!1},xs:!0,sm:!1,md:!1,lg:!1,xl:!1},{setSizes:hh,setDebounce:hh,install({$q:t,onSSRHydrated:e}){if(t.screen=this,this.__installed===!0){t.config.screen!==void 0&&(t.config.screen.bodyClasses===!1?document.body.classList.remove(`screen--${this.name}`):this.__update(!0));return}const{visualViewport:n}=window,s=n||window,r=document.scrollingElement||document.documentElement,i=n===void 0||Qr.is.mobile===!0?()=>[Math.max(window.innerWidth,r.clientWidth),Math.max(window.innerHeight,r.clientHeight)]:()=>[n.width*n.scale+window.innerWidth-r.clientWidth,n.height*n.scale+window.innerHeight-r.clientHeight],o=t.config.screen?.bodyClasses===!0;this.__update=d=>{const[p,m]=i();if(m!==this.height&&(this.height=m),p!==this.width)this.width=p;else if(d!==!0)return;let w=this.sizes;this.gt.xs=p>=w.sm,this.gt.sm=p>=w.md,this.gt.md=p>=w.lg,this.gt.lg=p>=w.xl,this.lt.sm=p<w.sm,this.lt.md=p<w.md,this.lt.lg=p<w.lg,this.lt.xl=p<w.xl,this.xs=this.lt.sm,this.sm=this.gt.xs===!0&&this.lt.md===!0,this.md=this.gt.sm===!0&&this.lt.lg===!0,this.lg=this.gt.md===!0&&this.lt.xl===!0,this.xl=this.gt.lg,w=this.xs===!0&&"xs"||this.sm===!0&&"sm"||this.md===!0&&"md"||this.lg===!0&&"lg"||"xl",w!==this.name&&(o===!0&&(document.body.classList.remove(`screen--${this.name}`),document.body.classList.add(`screen--${w}`)),this.name=w)};let a,c={},u=16;this.setSizes=d=>{yb.forEach(p=>{d[p]!==void 0&&(c[p]=d[p])})},this.setDebounce=d=>{u=d};const h=()=>{const d=getComputedStyle(document.body);d.getPropertyValue("--q-size-sm")&&yb.forEach(p=>{this.sizes[p]=parseInt(d.getPropertyValue(`--q-size-${p}`),10)}),this.setSizes=p=>{yb.forEach(m=>{p[m]&&(this.sizes[m]=p[m])}),this.__update(!0)},this.setDebounce=p=>{a!==void 0&&s.removeEventListener("resize",a,tP),a=p>0?QM(this.__update,p):this.__update,s.addEventListener("resize",a,tP)},this.setDebounce(u),Object.keys(c).length!==0?(this.setSizes(c),c=void 0):this.__update(),o===!0&&this.name==="xs"&&document.body.classList.add("screen--xs")};el.value===!0?e.push(h):h()}}),es=jv({isActive:!1,mode:!1},{__media:void 0,set(t){es.mode=t,t==="auto"?(es.__media===void 0&&(es.__media=window.matchMedia("(prefers-color-scheme: dark)"),es.__updateMedia=()=>{es.set("auto")},es.__media.addListener(es.__updateMedia)),t=es.__media.matches):es.__media!==void 0&&(es.__media.removeListener(es.__updateMedia),es.__media=void 0),es.isActive=t===!0,document.body.classList.remove(`body--${t===!0?"light":"dark"}`),document.body.classList.add(`body--${t===!0?"dark":"light"}`)},toggle(){es.set(es.isActive===!1)},install({$q:t,ssrContext:e}){const n=t.config.dark;t.dark=this,this.__installed!==!0&&this.set(n!==void 0?n:!1)}});function Bz(t,e,n=document.body){if(typeof t!="string")throw new TypeError("Expected a string as propName");if(typeof e!="string")throw new TypeError("Expected a string as value");if(!(n instanceof Element))throw new TypeError("Expected a DOM element");n.style.setProperty(`--q-${t}`,e)}let YM=!1;function jz(t){YM=t.isComposing===!0}function XM(t){return YM===!0||t!==Object(t)||t.isComposing===!0||t.qKeyEvent===!0}function K_(t,e){return XM(t)===!0?!1:[].concat(e).includes(t.keyCode)}function JM(t){if(t.ios===!0)return"ios";if(t.android===!0)return"android"}function $z({is:t,has:e,within:n},s){const r=[t.desktop===!0?"desktop":"mobile",`${e.touch===!1?"no-":""}touch`];if(t.mobile===!0){const i=JM(t);i!==void 0&&r.push("platform-"+i)}if(t.nativeMobile===!0){const i=t.nativeMobileWrapper;r.push(i),r.push("native-mobile"),t.ios===!0&&(s[i]===void 0||s[i].iosStatusBarPadding!==!1)&&r.push("q-ios-padding")}else t.electron===!0?r.push("electron"):t.bex===!0&&r.push("bex");return n.iframe===!0&&r.push("within-iframe"),r}function zz(){const{is:t}=Qr,e=document.body.className,n=new Set(e.replace(/ {2}/g," ").split(" "));if(t.nativeMobile!==!0&&t.electron!==!0&&t.bex!==!0){if(t.desktop===!0)n.delete("mobile"),n.delete("platform-ios"),n.delete("platform-android"),n.add("desktop");else if(t.mobile===!0){n.delete("desktop"),n.add("mobile"),n.delete("platform-ios"),n.delete("platform-android");const r=JM(t);r!==void 0&&n.add(`platform-${r}`)}}Qr.has.touch===!0&&(n.delete("no-touch"),n.add("touch")),Qr.within.iframe===!0&&n.add("within-iframe");const s=Array.from(n).join(" ");e!==s&&(document.body.className=s)}function Hz(t){for(const e in t)Bz(e,t[e])}const Wz={install(t){if(this.__installed!==!0){if(el.value===!0)zz();else{const{$q:e}=t;e.config.brand!==void 0&&Hz(e.config.brand);const n=$z(Qr,e.config);document.body.classList.add.apply(document.body.classList,n)}Qr.is.ios===!0&&document.body.addEventListener("touchstart",hh),window.addEventListener("keydown",jz,!0)}}},ZM=()=>!0;function Kz(t){return typeof t=="string"&&t!==""&&t!=="/"&&t!=="#/"}function Gz(t){return t.startsWith("#")===!0&&(t=t.substring(1)),t.startsWith("/")===!1&&(t="/"+t),t.endsWith("/")===!0&&(t=t.substring(0,t.length-1)),"#"+t}function Qz(t){if(t.backButtonExit===!1)return()=>!1;if(t.backButtonExit==="*")return ZM;const e=["#/"];return Array.isArray(t.backButtonExit)===!0&&e.push(...t.backButtonExit.filter(Kz).map(Gz)),()=>e.includes(window.location.hash)}const eV={__history:[],add:hh,remove:hh,install({$q:t}){if(this.__installed===!0)return;const{cordova:e,capacitor:n}=Qr.is;if(e!==!0&&n!==!0)return;const s=t.config[e===!0?"cordova":"capacitor"];if(s?.backButton===!1||n===!0&&(window.Capacitor===void 0||window.Capacitor.Plugins.App===void 0))return;this.add=o=>{o.condition===void 0&&(o.condition=ZM),this.__history.push(o)},this.remove=o=>{const a=this.__history.indexOf(o);a>=0&&this.__history.splice(a,1)};const r=Qz(Object.assign({backButtonExit:!0},s)),i=()=>{if(this.__history.length){const o=this.__history[this.__history.length-1];o.condition()===!0&&(this.__history.pop(),o.handler())}else r()===!0?navigator.app.exitApp():window.history.back()};e===!0?document.addEventListener("deviceready",()=>{document.addEventListener("backbutton",i,!1)}):window.Capacitor.Plugins.App.addListener("backButton",i)}},nP={isoName:"en-US",nativeName:"English (US)",label:{clear:"Clear",ok:"OK",cancel:"Cancel",close:"Close",set:"Set",select:"Select",reset:"Reset",remove:"Remove",update:"Update",create:"Create",search:"Search",filter:"Filter",refresh:"Refresh",expand:t=>t?`Expand "${t}"`:"Expand",collapse:t=>t?`Collapse "${t}"`:"Collapse"},date:{days:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),daysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),firstDayOfWeek:0,format24h:!1,pluralDay:"days",prevMonth:"Previous month",nextMonth:"Next month",prevYear:"Previous year",nextYear:"Next year",today:"Today",prevRangeYears:t=>`Previous ${t} years`,nextRangeYears:t=>`Next ${t} years`},table:{noData:"No data available",noResults:"No matching records found",loading:"Loading...",selectedRecords:t=>t===1?"1 record selected.":(t===0?"No":t)+" records selected.",recordsPerPage:"Records per page:",allRows:"All",pagination:(t,e,n)=>t+"-"+e+" of "+n,columns:"Columns"},pagination:{first:"First page",prev:"Previous page",next:"Next page",last:"Last page"},editor:{url:"URL",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",unorderedList:"Unordered List",orderedList:"Ordered List",subscript:"Subscript",superscript:"Superscript",hyperlink:"Hyperlink",toggleFullscreen:"Toggle Fullscreen",quote:"Quote",left:"Left align",center:"Center align",right:"Right align",justify:"Justify align",print:"Print",outdent:"Decrease indentation",indent:"Increase indentation",removeFormat:"Remove formatting",formatting:"Formatting",fontSize:"Font Size",align:"Align",hr:"Insert Horizontal Rule",undo:"Undo",redo:"Redo",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",heading4:"Heading 4",heading5:"Heading 5",heading6:"Heading 6",paragraph:"Paragraph",code:"Code",size1:"Very small",size2:"A bit small",size3:"Normal",size4:"Medium-large",size5:"Big",size6:"Very big",size7:"Maximum",defaultFont:"Default Font",viewSource:"View Source"},tree:{noNodes:"No nodes available",noResults:"No matching nodes found"}};function sP(){const t=Array.isArray(navigator.languages)===!0&&navigator.languages.length!==0?navigator.languages[0]:navigator.language;if(typeof t=="string")return t.split(/[-_]/).map((e,n)=>n===0?e.toLowerCase():n>1||e.length<4?e.toUpperCase():e[0].toUpperCase()+e.slice(1).toLowerCase()).join("-")}const Ea=jv({__qLang:{}},{getLocale:sP,set(t=nP,e){const n={...t,rtl:t.rtl===!0,getLocale:sP};{if(n.set=Ea.set,Ea.__langConfig===void 0||Ea.__langConfig.noHtmlAttrs!==!0){const s=document.documentElement;s.setAttribute("dir",n.rtl===!0?"rtl":"ltr"),s.setAttribute("lang",n.isoName)}Object.assign(Ea.__qLang,n)}},install({$q:t,lang:e,ssrContext:n}){t.lang=Ea.__qLang,Ea.__langConfig=t.config.lang,this.__installed===!0?e!==void 0&&this.set(e):(this.props=new Proxy(this.__qLang,{get(){return Reflect.get(...arguments)},ownKeys(s){return Reflect.ownKeys(s).filter(r=>r!=="set"&&r!=="getLocale")}}),this.set(e||nP))}}),Yz={name:"material-icons",type:{positive:"check_circle",negative:"warning",info:"info",warning:"priority_high"},arrow:{up:"arrow_upward",right:"arrow_forward",down:"arrow_downward",left:"arrow_back",dropdown:"arrow_drop_down"},chevron:{left:"chevron_left",right:"chevron_right"},colorPicker:{spectrum:"gradient",tune:"tune",palette:"style"},pullToRefresh:{icon:"refresh"},carousel:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down",navigationIcon:"lens"},chip:{remove:"cancel",selected:"check"},datetime:{arrowLeft:"chevron_left",arrowRight:"chevron_right",now:"access_time",today:"today"},editor:{bold:"format_bold",italic:"format_italic",strikethrough:"strikethrough_s",underline:"format_underlined",unorderedList:"format_list_bulleted",orderedList:"format_list_numbered",subscript:"vertical_align_bottom",superscript:"vertical_align_top",hyperlink:"link",toggleFullscreen:"fullscreen",quote:"format_quote",left:"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify",print:"print",outdent:"format_indent_decrease",indent:"format_indent_increase",removeFormat:"format_clear",formatting:"text_format",fontSize:"format_size",align:"format_align_left",hr:"remove",undo:"undo",redo:"redo",heading:"format_size",code:"code",size:"format_size",font:"font_download",viewSource:"code"},expansionItem:{icon:"keyboard_arrow_down",denseIcon:"arrow_drop_down"},fab:{icon:"add",activeIcon:"close"},field:{clear:"cancel",error:"error"},pagination:{first:"first_page",prev:"keyboard_arrow_left",next:"keyboard_arrow_right",last:"last_page"},rating:{icon:"grade"},stepper:{done:"check",active:"edit",error:"warning"},tabs:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down"},table:{arrowUp:"arrow_upward",warning:"warning",firstPage:"first_page",prevPage:"chevron_left",nextPage:"chevron_right",lastPage:"last_page"},tree:{icon:"play_arrow"},uploader:{done:"done",clear:"clear",add:"add_box",upload:"cloud_upload",removeQueue:"clear_all",removeUploaded:"done_all"}},G_=jv({iconMapFn:null,__qIconSet:{}},{set(t,e){const n={...t};n.set=G_.set,Object.assign(G_.__qIconSet,n)},install({$q:t,iconSet:e,ssrContext:n}){t.config.iconMapFn!==void 0&&(this.iconMapFn=t.config.iconMapFn),t.iconSet=this.__qIconSet,Lg(t,"iconMapFn",()=>this.iconMapFn,s=>{this.iconMapFn=s}),this.__installed===!0?e!==void 0&&this.set(e):(this.props=new Proxy(this.__qIconSet,{get(){return Reflect.get(...arguments)},ownKeys(s){return Reflect.ownKeys(s).filter(r=>r!=="set")}}),this.set(e||Yz))}}),tV="_q_",Xz="_q_l_",Jz="_q_pc_",Zz="_q_fo_";function eH(){}const Q_={};let nV=!1;function tH(){nV=!0}function t_(t,e){if(t===e)return!0;if(t!==null&&e!==null&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let n,s;if(t.constructor===Array){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(t_(t[s],e[s])!==!0)return!1;return!0}if(t.constructor===Map){if(t.size!==e.size)return!1;let i=t.entries();for(s=i.next();s.done!==!0;){if(e.has(s.value[0])!==!0)return!1;s=i.next()}for(i=t.entries(),s=i.next();s.done!==!0;){if(t_(s.value[1],e.get(s.value[0]))!==!0)return!1;s=i.next()}return!0}if(t.constructor===Set){if(t.size!==e.size)return!1;const i=t.entries();for(s=i.next();s.done!==!0;){if(e.has(s.value[0])!==!0)return!1;s=i.next()}return!0}if(t.buffer!=null&&t.buffer.constructor===ArrayBuffer){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(t[s]!==e[s])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const r=Object.keys(t).filter(i=>t[i]!==void 0);if(n=r.length,n!==Object.keys(e).filter(i=>e[i]!==void 0).length)return!1;for(s=n;s--!==0;){const i=r[s];if(t_(t[i],e[i])!==!0)return!1}return!0}return t!==t&&e!==e}function dh(t){return t!==null&&typeof t=="object"&&Array.isArray(t)!==!0}function nH(t){return Object.prototype.toString.call(t)==="[object Date]"}function sH(t){return typeof t=="number"&&isFinite(t)}const rP=[H_,Wz,es,qz,eV,Ea,G_];function rH(t,e){const n=$M(t);n.config.globalProperties=e.config.globalProperties;const{reload:s,...r}=e._context;return Object.assign(n._context,r),n}function iP(t,e){e.forEach(n=>{n.install(t),n.__installed=!0})}function iH(t,e,n){t.config.globalProperties.$q=n.$q,t.provide(tV,n.$q),iP(n,rP),e.components!==void 0&&Object.values(e.components).forEach(s=>{dh(s)===!0&&s.name!==void 0&&t.component(s.name,s)}),e.directives!==void 0&&Object.values(e.directives).forEach(s=>{dh(s)===!0&&s.name!==void 0&&t.directive(s.name,s)}),e.plugins!==void 0&&iP(n,Object.values(e.plugins).filter(s=>typeof s.install=="function"&&rP.includes(s)===!1)),el.value===!0&&(n.$q.onSSRHydrated=()=>{n.onSSRHydrated.forEach(s=>{s()}),n.$q.onSSRHydrated=()=>{}})}const oH=function(t,e={}){const n={version:"2.18.2"};nV===!1?(e.config!==void 0&&Object.assign(Q_,e.config),n.config={...Q_},tH()):n.config=e.config||{},iH(t,e,{parentApp:t,$q:n,lang:e.lang,iconSet:e.iconSet,onSSRHydrated:[]})},aH={name:"Quasar",version:"2.18.2",install:oH,lang:Ea,iconSet:G_};/*!
* vue-router v4.5.1
* (c) 2025 Eduardo San Martin Morote
* @license MIT
*/const Su=typeof document<"u";function sV(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function lH(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&sV(t.default)}const _t=Object.assign;function vb(t,e){const n={};for(const s in e){const r=e[s];n[s]=ai(r)?r.map(t):t(r)}return n}const Wf=()=>{},ai=Array.isArray,rV=/#/g,cH=/&/g,uH=/\//g,hH=/=/g,dH=/\?/g,iV=/\+/g,fH=/%5B/g,pH=/%5D/g,oV=/%5E/g,gH=/%60/g,aV=/%7B/g,mH=/%7C/g,lV=/%7D/g,_H=/%20/g;function SS(t){return encodeURI(""+t).replace(mH,"|").replace(fH,"[").replace(pH,"]")}function yH(t){return SS(t).replace(aV,"{").replace(lV,"}").replace(oV,"^")}function GT(t){return SS(t).replace(iV,"%2B").replace(_H,"+").replace(rV,"%23").replace(cH,"%26").replace(gH,"`").replace(aV,"{").replace(lV,"}").replace(oV,"^")}function vH(t){return GT(t).replace(hH,"%3D")}function wH(t){return SS(t).replace(rV,"%23").replace(dH,"%3F")}function EH(t){return t==null?"":wH(t).replace(uH,"%2F")}function Lp(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const bH=/\/$/,TH=t=>t.replace(bH,"");function wb(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("#");let c=e.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(s=e.slice(0,c),i=e.slice(c+1,a>-1?a:e.length),r=t(i)),a>-1&&(s=s||e.slice(0,a),o=e.slice(a,e.length)),s=RH(s??e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:Lp(o)}}function CH(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function oP(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function IH(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&fh(e.matched[s],n.matched[r])&&cV(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function fh(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function cV(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!SH(t[n],e[n]))return!1;return!0}function SH(t,e){return ai(t)?aP(t,e):ai(e)?aP(e,t):t===e}function aP(t,e){return ai(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function RH(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/"),r=s[s.length-1];(r===".."||r===".")&&s.push("");let i=n.length-1,o,a;for(o=0;o<s.length;o++)if(a=s[o],a!==".")if(a==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+s.slice(o).join("/")}const ua={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Mp;(function(t){t.pop="pop",t.push="push"})(Mp||(Mp={}));var Kf;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Kf||(Kf={}));function AH(t){if(!t)if(Su){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),TH(t)}const kH=/^[^#]+#/;function PH(t,e){return t.replace(kH,"#")+e}function NH(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const $v=()=>({left:window.scrollX,top:window.scrollY});function xH(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=NH(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function lP(t,e){return(history.state?history.state.position-e:-1)+t}const QT=new Map;function DH(t,e){QT.set(t,e)}function OH(t){const e=QT.get(t);return QT.delete(t),e}let LH=()=>location.protocol+"//"+location.host;function uV(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let o=r.includes(t.slice(i))?t.slice(i).length:1,a=r.slice(o);return a[0]!=="/"&&(a="/"+a),oP(a,"")}return oP(n,t)+s+r}function MH(t,e,n,s){let r=[],i=[],o=null;const a=({state:p})=>{const m=uV(t,location),w=n.value,R=e.value;let k=0;if(p){if(n.value=m,e.value=p,o&&o===w){o=null;return}k=R?p.position-R.position:0}else s(m);r.forEach(O=>{O(n.value,w,{delta:k,type:Mp.pop,direction:k?k>0?Kf.forward:Kf.back:Kf.unknown})})};function c(){o=n.value}function u(p){r.push(p);const m=()=>{const w=r.indexOf(p);w>-1&&r.splice(w,1)};return i.push(m),m}function h(){const{history:p}=window;p.state&&p.replaceState(_t({},p.state,{scroll:$v()}),"")}function d(){for(const p of i)p();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",h,{passive:!0}),{pauseListeners:c,listen:u,destroy:d}}function cP(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?$v():null}}function VH(t){const{history:e,location:n}=window,s={value:uV(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,h){const d=t.indexOf("#"),p=d>-1?(n.host&&document.querySelector("base")?t:t.slice(d))+c:LH()+t+c;try{e[h?"replaceState":"pushState"](u,"",p),r.value=u}catch(m){console.error(m),n[h?"replace":"assign"](p)}}function o(c,u){const h=_t({},e.state,cP(r.value.back,c,r.value.forward,!0),u,{position:r.value.position});i(c,h,!0),s.value=c}function a(c,u){const h=_t({},r.value,e.state,{forward:c,scroll:$v()});i(h.current,h,!0);const d=_t({},cP(s.value,c,null),{position:h.position+1},u);i(c,d,!1),s.value=c}return{location:s,state:r,push:a,replace:o}}function FH(t){t=AH(t);const e=VH(t),n=MH(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=_t({location:"",base:t,go:s,createHref:PH.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function UH(t){return typeof t=="string"||t&&typeof t=="object"}function hV(t){return typeof t=="string"||typeof t=="symbol"}const dV=Symbol("");var uP;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(uP||(uP={}));function ph(t,e){return _t(new Error,{type:t,[dV]:!0},e)}function mo(t,e){return t instanceof Error&&dV in t&&(e==null||!!(t.type&e))}const hP="[^/]+?",qH={sensitive:!1,strict:!1,start:!0,end:!0},BH=/[.+*?^${}()[\]/\\]/g;function jH(t,e){const n=_t({},qH,e),s=[];let r=n.start?"^":"";const i=[];for(const u of t){const h=u.length?[]:[90];n.strict&&!u.length&&(r+="/");for(let d=0;d<u.length;d++){const p=u[d];let m=40+(n.sensitive?.25:0);if(p.type===0)d||(r+="/"),r+=p.value.replace(BH,"\\$&"),m+=40;else if(p.type===1){const{value:w,repeatable:R,optional:k,regexp:O}=p;i.push({name:w,repeatable:R,optional:k});const M=O||hP;if(M!==hP){m+=10;try{new RegExp(`(${M})`)}catch(q){throw new Error(`Invalid custom RegExp for param "${w}" (${M}): `+q.message)}}let F=R?`((?:${M})(?:/(?:${M}))*)`:`(${M})`;d||(F=k&&u.length<2?`(?:/${F})`:"/"+F),k&&(F+="?"),r+=F,m+=20,k&&(m+=-8),R&&(m+=-20),M===".*"&&(m+=-50)}h.push(m)}s.push(h)}if(n.strict&&n.end){const u=s.length-1;s[u][s[u].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(u){const h=u.match(o),d={};if(!h)return null;for(let p=1;p<h.length;p++){const m=h[p]||"",w=i[p-1];d[w.name]=m&&w.repeatable?m.split("/"):m}return d}function c(u){let h="",d=!1;for(const p of t){(!d||!h.endsWith("/"))&&(h+="/"),d=!1;for(const m of p)if(m.type===0)h+=m.value;else if(m.type===1){const{value:w,repeatable:R,optional:k}=m,O=w in u?u[w]:"";if(ai(O)&&!R)throw new Error(`Provided param "${w}" is an array but it is not repeatable (* or + modifiers)`);const M=ai(O)?O.join("/"):O;if(!M)if(k)p.length<2&&(h.endsWith("/")?h=h.slice(0,-1):d=!0);else throw new Error(`Missing required param "${w}"`);h+=M}}return h||"/"}return{re:o,score:s,keys:i,parse:a,stringify:c}}function $H(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function fV(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=$H(s[n],r[n]);if(i)return i;n++}if(Math.abs(r.length-s.length)===1){if(dP(s))return 1;if(dP(r))return-1}return r.length-s.length}function dP(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const zH={type:0,value:""},HH=/[a-zA-Z0-9_]/;function WH(t){if(!t)return[[]];if(t==="/")return[[zH]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(m){throw new Error(`ERR (${n})/"${u}": ${m}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,c,u="",h="";function d(){u&&(n===0?i.push({type:0,value:u}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:h,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function p(){u+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:c==="/"?(u&&d(),o()):c===":"?(d(),n=1):p();break;case 4:p(),n=s;break;case 1:c==="("?n=2:HH.test(c)?p():(d(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+c:n=3:h+=c;break;case 3:d(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,h="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),d(),o(),r}function KH(t,e,n){const s=jH(WH(t.path),n),r=_t(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function GH(t,e){const n=[],s=new Map;e=mP({strict:!1,end:!0,sensitive:!1},e);function r(d){return s.get(d)}function i(d,p,m){const w=!m,R=pP(d);R.aliasOf=m&&m.record;const k=mP(e,d),O=[R];if("alias"in d){const q=typeof d.alias=="string"?[d.alias]:d.alias;for(const H of q)O.push(pP(_t({},R,{components:m?m.record.components:R.components,path:H,aliasOf:m?m.record:R})))}let M,F;for(const q of O){const{path:H}=q;if(p&&H[0]!=="/"){const J=p.record.path,I=J[J.length-1]==="/"?"":"/";q.path=p.record.path+(H&&I+H)}if(M=KH(q,p,k),m?m.alias.push(M):(F=F||M,F!==M&&F.alias.push(M),w&&d.name&&!gP(M)&&o(d.name)),pV(M)&&c(M),R.children){const J=R.children;for(let I=0;I<J.length;I++)i(J[I],M,m&&m.children[I])}m=m||M}return F?()=>{o(F)}:Wf}function o(d){if(hV(d)){const p=s.get(d);p&&(s.delete(d),n.splice(n.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=n.indexOf(d);p>-1&&(n.splice(p,1),d.record.name&&s.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return n}function c(d){const p=XH(d,n);n.splice(p,0,d),d.record.name&&!gP(d)&&s.set(d.record.name,d)}function u(d,p){let m,w={},R,k;if("name"in d&&d.name){if(m=s.get(d.name),!m)throw ph(1,{location:d});k=m.record.name,w=_t(fP(p.params,m.keys.filter(F=>!F.optional).concat(m.parent?m.parent.keys.filter(F=>F.optional):[]).map(F=>F.name)),d.params&&fP(d.params,m.keys.map(F=>F.name))),R=m.stringify(w)}else if(d.path!=null)R=d.path,m=n.find(F=>F.re.test(R)),m&&(w=m.parse(R),k=m.record.name);else{if(m=p.name?s.get(p.name):n.find(F=>F.re.test(p.path)),!m)throw ph(1,{location:d,currentLocation:p});k=m.record.name,w=_t({},p.params,d.params),R=m.stringify(w)}const O=[];let M=m;for(;M;)O.unshift(M.record),M=M.parent;return{name:k,path:R,params:w,matched:O,meta:YH(O)}}t.forEach(d=>i(d));function h(){n.length=0,s.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:h,getRoutes:a,getRecordMatcher:r}}function fP(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function pP(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:QH(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function QH(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="object"?n[s]:n;return e}function gP(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function YH(t){return t.reduce((e,n)=>_t(e,n.meta),{})}function mP(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function XH(t,e){let n=0,s=e.length;for(;n!==s;){const i=n+s>>1;fV(t,e[i])<0?s=i:n=i+1}const r=JH(t);return r&&(s=e.lastIndexOf(r,s-1)),s}function JH(t){let e=t;for(;e=e.parent;)if(pV(e)&&fV(t,e)===0)return e}function pV({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function ZH(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const r=n[s].replace(iV," "),i=r.indexOf("="),o=Lp(i<0?r:r.slice(0,i)),a=i<0?null:Lp(r.slice(i+1));if(o in e){let c=e[o];ai(c)||(c=e[o]=[c]),c.push(a)}else e[o]=a}return e}function _P(t){let e="";for(let n in t){const s=t[n];if(n=vH(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(ai(s)?s.map(r=>r&&GT(r)):[s&&GT(s)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+n,r!=null&&(e+="="+r))})}return e}function eW(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=ai(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}const tW=Symbol(""),yP=Symbol(""),zv=Symbol(""),RS=Symbol(""),YT=Symbol("");function sf(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function ba(t,e,n,s,r,i=o=>o()){const o=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((a,c)=>{const u=p=>{p===!1?c(ph(4,{from:n,to:e})):p instanceof Error?c(p):UH(p)?c(ph(2,{from:e,to:p})):(o&&s.enterCallbacks[r]===o&&typeof p=="function"&&o.push(p),a())},h=i(()=>t.call(s&&s.instances[r],e,n,u));let d=Promise.resolve(h);t.length<3&&(d=d.then(u)),d.catch(p=>c(p))})}function Eb(t,e,n,s,r=i=>i()){const i=[];for(const o of t)for(const a in o.components){let c=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(sV(c)){const u=(c.__vccOpts||c)[e];u&&i.push(ba(u,n,s,o,a,r))}else{let u=c();i.push(()=>u.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=lH(h)?h.default:h;o.mods[a]=h,o.components[a]=d;const p=(d.__vccOpts||d)[e];return p&&ba(p,n,s,o,a,r)()}))}}return i}function vP(t){const e=or(zv),n=or(RS),s=be(()=>{const c=Ma(t.to);return e.resolve(c)}),r=be(()=>{const{matched:c}=s.value,{length:u}=c,h=c[u-1],d=n.matched;if(!h||!d.length)return-1;const p=d.findIndex(fh.bind(null,h));if(p>-1)return p;const m=wP(c[u-2]);return u>1&&wP(h)===m&&d[d.length-1].path!==m?d.findIndex(fh.bind(null,c[u-2])):p}),i=be(()=>r.value>-1&&oW(n.params,s.value.params)),o=be(()=>r.value>-1&&r.value===n.matched.length-1&&cV(n.params,s.value.params));function a(c={}){if(iW(c)){const u=e[Ma(t.replace)?"replace":"push"](Ma(t.to)).catch(Wf);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:s,href:be(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}function nW(t){return t.length===1?t[0]:t}const sW=Dg({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:vP,setup(t,{slots:e}){const n=su(vP(t)),{options:s}=or(zv),r=be(()=>({[EP(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[EP(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&nW(e.default(n));return t.custom?i:Oe("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),rW=sW;function iW(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function oW(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!ai(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function wP(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const EP=(t,e,n)=>t??e??n,aW=Dg({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=or(YT),r=be(()=>t.route||s.value),i=or(yP,0),o=be(()=>{let u=Ma(i);const{matched:h}=r.value;let d;for(;(d=h[u])&&!d.components;)u++;return u}),a=be(()=>r.value.matched[o.value]);zf(yP,be(()=>o.value+1)),zf(tW,a),zf(YT,r);const c=jo();return Hu(()=>[c.value,a.value,t.name],([u,h,d],[p,m,w])=>{h&&(h.instances[d]=u,m&&m!==h&&u&&u===p&&(h.leaveGuards.size||(h.leaveGuards=m.leaveGuards),h.updateGuards.size||(h.updateGuards=m.updateGuards))),u&&h&&(!m||!fh(h,m)||!p)&&(h.enterCallbacks[d]||[]).forEach(R=>R(u))},{flush:"post"}),()=>{const u=r.value,h=t.name,d=a.value,p=d&&d.components[h];if(!p)return bP(n.default,{Component:p,route:u});const m=d.props[h],w=m?m===!0?u.params:typeof m=="function"?m(u):m:null,R=Oe(p,_t({},w,e,{onVnodeUnmounted:k=>{k.component.isUnmounted&&(d.instances[h]=null)},ref:c}));return bP(n.default,{Component:R,route:u})||R}}});function bP(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const lW=aW;function cW(t){const e=GH(t.routes,t),n=t.parseQuery||ZH,s=t.stringifyQuery||_P,r=t.history,i=sf(),o=sf(),a=sf(),c=O$(ua);let u=ua;Su&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=vb.bind(null,V=>""+V),d=vb.bind(null,EH),p=vb.bind(null,Lp);function m(V,Y){let Q,ee;return hV(V)?(Q=e.getRecordMatcher(V),ee=Y):ee=V,e.addRoute(ee,Q)}function w(V){const Y=e.getRecordMatcher(V);Y&&e.removeRoute(Y)}function R(){return e.getRoutes().map(V=>V.record)}function k(V){return!!e.getRecordMatcher(V)}function O(V,Y){if(Y=_t({},Y||c.value),typeof V=="string"){const N=wb(n,V,Y.path),L=e.resolve({path:N.path},Y),U=r.createHref(N.fullPath);return _t(N,L,{params:p(L.params),hash:Lp(N.hash),redirectedFrom:void 0,href:U})}let Q;if(V.path!=null)Q=_t({},V,{path:wb(n,V.path,Y.path).path});else{const N=_t({},V.params);for(const L in N)N[L]==null&&delete N[L];Q=_t({},V,{params:d(N)}),Y.params=d(Y.params)}const ee=e.resolve(Q,Y),x=V.hash||"";ee.params=h(p(ee.params));const b=CH(s,_t({},V,{hash:yH(x),path:ee.path})),A=r.createHref(b);return _t({fullPath:b,hash:x,query:s===_P?eW(V.query):V.query||{}},ee,{redirectedFrom:void 0,href:A})}function M(V){return typeof V=="string"?wb(n,V,c.value.path):_t({},V)}function F(V,Y){if(u!==V)return ph(8,{from:Y,to:V})}function q(V){return I(V)}function H(V){return q(_t(M(V),{replace:!0}))}function J(V){const Y=V.matched[V.matched.length-1];if(Y&&Y.redirect){const{redirect:Q}=Y;let ee=typeof Q=="function"?Q(V):Q;return typeof ee=="string"&&(ee=ee.includes("?")||ee.includes("#")?ee=M(ee):{path:ee},ee.params={}),_t({query:V.query,hash:V.hash,params:ee.path!=null?{}:V.params},ee)}}function I(V,Y){const Q=u=O(V),ee=c.value,x=V.state,b=V.force,A=V.replace===!0,N=J(Q);if(N)return I(_t(M(N),{state:typeof N=="object"?_t({},x,N.state):x,force:b,replace:A}),Y||Q);const L=Q;L.redirectedFrom=Y;let U;return!b&&IH(s,ee,Q)&&(U=ph(16,{to:L,from:ee}),Wt(ee,ee,!0,!1)),(U?Promise.resolve(U):C(L,ee)).catch(B=>mo(B)?mo(B,2)?B:Ht(B):ve(B,L,ee)).then(B=>{if(B){if(mo(B,2))return I(_t({replace:A},M(B.to),{state:typeof B.to=="object"?_t({},x,B.to.state):x,force:b}),Y||L)}else B=T(L,ee,!0,A,x);return S(L,ee,B),B})}function v(V,Y){const Q=F(V,Y);return Q?Promise.reject(Q):Promise.resolve()}function y(V){const Y=Bn.values().next().value;return Y&&typeof Y.runWithContext=="function"?Y.runWithContext(V):V()}function C(V,Y){let Q;const[ee,x,b]=uW(V,Y);Q=Eb(ee.reverse(),"beforeRouteLeave",V,Y);for(const N of ee)N.leaveGuards.forEach(L=>{Q.push(ba(L,V,Y))});const A=v.bind(null,V,Y);return Q.push(A),Tt(Q).then(()=>{Q=[];for(const N of i.list())Q.push(ba(N,V,Y));return Q.push(A),Tt(Q)}).then(()=>{Q=Eb(x,"beforeRouteUpdate",V,Y);for(const N of x)N.updateGuards.forEach(L=>{Q.push(ba(L,V,Y))});return Q.push(A),Tt(Q)}).then(()=>{Q=[];for(const N of b)if(N.beforeEnter)if(ai(N.beforeEnter))for(const L of N.beforeEnter)Q.push(ba(L,V,Y));else Q.push(ba(N.beforeEnter,V,Y));return Q.push(A),Tt(Q)}).then(()=>(V.matched.forEach(N=>N.enterCallbacks={}),Q=Eb(b,"beforeRouteEnter",V,Y,y),Q.push(A),Tt(Q))).then(()=>{Q=[];for(const N of o.list())Q.push(ba(N,V,Y));return Q.push(A),Tt(Q)}).catch(N=>mo(N,8)?N:Promise.reject(N))}function S(V,Y,Q){a.list().forEach(ee=>y(()=>ee(V,Y,Q)))}function T(V,Y,Q,ee,x){const b=F(V,Y);if(b)return b;const A=Y===ua,N=Su?history.state:{};Q&&(ee||A?r.replace(V.fullPath,_t({scroll:A&&N&&N.scroll},x)):r.push(V.fullPath,x)),c.value=V,Wt(V,Y,Q,A),Ht()}let E;function K(){E||(E=r.listen((V,Y,Q)=>{if(!hn.listening)return;const ee=O(V),x=J(ee);if(x){I(_t(x,{replace:!0,force:!0}),ee).catch(Wf);return}u=ee;const b=c.value;Su&&DH(lP(b.fullPath,Q.delta),$v()),C(ee,b).catch(A=>mo(A,12)?A:mo(A,2)?(I(_t(M(A.to),{force:!0}),ee).then(N=>{mo(N,20)&&!Q.delta&&Q.type===Mp.pop&&r.go(-1,!1)}).catch(Wf),Promise.reject()):(Q.delta&&r.go(-Q.delta,!1),ve(A,ee,b))).then(A=>{A=A||T(ee,b,!1),A&&(Q.delta&&!mo(A,8)?r.go(-Q.delta,!1):Q.type===Mp.pop&&mo(A,20)&&r.go(-1,!1)),S(ee,b,A)}).catch(Wf)}))}let oe=sf(),ge=sf(),de;function ve(V,Y,Q){Ht(V);const ee=ge.list();return ee.length?ee.forEach(x=>x(V,Y,Q)):console.error(V),Promise.reject(V)}function Kt(){return de&&c.value!==ua?Promise.resolve():new Promise((V,Y)=>{oe.add([V,Y])})}function Ht(V){return de||(de=!V,K(),oe.list().forEach(([Y,Q])=>V?Q(V):Y()),oe.reset()),V}function Wt(V,Y,Q,ee){const{scrollBehavior:x}=t;if(!Su||!x)return Promise.resolve();const b=!Q&&OH(lP(V.fullPath,0))||(ee||!Q)&&history.state&&history.state.scroll||null;return pS().then(()=>x(V,Y,b)).then(A=>A&&xH(A)).catch(A=>ve(A,V,Y))}const Fe=V=>r.go(V);let De;const Bn=new Set,hn={currentRoute:c,listening:!0,addRoute:m,removeRoute:w,clearRoutes:e.clearRoutes,hasRoute:k,getRoutes:R,resolve:O,options:t,push:q,replace:H,go:Fe,back:()=>Fe(-1),forward:()=>Fe(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:ge.add,isReady:Kt,install(V){const Y=this;V.component("RouterLink",rW),V.component("RouterView",lW),V.config.globalProperties.$router=Y,Object.defineProperty(V.config.globalProperties,"$route",{enumerable:!0,get:()=>Ma(c)}),Su&&!De&&c.value===ua&&(De=!0,q(r.location).catch(x=>{}));const Q={};for(const x in ua)Object.defineProperty(Q,x,{get:()=>c.value[x],enumerable:!0});V.provide(zv,Y),V.provide(RS,hS(Q)),V.provide(YT,c);const ee=V.unmount;Bn.add(V),V.unmount=function(){Bn.delete(V),Bn.size<1&&(u=ua,E&&E(),E=null,c.value=ua,De=!1,de=!1),ee()}}};function Tt(V){return V.reduce((Y,Q)=>Y.then(()=>y(Q)),Promise.resolve())}return hn}function uW(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(u=>fh(u,a))?s.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(u=>fh(u,c))||r.push(c))}return[n,s,r]}function gV(){return or(zv)}function mV(t){return or(RS)}const hW=()=>{};var TP={};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const _V={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ue=function(t,e){if(!t)throw jh(e)},jh=function(t){return new Error("Firebase Database ("+_V.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const yV=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},dW=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},AS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,h=i>>2,d=(i&3)<<4|a>>4;let p=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(p=64)),s.push(n[h],n[d],n[p],n[m])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(yV(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):dW(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],o=r<t.length?n[t.charAt(r)]:0;++r;const a=r<t.length?n[t.charAt(r)]:64;++r;const c=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||o==null||a==null||c==null)throw new fW;const u=i<<2|o>>4;if(s.push(u),a!==64){const h=o<<4&240|a>>2;if(s.push(h),c!==64){const d=a<<6&192|c;s.push(d)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class fW extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vV=function(t){const e=yV(t);return AS.encodeByteArray(e,!0)},Y_=function(t){return vV(t).replace(/\./g,"")},X_=function(t){try{return AS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function pW(t){return wV(void 0,t)}function wV(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!gW(n)||(t[n]=wV(t[n],e[n]));return t}function gW(t){return t!=="__proto__"}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function mW(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const _W=()=>mW().__FIREBASE_DEFAULTS__,yW=()=>{if(typeof process>"u"||typeof TP>"u")return;const t=TP.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},vW=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&X_(t[1]);return e&&JSON.parse(e)},Hv=()=>{try{return hW()||_W()||yW()||vW()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},EV=t=>Hv()?.emulatorHosts?.[t],kS=t=>{const e=EV(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},bV=()=>Hv()?.config,TV=t=>Hv()?.[`_${t}`];/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Wv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
* @license
* Copyright 2025 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Gi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Kv(t){return(await fetch(t,{credentials:"include"})).ok}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function PS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Y_(JSON.stringify(n)),Y_(JSON.stringify(o)),""].join(".")}const Gf={};function wW(){const t={prod:[],emulator:[]};for(const e of Object.keys(Gf))Gf[e]?t.emulator.push(e):t.prod.push(e);return t}function EW(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let CP=!1;function Gv(t,e){if(typeof window>"u"||typeof document>"u"||!Gi(window.location.host)||Gf[t]===e||Gf[t]||CP)return;Gf[t]=e;function n(d){return`__firebase__banner__${d}`}const s="__firebase__banner",r=wW().prod.length>0;function i(){const d=document.getElementById(s);d&&d.remove()}function o(d){d.style.display="flex",d.style.background="#7faaf0",d.style.position="fixed",d.style.bottom="5px",d.style.left="5px",d.style.padding=".5em",d.style.borderRadius="5px",d.style.alignItems="center"}function a(d,p){d.setAttribute("width","24"),d.setAttribute("id",p),d.setAttribute("height","24"),d.setAttribute("viewBox","0 0 24 24"),d.setAttribute("fill","none"),d.style.marginLeft="-6px"}function c(){const d=document.createElement("span");return d.style.cursor="pointer",d.style.marginLeft="16px",d.style.fontSize="24px",d.innerHTML=" &times;",d.onclick=()=>{CP=!0,i()},d}function u(d,p){d.setAttribute("id",p),d.innerText="Learn more",d.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",d.setAttribute("target","__blank"),d.style.paddingLeft="5px",d.style.textDecoration="underline"}function h(){const d=EW(s),p=n("text"),m=document.getElementById(p)||document.createElement("span"),w=n("learnmore"),R=document.getElementById(w)||document.createElement("a"),k=n("preprendIcon"),O=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){const M=d.element;o(M),u(R,w);const F=c();a(O,k),M.append(O,m,R,F),document.body.appendChild(M)}r?(m.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function _s(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_s())}function bW(){const t=Hv()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function TW(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CW(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function CV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function IW(){const t=_s();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function SW(){return _V.NODE_ADMIN===!0}function RW(){return!bW()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function AW(){try{return typeof indexedDB=="object"}catch{return!1}}function kW(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(n){e(n)}})}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const PW="FirebaseError";class Qi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=PW,Object.setPrototypeOf(this,Qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mg.prototype.create)}}class Mg{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?NW(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Qi(r,a,s)}}function NW(t,e){return t.replace(xW,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const xW=/\{\$([^}]+)}/g;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Vp(t){return JSON.parse(t)}function In(t){return JSON.stringify(t)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const IV=function(t){let e={},n={},s={},r="";try{const i=t.split(".");e=Vp(X_(i[0])||""),n=Vp(X_(i[1])||""),r=i[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:r}},DW=function(t){const e=IV(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},OW=function(t){const e=IV(t).claims;return typeof e=="object"&&e.admin===!0};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ra(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function gh(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function XT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function J_(t,e,n){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=e.call(n,t[r],r,t));return s}function nl(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(IP(i)&&IP(o)){if(!nl(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function IP(t){return t!==null&&typeof t=="object"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function $h(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class LW{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)s[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)s[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){const p=s[d-3]^s[d-8]^s[d-14]^s[d-16];s[d]=(p<<1|p>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],u,h;for(let d=0;d<80;d++){d<40?d<20?(u=a^i&(o^a),h=1518500249):(u=i^o^a,h=1859775393):d<60?(u=i&o|a&(i|o),h=2400959708):(u=i^o^a,h=3395469782);const p=(r<<5|r>>>27)+u+c+h+s[d]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=p}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<n;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function MW(t,e){const n=new VW(t,e);return n.subscribe.bind(n)}class VW{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");FW(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=bb),r.error===void 0&&(r.error=bb),r.complete===void 0&&(r.complete=bb);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FW(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function bb(){}function xS(t,e){return`${t} failed: ${e} argument `}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const UW=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,ue(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Qv=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function It(t){return t&&t._delegate?t._delegate:t}class $o{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ac="[DEFAULT]";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qW{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Wv;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jW(e))try{this.getOrInitializeService({instanceIdentifier:ac})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=ac){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ac){return this.instances.has(e)}getOptions(e=ac){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:BW(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ac){return this.component?this.component.multipleInstances?e:ac:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function BW(t){return t===ac?void 0:t}function jW(t){return t.instantiationMode==="EAGER"}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $W{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new qW(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ye||(Ye={}));const zW={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},HW=Ye.INFO,WW={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},KW=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=WW[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Yv{constructor(e){this.name=e,this._logLevel=HW,this._logHandler=KW,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zW[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const GW=(t,e)=>e.some(n=>t instanceof n);let SP,RP;function QW(){return SP||(SP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YW(){return RP||(RP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const SV=new WeakMap,JT=new WeakMap,RV=new WeakMap,Tb=new WeakMap,DS=new WeakMap;function XW(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Va(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&SV.set(n,t)}).catch(()=>{}),DS.set(e,t),e}function JW(t){if(JT.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});JT.set(t,e)}let ZT={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return JT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||RV.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Va(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ZW(t){ZT=t(ZT)}function e7(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Cb(this),e,...n);return RV.set(s,e.sort?e.sort():[e]),Va(s)}:YW().includes(t)?function(...e){return t.apply(Cb(this),e),Va(SV.get(this))}:function(...e){return Va(t.apply(Cb(this),e))}}function t7(t){return typeof t=="function"?e7(t):(t instanceof IDBTransaction&&JW(t),GW(t,QW())?new Proxy(t,ZT):t)}function Va(t){if(t instanceof IDBRequest)return XW(t);if(Tb.has(t))return Tb.get(t);const e=t7(t);return e!==t&&(Tb.set(t,e),DS.set(e,t)),e}const Cb=t=>DS.get(t);function n7(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=Va(o);return s&&o.addEventListener("upgradeneeded",c=>{s(Va(o.result),c.oldVersion,c.newVersion,Va(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const s7=["get","getKey","getAll","getAllKeys","count"],r7=["put","add","delete","clear"],Ib=new Map;function AP(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ib.get(e))return Ib.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=r7.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||s7.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),r&&c.done]))[0]};return Ib.set(e,i),i}ZW(t=>({...t,get:(e,n,s)=>AP(e,n)||t.get(e,n,s),has:(e,n)=>!!AP(e,n)||t.has(e,n)}));/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class i7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(o7(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function o7(t){return t.getComponent()?.type==="VERSION"}const eC="@firebase/app",kP="0.14.0";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const zo=new Yv("@firebase/app"),a7="@firebase/app-compat",l7="@firebase/analytics-compat",c7="@firebase/analytics",u7="@firebase/app-check-compat",h7="@firebase/app-check",d7="@firebase/auth",f7="@firebase/auth-compat",p7="@firebase/database",g7="@firebase/data-connect",m7="@firebase/database-compat",_7="@firebase/functions",y7="@firebase/functions-compat",v7="@firebase/installations",w7="@firebase/installations-compat",E7="@firebase/messaging",b7="@firebase/messaging-compat",T7="@firebase/performance",C7="@firebase/performance-compat",I7="@firebase/remote-config",S7="@firebase/remote-config-compat",R7="@firebase/storage",A7="@firebase/storage-compat",k7="@firebase/firestore",P7="@firebase/ai",N7="@firebase/firestore-compat",x7="firebase",D7="12.0.0";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const tC="[DEFAULT]",O7={[eC]:"fire-core",[a7]:"fire-core-compat",[c7]:"fire-analytics",[l7]:"fire-analytics-compat",[h7]:"fire-app-check",[u7]:"fire-app-check-compat",[d7]:"fire-auth",[f7]:"fire-auth-compat",[p7]:"fire-rtdb",[g7]:"fire-data-connect",[m7]:"fire-rtdb-compat",[_7]:"fire-fn",[y7]:"fire-fn-compat",[v7]:"fire-iid",[w7]:"fire-iid-compat",[E7]:"fire-fcm",[b7]:"fire-fcm-compat",[T7]:"fire-perf",[C7]:"fire-perf-compat",[I7]:"fire-rc",[S7]:"fire-rc-compat",[R7]:"fire-gcs",[A7]:"fire-gcs-compat",[k7]:"fire-fst",[N7]:"fire-fst-compat",[P7]:"fire-vertex","fire-js":"fire-js",[x7]:"fire-js-all"};/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Z_=new Map,L7=new Map,nC=new Map;function PP(t,e){try{t.container.addComponent(e)}catch(n){zo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function sl(t){const e=t.name;if(nC.has(e))return zo.debug(`There were multiple attempts to register component ${e}.`),!1;nC.set(e,t);for(const n of Z_.values())PP(n,t);for(const n of L7.values())PP(n,t);return!0}function Vg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Zs(t){return t==null?!1:t.settings!==void 0}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const M7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fa=new Mg("app","Firebase",M7);/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class V7{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new $o("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fa.create("app-deleted",{appName:this._name})}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Pl=D7;function AV(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:tC,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw Fa.create("bad-app-name",{appName:String(r)});if(n||(n=bV()),!n)throw Fa.create("no-options");const i=Z_.get(r);if(i){if(nl(n,i.options)&&nl(s,i.config))return i;throw Fa.create("duplicate-app",{appName:r})}const o=new $W(r);for(const c of nC.values())o.addComponent(c);const a=new V7(n,s,o);return Z_.set(r,a),a}function Xv(t=tC){const e=Z_.get(t);if(!e&&t===tC&&bV())return AV();if(!e)throw Fa.create("no-app",{appName:t});return e}function gr(t,e,n){let s=O7[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zo.warn(o.join(" "));return}sl(new $o(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const F7="firebase-heartbeat-database",U7=1,Fp="firebase-heartbeat-store";let Sb=null;function kV(){return Sb||(Sb=n7(F7,U7,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Fp)}catch(n){console.warn(n)}}}}).catch(t=>{throw Fa.create("idb-open",{originalErrorMessage:t.message})})),Sb}async function q7(t){try{const e=(await kV()).transaction(Fp),n=await e.objectStore(Fp).get(PV(t));return await e.done,n}catch(e){if(e instanceof Qi)zo.warn(e.message);else{const n=Fa.create("idb-get",{originalErrorMessage:e?.message});zo.warn(n.message)}}}async function NP(t,e){try{const n=(await kV()).transaction(Fp,"readwrite");await n.objectStore(Fp).put(e,PV(t)),await n.done}catch(n){if(n instanceof Qi)zo.warn(n.message);else{const s=Fa.create("idb-set",{originalErrorMessage:n?.message});zo.warn(s.message)}}}function PV(t){return`${t.name}!${t.options.appId}`}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const B7=1024,j7=30;class $7{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new H7(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=xP();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>j7){const s=W7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){zo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=xP(),{heartbeatsToSend:n,unsentEntries:s}=z7(this._heartbeatsCache.heartbeats),r=Y_(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return zo.warn(e),""}}}function xP(){return new Date().toISOString().substring(0,10)}function z7(t,e=B7){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),DP(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),DP(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class H7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return AW()?kW().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await q7(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return NP(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return NP(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function DP(t){return Y_(JSON.stringify({version:2,heartbeats:t})).length}function W7(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function K7(t){sl(new $o("platform-logger",e=>new i7(e),"PRIVATE")),sl(new $o("heartbeat",e=>new $7(e),"PRIVATE")),gr(eC,kP,t),gr(eC,kP,"esm2020"),gr("fire-js","")}K7("");function NV(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xV=NV,DV=new Mg("auth","Firebase",NV());/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ey=new Yv("@firebase/auth");function G7(t,...e){ey.logLevel<=Ye.WARN&&ey.warn(`Auth (${Pl}): ${t}`,...e)}function n_(t,...e){ey.logLevel<=Ye.ERROR&&ey.error(`Auth (${Pl}): ${t}`,...e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function qi(t,...e){throw LS(t,...e)}function Yr(t,...e){return LS(t,...e)}function OS(t,e,n){const s={...xV(),[e]:n};return new Mg("auth","Firebase",s).create(e,{appName:t.name})}function Rc(t){return OS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Q7(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&qi(t,"argument-error"),OS(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function LS(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return DV.create(t,...e)}function Le(t,e,...n){if(!t)throw LS(e,...n)}function xo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw n_(e),new Error(e)}function Ho(t,e){t||xo(e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function sC(){return typeof self<"u"&&self.location?.href||""}function Y7(){return OP()==="http:"||OP()==="https:"}function OP(){return typeof self<"u"&&self.location?.protocol||null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function X7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Y7()||CW()||"connection"in navigator)?navigator.onLine:!0}function J7(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Fg{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ho(n>e,"Short delay should be less than long delay!"),this.isMobile=NS()||CV()}get(){return X7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function MS(t,e){Ho(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class OV{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Z7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const e8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],t8=new Fg(3e4,6e4);function VS(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function zh(t,e,n,s,r={}){return LV(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=$h({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...i};return TW()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Gi(t.emulatorConfig.host)&&(u.credentials="include"),OV.fetch()(await MV(t,t.config.apiHost,n,a),u)})}async function LV(t,e,n){t._canInitEmulator=!1;const s={...Z7,...e};try{const r=new s8(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Im(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Im(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Im(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Im(t,"user-disabled",o);const h=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw OS(t,h,u);qi(t,h)}}catch(r){if(r instanceof Qi)throw r;qi(t,"network-request-failed",{message:String(r)})}}async function n8(t,e,n,s,r={}){const i=await zh(t,e,n,s,r);return"mfaPendingCredential"in i&&qi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function MV(t,e,n,s){const r=`${e}${n}?${s}`,i=t,o=i.config.emulator?MS(t.config,r):`${t.config.apiScheme}://${r}`;return e8.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class s8{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Yr(this.auth,"network-request-failed")),t8.get())})}}function Im(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=Yr(t,e,s);return r.customData._tokenResponse=n,r}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function r8(t,e){return zh(t,"POST","/v1/accounts:delete",e)}async function ty(t,e){return zh(t,"POST","/v1/accounts:lookup",e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Qf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function VV(t,e=!1){const n=It(t),s=await n.getIdToken(e),r=FS(s);Le(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i?.sign_in_provider;return{claims:r,token:s,authTime:Qf(Rb(r.auth_time)),issuedAtTime:Qf(Rb(r.iat)),expirationTime:Qf(Rb(r.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Rb(t){return Number(t)*1e3}function FS(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return n_("JWT malformed, contained fewer than 3 sections"),null;try{const r=X_(n);return r?JSON.parse(r):(n_("Failed to decode base64 JWT payload"),null)}catch(r){return n_("Caught error parsing JWT payload as JSON",r?.toString()),null}}function LP(t){const e=FS(t);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Up(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Qi&&i8(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function i8({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class o8{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class rC{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qf(this.lastLoginAt),this.creationTime=Qf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function ny(t){const e=t.auth,n=await t.getIdToken(),s=await Up(t,ty(e,{idToken:n}));Le(s?.users.length,e,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const i=r.providerUserInfo?.length?UV(r.providerUserInfo):[],o=a8(t.providerData,i),a=t.isAnonymous,c=!(t.email&&r.passwordHash)&&!o?.length,u=a?c:!1,h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new rC(r.createdAt,r.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function FV(t){const e=It(t);await ny(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function a8(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function UV(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function l8(t,e){const n=await LV(t,{},async()=>{const s=$h({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=await MV(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:s};return t.emulatorConfig&&Gi(t.emulatorConfig.host)&&(c.credentials="include"),OV.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function c8(t,e){return zh(t,"POST","/v2/accounts:revokeToken",VS(t,e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Wu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):LP(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const n=LP(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await l8(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new Wu;return s&&(Le(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(Le(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(Le(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wu,this.toJSON())}_performRefresh(){return xo("not implemented")}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ha(t,e){Le(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class qr{constructor({uid:e,auth:n,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new o8(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new rC(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await Up(this,this.stsTokenManager.getToken(this.auth,e));return Le(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return VV(this,e)}reload(){return FV(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new qr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await ny(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Zs(this.auth.app))return Promise.reject(Rc(this.auth));const e=await this.getIdToken();return await Up(this,r8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,r=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:d,emailVerified:p,isAnonymous:m,providerData:w,stsTokenManager:R}=n;Le(d&&R,e,"internal-error");const k=Wu.fromJSON(this.name,R);Le(typeof d=="string",e,"internal-error"),ha(s,e.name),ha(r,e.name),Le(typeof p=="boolean",e,"internal-error"),Le(typeof m=="boolean",e,"internal-error"),ha(i,e.name),ha(o,e.name),ha(a,e.name),ha(c,e.name),ha(u,e.name),ha(h,e.name);const O=new qr({uid:d,auth:e,email:r,emailVerified:p,displayName:s,isAnonymous:m,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:k,createdAt:u,lastLoginAt:h});return w&&Array.isArray(w)&&(O.providerData=w.map(M=>({...M}))),c&&(O._redirectEventId=c),O}static async _fromIdTokenResponse(e,n,s=!1){const r=new Wu;r.updateFromServerResponse(n);const i=new qr({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await ny(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];Le(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?UV(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!i?.length,a=new Wu;a.updateFromIdToken(s);const c=new qr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new rC(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!i?.length};return Object.assign(c,u),c}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const MP=new Map;function Do(t){Ho(t instanceof Function,"Expected a class definition");let e=MP.get(t);return e?(Ho(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,MP.set(t,e),e)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qV{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}qV.type="NONE";const iC=qV;/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function s_(t,e,n){return`firebase:${t}:${e}:${n}`}class Ku{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=s_(this.userKey,r.apiKey,i),this.fullPersistenceKey=s_("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ty(this.auth,{idToken:e}).catch(()=>{});return n?qr._fromGetAccountInfoResponse(this.auth,n,e):null}return qr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new Ku(Do(iC),e,s);const r=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=r[0]||Do(iC);const o=s_(s,e.config.apiKey,e.name);let a=null;for(const u of n)try{const h=await u._get(o);if(h){let d;if(typeof h=="string"){const p=await ty(e,{idToken:h}).catch(()=>{});if(!p)break;d=await qr._fromGetAccountInfoResponse(e,p,h)}else d=qr._fromJSON(e,h);u!==i&&(a=d),i=u;break}}catch{}const c=r.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Ku(i,e,s):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Ku(i,e,s))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function VP(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(zV(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(BV(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(WV(e))return"Blackberry";if(KV(e))return"Webos";if(jV(e))return"Safari";if((e.includes("chrome/")||$V(e))&&!e.includes("edge/"))return"Chrome";if(HV(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if(s?.length===2)return s[1]}return"Other"}function BV(t=_s()){return/firefox\//i.test(t)}function jV(t=_s()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $V(t=_s()){return/crios\//i.test(t)}function zV(t=_s()){return/iemobile/i.test(t)}function HV(t=_s()){return/android/i.test(t)}function WV(t=_s()){return/blackberry/i.test(t)}function KV(t=_s()){return/webos/i.test(t)}function US(t=_s()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function u8(t=_s()){return US(t)&&!!window.navigator?.standalone}function h8(){return IW()&&document.documentMode===10}function GV(t=_s()){return US(t)||HV(t)||KV(t)||WV(t)||/windows phone/i.test(t)||zV(t)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function QV(t,e=[]){let n;switch(t){case"Browser":n=VP(_s());break;case"Worker":n=`${VP(_s())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Pl}/${s}`}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class d8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function f8(t,e={}){return zh(t,"GET","/v2/passwordPolicy",VS(t,e))}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const p8=6;class g8{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??p8,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class m8{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new FP(this),this.idTokenSubscription=new FP(this),this.beforeStateQueue=new d8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DV,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Do(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ku.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ty(this,{idToken:e}),s=await qr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Zs(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=s?._redirectEventId,a=await this.tryRedirectSignIn(e);(!i||i===o)&&a?.user&&(s=a.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ny(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=J7()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Zs(this.app))return Promise.reject(Rc(this));const n=e?It(e):null;return n&&Le(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Zs(this.app)?Promise.reject(Rc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Zs(this.app)?Promise.reject(Rc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Do(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await f8(this),n=new g8(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Mg("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await c8(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Do(e)||this._popupRedirectResolver;Le(n,this,"argument-error"),this.redirectPersistenceManager=await Ku.create(this,[Do(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,s,r);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=QV(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Zs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&G7(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Jv(t){return It(t)}class FP{constructor(e){this.auth=e,this.observer=null,this.addObserver=MW(n=>this.observer=n)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let qS={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _8(t){qS=t}function y8(t){return qS.loadJS(t)}function v8(){return qS.gapiScript}function w8(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function YV(t,e){const n=Vg(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),r=n.getOptions();if(nl(r,e??{}))return s;qi(s,"already-initialized")}return n.initialize({options:e})}function E8(t,e){const n=e?.persistence||[],s=(Array.isArray(n)?n:[n]).map(Do);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e?.popupRedirectResolver)}function XV(t,e,n){const s=Jv(t);Le(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=JV(e),{host:o,port:a}=b8(e),c=a===null?"":`:${a}`,u={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){Le(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Le(nl(u,s.config.emulator)&&nl(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=u,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,Gi(o)?(Kv(`${i}//${o}${c}`),Gv("Auth",!0)):T8()}function JV(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function b8(t){const e=JV(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:UP(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:UP(o)}}}function UP(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function T8(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class BS{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return xo("not implemented")}_getIdTokenResponse(e){return xo("not implemented")}_linkToIdToken(e,n){return xo("not implemented")}_getReauthenticationResolver(e){return xo("not implemented")}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Gu(t,e){return n8(t,"POST","/v1/accounts:signInWithIdp",VS(t,e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const C8="http://localhost";class rl extends BS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new rl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):qi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...i}=n;if(!s||!r)return null;const o=new rl(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Gu(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,Gu(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Gu(e,n)}buildRequest(){const e={requestUri:C8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=$h(n)}return e}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class jS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ug extends jS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class So extends Ug{constructor(){super("facebook.com")}static credential(e){return rl._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return So.credential(e.oauthAccessToken)}catch{return null}}}So.FACEBOOK_SIGN_IN_METHOD="facebook.com";So.PROVIDER_ID="facebook.com";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ci extends Ug{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return rl._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Ci.credential(n,s)}catch{return null}}}Ci.GOOGLE_SIGN_IN_METHOD="google.com";Ci.PROVIDER_ID="google.com";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ro extends Ug{constructor(){super("github.com")}static credential(e){return rl._fromParams({providerId:Ro.PROVIDER_ID,signInMethod:Ro.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ro.credentialFromTaggedObject(e)}static credentialFromError(e){return Ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ro.credential(e.oauthAccessToken)}catch{return null}}}Ro.GITHUB_SIGN_IN_METHOD="github.com";Ro.PROVIDER_ID="github.com";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ao extends Ug{constructor(){super("twitter.com")}static credential(e,n){return rl._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Ao.credential(n,s)}catch{return null}}}Ao.TWITTER_SIGN_IN_METHOD="twitter.com";Ao.PROVIDER_ID="twitter.com";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class mh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await qr._fromIdTokenResponse(e,s,r),o=qP(s);return new mh({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=qP(s);return new mh({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function qP(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class sy extends Qi{constructor(e,n,s,r){super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,sy.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new sy(e,n,s,r)}}function ZV(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?sy._fromErrorAndOperation(t,r,e,s):r})}async function I8(t,e,n=!1){const s=await Up(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return mh._forOperation(t,"link",s)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function S8(t,e,n=!1){const{auth:s}=t;if(Zs(s.app))return Promise.reject(Rc(s));const r="reauthenticate";try{const i=await Up(t,ZV(s,r,e,t),n);Le(i.idToken,s,"internal-error");const o=FS(i.idToken);Le(o,s,"internal-error");const{sub:a}=o;return Le(t.uid===a,s,"user-mismatch"),mh._forOperation(t,r,i)}catch(i){throw i?.code==="auth/user-not-found"&&qi(s,"user-mismatch"),i}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function R8(t,e,n=!1){if(Zs(t.app))return Promise.reject(Rc(t));const s="signIn",r=await ZV(t,s,e),i=await mh._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}function e2(t,e,n,s){return It(t).onIdTokenChanged(e,n,s)}function t2(t,e,n){return It(t).beforeAuthStateChanged(e,n)}function n2(t,e,n,s){return It(t).onAuthStateChanged(e,n,s)}function Ru(t){return It(t).signOut()}const ry="__sak";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class s2{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ry,"1"),this.storage.removeItem(ry),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const A8=1e3,k8=10;class r2 extends s2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=GV(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);h8()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,k8):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},A8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}r2.type="LOCAL";const i2=r2;/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class o2 extends s2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}o2.type="SESSION";const $S=o2;/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function P8(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Zv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new Zv(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async u=>u(n.origin,i)),c=await P8(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Zv.receivers=[];/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function zS(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class N8{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const u=zS("",20);r.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(d){const p=d;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Ai(){return window}function x8(t){Ai().location.href=t}/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function a2(){return typeof Ai().WorkerGlobalScope<"u"&&typeof Ai().importScripts=="function"}async function D8(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function O8(){return navigator?.serviceWorker?.controller||null}function L8(){return a2()?self:null}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const l2="firebaseLocalStorageDb",M8=1,iy="firebaseLocalStorage",c2="fbase_key";class qg{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function ew(t,e){return t.transaction([iy],e?"readwrite":"readonly").objectStore(iy)}function V8(){const t=indexedDB.deleteDatabase(l2);return new qg(t).toPromise()}function oC(){const t=indexedDB.open(l2,M8);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(iy,{keyPath:c2})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(iy)?e(s):(s.close(),await V8(),e(await oC()))})})}async function BP(t,e,n){const s=ew(t,!0).put({[c2]:e,value:n});return new qg(s).toPromise()}async function F8(t,e){const n=ew(t,!1).get(e),s=await new qg(n).toPromise();return s===void 0?null:s.value}function jP(t,e){const n=ew(t,!0).delete(e);return new qg(n).toPromise()}const U8=800,q8=3;class u2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await oC(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>q8)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return a2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Zv._getInstance(L8()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await D8(),!this.activeServiceWorker)return;this.sender=new N8(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||O8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await oC();return await BP(e,ry,"1"),await jP(e,ry),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>BP(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>F8(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>jP(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=ew(r,!1).getAll();return new qg(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),U8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}u2.type="LOCAL";const h2=u2;new Fg(3e4,6e4);/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function d2(t,e){return e?Do(e):(Le(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class HS extends BS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gu(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Gu(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Gu(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function B8(t){return R8(t.auth,new HS(t),t.bypassAuthState)}function j8(t){const{auth:e,user:n}=t;return Le(n,e,"internal-error"),S8(n,new HS(t),t.bypassAuthState)}async function $8(t){const{auth:e,user:n}=t;return Le(n,e,"internal-error"),I8(n,new HS(t),t.bypassAuthState)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class f2{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return B8;case"linkViaPopup":case"linkViaRedirect":return $8;case"reauthViaPopup":case"reauthViaRedirect":return j8;default:qi(this.auth,"internal-error")}}resolve(e){Ho(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ho(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const z8=new Fg(2e3,1e4);async function p2(t,e,n){if(Zs(t.app))return Promise.reject(Yr(t,"operation-not-supported-in-this-environment"));const s=Jv(t);Q7(t,e,jS);const r=d2(s,n);return new pc(s,"signInViaPopup",e,r).executeNotNull()}class pc extends f2{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,pc.currentPopupAction&&pc.currentPopupAction.cancel(),pc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){Ho(this.filter.length===1,"Popup operations only handle one event");const e=zS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Yr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Yr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,z8.get())};e()}}pc.currentPopupAction=null;/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const H8="pendingRedirect",r_=new Map;class W8 extends f2{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=r_.get(this.auth._key());if(!e){try{const n=await K8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(n){e=()=>Promise.reject(n)}r_.set(this.auth._key(),e)}return this.bypassAuthState||r_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function K8(t,e){const n=Y8(e),s=Q8(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function G8(t,e){r_.set(t._key(),e)}function Q8(t){return Do(t._redirectPersistence)}function Y8(t){return s_(H8,t.config.apiKey,t.name)}async function X8(t,e,n=!1){if(Zs(t.app))return Promise.reject(Rc(t));const s=Jv(t),r=d2(s,e),i=await new W8(s,r,n).execute();return i&&!n&&(delete i.user._redirectEventId,await s._persistUserIfCurrent(i.user),await s._setRedirectUser(null,e)),i}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const J8=600*1e3;class Z8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eK(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!g2(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Yr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=J8&&this.cachedEventUids.clear(),this.cachedEventUids.has($P(e))}saveEventToCache(e){this.cachedEventUids.add($P(e)),this.lastProcessedEventTime=Date.now()}}function $P(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function g2({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function eK(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return g2(t);default:return!1}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function tK(t,e={}){return zh(t,"GET","/v1/projects",e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const nK=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sK=/^https?/;async function rK(t){if(t.config.emulator)return;const{authorizedDomains:e}=await tK(t);for(const n of e)try{if(iK(n))return}catch{}qi(t,"unauthorized-domain")}function iK(t){const e=sC(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&i.hostname===s}if(!sK.test(n))return!1;if(nK.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const oK=new Fg(3e4,6e4);function zP(){const t=Ai().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function aK(t){return new Promise((e,n)=>{function s(){zP(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{zP(),n(Yr(t,"network-request-failed"))},timeout:oK.get()})}if(Ai().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ai().gapi?.load)s();else{const r=w8("iframefcb");return Ai()[r]=()=>{gapi.load?s():n(Yr(t,"network-request-failed"))},y8(`${v8()}?onload=${r}`).catch(i=>n(i))}}).catch(e=>{throw i_=null,e})}let i_=null;function lK(t){return i_=i_||aK(t),i_}/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const cK=new Fg(5e3,15e3),uK="__/auth/iframe",hK="emulator/auth/iframe",dK={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pK(t){const e=t.config;Le(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?MS(e,hK):`https://${t.config.authDomain}/${uK}`,s={apiKey:e.apiKey,appName:t.name,v:Pl},r=fK.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${$h(s).slice(1)}`}async function gK(t){const e=await lK(t),n=Ai().gapi;return Le(n,t,"internal-error"),e.open({where:document.body,url:pK(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dK,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=Yr(t,"network-request-failed"),a=Ai().setTimeout(()=>{i(o)},cK.get());function c(){Ai().clearTimeout(a),r(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const mK={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_K=500,yK=600,vK="_blank",wK="http://localhost";class HP{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function EK(t,e,n,s=_K,r=yK){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const c={...mK,width:s.toString(),height:r.toString(),top:i,left:o},u=_s().toLowerCase();n&&(a=$V(u)?vK:n),BV(u)&&(e=e||wK,c.scrollbars="yes");const h=Object.entries(c).reduce((p,[m,w])=>`${p}${m}=${w},`,"");if(u8(u)&&a!=="_self")return bK(e||"",a),new HP(null);const d=window.open(e||"",a,h);Le(d,t,"popup-blocked");try{d.focus()}catch{}return new HP(d)}function bK(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const TK="__/auth/handler",CK="emulator/auth/handler",IK=encodeURIComponent("fac");async function WP(t,e,n,s,r,i){Le(t.config.authDomain,t,"auth-domain-config-required"),Le(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Pl,eventId:r};if(e instanceof jS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",XT(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(e instanceof Ug){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),u=c?`#${IK}=${encodeURIComponent(c)}`:"";return`${SK(t)}?${$h(a).slice(1)}${u}`}function SK({config:t}){return t.emulator?MS(t,CK):`https://${t.authDomain}/${TK}`}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Ab="webStorageSupport";class RK{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$S,this._completeRedirectFn=X8,this._overrideRedirectResult=G8}async _openPopup(e,n,s,r){Ho(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await WP(e,n,s,sC(),r);return EK(e,i,zS())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await WP(e,n,s,sC(),r);return x8(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(Ho(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await gK(e),s=new Z8(e);return n.register("authEvent",r=>(Le(r?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Ab,{type:Ab},s=>{const r=s?.[0]?.[Ab];r!==void 0&&n(!!r),qi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=rK(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return GV()||jV()||US()}}const m2=RK;var KP="@firebase/auth",GP="1.11.0";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class AK{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function kK(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function PK(t){sl(new $o("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;Le(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:QV(t)},u=new m8(s,r,i,c);return E8(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),sl(new $o("auth-internal",e=>{const n=Jv(e.getProvider("auth").getImmediate());return(s=>new AK(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),gr(KP,GP,kK(t)),gr(KP,GP,"esm2020")}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const NK=300,xK=TV("authIdTokenMaxAge")||NK;let QP=null;const DK=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>xK)return;const r=n?.token;QP!==r&&(QP=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function _2(t=Xv()){const e=Vg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=YV(t,{popupRedirectResolver:m2,persistence:[h2,i2,$S]}),s=TV("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=DK(i.toString());t2(n,o,()=>o(n.currentUser)),e2(n,a=>o(a))}}const r=EV("auth");return r&&XV(n,`http://${r}`),n}function OK(){return document.getElementsByTagName("head")?.[0]??document}_8({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=Yr("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",OK().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});PK("Browser");var YP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ua,y2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,v){function y(){}y.prototype=v.prototype,I.D=v.prototype,I.prototype=new y,I.prototype.constructor=I,I.C=function(C,S,T){for(var E=Array(arguments.length-2),K=2;K<arguments.length;K++)E[K-2]=arguments[K];return v.prototype[S].apply(C,E)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,n),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(I,v,y){y||(y=0);var C=Array(16);if(typeof v=="string")for(var S=0;16>S;++S)C[S]=v.charCodeAt(y++)|v.charCodeAt(y++)<<8|v.charCodeAt(y++)<<16|v.charCodeAt(y++)<<24;else for(S=0;16>S;++S)C[S]=v[y++]|v[y++]<<8|v[y++]<<16|v[y++]<<24;v=I.g[0],y=I.g[1],S=I.g[2];var T=I.g[3],E=v+(T^y&(S^T))+C[0]+3614090360&4294967295;v=y+(E<<7&4294967295|E>>>25),E=T+(S^v&(y^S))+C[1]+3905402710&4294967295,T=v+(E<<12&4294967295|E>>>20),E=S+(y^T&(v^y))+C[2]+606105819&4294967295,S=T+(E<<17&4294967295|E>>>15),E=y+(v^S&(T^v))+C[3]+3250441966&4294967295,y=S+(E<<22&4294967295|E>>>10),E=v+(T^y&(S^T))+C[4]+4118548399&4294967295,v=y+(E<<7&4294967295|E>>>25),E=T+(S^v&(y^S))+C[5]+1200080426&4294967295,T=v+(E<<12&4294967295|E>>>20),E=S+(y^T&(v^y))+C[6]+2821735955&4294967295,S=T+(E<<17&4294967295|E>>>15),E=y+(v^S&(T^v))+C[7]+4249261313&4294967295,y=S+(E<<22&4294967295|E>>>10),E=v+(T^y&(S^T))+C[8]+1770035416&4294967295,v=y+(E<<7&4294967295|E>>>25),E=T+(S^v&(y^S))+C[9]+2336552879&4294967295,T=v+(E<<12&4294967295|E>>>20),E=S+(y^T&(v^y))+C[10]+4294925233&4294967295,S=T+(E<<17&4294967295|E>>>15),E=y+(v^S&(T^v))+C[11]+2304563134&4294967295,y=S+(E<<22&4294967295|E>>>10),E=v+(T^y&(S^T))+C[12]+1804603682&4294967295,v=y+(E<<7&4294967295|E>>>25),E=T+(S^v&(y^S))+C[13]+4254626195&4294967295,T=v+(E<<12&4294967295|E>>>20),E=S+(y^T&(v^y))+C[14]+2792965006&4294967295,S=T+(E<<17&4294967295|E>>>15),E=y+(v^S&(T^v))+C[15]+1236535329&4294967295,y=S+(E<<22&4294967295|E>>>10),E=v+(S^T&(y^S))+C[1]+4129170786&4294967295,v=y+(E<<5&4294967295|E>>>27),E=T+(y^S&(v^y))+C[6]+3225465664&4294967295,T=v+(E<<9&4294967295|E>>>23),E=S+(v^y&(T^v))+C[11]+643717713&4294967295,S=T+(E<<14&4294967295|E>>>18),E=y+(T^v&(S^T))+C[0]+3921069994&4294967295,y=S+(E<<20&4294967295|E>>>12),E=v+(S^T&(y^S))+C[5]+3593408605&4294967295,v=y+(E<<5&4294967295|E>>>27),E=T+(y^S&(v^y))+C[10]+38016083&4294967295,T=v+(E<<9&4294967295|E>>>23),E=S+(v^y&(T^v))+C[15]+3634488961&4294967295,S=T+(E<<14&4294967295|E>>>18),E=y+(T^v&(S^T))+C[4]+3889429448&4294967295,y=S+(E<<20&4294967295|E>>>12),E=v+(S^T&(y^S))+C[9]+568446438&4294967295,v=y+(E<<5&4294967295|E>>>27),E=T+(y^S&(v^y))+C[14]+3275163606&4294967295,T=v+(E<<9&4294967295|E>>>23),E=S+(v^y&(T^v))+C[3]+4107603335&4294967295,S=T+(E<<14&4294967295|E>>>18),E=y+(T^v&(S^T))+C[8]+1163531501&4294967295,y=S+(E<<20&4294967295|E>>>12),E=v+(S^T&(y^S))+C[13]+2850285829&4294967295,v=y+(E<<5&4294967295|E>>>27),E=T+(y^S&(v^y))+C[2]+4243563512&4294967295,T=v+(E<<9&4294967295|E>>>23),E=S+(v^y&(T^v))+C[7]+1735328473&4294967295,S=T+(E<<14&4294967295|E>>>18),E=y+(T^v&(S^T))+C[12]+2368359562&4294967295,y=S+(E<<20&4294967295|E>>>12),E=v+(y^S^T)+C[5]+4294588738&4294967295,v=y+(E<<4&4294967295|E>>>28),E=T+(v^y^S)+C[8]+2272392833&4294967295,T=v+(E<<11&4294967295|E>>>21),E=S+(T^v^y)+C[11]+1839030562&4294967295,S=T+(E<<16&4294967295|E>>>16),E=y+(S^T^v)+C[14]+4259657740&4294967295,y=S+(E<<23&4294967295|E>>>9),E=v+(y^S^T)+C[1]+2763975236&4294967295,v=y+(E<<4&4294967295|E>>>28),E=T+(v^y^S)+C[4]+1272893353&4294967295,T=v+(E<<11&4294967295|E>>>21),E=S+(T^v^y)+C[7]+4139469664&4294967295,S=T+(E<<16&4294967295|E>>>16),E=y+(S^T^v)+C[10]+3200236656&4294967295,y=S+(E<<23&4294967295|E>>>9),E=v+(y^S^T)+C[13]+681279174&4294967295,v=y+(E<<4&4294967295|E>>>28),E=T+(v^y^S)+C[0]+3936430074&4294967295,T=v+(E<<11&4294967295|E>>>21),E=S+(T^v^y)+C[3]+3572445317&4294967295,S=T+(E<<16&4294967295|E>>>16),E=y+(S^T^v)+C[6]+76029189&4294967295,y=S+(E<<23&4294967295|E>>>9),E=v+(y^S^T)+C[9]+3654602809&4294967295,v=y+(E<<4&4294967295|E>>>28),E=T+(v^y^S)+C[12]+3873151461&4294967295,T=v+(E<<11&4294967295|E>>>21),E=S+(T^v^y)+C[15]+530742520&4294967295,S=T+(E<<16&4294967295|E>>>16),E=y+(S^T^v)+C[2]+3299628645&4294967295,y=S+(E<<23&4294967295|E>>>9),E=v+(S^(y|~T))+C[0]+4096336452&4294967295,v=y+(E<<6&4294967295|E>>>26),E=T+(y^(v|~S))+C[7]+1126891415&4294967295,T=v+(E<<10&4294967295|E>>>22),E=S+(v^(T|~y))+C[14]+2878612391&4294967295,S=T+(E<<15&4294967295|E>>>17),E=y+(T^(S|~v))+C[5]+4237533241&4294967295,y=S+(E<<21&4294967295|E>>>11),E=v+(S^(y|~T))+C[12]+1700485571&4294967295,v=y+(E<<6&4294967295|E>>>26),E=T+(y^(v|~S))+C[3]+2399980690&4294967295,T=v+(E<<10&4294967295|E>>>22),E=S+(v^(T|~y))+C[10]+4293915773&4294967295,S=T+(E<<15&4294967295|E>>>17),E=y+(T^(S|~v))+C[1]+2240044497&4294967295,y=S+(E<<21&4294967295|E>>>11),E=v+(S^(y|~T))+C[8]+1873313359&4294967295,v=y+(E<<6&4294967295|E>>>26),E=T+(y^(v|~S))+C[15]+4264355552&4294967295,T=v+(E<<10&4294967295|E>>>22),E=S+(v^(T|~y))+C[6]+2734768916&4294967295,S=T+(E<<15&4294967295|E>>>17),E=y+(T^(S|~v))+C[13]+1309151649&4294967295,y=S+(E<<21&4294967295|E>>>11),E=v+(S^(y|~T))+C[4]+4149444226&4294967295,v=y+(E<<6&4294967295|E>>>26),E=T+(y^(v|~S))+C[11]+3174756917&4294967295,T=v+(E<<10&4294967295|E>>>22),E=S+(v^(T|~y))+C[2]+718787259&4294967295,S=T+(E<<15&4294967295|E>>>17),E=y+(T^(S|~v))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(S+(E<<21&4294967295|E>>>11))&4294967295,I.g[2]=I.g[2]+S&4294967295,I.g[3]=I.g[3]+T&4294967295}s.prototype.u=function(I,v){v===void 0&&(v=I.length);for(var y=v-this.blockSize,C=this.B,S=this.h,T=0;T<v;){if(S==0)for(;T<=y;)r(this,I,T),T+=this.blockSize;if(typeof I=="string"){for(;T<v;)if(C[S++]=I.charCodeAt(T++),S==this.blockSize){r(this,C),S=0;break}}else for(;T<v;)if(C[S++]=I[T++],S==this.blockSize){r(this,C),S=0;break}}this.h=S,this.o+=v},s.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;var y=8*this.o;for(v=I.length-8;v<I.length;++v)I[v]=y&255,y/=256;for(this.u(I),I=Array(16),v=y=0;4>v;++v)for(var C=0;32>C;C+=8)I[y++]=this.g[v]>>>C&255;return I};function i(I,v){var y=a;return Object.prototype.hasOwnProperty.call(y,I)?y[I]:y[I]=v(I)}function o(I,v){this.h=v;for(var y=[],C=!0,S=I.length-1;0<=S;S--){var T=I[S]|0;C&&T==v||(y[S]=T,C=!1)}this.g=y}var a={};function c(I){return-128<=I&&128>I?i(I,function(v){return new o([v|0],0>v?-1:0)}):new o([I|0],0>I?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return k(u(-I));for(var v=[],y=1,C=0;I>=y;C++)v[C]=I/y|0,y*=4294967296;return new o(v,0)}function h(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return k(h(I.substring(1),v));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=u(Math.pow(v,8)),C=d,S=0;S<I.length;S+=8){var T=Math.min(8,I.length-S),E=parseInt(I.substring(S,S+T),v);8>T?(T=u(Math.pow(v,T)),C=C.j(T).add(u(E))):(C=C.j(y),C=C.add(u(E)))}return C}var d=c(0),p=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(R(this))return-k(this).m();for(var I=0,v=1,y=0;y<this.g.length;y++){var C=this.i(y);I+=(0<=C?C:4294967296+C)*v,v*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(w(this))return"0";if(R(this))return"-"+k(this).toString(I);for(var v=u(Math.pow(I,6)),y=this,C="";;){var S=q(y,v).g;y=O(y,S.j(v));var T=((0<y.g.length?y.g[0]:y.h)>>>0).toString(I);if(y=S,w(y))return T+C;for(;6>T.length;)T="0"+T;C=T+C}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function w(I){if(I.h!=0)return!1;for(var v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function R(I){return I.h==-1}t.l=function(I){return I=O(this,I),R(I)?-1:w(I)?0:1};function k(I){for(var v=I.g.length,y=[],C=0;C<v;C++)y[C]=~I.g[C];return new o(y,~I.h).add(p)}t.abs=function(){return R(this)?k(this):this},t.add=function(I){for(var v=Math.max(this.g.length,I.g.length),y=[],C=0,S=0;S<=v;S++){var T=C+(this.i(S)&65535)+(I.i(S)&65535),E=(T>>>16)+(this.i(S)>>>16)+(I.i(S)>>>16);C=E>>>16,T&=65535,E&=65535,y[S]=E<<16|T}return new o(y,y[y.length-1]&-2147483648?-1:0)};function O(I,v){return I.add(k(v))}t.j=function(I){if(w(this)||w(I))return d;if(R(this))return R(I)?k(this).j(k(I)):k(k(this).j(I));if(R(I))return k(this.j(k(I)));if(0>this.l(m)&&0>I.l(m))return u(this.m()*I.m());for(var v=this.g.length+I.g.length,y=[],C=0;C<2*v;C++)y[C]=0;for(C=0;C<this.g.length;C++)for(var S=0;S<I.g.length;S++){var T=this.i(C)>>>16,E=this.i(C)&65535,K=I.i(S)>>>16,oe=I.i(S)&65535;y[2*C+2*S]+=E*oe,M(y,2*C+2*S),y[2*C+2*S+1]+=T*oe,M(y,2*C+2*S+1),y[2*C+2*S+1]+=E*K,M(y,2*C+2*S+1),y[2*C+2*S+2]+=T*K,M(y,2*C+2*S+2)}for(C=0;C<v;C++)y[C]=y[2*C+1]<<16|y[2*C];for(C=v;C<2*v;C++)y[C]=0;return new o(y,0)};function M(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function F(I,v){this.g=I,this.h=v}function q(I,v){if(w(v))throw Error("division by zero");if(w(I))return new F(d,d);if(R(I))return v=q(k(I),v),new F(k(v.g),k(v.h));if(R(v))return v=q(I,k(v)),new F(k(v.g),v.h);if(30<I.g.length){if(R(I)||R(v))throw Error("slowDivide_ only works with positive integers.");for(var y=p,C=v;0>=C.l(I);)y=H(y),C=H(C);var S=J(y,1),T=J(C,1);for(C=J(C,2),y=J(y,2);!w(C);){var E=T.add(C);0>=E.l(I)&&(S=S.add(y),T=E),C=J(C,1),y=J(y,1)}return v=O(I,S.j(v)),new F(S,v)}for(S=d;0<=I.l(v);){for(y=Math.max(1,Math.floor(I.m()/v.m())),C=Math.ceil(Math.log(y)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),T=u(y),E=T.j(v);R(E)||0<E.l(I);)y-=C,T=u(y),E=T.j(v);w(T)&&(T=p),S=S.add(T),I=O(I,E)}return new F(S,I)}t.A=function(I){return q(this,I).h},t.and=function(I){for(var v=Math.max(this.g.length,I.g.length),y=[],C=0;C<v;C++)y[C]=this.i(C)&I.i(C);return new o(y,this.h&I.h)},t.or=function(I){for(var v=Math.max(this.g.length,I.g.length),y=[],C=0;C<v;C++)y[C]=this.i(C)|I.i(C);return new o(y,this.h|I.h)},t.xor=function(I){for(var v=Math.max(this.g.length,I.g.length),y=[],C=0;C<v;C++)y[C]=this.i(C)^I.i(C);return new o(y,this.h^I.h)};function H(I){for(var v=I.g.length+1,y=[],C=0;C<v;C++)y[C]=I.i(C)<<1|I.i(C-1)>>>31;return new o(y,I.h)}function J(I,v){var y=v>>5;v%=32;for(var C=I.g.length-y,S=[],T=0;T<C;T++)S[T]=0<v?I.i(T+y)>>>v|I.i(T+y+1)<<32-v:I.i(T+y);return new o(S,I.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,y2=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,Ua=o}).apply(typeof YP<"u"?YP:typeof self<"u"?self:typeof window<"u"?window:{});var Sm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var v2,Tf,w2,o_,aC,E2,b2,T2;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,g){return l==Array.prototype||l==Object.prototype||(l[f]=g.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sm=="object"&&Sm];for(var f=0;f<l.length;++f){var g=l[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=n(this);function r(l,f){if(f)e:{var g=s;l=l.split(".");for(var _=0;_<l.length-1;_++){var P=l[_];if(!(P in g))break e;g=g[P]}l=l[l.length-1],_=g[l],f=f(_),f!=_&&f!=null&&e(g,l,{configurable:!0,writable:!0,value:f})}}function i(l,f){l instanceof String&&(l+="");var g=0,_=!1,P={next:function(){if(!_&&g<l.length){var D=g++;return{value:f(D,l[D]),done:!1}}return _=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}r("Array.prototype.values",function(l){return l||function(){return i(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function u(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function h(l,f,g){return l.call.apply(l.bind,arguments)}function d(l,f,g){if(!l)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,_),l.apply(f,P)}}return function(){return l.apply(f,arguments)}}function p(l,f,g){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function m(l,f){var g=Array.prototype.slice.call(arguments,1);return function(){var _=g.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function w(l,f){function g(){}g.prototype=f.prototype,l.aa=f.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(_,P,D){for(var z=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)z[Te-2]=arguments[Te];return f.prototype[P].apply(_,z)}}function R(l){const f=l.length;if(0<f){const g=Array(f);for(let _=0;_<f;_++)g[_]=l[_];return g}return[]}function k(l,f){for(let g=1;g<arguments.length;g++){const _=arguments[g];if(c(_)){const P=l.length||0,D=_.length||0;l.length=P+D;for(let z=0;z<D;z++)l[P+z]=_[z]}else l.push(_)}}class O{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function M(l){return/^[\s\xa0]*$/.test(l)}function F(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function q(l){return q[" "](l),l}q[" "]=function(){};var H=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function J(l,f,g){for(const _ in l)f.call(g,l[_],_,l)}function I(l,f){for(const g in l)f.call(void 0,l[g],g,l)}function v(l){const f={};for(const g in l)f[g]=l[g];return f}const y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(l,f){let g,_;for(let P=1;P<arguments.length;P++){_=arguments[P];for(g in _)l[g]=_[g];for(let D=0;D<y.length;D++)g=y[D],Object.prototype.hasOwnProperty.call(_,g)&&(l[g]=_[g])}}function S(l){var f=1;l=l.split(":");const g=[];for(;0<f&&l.length;)g.push(l.shift()),f--;return l.length&&g.push(l.join(":")),g}function T(l){a.setTimeout(()=>{throw l},0)}function E(){var l=Kt;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class K{constructor(){this.h=this.g=null}add(f,g){const _=oe.get();_.set(f,g),this.h?this.h.next=_:this.g=_,this.h=_}}var oe=new O(()=>new ge,l=>l.reset());class ge{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let de,ve=!1,Kt=new K,Ht=()=>{const l=a.Promise.resolve(void 0);de=()=>{l.then(Wt)}};var Wt=()=>{for(var l;l=E();){try{l.h.call(l.g)}catch(g){T(g)}var f=oe;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}ve=!1};function Fe(){this.s=this.s,this.C=this.C}Fe.prototype.s=!1,Fe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Fe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function De(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}De.prototype.h=function(){this.defaultPrevented=!0};var Bn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};a.addEventListener("test",g,f),a.removeEventListener("test",g,f)}catch{}return l}();function hn(l,f){if(De.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(H){e:{try{q(f.nodeName);var P=!0;break e}catch{}P=!1}P||(f=null)}}else g=="mouseover"?f=l.fromElement:g=="mouseout"&&(f=l.toElement);this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Tt[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&hn.aa.h.call(this)}}w(hn,De);var Tt={2:"touch",3:"pen",4:"mouse"};hn.prototype.h=function(){hn.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var V="closure_listenable_"+(1e6*Math.random()|0),Y=0;function Q(l,f,g,_,P){this.listener=l,this.proxy=null,this.src=f,this.type=g,this.capture=!!_,this.ha=P,this.key=++Y,this.da=this.fa=!1}function ee(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function x(l){this.src=l,this.g={},this.h=0}x.prototype.add=function(l,f,g,_,P){var D=l.toString();l=this.g[D],l||(l=this.g[D]=[],this.h++);var z=A(l,f,_,P);return-1<z?(f=l[z],g||(f.fa=!1)):(f=new Q(f,this.src,D,!!_,P),f.fa=g,l.push(f)),f};function b(l,f){var g=f.type;if(g in l.g){var _=l.g[g],P=Array.prototype.indexOf.call(_,f,void 0),D;(D=0<=P)&&Array.prototype.splice.call(_,P,1),D&&(ee(f),l.g[g].length==0&&(delete l.g[g],l.h--))}}function A(l,f,g,_){for(var P=0;P<l.length;++P){var D=l[P];if(!D.da&&D.listener==f&&D.capture==!!g&&D.ha==_)return P}return-1}var N="closure_lm_"+(1e6*Math.random()|0),L={};function U(l,f,g,_,P){if(Array.isArray(f)){for(var D=0;D<f.length;D++)U(l,f[D],g,_,P);return null}return g=ce(g),l&&l[V]?l.K(f,g,u(_)?!!_.capture:!1,P):B(l,f,g,!1,_,P)}function B(l,f,g,_,P,D){if(!f)throw Error("Invalid event type");var z=u(P)?!!P.capture:!!P,Te=X(l);if(Te||(l[N]=Te=new x(l)),g=Te.add(f,g,_,z,D),g.proxy)return g;if(_=G(),g.proxy=_,_.src=l,_.listener=g,l.addEventListener)Bn||(P=z),P===void 0&&(P=!1),l.addEventListener(f.toString(),_,P);else if(l.attachEvent)l.attachEvent(W(f.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return g}function G(){function l(g){return f.call(l.src,l.listener,g)}const f=Z;return l}function $(l,f,g,_,P){if(Array.isArray(f))for(var D=0;D<f.length;D++)$(l,f[D],g,_,P);else _=u(_)?!!_.capture:!!_,g=ce(g),l&&l[V]?(l=l.i,f=String(f).toString(),f in l.g&&(D=l.g[f],g=A(D,g,_,P),-1<g&&(ee(D[g]),Array.prototype.splice.call(D,g,1),D.length==0&&(delete l.g[f],l.h--)))):l&&(l=X(l))&&(f=l.g[f.toString()],l=-1,f&&(l=A(f,g,_,P)),(g=-1<l?f[l]:null)&&j(g))}function j(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[V])b(f.i,l);else{var g=l.type,_=l.proxy;f.removeEventListener?f.removeEventListener(g,_,l.capture):f.detachEvent?f.detachEvent(W(g),_):f.addListener&&f.removeListener&&f.removeListener(_),(g=X(f))?(b(g,l),g.h==0&&(g.src=null,f[N]=null)):ee(l)}}}function W(l){return l in L?L[l]:L[l]="on"+l}function Z(l,f){if(l.da)l=!0;else{f=new hn(f,this);var g=l.listener,_=l.ha||l.src;l.fa&&j(l),l=g.call(_,f)}return l}function X(l){return l=l[N],l instanceof x?l:null}var ne="__closure_events_fn_"+(1e9*Math.random()>>>0);function ce(l){return typeof l=="function"?l:(l[ne]||(l[ne]=function(f){return l.handleEvent(f)}),l[ne])}function ae(){Fe.call(this),this.i=new x(this),this.M=this,this.F=null}w(ae,Fe),ae.prototype[V]=!0,ae.prototype.removeEventListener=function(l,f,g,_){$(this,l,f,g,_)};function le(l,f){var g,_=l.F;if(_)for(g=[];_;_=_.F)g.push(_);if(l=l.M,_=f.type||f,typeof f=="string")f=new De(f,l);else if(f instanceof De)f.target=f.target||l;else{var P=f;f=new De(_,l),C(f,P)}if(P=!0,g)for(var D=g.length-1;0<=D;D--){var z=f.g=g[D];P=we(z,_,!0,f)&&P}if(z=f.g=l,P=we(z,_,!0,f)&&P,P=we(z,_,!1,f)&&P,g)for(D=0;D<g.length;D++)z=f.g=g[D],P=we(z,_,!1,f)&&P}ae.prototype.N=function(){if(ae.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var g=l.g[f],_=0;_<g.length;_++)ee(g[_]);delete l.g[f],l.h--}}this.F=null},ae.prototype.K=function(l,f,g,_){return this.i.add(String(l),f,!1,g,_)},ae.prototype.L=function(l,f,g,_){return this.i.add(String(l),f,!0,g,_)};function we(l,f,g,_){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var P=!0,D=0;D<f.length;++D){var z=f[D];if(z&&!z.da&&z.capture==g){var Te=z.listener,it=z.ha||z.src;z.fa&&b(l.i,z),P=Te.call(it,_)!==!1&&P}}return P&&!_.defaultPrevented}function rt(l,f,g){if(typeof l=="function")g&&(l=p(l,g));else if(l&&typeof l.handleEvent=="function")l=p(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(l,f||0)}function pt(l){l.g=rt(()=>{l.g=null,l.i&&(l.i=!1,pt(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class Mt extends Fe{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:pt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ct(l){Fe.call(this),this.h=l,this.g={}}w(Ct,Fe);var Us=[];function Jt(l){J(l.g,function(f,g){this.g.hasOwnProperty(g)&&j(f)},l),l.g={}}Ct.prototype.N=function(){Ct.aa.N.call(this),Jt(this)},Ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ht=a.JSON.stringify,jn=a.JSON.parse,Ji=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function ui(){}ui.prototype.h=null;function cd(l){return l.h||(l.h=l.i())}function ud(){}var Er={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Vl(){De.call(this,"d")}w(Vl,De);function Fl(){De.call(this,"c")}w(Fl,De);var vs={},hd=null;function Zi(){return hd=hd||new ae}vs.La="serverreachability";function dd(l){De.call(this,vs.La,l)}w(dd,De);function br(l){const f=Zi();le(f,new dd(f))}vs.STAT_EVENT="statevent";function fd(l,f){De.call(this,vs.STAT_EVENT,l),this.stat=f}w(fd,De);function gt(l){const f=Zi();le(f,new fd(f,l))}vs.Ma="timingevent";function pd(l,f){De.call(this,vs.Ma,l),this.size=f}w(pd,De);function Tr(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function Cr(){this.g=!0}Cr.prototype.xa=function(){this.g=!1};function ME(l,f,g,_,P,D){l.info(function(){if(l.g)if(D)for(var z="",Te=D.split("&"),it=0;it<Te.length;it++){var me=Te[it].split("=");if(1<me.length){var ct=me[0];me=me[1];var mt=ct.split("_");z=2<=mt.length&&mt[1]=="type"?z+(ct+"="+me+"&"):z+(ct+"=redacted&")}}else z=null;else z=D;return"XMLHTTP REQ ("+_+") [attempt "+P+"]: "+f+`
`+g+`
`+z})}function VE(l,f,g,_,P,D,z){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+P+"]: "+f+`
`+g+`
`+D+" "+z})}function Gs(l,f,g,_){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+UE(l,g)+(_?" "+_:"")})}function FE(l,f){l.info(function(){return"TIMEOUT: "+f})}Cr.prototype.info=function(){};function UE(l,f){if(!l.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var _=g[l];if(!(2>_.length)){var P=_[1];if(Array.isArray(P)&&!(1>P.length)){var D=P[0];if(D!="noop"&&D!="stop"&&D!="close")for(var z=1;z<P.length;z++)P[z]=""}}}}return ht(g)}catch{return f}}var eo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ul;function to(){}w(to,ui),to.prototype.g=function(){return new XMLHttpRequest},to.prototype.i=function(){return{}},Ul=new to;function $n(l,f,g,_){this.j=l,this.i=f,this.l=g,this.R=_||1,this.U=new Ct(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new md}function md(){this.i=null,this.g="",this.h=!1}var _d={},ql={};function Bl(l,f,g){l.L=1,l.v=io(En(f)),l.m=g,l.P=!0,yd(l,null)}function yd(l,f){l.F=Date.now(),no(l),l.A=En(l.v);var g=l.A,_=l.R;Array.isArray(_)||(_=[String(_)]),xd(g.i,"t",_),l.C=0,g=l.j.J,l.h=new md,l.g=Yd(l.j,g?f:null,!l.m),0<l.O&&(l.M=new Mt(p(l.Y,l,l.g),l.O)),f=l.U,g=l.g,_=l.ca;var P="readystatechange";Array.isArray(P)||(P&&(Us[0]=P.toString()),P=Us);for(var D=0;D<P.length;D++){var z=U(g,P[D],_||f.handleEvent,!1,f.h||f);if(!z)break;f.g[z.key]=z}f=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),br(),ME(l.i,l.u,l.A,l.l,l.R,l.m)}$n.prototype.ca=function(l){l=l.target;const f=this.M;f&&bn(l)==3?f.j():this.Y(l)},$n.prototype.Y=function(l){try{if(l==this.g)e:{const mt=bn(this.g);var f=this.g.Ba();const Xs=this.g.Z();if(!(3>mt)&&(mt!=3||this.g&&(this.h.h||this.g.oa()||Ud(this.g)))){this.J||mt!=4||f==7||(f==8||0>=Xs?br(3):br(2)),jl(this);var g=this.g.Z();this.X=g;t:if(vd(this)){var _=Ud(this.g);l="";var P=_.length,D=bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ws(this),Ir(this);var z="";break t}this.h.i=new a.TextDecoder}for(f=0;f<P;f++)this.h.h=!0,l+=this.h.i.decode(_[f],{stream:!(D&&f==P-1)});_.length=0,this.h.g+=l,this.C=0,z=this.h.g}else z=this.g.oa();if(this.o=g==200,VE(this.i,this.u,this.A,this.l,this.R,mt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Te,it=this.g;if((Te=it.g?it.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(Te)){var me=Te;break t}}me=null}if(g=me)Gs(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$l(this,g);else{this.o=!1,this.s=3,gt(12),ws(this),Ir(this);break e}}if(this.P){g=!0;let Gt;for(;!this.J&&this.C<z.length;)if(Gt=qE(this,z),Gt==ql){mt==4&&(this.s=4,gt(14),g=!1),Gs(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==_d){this.s=4,gt(15),Gs(this.i,this.l,z,"[Invalid Chunk]"),g=!1;break}else Gs(this.i,this.l,Gt,null),$l(this,Gt);if(vd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||z.length!=0||this.h.h||(this.s=1,gt(16),g=!1),this.o=this.o&&g,!g)Gs(this.i,this.l,z,"[Invalid Chunked Response]"),ws(this),Ir(this);else if(0<z.length&&!this.W){this.W=!0;var ct=this.j;ct.g==this&&ct.ba&&!ct.M&&(ct.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),Ql(ct),ct.M=!0,gt(11))}}else Gs(this.i,this.l,z,null),$l(this,z);mt==4&&ws(this),this.o&&!this.J&&(mt==4?Wd(this.j,this):(this.o=!1,no(this)))}else sb(this.g),g==400&&0<z.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),ws(this),Ir(this)}}}catch{}finally{}};function vd(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function qE(l,f){var g=l.C,_=f.indexOf(`
`,g);return _==-1?ql:(g=Number(f.substring(g,_)),isNaN(g)?_d:(_+=1,_+g>f.length?ql:(f=f.slice(_,_+g),l.C=_+g,f)))}$n.prototype.cancel=function(){this.J=!0,ws(this)};function no(l){l.S=Date.now()+l.I,wd(l,l.I)}function wd(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Tr(p(l.ba,l),f)}function jl(l){l.B&&(a.clearTimeout(l.B),l.B=null)}$n.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(FE(this.i,this.A),this.L!=2&&(br(),gt(17)),ws(this),this.s=2,Ir(this)):wd(this,this.S-l)};function Ir(l){l.j.G==0||l.J||Wd(l.j,l)}function ws(l){jl(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,Jt(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function $l(l,f){try{var g=l.j;if(g.G!=0&&(g.g==l||zl(g.h,l))){if(!l.K&&zl(g.h,l)&&g.G==3){try{var _=g.Da.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var P=_;if(P[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)ho(g),co(g);else break e;Gl(g),gt(18)}}else g.za=P[1],0<g.za-g.T&&37500>P[2]&&g.F&&g.v==0&&!g.C&&(g.C=Tr(p(g.Za,g),6e3));if(1>=Td(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else bs(g,11)}else if((l.K||g.g==l)&&ho(g),!M(f))for(P=g.Da.g.parse(f),f=0;f<P.length;f++){let me=P[f];if(g.T=me[0],me=me[1],g.G==2)if(me[0]=="c"){g.K=me[1],g.ia=me[2];const ct=me[3];ct!=null&&(g.la=ct,g.j.info("VER="+g.la));const mt=me[4];mt!=null&&(g.Aa=mt,g.j.info("SVER="+g.Aa));const Xs=me[5];Xs!=null&&typeof Xs=="number"&&0<Xs&&(_=1.5*Xs,g.L=_,g.j.info("backChannelRequestTimeoutMs_="+_)),_=g;const Gt=l.g;if(Gt){const po=Gt.g?Gt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(po){var D=_.h;D.g||po.indexOf("spdy")==-1&&po.indexOf("quic")==-1&&po.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(Hl(D,D.h),D.h=null))}if(_.D){const Yl=Gt.g?Gt.g.getResponseHeader("X-HTTP-Session-Id"):null;Yl&&(_.ya=Yl,Se(_.I,_.D,Yl))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),_=g;var z=l;if(_.qa=Qd(_,_.J?_.ia:null,_.W),z.K){Cd(_.h,z);var Te=z,it=_.L;it&&(Te.I=it),Te.B&&(jl(Te),no(Te)),_.g=z}else zd(_);0<g.i.length&&uo(g)}else me[0]!="stop"&&me[0]!="close"||bs(g,7);else g.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?bs(g,7):Kl(g):me[0]!="noop"&&g.l&&g.l.ta(me),g.v=0)}}br(4)}catch{}}var BE=class{constructor(l,f){this.g=l,this.map=f}};function Ed(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bd(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Td(l){return l.h?1:l.g?l.g.size:0}function zl(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Hl(l,f){l.g?l.g.add(f):l.h=f}function Cd(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Ed.prototype.cancel=function(){if(this.i=Id(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Id(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const g of l.g.values())f=f.concat(g.D);return f}return R(l.i)}function jE(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var f=[],g=l.length,_=0;_<g;_++)f.push(l[_]);return f}f=[],g=0;for(_ in l)f[g++]=l[_];return f}function $E(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var f=[];l=l.length;for(var g=0;g<l;g++)f.push(g);return f}f=[],g=0;for(const _ in l)f[g++]=_;return f}}}function Sd(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var g=$E(l),_=jE(l),P=_.length,D=0;D<P;D++)f.call(void 0,_[D],g&&g[D],l)}var Rd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zE(l,f){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var _=l[g].indexOf("="),P=null;if(0<=_){var D=l[g].substring(0,_);P=l[g].substring(_+1)}else D=l[g];f(D,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function Es(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Es){this.h=l.h,so(this,l.j),this.o=l.o,this.g=l.g,ro(this,l.s),this.l=l.l;var f=l.i,g=new Ar;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),Ad(this,g),this.m=l.m}else l&&(f=String(l).match(Rd))?(this.h=!1,so(this,f[1]||"",!0),this.o=Sr(f[2]||""),this.g=Sr(f[3]||"",!0),ro(this,f[4]),this.l=Sr(f[5]||"",!0),Ad(this,f[6]||"",!0),this.m=Sr(f[7]||"")):(this.h=!1,this.i=new Ar(null,this.h))}Es.prototype.toString=function(){var l=[],f=this.j;f&&l.push(Rr(f,kd,!0),":");var g=this.g;return(g||f=="file")&&(l.push("//"),(f=this.o)&&l.push(Rr(f,kd,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Rr(g,g.charAt(0)=="/"?KE:WE,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Rr(g,QE)),l.join("")};function En(l){return new Es(l)}function so(l,f,g){l.j=g?Sr(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function ro(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function Ad(l,f,g){f instanceof Ar?(l.i=f,YE(l.i,l.h)):(g||(f=Rr(f,GE)),l.i=new Ar(f,l.h))}function Se(l,f,g){l.i.set(f,g)}function io(l){return Se(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Sr(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Rr(l,f,g){return typeof l=="string"?(l=encodeURI(l).replace(f,HE),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function HE(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var kd=/[#\/\?@]/g,WE=/[#\?:]/g,KE=/[#\?]/g,GE=/[#\?@]/g,QE=/#/g;function Ar(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function zn(l){l.g||(l.g=new Map,l.h=0,l.i&&zE(l.i,function(f,g){l.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=Ar.prototype,t.add=function(l,f){zn(this),this.i=null,l=Qs(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(f),this.h+=1,this};function Pd(l,f){zn(l),f=Qs(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Nd(l,f){return zn(l),f=Qs(l,f),l.g.has(f)}t.forEach=function(l,f){zn(this),this.g.forEach(function(g,_){g.forEach(function(P){l.call(f,P,_,this)},this)},this)},t.na=function(){zn(this);const l=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let _=0;_<f.length;_++){const P=l[_];for(let D=0;D<P.length;D++)g.push(f[_])}return g},t.V=function(l){zn(this);let f=[];if(typeof l=="string")Nd(this,l)&&(f=f.concat(this.g.get(Qs(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)f=f.concat(l[g])}return f},t.set=function(l,f){return zn(this),this.i=null,l=Qs(this,l),Nd(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function xd(l,f,g){Pd(l,f),0<g.length&&(l.i=null,l.g.set(Qs(l,f),R(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var _=f[g];const D=encodeURIComponent(String(_)),z=this.V(_);for(_=0;_<z.length;_++){var P=D;z[_]!==""&&(P+="="+encodeURIComponent(String(z[_]))),l.push(P)}}return this.i=l.join("&")};function Qs(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function YE(l,f){f&&!l.j&&(zn(l),l.i=null,l.g.forEach(function(g,_){var P=_.toLowerCase();_!=P&&(Pd(this,_),xd(this,P,g))},l)),l.j=f}function XE(l,f){const g=new Cr;if(a.Image){const _=new Image;_.onload=m(Hn,g,"TestLoadImage: loaded",!0,f,_),_.onerror=m(Hn,g,"TestLoadImage: error",!1,f,_),_.onabort=m(Hn,g,"TestLoadImage: abort",!1,f,_),_.ontimeout=m(Hn,g,"TestLoadImage: timeout",!1,f,_),a.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else f(!1)}function JE(l,f){const g=new Cr,_=new AbortController,P=setTimeout(()=>{_.abort(),Hn(g,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:_.signal}).then(D=>{clearTimeout(P),D.ok?Hn(g,"TestPingServer: ok",!0,f):Hn(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(P),Hn(g,"TestPingServer: error",!1,f)})}function Hn(l,f,g,_,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),_(g)}catch{}}function ZE(){this.g=new Ji}function eb(l,f,g){const _=g||"";try{Sd(l,function(P,D){let z=P;u(P)&&(z=ht(P)),f.push(_+D+"="+encodeURIComponent(z))})}catch(P){throw f.push(_+"type="+encodeURIComponent("_badmap")),P}}function oo(l){this.l=l.Ub||null,this.j=l.eb||!1}w(oo,ui),oo.prototype.g=function(){return new ao(this.l,this.j)},oo.prototype.i=function(l){return function(){return l}}({});function ao(l,f){ae.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(ao,ae),t=ao.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,Pr(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,kr(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Pr(this)),this.g&&(this.readyState=3,Pr(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Dd(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Dd(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?kr(this):Pr(this),this.readyState==3&&Dd(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,kr(this))},t.Qa=function(l){this.g&&(this.response=l,kr(this))},t.ga=function(){this.g&&kr(this)};function kr(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Pr(l)}t.setRequestHeader=function(l,f){this.u.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=f.next();return l.join(`\r
`)};function Pr(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ao.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Od(l){let f="";return J(l,function(g,_){f+=_,f+=":",f+=g,f+=`\r
`}),f}function Wl(l,f,g){e:{for(_ in g){var _=!1;break e}_=!0}_||(g=Od(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Se(l,f,g))}function Ue(l){ae.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Ue,ae);var tb=/^https?$/i,nb=["POST","PUT"];t=Ue.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,f,g,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ul.g(),this.v=this.o?cd(this.o):cd(Ul),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(D){Ld(this,D);return}if(l=g||"",g=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var P in _)g.set(P,_[P]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const D of _.keys())g.set(D,_.get(D));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(g.keys()).find(D=>D.toLowerCase()=="content-type"),P=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(nb,f,void 0))||_||P||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[D,z]of g)this.g.setRequestHeader(D,z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fd(this),this.u=!0,this.g.send(l),this.u=!1}catch(D){Ld(this,D)}};function Ld(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,Md(l),lo(l)}function Md(l){l.A||(l.A=!0,le(l,"complete"),le(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,le(this,"complete"),le(this,"abort"),lo(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),lo(this,!0)),Ue.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Vd(this):this.bb())},t.bb=function(){Vd(this)};function Vd(l){if(l.h&&typeof o<"u"&&(!l.v[1]||bn(l)!=4||l.Z()!=2)){if(l.u&&bn(l)==4)rt(l.Ea,0,l);else if(le(l,"readystatechange"),bn(l)==4){l.h=!1;try{const z=l.Z();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var _;if(_=z===0){var P=String(l.D).match(Rd)[1]||null;!P&&a.self&&a.self.location&&(P=a.self.location.protocol.slice(0,-1)),_=!tb.test(P?P.toLowerCase():"")}g=_}if(g)le(l,"complete"),le(l,"success");else{l.m=6;try{var D=2<bn(l)?l.g.statusText:""}catch{D=""}l.l=D+" ["+l.Z()+"]",Md(l)}}finally{lo(l)}}}}function lo(l,f){if(l.g){Fd(l);const g=l.g,_=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||le(l,"ready");try{g.onreadystatechange=_}catch{}}}function Fd(l){l.I&&(a.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function bn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<bn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),jn(f)}};function Ud(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function sb(l){const f={};l=(l.g&&2<=bn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(M(l[_]))continue;var g=S(l[_]);const P=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const D=f[P]||[];f[P]=D,D.push(g)}I(f,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Nr(l,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||f}function qd(l){this.Aa=0,this.i=[],this.j=new Cr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Nr("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Nr("baseRetryDelayMs",5e3,l),this.cb=Nr("retryDelaySeedMs",1e4,l),this.Wa=Nr("forwardChannelMaxRetries",2,l),this.wa=Nr("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Ed(l&&l.concurrentRequestLimit),this.Da=new ZE,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=qd.prototype,t.la=8,t.G=1,t.connect=function(l,f,g,_){gt(0),this.W=l,this.H=f||{},g&&_!==void 0&&(this.H.OSID=g,this.H.OAID=_),this.F=this.X,this.I=Qd(this,null,this.W),uo(this)};function Kl(l){if(Bd(l),l.G==3){var f=l.U++,g=En(l.I);if(Se(g,"SID",l.K),Se(g,"RID",f),Se(g,"TYPE","terminate"),xr(l,g),f=new $n(l,l.j,f),f.L=2,f.v=io(En(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&a.Image&&(new Image().src=f.v,g=!0),g||(f.g=Yd(f.j,null),f.g.ea(f.v)),f.F=Date.now(),no(f)}Gd(l)}function co(l){l.g&&(Ql(l),l.g.cancel(),l.g=null)}function Bd(l){co(l),l.u&&(a.clearTimeout(l.u),l.u=null),ho(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function uo(l){if(!bd(l.h)&&!l.s){l.s=!0;var f=l.Ga;de||Ht(),ve||(de(),ve=!0),Kt.add(f,l),l.B=0}}function rb(l,f){return Td(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Tr(p(l.Ga,l,f),Kd(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const P=new $n(this,this.j,l);let D=this.o;if(this.S&&(D?(D=v(D),C(D,this.S)):D=this.S),this.m!==null||this.O||(P.H=D,D=null),this.P)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var _=this.i[g];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(f+=_,4096<f){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=$d(this,P,f),g=En(this.I),Se(g,"RID",l),Se(g,"CVER",22),this.D&&Se(g,"X-HTTP-Session-Id",this.D),xr(this,g),D&&(this.O?f="headers="+encodeURIComponent(String(Od(D)))+"&"+f:this.m&&Wl(g,this.m,D)),Hl(this.h,P),this.Ua&&Se(g,"TYPE","init"),this.P?(Se(g,"$req",f),Se(g,"SID","null"),P.T=!0,Bl(P,g,null)):Bl(P,g,f),this.G=2}}else this.G==3&&(l?jd(this,l):this.i.length==0||bd(this.h)||jd(this))};function jd(l,f){var g;f?g=f.l:g=l.U++;const _=En(l.I);Se(_,"SID",l.K),Se(_,"RID",g),Se(_,"AID",l.T),xr(l,_),l.m&&l.o&&Wl(_,l.m,l.o),g=new $n(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),f&&(l.i=f.D.concat(l.i)),f=$d(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Hl(l.h,g),Bl(g,_,f)}function xr(l,f){l.H&&J(l.H,function(g,_){Se(f,_,g)}),l.l&&Sd({},function(g,_){Se(f,_,g)})}function $d(l,f,g){g=Math.min(l.i.length,g);var _=l.l?p(l.l.Na,l.l,l):null;e:{var P=l.i;let D=-1;for(;;){const z=["count="+g];D==-1?0<g?(D=P[0].g,z.push("ofs="+D)):D=0:z.push("ofs="+D);let Te=!0;for(let it=0;it<g;it++){let me=P[it].g;const ct=P[it].map;if(me-=D,0>me)D=Math.max(0,P[it].g-100),Te=!1;else try{eb(ct,z,"req"+me+"_")}catch{_&&_(ct)}}if(Te){_=z.join("&");break e}}}return l=l.i.splice(0,g),f.D=l,_}function zd(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;de||Ht(),ve||(de(),ve=!0),Kt.add(f,l),l.v=0}}function Gl(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Tr(p(l.Fa,l),Kd(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Hd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Tr(p(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),co(this),Hd(this))};function Ql(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function Hd(l){l.g=new $n(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=En(l.qa);Se(f,"RID","rpc"),Se(f,"SID",l.K),Se(f,"AID",l.T),Se(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&Se(f,"TO",l.ja),Se(f,"TYPE","xmlhttp"),xr(l,f),l.m&&l.o&&Wl(f,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=io(En(f)),g.m=null,g.P=!0,yd(g,l)}t.Za=function(){this.C!=null&&(this.C=null,co(this),Gl(this),gt(19))};function ho(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Wd(l,f){var g=null;if(l.g==f){ho(l),Ql(l),l.g=null;var _=2}else if(zl(l.h,f))g=f.D,Cd(l.h,f),_=1;else return;if(l.G!=0){if(f.o)if(_==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var P=l.B;_=Zi(),le(_,new pd(_,g)),uo(l)}else zd(l);else if(P=f.s,P==3||P==0&&0<f.X||!(_==1&&rb(l,f)||_==2&&Gl(l)))switch(g&&0<g.length&&(f=l.h,f.i=f.i.concat(g)),P){case 1:bs(l,5);break;case 4:bs(l,10);break;case 3:bs(l,6);break;default:bs(l,2)}}}function Kd(l,f){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*f}function bs(l,f){if(l.j.info("Error code "+f),f==2){var g=p(l.fb,l),_=l.Xa;const P=!_;_=new Es(_||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||so(_,"https"),io(_),P?XE(_.toString(),g):JE(_.toString(),g)}else gt(2);l.G=0,l.l&&l.l.sa(f),Gd(l),Bd(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Gd(l){if(l.G=0,l.ka=[],l.l){const f=Id(l.h);(f.length!=0||l.i.length!=0)&&(k(l.ka,f),k(l.ka,l.i),l.h.i.length=0,R(l.i),l.i.length=0),l.l.ra()}}function Qd(l,f,g){var _=g instanceof Es?En(g):new Es(g);if(_.g!="")f&&(_.g=f+"."+_.g),ro(_,_.s);else{var P=a.location;_=P.protocol,f=f?f+"."+P.hostname:P.hostname,P=+P.port;var D=new Es(null);_&&so(D,_),f&&(D.g=f),P&&ro(D,P),g&&(D.l=g),_=D}return g=l.D,f=l.ya,g&&f&&Se(_,g,f),Se(_,"VER",l.la),xr(l,_),_}function Yd(l,f,g){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new Ue(new oo({eb:g})):new Ue(l.pa),f.Ha(l.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xd(){}t=Xd.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function fo(){}fo.prototype.g=function(l,f){return new Rt(l,f)};function Rt(l,f){ae.call(this),this.g=new qd(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!M(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!M(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Ys(this)}w(Rt,ae),Rt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Rt.prototype.close=function(){Kl(this.g)},Rt.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=ht(l),l=g);f.i.push(new BE(f.Ya++,l)),f.G==3&&uo(f)},Rt.prototype.N=function(){this.g.l=null,delete this.j,Kl(this.g),delete this.g,Rt.aa.N.call(this)};function Jd(l){Vl.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const g in f){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}w(Jd,Vl);function Zd(){Fl.call(this),this.status=1}w(Zd,Fl);function Ys(l){this.g=l}w(Ys,Xd),Ys.prototype.ua=function(){le(this.g,"a")},Ys.prototype.ta=function(l){le(this.g,new Jd(l))},Ys.prototype.sa=function(l){le(this.g,new Zd)},Ys.prototype.ra=function(){le(this.g,"b")},fo.prototype.createWebChannel=fo.prototype.g,Rt.prototype.send=Rt.prototype.o,Rt.prototype.open=Rt.prototype.m,Rt.prototype.close=Rt.prototype.close,T2=function(){return new fo},b2=function(){return Zi()},E2=vs,aC={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},eo.NO_ERROR=0,eo.TIMEOUT=8,eo.HTTP_ERROR=6,o_=eo,gd.COMPLETE="complete",w2=gd,ud.EventType=Er,Er.OPEN="a",Er.CLOSE="b",Er.ERROR="c",Er.MESSAGE="d",ae.prototype.listen=ae.prototype.K,Tf=ud,Ue.prototype.listenOnce=Ue.prototype.L,Ue.prototype.getLastError=Ue.prototype.Ka,Ue.prototype.getLastErrorCode=Ue.prototype.Ba,Ue.prototype.getStatus=Ue.prototype.Z,Ue.prototype.getResponseJson=Ue.prototype.Oa,Ue.prototype.getResponseText=Ue.prototype.oa,Ue.prototype.send=Ue.prototype.ea,Ue.prototype.setWithCredentials=Ue.prototype.Ha,v2=Ue}).apply(typeof Sm<"u"?Sm:typeof self<"u"?self:typeof window<"u"?window:{});const XP="@firebase/firestore",JP="4.9.0";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let rs=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};rs.UNAUTHENTICATED=new rs(null),rs.GOOGLE_CREDENTIALS=new rs("google-credentials-uid"),rs.FIRST_PARTY=new rs("first-party-uid"),rs.MOCK_USER=new rs("mock-user");/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Hh="12.0.0";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Vc=new Yv("@firebase/firestore");function Au(){return Vc.logLevel}function fe(t,...e){if(Vc.logLevel<=Ye.DEBUG){const n=e.map(WS);Vc.debug(`Firestore (${Hh}): ${t}`,...n)}}function Wo(t,...e){if(Vc.logLevel<=Ye.ERROR){const n=e.map(WS);Vc.error(`Firestore (${Hh}): ${t}`,...n)}}function _h(t,...e){if(Vc.logLevel<=Ye.WARN){const n=e.map(WS);Vc.warn(`Firestore (${Hh}): ${t}`,...n)}}function WS(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(t)}catch{return t}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ke(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,C2(t,s,n)}function C2(t,e,n){let s=`FIRESTORE (${Hh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw Wo(s),new Error(s)}function Et(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||C2(e,r,s)}function ze(t,e){return t}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _e extends Qi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qa{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class I2{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class LK{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(rs.UNAUTHENTICATED))}shutdown(){}}class MK{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class VK{constructor(e){this.t=e,this.currentUser=rs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Et(this.o===void 0,42304);let s=this.i;const r=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let i=new qa;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new qa,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new qa)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Et(typeof s.accessToken=="string",31837,{l:s}),new I2(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new rs(e)}}class FK{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=rs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class UK{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new FK(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(rs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ZP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qK{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Zs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Et(this.o===void 0,3512);const s=i=>{i.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ZP(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Et(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new ZP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function BK(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class KS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=BK(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%62))}return s}}function et(t,e){return t<e?-1:t>e?1:0}function lC(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),i=e.charAt(s);if(r!==i)return kb(r)===kb(i)?et(r,i):kb(r)?1:-1}return et(t.length,e.length)}const jK=55296,$K=57343;function kb(t){const e=t.charCodeAt(0);return e>=jK&&e<=$K}function yh(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const e1="__name__";class wi{constructor(e,n,s){n===void 0?n=0:n>e.length&&ke(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&ke(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return wi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof wi?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=wi.compareSegments(e.get(r),n.get(r));if(i!==0)return i}return et(e.length,n.length)}static compareSegments(e,n){const s=wi.isNumericId(e),r=wi.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?wi.extractNumericId(e).compare(wi.extractNumericId(n)):lC(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ua.fromString(e.substring(4,e.length-2))}}class Yt extends wi{construct(e,n,s){return new Yt(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new _e(se.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new Yt(n)}static emptyPath(){return new Yt([])}}const zK=/^[_a-zA-Z][_a-zA-Z0-9]*$/;let Xr=class ku extends wi{construct(e,n,s){return new ku(e,n,s)}static isValidIdentifier(e){return zK.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ku.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===e1}static keyField(){return new ku([e1])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new _e(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new _e(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new _e(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new _e(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ku(n)}static emptyPath(){return new ku([])}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ce{constructor(e){this.path=e}static fromPath(e){return new Ce(Yt.fromString(e))}static fromName(e){return new Ce(Yt.fromString(e).popFirst(5))}static empty(){return new Ce(Yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Yt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ce(new Yt(e.slice()))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function HK(t,e,n){if(!n)throw new _e(se.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function WK(t,e,n,s){if(e===!0&&s===!0)throw new _e(se.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function t1(t){if(!Ce.isDocumentKey(t))throw new _e(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function S2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function GS(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ke(12329,{type:typeof t})}function Jr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new _e(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=GS(t);throw new _e(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
* @license
* Copyright 2025 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function mn(t,e){const n={typeString:t};return e&&(n.value=e),n}function Bg(t,e){if(!S2(t))throw new _e(se.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const o=t[s];if(r&&typeof o!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${s}' field to equal '${i.value}'`;break}}if(n)throw new _e(se.INVALID_ARGUMENT,n);return!0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const n1=-62135596800,s1=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*s1);return new Bt(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new _e(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new _e(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<n1)throw new _e(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _e(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/s1}_compareTo(e){return this.seconds===e.seconds?et(this.nanoseconds,e.nanoseconds):et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Bg(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-n1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:mn("string",Bt._jsonSchemaVersion),seconds:mn("number"),nanoseconds:mn("number")};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qe{static fromTimestamp(e){return new qe(e)}static min(){return new qe(new Bt(0,0))}static max(){return new qe(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const qp=-1;function KK(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=qe.fromTimestamp(s===1e9?new Bt(n+1,0):new Bt(n,s));return new il(r,Ce.empty(),e)}function GK(t){return new il(t.readTime,t.key,qp)}class il{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new il(qe.min(),Ce.empty(),qp)}static max(){return new il(qe.max(),Ce.empty(),qp)}}function QK(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ce.comparator(t.documentKey,e.documentKey),n!==0?n:et(t.largestBatchId,e.largestBatchId))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const YK="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XK{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Wh(t){if(t.code!==se.FAILED_PRECONDITION||t.message!==YK)throw t;fe("LocalStore","Unexpectedly lost primary lease")}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let ie=class qs{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new qs((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof qs?n:qs.resolve(n)}catch(n){return qs.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):qs.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):qs.reject(n)}static resolve(e){return new qs((n,s)=>{n(e)})}static reject(e){return new qs((n,s)=>{s(e)})}static waitFor(e){return new qs((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},c=>s(c))}),o=!0,i===r&&n()})}static or(e){let n=qs.resolve(!1);for(const s of e)n=n.next(r=>r?qs.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new qs((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(h=>{o[u]=h,++a,a===i&&s(o)},h=>r(h))}})}static doWhile(e,n){return new qs((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}};function JK(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Kh(t){return t.name==="IndexedDbTransactionError"}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class tw{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}tw.ce=-1;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const QS=-1;function nw(t){return t==null}function oy(t){return t===0&&1/t==-1/0}function ZK(t){return typeof t=="number"&&Number.isInteger(t)&&!oy(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const R2="";function eG(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=r1(e)),e=tG(t.get(n),e);return r1(e)}function tG(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case R2:n+="";break;default:n+=i}}return n}function r1(t){return t+R2+""}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function i1(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Nl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function A2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let vn=class cC{constructor(e,n){this.comparator=e,this.root=n||Ba.EMPTY}insert(e,n){return new cC(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ba.BLACK,null,null))}remove(e){return new cC(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ba.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rm(this.root,e,this.comparator,!0)}},Rm=class{constructor(t,e,n,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}},Ba=class vo{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??vo.RED,this.left=r??vo.EMPTY,this.right=i??vo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new vo(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return vo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return vo.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ke(27949);return e+(this.isRed()?0:1)}};Ba.EMPTY=null,Ba.RED=!0,Ba.BLACK=!1;Ba.EMPTY=new class{constructor(){this.size=0}get key(){throw ke(57766)}get value(){throw ke(16141)}get color(){throw ke(16727)}get left(){throw ke(29726)}get right(){throw ke(36894)}copy(t,e,n,s,r){return this}insert(t,e,n){return new Ba(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let ms=class uC{constructor(e){this.comparator=e,this.data=new vn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new o1(this.data.getIterator())}getIteratorFrom(e){return new o1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof uC)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new uC(this.comparator);return n.data=e,n}};class o1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Ii=class hC{constructor(e){this.fields=e,e.sort(Xr.comparator)}static empty(){return new hC([])}unionWith(e){let n=new ms(Xr.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new hC(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return yh(this.fields,e.fields,(n,s)=>n.isEqual(s))}};/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class k2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Yn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new k2("Invalid base64 string: "+r):r}}(e);return new Yn(n)}static fromUint8Array(e){const n=function(s){let r="";for(let i=0;i<s.length;++i)r+=String.fromCharCode(s[i]);return r}(e);return new Yn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yn.EMPTY_BYTE_STRING=new Yn("");const nG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ol(t){if(Et(!!t,39018),typeof t=="string"){let e=0;const n=nG.exec(t);if(Et(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:dn(t.seconds),nanos:dn(t.nanos)}}function dn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function al(t){return typeof t=="string"?Yn.fromBase64String(t):Yn.fromUint8Array(t)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const P2="server_timestamp",N2="__type__",x2="__previous_value__",D2="__local_write_time__";function YS(t){return(t?.mapValue?.fields||{})[N2]?.stringValue===P2}function sw(t){const e=t.mapValue.fields[x2];return YS(e)?sw(e):e}function Bp(t){const e=ol(t.mapValue.fields[D2].timestampValue);return new Bt(e.seconds,e.nanos)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class sG{constructor(e,n,s,r,i,o,a,c,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const ay="(default)";class jp{constructor(e,n){this.projectId=e,this.database=n||ay}static empty(){return new jp("","")}get isDefaultDatabase(){return this.database===ay}isEqual(e){return e instanceof jp&&e.projectId===this.projectId&&e.database===this.database}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const O2="__type__",rG="__max__",Am={mapValue:{}},L2="__vector__",ly="value";function ll(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?YS(t)?4:oG(t)?9007199254740991:iG(t)?10:11:ke(28295,{value:t})}function Bi(t,e){if(t===e)return!0;const n=ll(t);if(n!==ll(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Bp(t).isEqual(Bp(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const i=ol(s.timestampValue),o=ol(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,r){return al(s.bytesValue).isEqual(al(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,r){return dn(s.geoPointValue.latitude)===dn(r.geoPointValue.latitude)&&dn(s.geoPointValue.longitude)===dn(r.geoPointValue.longitude)}(t,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return dn(s.integerValue)===dn(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const i=dn(s.doubleValue),o=dn(r.doubleValue);return i===o?oy(i)===oy(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return yh(t.arrayValue.values||[],e.arrayValue.values||[],Bi);case 10:case 11:return function(s,r){const i=s.mapValue.fields||{},o=r.mapValue.fields||{};if(i1(i)!==i1(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Bi(i[a],o[a])))return!1;return!0}(t,e);default:return ke(52216,{left:t})}}function $p(t,e){return(t.values||[]).find(n=>Bi(n,e))!==void 0}function vh(t,e){if(t===e)return 0;const n=ll(t),s=ll(e);if(n!==s)return et(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return et(t.booleanValue,e.booleanValue);case 2:return function(r,i){const o=dn(r.integerValue||r.doubleValue),a=dn(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return a1(t.timestampValue,e.timestampValue);case 4:return a1(Bp(t),Bp(e));case 5:return lC(t.stringValue,e.stringValue);case 6:return function(r,i){const o=al(r),a=al(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,i){const o=r.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const u=et(o[c],a[c]);if(u!==0)return u}return et(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,i){const o=et(dn(r.latitude),dn(i.latitude));return o!==0?o:et(dn(r.longitude),dn(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return l1(t.arrayValue,e.arrayValue);case 10:return function(r,i){const o=r.fields||{},a=i.fields||{},c=o[ly]?.arrayValue,u=a[ly]?.arrayValue,h=et(c?.values?.length||0,u?.values?.length||0);return h!==0?h:l1(c,u)}(t.mapValue,e.mapValue);case 11:return function(r,i){if(r===Am.mapValue&&i===Am.mapValue)return 0;if(r===Am.mapValue)return 1;if(i===Am.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),c=i.fields||{},u=Object.keys(c);a.sort(),u.sort();for(let h=0;h<a.length&&h<u.length;++h){const d=lC(a[h],u[h]);if(d!==0)return d;const p=vh(o[a[h]],c[u[h]]);if(p!==0)return p}return et(a.length,u.length)}(t.mapValue,e.mapValue);default:throw ke(23264,{he:n})}}function a1(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return et(t,e);const n=ol(t),s=ol(e),r=et(n.seconds,s.seconds);return r!==0?r:et(n.nanos,s.nanos)}function l1(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=vh(n[r],s[r]);if(i)return i}return et(n.length,s.length)}function wh(t){return dC(t)}function dC(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(e){const n=ol(e);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(e){return al(e).toBase64()}(t.bytesValue):"referenceValue"in t?function(e){return Ce.fromName(e).toString()}(t.referenceValue):"geoPointValue"in t?function(e){return`geo(${e.latitude},${e.longitude})`}(t.geoPointValue):"arrayValue"in t?function(e){let n="[",s=!0;for(const r of e.values||[])s?s=!1:n+=",",n+=dC(r);return n+"]"}(t.arrayValue):"mapValue"in t?function(e){const n=Object.keys(e.fields||{}).sort();let s="{",r=!0;for(const i of n)r?r=!1:s+=",",s+=`${i}:${dC(e.fields[i])}`;return s+"}"}(t.mapValue):ke(61005,{value:t})}function a_(t){switch(ll(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=sw(t);return e?16+a_(e):16;case 5:return 2*t.stringValue.length;case 6:return al(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,r)=>s+a_(r),0)}(t.arrayValue);case 10:case 11:return function(n){let s=0;return Nl(n.fields,(r,i)=>{s+=r.length+a_(i)}),s}(t.mapValue);default:throw ke(13486,{value:t})}}function fC(t){return!!t&&"integerValue"in t}function XS(t){return!!t&&"arrayValue"in t}function c1(t){return!!t&&"nullValue"in t}function u1(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function l_(t){return!!t&&"mapValue"in t}function iG(t){return(t?.mapValue?.fields||{})[O2]?.stringValue===L2}function Yf(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Nl(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=Yf(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Yf(t.arrayValue.values[n]);return e}return{...t}}function oG(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===rG}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Vr=class pC{constructor(e){this.value=e}static empty(){return new pC({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!l_(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yf(n)}setAll(e){let n=Xr.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=Yf(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());l_(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Bi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];l_(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Nl(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new pC(Yf(this.value))}};function M2(t){const e=[];return Nl(t.fields,(n,s)=>{const r=new Xr([n]);if(l_(s)){const i=M2(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Ii(e)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ls{constructor(e,n,s,r,i,o,a){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ls(e,0,qe.min(),qe.min(),qe.min(),Vr.empty(),0)}static newFoundDocument(e,n,s,r){return new ls(e,1,n,qe.min(),s,r,0)}static newNoDocument(e,n){return new ls(e,2,n,qe.min(),qe.min(),Vr.empty(),0)}static newUnknownDocument(e,n){return new ls(e,3,n,qe.min(),qe.min(),Vr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ls&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ls(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class cy{constructor(e,n){this.position=e,this.inclusive=n}}function h1(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=Ce.comparator(Ce.fromName(o.referenceValue),n.key):s=vh(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function d1(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Bi(t.position[n],e.position[n]))return!1;return!0}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class uy{constructor(e,n="asc"){this.field=e,this.dir=n}}function aG(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class V2{}class Sn extends V2{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new cG(e,n,s):n==="array-contains"?new dG(e,s):n==="in"?new fG(e,s):n==="not-in"?new pG(e,s):n==="array-contains-any"?new gG(e,s):new Sn(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new uG(e,s):new hG(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(vh(n,this.value)):n!==null&&ll(this.value)===ll(n)&&this.matchesComparison(vh(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ji extends V2{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new ji(e,n)}matches(e){return F2(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function F2(t){return t.op==="and"}function U2(t){return lG(t)&&F2(t)}function lG(t){for(const e of t.filters)if(e instanceof ji)return!1;return!0}function gC(t){if(t instanceof Sn)return t.field.canonicalString()+t.op.toString()+wh(t.value);if(U2(t))return t.filters.map(e=>gC(e)).join(",");{const e=t.filters.map(n=>gC(n)).join(",");return`${t.op}(${e})`}}function q2(t,e){return t instanceof Sn?function(n,s){return s instanceof Sn&&n.op===s.op&&n.field.isEqual(s.field)&&Bi(n.value,s.value)}(t,e):t instanceof ji?function(n,s){return s instanceof ji&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((r,i,o)=>r&&q2(i,s.filters[o]),!0):!1}(t,e):void ke(19439)}function B2(t){return t instanceof Sn?function(e){return`${e.field.canonicalString()} ${e.op} ${wh(e.value)}`}(t):t instanceof ji?function(e){return e.op.toString()+" {"+e.getFilters().map(B2).join(" ,")+"}"}(t):"Filter"}class cG extends Sn{constructor(e,n,s){super(e,n,s),this.key=Ce.fromName(s.referenceValue)}matches(e){const n=Ce.comparator(e.key,this.key);return this.matchesComparison(n)}}class uG extends Sn{constructor(e,n){super(e,"in",n),this.keys=j2("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class hG extends Sn{constructor(e,n){super(e,"not-in",n),this.keys=j2("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function j2(t,e){return(e.arrayValue?.values||[]).map(n=>Ce.fromName(n.referenceValue))}class dG extends Sn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return XS(n)&&$p(n.arrayValue,this.value)}}class fG extends Sn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&$p(this.value.arrayValue,n)}}class pG extends Sn{constructor(e,n){super(e,"not-in",n)}matches(e){if($p(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!$p(this.value.arrayValue,n)}}class gG extends Sn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!XS(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>$p(this.value.arrayValue,s))}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class mG{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function f1(t,e=null,n=[],s=[],r=null,i=null,o=null){return new mG(t,e,n,s,r,i,o)}function JS(t){const e=ze(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>gC(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),nw(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>wh(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>wh(s)).join(",")),e.Te=n}return e.Te}function ZS(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!aG(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!q2(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!d1(t.startAt,e.startAt)&&d1(t.endAt,e.endAt)}function mC(t){return Ce.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class rw{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function _G(t,e,n,s,r,i,o,a){return new rw(t,e,n,s,r,i,o,a)}function iw(t){return new rw(t)}function p1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yG(t){return t.collectionGroup!==null}function Xf(t){const e=ze(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const r of e.explicitOrderBy)e.Ie.push(r),n.add(r.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(r){let i=new ms(Xr.comparator);return r.filters.forEach(o=>{o.getFlattenedFilters().forEach(a=>{a.isInequality()&&(i=i.add(a.field))})}),i})(e).forEach(r=>{n.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new uy(r,s))}),n.has(Xr.keyField().canonicalString())||e.Ie.push(new uy(Xr.keyField(),s))}return e.Ie}function ki(t){const e=ze(t);return e.Ee||(e.Ee=vG(e,Xf(t))),e.Ee}function vG(t,e){if(t.limitType==="F")return f1(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new uy(r.field,i)});const n=t.endAt?new cy(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new cy(t.startAt.position,t.startAt.inclusive):null;return f1(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function _C(t,e,n){return new rw(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ow(t,e){return ZS(ki(t),ki(e))&&t.limitType===e.limitType}function $2(t){return`${JS(ki(t))}|lt:${t.limitType}`}function Pu(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(s=>B2(s)).join(", ")}]`),nw(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(s=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(s)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>wh(s)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>wh(s)).join(",")),`Target(${n})`}(ki(t))}; limitType=${t.limitType})`}function aw(t,e){return e.isFoundDocument()&&function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):Ce.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(t,e)&&function(n,s){for(const r of Xf(n))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(r,i,o){const a=h1(r,i,o);return r.inclusive?a<=0:a<0}(n.startAt,Xf(n),s)||n.endAt&&!function(r,i,o){const a=h1(r,i,o);return r.inclusive?a>=0:a>0}(n.endAt,Xf(n),s))}(t,e)}function wG(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function z2(t){return(e,n)=>{let s=!1;for(const r of Xf(t)){const i=EG(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function EG(t,e,n){const s=t.field.isKeyField()?Ce.comparator(e.key,n.key):function(r,i,o){const a=i.data.field(r),c=o.data.field(r);return a!==null&&c!==null?vh(a,c):ke(42886)}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return ke(19790,{direction:t.dir})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ru{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Nl(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return A2(this.inner)}size(){return this.innerSize}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const bG=new vn(Ce.comparator);function Ko(){return bG}const H2=new vn(Ce.comparator);function Cf(...t){let e=H2;for(const n of t)e=e.insert(n.key,n);return e}function W2(t){let e=H2;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function gc(){return Jf()}function K2(){return Jf()}function Jf(){return new ru(t=>t.toString(),(t,e)=>t.isEqual(e))}const TG=new vn(Ce.comparator),CG=new ms(Ce.comparator);function nt(...t){let e=CG;for(const n of t)e=e.add(n);return e}const IG=new ms(et);function SG(){return IG}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function e0(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:oy(e)?"-0":e}}function G2(t){return{integerValue:""+t}}function RG(t,e){return ZK(e)?G2(e):e0(t,e)}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class lw{constructor(){this._=void 0}}function AG(t,e,n){return t instanceof zp?function(s,r){const i={fields:{[N2]:{stringValue:P2},[D2]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&YS(r)&&(r=sw(r)),r&&(i.fields[x2]=r),{mapValue:i}}(n,e):t instanceof Hp?Y2(t,e):t instanceof Wp?X2(t,e):function(s,r){const i=Q2(s,r),o=g1(i)+g1(s.Ae);return fC(i)&&fC(s.Ae)?G2(o):e0(s.serializer,o)}(t,e)}function kG(t,e,n){return t instanceof Hp?Y2(t,e):t instanceof Wp?X2(t,e):n}function Q2(t,e){return t instanceof hy?function(n){return fC(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class zp extends lw{}class Hp extends lw{constructor(e){super(),this.elements=e}}function Y2(t,e){const n=J2(e);for(const s of t.elements)n.some(r=>Bi(r,s))||n.push(s);return{arrayValue:{values:n}}}class Wp extends lw{constructor(e){super(),this.elements=e}}function X2(t,e){let n=J2(e);for(const s of t.elements)n=n.filter(r=>!Bi(r,s));return{arrayValue:{values:n}}}class hy extends lw{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function g1(t){return dn(t.integerValue||t.doubleValue)}function J2(t){return XS(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class PG{constructor(e,n){this.field=e,this.transform=n}}function NG(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Hp&&s instanceof Hp||n instanceof Wp&&s instanceof Wp?yh(n.elements,s.elements,Bi):n instanceof hy&&s instanceof hy?Bi(n.Ae,s.Ae):n instanceof zp&&s instanceof zp}(t.transform,e.transform)}class xG{constructor(e,n){this.version=e,this.transformResults=n}}class Zr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Zr}static exists(e){return new Zr(void 0,e)}static updateTime(e){return new Zr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function c_(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class cw{}function Z2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new t0(t.key,Zr.none()):new jg(t.key,t.data,Zr.none());{const n=t.data,s=Vr.empty();let r=new ms(Xr.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new xl(t.key,s,new Ii(r.toArray()),Zr.none())}}function DG(t,e,n){t instanceof jg?function(s,r,i){const o=s.value.clone(),a=_1(s.fieldTransforms,r,i.transformResults);o.setAll(a),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof xl?function(s,r,i){if(!c_(s.precondition,r))return void r.convertToUnknownDocument(i.version);const o=_1(s.fieldTransforms,r,i.transformResults),a=r.data;a.setAll(eF(s)),a.setAll(o),r.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(s,r,i){r.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function Zf(t,e,n,s){return t instanceof jg?function(r,i,o,a){if(!c_(r.precondition,i))return o;const c=r.value.clone(),u=y1(r.fieldTransforms,a,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,s):t instanceof xl?function(r,i,o,a){if(!c_(r.precondition,i))return o;const c=y1(r.fieldTransforms,a,i),u=i.data;return u.setAll(eF(r)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(h=>h.field))}(t,e,n,s):function(r,i,o){return c_(r.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function OG(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=Q2(s.transform,r||null);i!=null&&(n===null&&(n=Vr.empty()),n.set(s.field,i))}return n||null}function m1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&yh(n,s,(r,i)=>NG(r,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class jg extends cw{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class xl extends cw{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function eF(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function _1(t,e,n){const s=new Map;Et(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,kG(o,a,n[r]))}return s}function y1(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,AG(i,o,e))}return s}class t0 extends cw{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LG extends cw{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class MG{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&DG(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Zf(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Zf(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=K2();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const c=Z2(o,a);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(qe.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),nt())}isEqual(e){return this.batchId===e.batchId&&yh(this.mutations,e.mutations,(n,s)=>m1(n,s))&&yh(this.baseMutations,e.baseMutations,(n,s)=>m1(n,s))}}class n0{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){Et(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return TG}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new n0(e,n,s,r)}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class VG{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class FG{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var pn,ot;function UG(t){switch(t){case se.OK:return ke(64938);case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return ke(15467,{code:t})}}function tF(t){if(t===void 0)return Wo("GRPC error has no .code"),se.UNKNOWN;switch(t){case pn.OK:return se.OK;case pn.CANCELLED:return se.CANCELLED;case pn.UNKNOWN:return se.UNKNOWN;case pn.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case pn.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case pn.INTERNAL:return se.INTERNAL;case pn.UNAVAILABLE:return se.UNAVAILABLE;case pn.UNAUTHENTICATED:return se.UNAUTHENTICATED;case pn.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case pn.NOT_FOUND:return se.NOT_FOUND;case pn.ALREADY_EXISTS:return se.ALREADY_EXISTS;case pn.PERMISSION_DENIED:return se.PERMISSION_DENIED;case pn.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case pn.ABORTED:return se.ABORTED;case pn.OUT_OF_RANGE:return se.OUT_OF_RANGE;case pn.UNIMPLEMENTED:return se.UNIMPLEMENTED;case pn.DATA_LOSS:return se.DATA_LOSS;default:return ke(39323,{code:t})}}(ot=pn||(pn={}))[ot.OK=0]="OK",ot[ot.CANCELLED=1]="CANCELLED",ot[ot.UNKNOWN=2]="UNKNOWN",ot[ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ot[ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ot[ot.NOT_FOUND=5]="NOT_FOUND",ot[ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",ot[ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",ot[ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",ot[ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ot[ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ot[ot.ABORTED=10]="ABORTED",ot[ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",ot[ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",ot[ot.INTERNAL=13]="INTERNAL",ot[ot.UNAVAILABLE=14]="UNAVAILABLE",ot[ot.DATA_LOSS=15]="DATA_LOSS";/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function qG(){return new TextEncoder}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const BG=new Ua([4294967295,4294967295],0);function v1(t){const e=qG().encode(t),n=new y2;return n.update(e),new Uint8Array(n.digest())}function w1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ua([n,s],0),new Ua([r,i],0)]}class s0{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new If(`Invalid padding: ${n}`);if(s<0)throw new If(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new If(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new If(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ua.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply(Ua.fromNumber(s)));return r.compare(BG)===1&&(r=new Ua([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=v1(e),[s,r]=w1(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new s0(i,r,n);return s.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=v1(e),[s,r]=w1(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class If extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class uw{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,$g.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new uw(qe.min(),r,new vn(et),Ko(),nt())}}class $g{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new $g(s,n,nt(),nt(),nt())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class u_{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class nF{constructor(e,n){this.targetId=e,this.Ce=n}}class sF{constructor(e,n,s=Yn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class E1{constructor(){this.ve=0,this.Fe=b1(),this.Me=Yn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=nt(),n=nt(),s=nt();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:ke(38017,{changeType:i})}}),new $g(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=b1()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class jG{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ko(),this.Je=km(),this.He=km(),this.Ye=new vn(et)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:ke(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((s,r)=>{this.rt(r)&&n(r)})}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const i=r.target;if(mC(i))if(s===0){const o=new Ce(i.path);this.et(n,o,ls.newNoDocument(o,qe.min()))}else Et(s===1,20013,{expectedCount:s});else{const o=this._t(n);if(o!==s){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let o,a;try{o=al(s).toUint8Array()}catch(c){if(c instanceof k2)return _h("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new s0(o,r,i)}catch(c){return _h(c instanceof If?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),r++)}),r}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&mC(a.target)){const c=new Ce(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,ls.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let s=nt();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new uw(e,n,this.Ye,this.je,s);return this.je=Ko(),this.Je=km(),this.He=km(),this.Ye=new vn(et),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new E1,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new ms(et),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new ms(et),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||fe("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new E1),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function km(){return new vn(Ce.comparator)}function b1(){return new vn(Ce.comparator)}const $G={asc:"ASCENDING",desc:"DESCENDING"},zG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HG={and:"AND",or:"OR"};class WG{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function yC(t,e){return t.useProto3Json||nw(e)?e:{value:e}}function dy(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function rF(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function KG(t,e){return dy(t,e.toTimestamp())}function Pi(t){return Et(!!t,49232),qe.fromTimestamp(function(e){const n=ol(e);return new Bt(n.seconds,n.nanos)}(t))}function r0(t,e){return vC(t,e).canonicalString()}function vC(t,e){const n=function(s){return new Yt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function iF(t){const e=Yt.fromString(t);return Et(uF(e),10190,{key:e.toString()}),e}function wC(t,e){return r0(t.databaseId,e.path)}function Pb(t,e){const n=iF(e);if(n.get(1)!==t.databaseId.projectId)throw new _e(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new _e(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ce(aF(n))}function oF(t,e){return r0(t.databaseId,e)}function GG(t){const e=iF(t);return e.length===4?Yt.emptyPath():aF(e)}function EC(t){return new Yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function aF(t){return Et(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function T1(t,e,n){return{name:wC(t,e),fields:n.value.mapValue.fields}}function QG(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ke(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Et(u===void 0||typeof u=="string",58123),Yn.fromBase64String(u||"")):(Et(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Yn.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?se.UNKNOWN:tF(c.code);return new _e(u,c.message||"")}(o);n=new sF(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Pb(t,s.document.name),i=Pi(s.document.updateTime),o=s.document.createTime?Pi(s.document.createTime):qe.min(),a=new Vr({mapValue:{fields:s.document.fields}}),c=ls.newFoundDocument(r,i,o,a),u=s.targetIds||[],h=s.removedTargetIds||[];n=new u_(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Pb(t,s.document),i=s.readTime?Pi(s.readTime):qe.min(),o=ls.newNoDocument(r,i),a=s.removedTargetIds||[];n=new u_([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Pb(t,s.document),i=s.removedTargetIds||[];n=new u_([],i,r,null)}else{if(!("filter"in e))return ke(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new FG(r,i),a=s.targetId;n=new nF(a,o)}}return n}function YG(t,e){let n;if(e instanceof jg)n={update:T1(t,e.key,e.value)};else if(e instanceof t0)n={delete:wC(t,e.key)};else if(e instanceof xl)n={update:T1(t,e.key,e.data),updateMask:iQ(e.fieldMask)};else{if(!(e instanceof LG))return ke(16599,{Vt:e.type});n={verify:wC(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,i){const o=i.transform;if(o instanceof zp)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Hp)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Wp)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof hy)return{fieldPath:i.field.canonicalString(),increment:o.Ae};throw ke(20930,{transform:i.transform})}(0,s))),e.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:KG(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:ke(27497)}(t,e.precondition)),n}function XG(t,e){return t&&t.length>0?(Et(e!==void 0,14353),t.map(n=>function(s,r){let i=s.updateTime?Pi(s.updateTime):Pi(r);return i.isEqual(qe.min())&&(i=Pi(r)),new xG(i,s.transformResults||[])}(n,e))):[]}function JG(t,e){return{documents:[oF(t,e.path)]}}function ZG(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=oF(t,r);const i=function(c){if(c.length!==0)return cF(ji.create(c,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:Nu(h.field),direction:nQ(h.dir)}}(u))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=yC(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:n,parent:r}}function eQ(t){let e=GG(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){Et(s===1,65062);const h=n.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(h){const d=lF(h);return d instanceof ji&&U2(d)?d.getFilters():[d]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(d=>function(p){return new uy(xu(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(d))}(n.orderBy));let a=null;n.limit&&(a=function(h){let d;return d=typeof h=="object"?h.value:h,nw(d)?null:d}(n.limit));let c=null;n.startAt&&(c=function(h){const d=!!h.before,p=h.values||[];return new cy(p,d)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const d=!h.before,p=h.values||[];return new cy(p,d)}(n.endAt)),_G(e,r,o,i,a,"F",c,u)}function tQ(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ke(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function lF(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=xu(e.unaryFilter.field);return Sn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=xu(e.unaryFilter.field);return Sn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=xu(e.unaryFilter.field);return Sn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=xu(e.unaryFilter.field);return Sn.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ke(61313);default:return ke(60726)}}(t):t.fieldFilter!==void 0?function(e){return Sn.create(xu(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ke(58110);default:return ke(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return ji.create(e.compositeFilter.filters.map(n=>lF(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return ke(1026)}}(e.compositeFilter.op))}(t):ke(30097,{filter:t})}function nQ(t){return $G[t]}function sQ(t){return zG[t]}function rQ(t){return HG[t]}function Nu(t){return{fieldPath:t.canonicalString()}}function xu(t){return Xr.fromServerFormat(t.fieldPath)}function cF(t){return t instanceof Sn?function(e){if(e.op==="=="){if(u1(e.value))return{unaryFilter:{field:Nu(e.field),op:"IS_NAN"}};if(c1(e.value))return{unaryFilter:{field:Nu(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(u1(e.value))return{unaryFilter:{field:Nu(e.field),op:"IS_NOT_NAN"}};if(c1(e.value))return{unaryFilter:{field:Nu(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nu(e.field),op:sQ(e.op),value:e.value}}}(t):t instanceof ji?function(e){const n=e.getFilters().map(s=>cF(s));return n.length===1?n[0]:{compositeFilter:{op:rQ(e.op),filters:n}}}(t):ke(54877,{filter:t})}function iQ(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function uF(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Da{constructor(e,n,s,r,i=qe.min(),o=qe.min(),a=Yn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Da(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Da(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class oQ{constructor(e){this.yt=e}}function aQ(t){const e=eQ({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?_C(e,e.limit,"L"):e}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class lQ{constructor(){this.Cn=new cQ}addToCollectionParentIndex(e,n){return this.Cn.add(n),ie.resolve()}getCollectionParents(e,n){return ie.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ie.resolve()}deleteFieldIndex(e,n){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,n){return ie.resolve()}getDocumentsMatchingTarget(e,n){return ie.resolve(null)}getIndexType(e,n){return ie.resolve(0)}getFieldIndexes(e,n){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,n){return ie.resolve(il.min())}getMinOffsetFromCollectionGroup(e,n){return ie.resolve(il.min())}updateCollectionGroup(e,n,s){return ie.resolve()}updateIndexEntries(e,n){return ie.resolve()}}class cQ{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new ms(Yt.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new ms(Yt.comparator)).toArray()}}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const C1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},hF=41943040;let yi=class h_{static withCacheSize(e){return new h_(e,h_.DEFAULT_COLLECTION_PERCENTILE,h_.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/yi.DEFAULT_COLLECTION_PERCENTILE=10,yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yi.DEFAULT=new yi(hF,yi.DEFAULT_COLLECTION_PERCENTILE,yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yi.DISABLED=new yi(-1,0,0);/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Eh{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Eh(0)}static cr(){return new Eh(-1)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const I1="LruGarbageCollector",uQ=1048576;function S1([t,e],[n,s]){const r=et(t,n);return r===0?et(e,s):r}class hQ{constructor(e){this.Ir=e,this.buffer=new ms(S1),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();S1(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class dQ{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){fe(I1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Kh(n)?fe(I1,"Ignoring IndexedDB error during garbage collection: ",n):await Wh(n)}await this.Vr(3e5)})}}class fQ{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return ie.resolve(tw.ce);const s=new hQ(n);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(C1)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),C1):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,i,o,a,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(e,r))).next(d=>(s=d,a=Date.now(),this.removeTargets(e,s,n))).next(d=>(i=d,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(d=>(u=Date.now(),Au()<=Ye.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:d})))}}function pQ(t,e){return new fQ(t,e)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gQ{constructor(){this.changes=new ru(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ls.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?ie.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class mQ{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _Q{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&Zf(s.mutation,r,Ii.empty(),Bt.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,nt()).next(()=>s))}getLocalViewOfDocuments(e,n,s=nt()){const r=gc();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=Cf();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=gc();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,nt()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=Ko();const o=Jf(),a=function(){return Jf()}();return n.forEach((c,u)=>{const h=s.get(u.key);r.has(u.key)&&(h===void 0||h.mutation instanceof xl)?i=i.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Zf(h.mutation,u,h.mutation.getFieldMask(),Bt.now())):o.set(u.key,Ii.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,h)=>o.set(u,h)),n.forEach((u,h)=>a.set(u,new mQ(h,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const s=Jf();let r=new vn((o,a)=>o-a),i=nt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let h=s.get(c)||Ii.empty();h=a.applyToLocalView(u,h),s.set(c,h);const d=(r.get(a.batchId)||nt()).add(c);r=r.insert(a.batchId,d)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,h=c.value,d=K2();h.forEach(p=>{if(!i.has(p)){const m=Z2(n.get(p),s.get(p));m!==null&&d.set(p,m),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return ie.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(i){return Ce.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yG(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):ie.resolve(gc());let a=qp,c=i;return o.next(u=>ie.forEach(u,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(h)?ie.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,nt())).next(h=>({batchId:a,changes:W2(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ce(n)).next(s=>{let r=Cf();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let o=Cf();return this.indexManager.getCollectionParents(e,i).next(a=>ie.forEach(a,c=>{const u=function(h,d){return new rw(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r))).next(o=>{i.forEach((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,ls.newInvalidDocument(h)))});let a=Cf();return o.forEach((c,u)=>{const h=i.get(c);h!==void 0&&Zf(h.mutation,u,Ii.empty(),Bt.now()),aw(n,u)&&(a=a.insert(c,u))}),a})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class yQ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ie.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Pi(s.createTime)}}(n)),ie.resolve()}getNamedQuery(e,n){return ie.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:aQ(s.bundledQuery),readTime:Pi(s.readTime)}}(n)),ie.resolve()}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class vQ{constructor(){this.overlays=new vn(Ce.comparator),this.qr=new Map}getOverlay(e,n){return ie.resolve(this.overlays.get(n))}getOverlays(e,n){const s=gc();return ie.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.St(e,n,i)}),ie.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),ie.resolve()}getOverlaysForCollection(e,n,s){const r=gc(),i=n.length+1,o=new Ce(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return ie.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new vn((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let h=i.get(u.largestBatchId);h===null&&(h=gc(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=gc(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=r)););return ie.resolve(a)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new VG(n,s));let i=this.qr.get(n);i===void 0&&(i=nt(),this.qr.set(n,i)),this.qr.set(n,i.add(s.key))}}/**
* @license
* Copyright 2024 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class wQ{constructor(){this.sessionToken=Yn.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ie.resolve()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class i0{constructor(){this.Qr=new ms(Ln.$r),this.Ur=new ms(Ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new Ln(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Gr(new Ln(e,n))}zr(e,n){e.forEach(s=>this.removeReference(s,n))}jr(e){const n=new Ce(new Yt([])),s=new Ln(n,e),r=new Ln(n,e+1),i=[];return this.Ur.forEachInRange([s,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Ce(new Yt([])),s=new Ln(n,e),r=new Ln(n,e+1);let i=nt();return this.Ur.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ln(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}let Ln=class{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Ce.comparator(e.key,n.key)||et(e.Yr,n.Yr)}static Kr(e,n){return et(e.Yr,n.Yr)||Ce.comparator(e.key,n.key)}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class EQ{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new ms(Ln.$r)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new MG(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new Ln(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ie.resolve(o)}lookupMutationBatch(e,n){return ie.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),i=r<0?0:r;return ie.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?QS:this.tr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Ln(n,0),r=new Ln(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],o=>{const a=this.Xr(o.Yr);i.push(a)}),ie.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new ms(et);return n.forEach(r=>{const i=new Ln(r,0),o=new Ln(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{s=s.add(a.Yr)})}),ie.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;Ce.isDocumentKey(i)||(i=i.child(""));const o=new Ln(new Ce(i),0);let a=new ms(et);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(a=a.add(c.Yr)),!0)},o),ie.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){Et(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return ie.forEach(n.mutations,r=>{const i=new Ln(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,n){const s=new Ln(n,0),r=this.Zr.firstAfterOrEqual(s);return ie.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class bQ{constructor(e){this.ri=e,this.docs=function(){return new vn(Ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return ie.resolve(s?s.document.mutableCopy():ls.newInvalidDocument(n))}getEntries(e,n){let s=Ko();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():ls.newInvalidDocument(r))}),ie.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=Ko();const o=n.path,a=new Ce(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||QK(GK(h),s)<=0||(r.has(h.key)||aw(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return ie.resolve(i)}getAllFromCollectionGroup(e,n,s,r){ke(9500)}ii(e,n){return ie.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new TQ(this)}getSize(e){return ie.resolve(this.size)}}class TQ extends gQ{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),ie.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class CQ{constructor(e){this.persistence=e,this.si=new ru(n=>JS(n),ZS),this.lastRemoteSnapshotVersion=qe.min(),this.highestTargetId=0,this.oi=0,this._i=new i0,this.targetCount=0,this.ai=Eh.ur()}forEachTarget(e,n){return this.si.forEach((s,r)=>n(r)),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),ie.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Eh(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ie.resolve()}updateTargetData(e,n){return this.Pr(n),ie.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),ie.waitFor(i).next(()=>r)}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return ie.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),ie.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),ie.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ie.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return ie.resolve(s)}containsKey(e,n){return ie.resolve(this._i.containsKey(n))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class dF{constructor(e,n){this.ui={},this.overlays={},this.ci=new tw(0),this.li=!1,this.li=!0,this.hi=new wQ,this.referenceDelegate=e(this),this.Pi=new CQ(this),this.indexManager=new lQ,this.remoteDocumentCache=function(s){return new bQ(s)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new oQ(n),this.Ii=new yQ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new vQ,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new EQ(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){fe("MemoryPersistence","Starting transaction:",e);const r=new IQ(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,n){return ie.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,n)))}}class IQ extends XK{constructor(e){super(),this.currentSequenceNumber=e}}class o0{constructor(e){this.persistence=e,this.Ri=new i0,this.Vi=null}static mi(e){return new o0(e)}get fi(){if(this.Vi)return this.Vi;throw ke(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),ie.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),ie.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ie.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.fi,s=>{const r=Ce.fromPath(s);return this.gi(e,r).next(i=>{i||n.removeEntry(r,qe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return ie.or([()=>ie.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class fy{constructor(e,n){this.persistence=e,this.pi=new ru(s=>eG(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=pQ(this,n)}static mi(e,n){return new fy(e,n)}Ei(){}di(e){return ie.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}wr(e){let n=0;return this.pr(e,s=>{n++}).next(()=>n)}pr(e,n){return ie.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?ie.resolve():n(r)))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,n).next(a=>{a||(s++,i.removeEntry(o,qe.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ie.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),ie.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ie.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=a_(e.data.value)),n}br(e,n,s){return ie.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return ie.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class a0{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=nt(),r=nt();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new a0(e,n.fromCache,s,r)}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class SQ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class RQ{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return RW()?8:JK(_s())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new SQ;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,s,r){return s.documentReadCount<this.fs?(Au()<=Ye.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",Pu(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ie.resolve()):(Au()<=Ye.DEBUG&&fe("QueryEngine","Query:",Pu(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Au()<=Ye.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",Pu(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ki(n))):ie.resolve())}ys(e,n){if(p1(n))return ie.resolve(null);let s=ki(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=_C(n,null,"F"),s=ki(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=nt(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(c=>{const u=this.Ds(n,a);return this.Cs(n,u,o,c.readTime)?this.ys(e,_C(n,null,"F")):this.vs(e,u,n,c)}))})))}ws(e,n,s,r){return p1(n)||r.isEqual(qe.min())?ie.resolve(null):this.ps.getDocuments(e,s).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,s,r)?ie.resolve(null):(Au()<=Ye.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Pu(n)),this.vs(e,o,n,KK(r,qp)).next(a=>a))})}Ds(e,n){let s=new ms(z2(e));return n.forEach((r,i)=>{aw(e,i)&&(s=s.add(i))}),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,n,s){return Au()<=Ye.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",Pu(n)),this.ps.getDocumentsMatchingQuery(e,n,il.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const l0="LocalStore",AQ=3e8;class kQ{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new vn(et),this.xs=new ru(i=>JS(i),ZS),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _Q(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function PQ(t,e,n,s){return new kQ(t,e,n,s)}async function fF(t,e){const n=ze(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let c=nt();for(const u of r){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of i){a.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(s,c).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function NQ(t,e){const n=ze(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(o,a,c,u){const h=c.batch,d=h.keys();let p=ie.resolve();return d.forEach(m=>{p=p.next(()=>u.getEntry(a,m)).next(w=>{const R=c.docVersions.get(m);Et(R!==null,48541),w.version.compareTo(R)<0&&(h.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),u.addEntry(w)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(a,h))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(o){let a=nt();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function pF(t){const e=ze(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function xQ(t,e){const n=ze(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const a=[];e.targetChanges.forEach((h,d)=>{const p=r.get(d);if(!p)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,d).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,d)));let m=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?m=m.withResumeToken(Yn.EMPTY_BYTE_STRING,qe.min()).withLastLimboFreeSnapshotVersion(qe.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,s)),r=r.insert(d,m),function(w,R,k){return w.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=AQ?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(p,m,h)&&a.push(n.Pi.updateTargetData(i,m))});let c=Ko(),u=nt();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(DQ(i,o,e.documentUpdates).next(h=>{c=h.ks,u=h.qs})),!s.isEqual(qe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(d=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(h)}return ie.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.Ms=r,i))}function DQ(t,e,n){let s=nt(),r=nt();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=Ko();return n.forEach((a,c)=>{const u=i.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(qe.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):fe(l0,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{ks:o,qs:r}})}function OQ(t,e){const n=ze(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=QS),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function LQ(t,e){const n=ze(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Pi.getTargetData(s,e).next(i=>i?(r=i,ie.resolve(r)):n.Pi.allocateTargetId(s).next(o=>(r=new Da(e,o,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s})}async function bC(t,e,n){const s=ze(t),r=s.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Kh(o))throw o;fe(l0,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function R1(t,e,n){const s=ze(t);let r=qe.min(),i=nt();return s.persistence.runTransaction("Execute query","readwrite",o=>function(a,c,u){const h=ze(a),d=h.xs.get(u);return d!==void 0?ie.resolve(h.Ms.get(d)):h.Pi.getTargetData(c,u)}(s,o,ki(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,e,n?r:qe.min(),n?i:nt())).next(a=>(MQ(s,wG(e),a),{documents:a,Qs:i})))}function MQ(t,e,n){let s=t.Os.get(e)||qe.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Os.set(e,s)}class A1{constructor(){this.activeTargetIds=SG()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class VQ{constructor(){this.Mo=new A1,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new A1,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class FQ{Oo(e){}shutdown(){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const k1="ConnectivityMonitor";class P1{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){fe(k1,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){fe(k1,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Pm=null;function TC(){return Pm===null?Pm=function(){return 268435456+Math.round(2147483648*Math.random())}():Pm++,"0x"+Pm.toString(16)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Nb="RestConnection",UQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class qQ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===ay?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,i){const o=TC(),a=this.zo(e,n.toUriEncodedString());fe(Nb,`Sending RPC '${e}' ${o}:`,a,s);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,i);const{host:u}=new URL(a),h=Gi(u);return this.Jo(e,a,c,s,h).then(d=>(fe(Nb,`Received RPC '${e}' ${o}: `,d),d),d=>{throw _h(Nb,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",s),d})}Ho(e,n,s,r,i,o){return this.Go(e,n,s,r,i)}jo(e,n,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Hh}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,n){const s=UQ[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class BQ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Jn="WebChannelConnection";class jQ extends qQ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,i){const o=TC();return new Promise((a,c)=>{const u=new v2;u.setWithCredentials(!0),u.listenOnce(w2.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case o_.NO_ERROR:const d=u.getResponseJson();fe(Jn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case o_.TIMEOUT:fe(Jn,`RPC '${e}' ${o} timed out`),c(new _e(se.DEADLINE_EXCEEDED,"Request time out"));break;case o_.HTTP_ERROR:const p=u.getStatus();if(fe(Jn,`RPC '${e}' ${o} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const w=m?.error;if(w&&w.status&&w.message){const R=function(k){const O=k.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(O)>=0?O:se.UNKNOWN}(w.status);c(new _e(R,w.message))}else c(new _e(se.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new _e(se.UNAVAILABLE,"Connection failed."));break;default:ke(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{fe(Jn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(r);fe(Jn,`RPC '${e}' ${o} sending request:`,r),u.send(n,"POST",h,s,15)})}T_(e,n,s){const r=TC(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=T2(),a=b2(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,s),c.encodeInitMessageHeaders=!0;const h=i.join("");fe(Jn,`Creating RPC '${e}' stream ${r}: ${h}`,c);const d=o.createWebChannel(h,c);this.I_(d);let p=!1,m=!1;const w=new BQ({Yo:k=>{m?fe(Jn,`Not sending because RPC '${e}' stream ${r} is closed:`,k):(p||(fe(Jn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),p=!0),fe(Jn,`RPC '${e}' stream ${r} sending:`,k),d.send(k))},Zo:()=>d.close()}),R=(k,O,M)=>{k.listen(O,F=>{try{M(F)}catch(q){setTimeout(()=>{throw q},0)}})};return R(d,Tf.EventType.OPEN,()=>{m||(fe(Jn,`RPC '${e}' stream ${r} transport opened.`),w.o_())}),R(d,Tf.EventType.CLOSE,()=>{m||(m=!0,fe(Jn,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(d))}),R(d,Tf.EventType.ERROR,k=>{m||(m=!0,_h(Jn,`RPC '${e}' stream ${r} transport errored. Name:`,k.name,"Message:",k.message),w.a_(new _e(se.UNAVAILABLE,"The operation could not be completed")))}),R(d,Tf.EventType.MESSAGE,k=>{if(!m){const O=k.data[0];Et(!!O,16349);const M=O,F=M?.error||M[0]?.error;if(F){fe(Jn,`RPC '${e}' stream ${r} received error:`,F);const q=F.status;let H=function(I){const v=pn[I];if(v!==void 0)return tF(v)}(q),J=F.message;H===void 0&&(H=se.INTERNAL,J="Unknown error status: "+q+" with message "+F.message),m=!0,w.a_(new _e(H,J)),d.close()}else fe(Jn,`RPC '${e}' stream ${r} received:`,O),w.u_(O)}}),R(a,E2.STAT_EVENT,k=>{k.stat===aC.PROXY?fe(Jn,`RPC '${e}' stream ${r} detected buffering proxy`):k.stat===aC.NOPROXY&&fe(Jn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function xb(){return typeof document<"u"?document:null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function hw(t){return new WG(t,!0)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gF{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&fe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const N1="PersistentStream";class mF{constructor(e,n,s,r,i,o,a,c){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new gF(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===se.RESOURCE_EXHAUSTED?(Wo(n.toString()),Wo("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===n&&this.G_(s,r)},s=>{e(()=>{const r=new _e(se.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return fe(N1,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(fe(N1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $Q extends mF{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=QG(this.serializer,e),s=function(r){if(!("targetChange"in r))return qe.min();const i=r.targetChange;return i.targetIds&&i.targetIds.length?qe.min():i.readTime?Pi(i.readTime):qe.min()}(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=EC(this.serializer),n.addTarget=function(r,i){let o;const a=i.target;if(o=mC(a)?{documents:JG(r,a)}:{query:ZG(r,a).ft},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=rF(r,i.resumeToken);const c=yC(r,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(qe.min())>0){o.readTime=dy(r,i.snapshotVersion.toTimestamp());const c=yC(r,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const s=tQ(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=EC(this.serializer),n.removeTarget=e,this.q_(n)}}class zQ extends mF{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=XG(e.writeResults,e.commitTime),s=Pi(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=EC(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>YG(this.serializer,s))};this.q_(n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class HQ{}class WQ extends HQ{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new _e(se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,vC(n,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new _e(se.UNKNOWN,i.toString())})}Ho(e,n,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,vC(n,s),r,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new _e(se.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class KQ{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Wo(n),this.aa=!1):fe("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Fc="RemoteStore";class GQ{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{iu(this)&&(fe(Fc,"Restarting streams for network reachability change."),await async function(a){const c=ze(a);c.Ea.add(4),await zg(c),c.Ra.set("Unknown"),c.Ea.delete(4),await dw(c)}(this))})}),this.Ra=new KQ(s,r)}}async function dw(t){if(iu(t))for(const e of t.da)await e(!0)}async function zg(t){for(const e of t.da)await e(!1)}function _F(t,e){const n=ze(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),d0(n)?h0(n):Gh(n).O_()&&u0(n,e))}function c0(t,e){const n=ze(t),s=Gh(n);n.Ia.delete(e),s.O_()&&yF(n,e),n.Ia.size===0&&(s.O_()?s.L_():iu(n)&&n.Ra.set("Unknown"))}function u0(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(qe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Gh(t).Y_(e)}function yF(t,e){t.Va.Ue(e),Gh(t).Z_(e)}function h0(t){t.Va=new jG({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Gh(t).start(),t.Ra.ua()}function d0(t){return iu(t)&&!Gh(t).x_()&&t.Ia.size>0}function iu(t){return ze(t).Ea.size===0}function vF(t){t.Va=void 0}async function QQ(t){t.Ra.set("Online")}async function YQ(t){t.Ia.forEach((e,n)=>{u0(t,e)})}async function XQ(t,e){vF(t),d0(t)?(t.Ra.ha(e),h0(t)):t.Ra.set("Unknown")}async function JQ(t,e,n){if(t.Ra.set("Online"),e instanceof sF&&e.state===2&&e.cause)try{await async function(s,r){const i=r.cause;for(const o of r.targetIds)s.Ia.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.Ia.delete(o),s.Va.removeTarget(o))}(t,e)}catch(s){fe(Fc,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await py(t,s)}else if(e instanceof u_?t.Va.Ze(e):e instanceof nF?t.Va.st(e):t.Va.tt(e),!n.isEqual(qe.min()))try{const s=await pF(t.localStore);n.compareTo(s)>=0&&await function(r,i){const o=r.Va.Tt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const u=r.Ia.get(c);u&&r.Ia.set(c,u.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach((a,c)=>{const u=r.Ia.get(a);if(!u)return;r.Ia.set(a,u.withResumeToken(Yn.EMPTY_BYTE_STRING,u.snapshotVersion)),yF(r,a);const h=new Da(u.target,a,c,u.sequenceNumber);u0(r,h)}),r.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(s){fe(Fc,"Failed to raise snapshot:",s),await py(t,s)}}async function py(t,e,n){if(!Kh(e))throw e;t.Ea.add(1),await zg(t),t.Ra.set("Offline"),n||(n=()=>pF(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{fe(Fc,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await dw(t)})}function wF(t,e){return e().catch(n=>py(t,n,e))}async function fw(t){const e=ze(t),n=cl(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:QS;for(;ZQ(e);)try{const r=await OQ(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,eY(e,r)}catch(r){await py(e,r)}EF(e)&&bF(e)}function ZQ(t){return iu(t)&&t.Ta.length<10}function eY(t,e){t.Ta.push(e);const n=cl(t);n.O_()&&n.X_&&n.ea(e.mutations)}function EF(t){return iu(t)&&!cl(t).x_()&&t.Ta.length>0}function bF(t){cl(t).start()}async function tY(t){cl(t).ra()}async function nY(t){const e=cl(t);for(const n of t.Ta)e.ea(n.mutations)}async function sY(t,e,n){const s=t.Ta.shift(),r=n0.from(s,e,n);await wF(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await fw(t)}async function rY(t,e){e&&cl(t).X_&&await async function(n,s){if(function(r){return UG(r)&&r!==se.ABORTED}(s.code)){const r=n.Ta.shift();cl(n).B_(),await wF(n,()=>n.remoteSyncer.rejectFailedWrite(r.batchId,s)),await fw(n)}}(t,e),EF(t)&&bF(t)}async function x1(t,e){const n=ze(t);n.asyncQueue.verifyOperationInProgress(),fe(Fc,"RemoteStore received new credentials");const s=iu(n);n.Ea.add(3),await zg(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await dw(n)}async function iY(t,e){const n=ze(t);e?(n.Ea.delete(2),await dw(n)):e||(n.Ea.add(2),await zg(n),n.Ra.set("Unknown"))}function Gh(t){return t.ma||(t.ma=function(e,n,s){const r=ze(e);return r.sa(),new $Q(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(t.datastore,t.asyncQueue,{Xo:QQ.bind(null,t),t_:YQ.bind(null,t),r_:XQ.bind(null,t),H_:JQ.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),d0(t)?h0(t):t.Ra.set("Unknown")):(await t.ma.stop(),vF(t))})),t.ma}function cl(t){return t.fa||(t.fa=function(e,n,s){const r=ze(e);return r.sa(),new zQ(n,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:tY.bind(null,t),r_:rY.bind(null,t),ta:nY.bind(null,t),na:sY.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await fw(t)):(await t.fa.stop(),t.Ta.length>0&&(fe(Fc,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class f0{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new qa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new f0(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _e(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function p0(t,e){if(Wo("AsyncQueue",`${e}: ${t}`),Kh(t))return new _e(se.UNAVAILABLE,`${e}: ${t}`);throw t}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Qu{static emptySet(e){return new Qu(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||Ce.comparator(n.key,s.key):(n,s)=>Ce.comparator(n.key,s.key),this.keyedMap=Cf(),this.sortedSet=new vn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Qu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Qu;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class D1{constructor(){this.ga=new vn(Ce.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ke(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,s)=>{e.push(s)}),e}}class bh{constructor(e,n,s,r,i,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,r,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new bh(e,n,Qu.emptySet(n),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ow(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class oY{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class aY{constructor(){this.queries=O1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,n){const s=ze(e),r=s.queries;s.queries=O1(),r.forEach((i,o)=>{for(const a of o.Sa)a.onError(n)})})(this,new _e(se.ABORTED,"Firestore shutting down"))}}function O1(){return new ru(t=>$2(t),ow)}async function TF(t,e){const n=ze(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new oY,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await n.onListen(r,!0);break;case 1:i.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const a=p0(o,`Initialization of query '${Pu(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&g0(n)}async function CF(t,e){const n=ze(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function lY(t,e){const n=ze(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(r)&&(s=!0);o.wa=r}}s&&g0(n)}function cY(t,e,n){const s=ze(t),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(n);s.queries.delete(e)}function g0(t){t.Ca.forEach(e=>{e.next()})}var CC,L1;(L1=CC||(CC={})).Ma="default",L1.Cache="cache";class IF{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new bh(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=bh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==CC.Cache}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class SF{constructor(e){this.key=e}}class RF{constructor(e){this.key=e}}class uY{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=nt(),this.mutatedKeys=nt(),this.eu=z2(e),this.tu=new Qu(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new D1,r=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,d)=>{const p=r.get(h),m=aw(this.query,d)?d:null,w=!!p&&this.mutatedKeys.has(p.key),R=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let k=!1;p&&m?p.data.isEqual(m.data)?w!==R&&(s.track({type:3,doc:m}),k=!0):this.su(p,m)||(s.track({type:2,doc:m}),k=!0,(c&&this.eu(m,c)>0||u&&this.eu(m,u)<0)&&(a=!0)):!p&&m?(s.track({type:0,doc:m}),k=!0):p&&!m&&(s.track({type:1,doc:p}),k=!0,(c||u)&&(a=!0)),k&&(m?(o=o.add(m),i=R?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),s.track({type:1,doc:h})}return{tu:o,iu:s,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,d)=>function(p,m){const w=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ke(20277,{Rt:R})}};return w(p)-w(m)}(h.type,d.type)||this.eu(h.doc,d.doc)),this.ou(s),r=r??!1;const a=n&&!r?this._u():[],c=this.Xa.size===0&&this.current&&!r?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new bh(this.query,e.tu,i,o,e.mutatedKeys,c===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new D1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=nt(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const n=[];return e.forEach(s=>{this.Xa.has(s)||n.push(new RF(s))}),this.Xa.forEach(s=>{e.has(s)||n.push(new SF(s))}),n}cu(e){this.Ya=e.Qs,this.Xa=nt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return bh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const m0="SyncEngine";class hY{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class dY{constructor(e){this.key=e,this.hu=!1}}class fY{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ru(a=>$2(a),ow),this.Iu=new Map,this.Eu=new Set,this.du=new vn(Ce.comparator),this.Au=new Map,this.Ru=new i0,this.Vu={},this.mu=new Map,this.fu=Eh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function pY(t,e,n=!0){const s=DF(t);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await AF(s,e,n,!0),r}async function gY(t,e){const n=DF(t);await AF(n,e,!0,!1)}async function AF(t,e,n,s){const r=await LQ(t.localStore,ki(e)),i=r.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return s&&(a=await mY(t,e,i,o==="current",r.resumeToken)),t.isPrimaryClient&&n&&_F(t.remoteStore,r),a}async function mY(t,e,n,s,r){t.pu=(d,p,m)=>async function(w,R,k,O){let M=R.view.ru(k);M.Cs&&(M=await R1(w.localStore,R.query,!1).then(({documents:J})=>R.view.ru(J,M)));const F=O&&O.targetChanges.get(R.targetId),q=O&&O.targetMismatches.get(R.targetId)!=null,H=R.view.applyChanges(M,w.isPrimaryClient,F,q);return V1(w,R.targetId,H.au),H.snapshot}(t,d,p,m);const i=await R1(t.localStore,e,!0),o=new uY(e,i.Qs),a=o.ru(i.documents),c=$g.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),u=o.applyChanges(a,t.isPrimaryClient,c);V1(t,n,u.au);const h=new hY(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function _Y(t,e,n){const s=ze(t),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(o=>!ow(o,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await bC(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&c0(s.remoteStore,r.targetId),IC(s,r.targetId)}).catch(Wh)):(IC(s,r.targetId),await bC(s.localStore,r.targetId,!0))}async function yY(t,e){const n=ze(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),c0(n.remoteStore,s.targetId))}async function vY(t,e,n){const s=SY(t);try{const r=await function(i,o){const a=ze(i),c=Bt.now(),u=o.reduce((p,m)=>p.add(m.key),nt());let h,d;return a.persistence.runTransaction("Locally write mutations","readwrite",p=>{let m=Ko(),w=nt();return a.Ns.getEntries(p,u).next(R=>{m=R,m.forEach((k,O)=>{O.isValidDocument()||(w=w.add(k))})}).next(()=>a.localDocuments.getOverlayedDocuments(p,m)).next(R=>{h=R;const k=[];for(const O of o){const M=OG(O,h.get(O.key).overlayedDocument);M!=null&&k.push(new xl(O.key,M,M2(M.value.mapValue),Zr.exists(!0)))}return a.mutationQueue.addMutationBatch(p,c,k,o)}).next(R=>{d=R;const k=R.applyToLocalDocumentSet(h,w);return a.documentOverlayCache.saveOverlays(p,R.batchId,k)})}).then(()=>({batchId:d.batchId,changes:W2(h)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(i,o,a){let c=i.Vu[i.currentUser.toKey()];c||(c=new vn(et)),c=c.insert(o,a),i.Vu[i.currentUser.toKey()]=c}(s,r.batchId,n),await Hg(s,r.changes),await fw(s.remoteStore)}catch(r){const i=p0(r,"Failed to persist write");n.reject(i)}}async function kF(t,e){const n=ze(t);try{const s=await xQ(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.Au.get(i);o&&(Et(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?Et(o.hu,14607):r.removedDocuments.size>0&&(Et(o.hu,42227),o.hu=!1))}),await Hg(n,s,e)}catch(s){await Wh(s)}}function M1(t,e,n){const s=ze(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)}),function(i,o){const a=ze(i);a.onlineState=o;let c=!1;a.queries.forEach((u,h)=>{for(const d of h.Sa)d.va(o)&&(c=!0)}),c&&g0(a)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function wY(t,e,n){const s=ze(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new vn(Ce.comparator);o=o.insert(i,ls.newNoDocument(i,qe.min()));const a=nt().add(i),c=new uw(qe.min(),new Map,new vn(et),o,a);await kF(s,c),s.du=s.du.remove(i),s.Au.delete(e),_0(s)}else await bC(s.localStore,e,!1).then(()=>IC(s,e,n)).catch(Wh)}async function EY(t,e){const n=ze(t),s=e.batch.batchId;try{const r=await NQ(n.localStore,e);NF(n,s,null),PF(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Hg(n,r)}catch(r){await Wh(r)}}async function bY(t,e,n){const s=ze(t);try{const r=await function(i,o){const a=ze(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return a.mutationQueue.lookupMutationBatch(c,o).next(h=>(Et(h!==null,37113),u=h.keys(),a.mutationQueue.removeMutationBatch(c,h))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>a.localDocuments.getDocuments(c,u))})}(s.localStore,e);NF(s,e,n),PF(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Hg(s,r)}catch(r){await Wh(r)}}function PF(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function NF(t,e,n){const s=ze(t);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function IC(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(s=>{t.Ru.containsKey(s)||xF(t,s)})}function xF(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(c0(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),_0(t))}function V1(t,e,n){for(const s of n)s instanceof SF?(t.Ru.addReference(s.key,e),TY(t,s)):s instanceof RF?(fe(m0,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||xF(t,s.key)):ke(19791,{wu:s})}function TY(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(fe(m0,"New document in limbo: "+n),t.Eu.add(s),_0(t))}function _0(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Ce(Yt.fromString(e)),s=t.fu.next();t.Au.set(s,new dY(n)),t.du=t.du.insert(n,s),_F(t.remoteStore,new Da(ki(iw(n.path)),s,"TargetPurposeLimboResolution",tw.ce))}}async function Hg(t,e,n){const s=ze(t),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((a,c)=>{o.push(s.pu(c,e,n).then(u=>{if((u||n)&&s.isPrimaryClient){const h=u?!u.fromCache:n?.targetChanges.get(c.targetId)?.current;s.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){r.push(u);const h=a0.As(c.targetId,u);i.push(h)}}))}),await Promise.all(o),s.Pu.H_(r),await async function(a,c){const u=ze(a);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ie.forEach(c,d=>ie.forEach(d.Es,p=>u.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>ie.forEach(d.ds,p=>u.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!Kh(h))throw h;fe(l0,"Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=u.Ms.get(d),m=p.snapshotVersion,w=p.withLastLimboFreeSnapshotVersion(m);u.Ms=u.Ms.insert(d,w)}}}(s.localStore,i))}async function CY(t,e){const n=ze(t);if(!n.currentUser.isEqual(e)){fe(m0,"User change. New user:",e.toKey());const s=await fF(n.localStore,e);n.currentUser=e,function(r,i){r.mu.forEach(o=>{o.forEach(a=>{a.reject(new _e(se.CANCELLED,i))})}),r.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Hg(n,s.Ls)}}function IY(t,e){const n=ze(t),s=n.Au.get(e);if(s&&s.hu)return nt().add(s.key);{let r=nt();const i=n.Iu.get(e);if(!i)return r;for(const o of i){const a=n.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function DF(t){const e=ze(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=kF.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IY.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wY.bind(null,e),e.Pu.H_=lY.bind(null,e.eventManager),e.Pu.yu=cY.bind(null,e.eventManager),e}function SY(t){const e=ze(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=EY.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bY.bind(null,e),e}class gy{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hw(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return PQ(this.persistence,new RQ,e.initialUser,this.serializer)}Cu(e){return new dF(o0.mi,this.serializer)}Du(e){return new VQ}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gy.provider={build:()=>new gy};class RY extends gy{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Et(this.persistence.referenceDelegate instanceof fy,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new dQ(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?yi.withCacheSize(this.cacheSizeBytes):yi.DEFAULT;return new dF(s=>fy.mi(s,n),this.serializer)}}class SC{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>M1(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=CY.bind(null,this.syncEngine),await iY(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new aY}()}createDatastore(e){const n=hw(e.databaseInfo.databaseId),s=function(r){return new jQ(r)}(e.databaseInfo);return function(r,i,o,a){return new WQ(r,i,o,a)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(n,s,r,i,o){return new GQ(n,s,r,i,o)}(this.localStore,this.datastore,e.asyncQueue,n=>M1(this.syncEngine,n,0),function(){return P1.v()?new P1:new FQ}())}createSyncEngine(e,n){return function(s,r,i,o,a,c,u){const h=new fY(s,r,i,o,a,c);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await async function(e){const n=ze(e);fe(Fc,"RemoteStore shutting down."),n.Ea.add(5),await zg(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}SC.provider={build:()=>new SC};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class OF{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Wo("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ul="FirestoreClient";class AY{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=rs.UNAUTHENTICATED,this.clientId=KS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{fe(ul,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(fe(ul,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=p0(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Db(t,e){t.asyncQueue.verifyOperationInProgress(),fe(ul,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await fF(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function F1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await kY(t);fe(ul,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>x1(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>x1(e.remoteStore,r)),t._onlineComponents=e}async function kY(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){fe(ul,"Using user provided OfflineComponentProvider");try{await Db(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===se.FAILED_PRECONDITION||s.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;_h("Error using user provided cache. Falling back to memory cache: "+n),await Db(t,new gy)}}else fe(ul,"Using default OfflineComponentProvider"),await Db(t,new RY(void 0));return t._offlineComponents}async function LF(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(fe(ul,"Using user provided OnlineComponentProvider"),await F1(t,t._uninitializedComponentsProvider._online)):(fe(ul,"Using default OnlineComponentProvider"),await F1(t,new SC))),t._onlineComponents}function PY(t){return LF(t).then(e=>e.syncEngine)}async function RC(t){const e=await LF(t),n=e.eventManager;return n.onListen=pY.bind(null,e.syncEngine),n.onUnlisten=_Y.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=gY.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=yY.bind(null,e.syncEngine),n}function NY(t,e,n={}){const s=new qa;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const u=new OF({next:d=>{u.Nu(),i.enqueueAndForget(()=>CF(r,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new _e(se.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&a&&a.source==="server"?c.reject(new _e(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new IF(iw(o.path),u,{includeMetadataChanges:!0,qa:!0});return TF(r,h)}(await RC(t),t.asyncQueue,e,n,s)),s.promise}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function MF(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const U1=new Map;/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const VF="firestore.googleapis.com",q1=!0;class B1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new _e(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=VF,this.ssl=q1}else this.host=e.host,this.ssl=e.ssl??q1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=hF;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<uQ)throw new _e(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}WK("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=MF(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new _e(se.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class y0{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new B1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _e(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new _e(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new B1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new LK;switch(n.type){case"firstParty":return new UK(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new _e(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=U1.get(e);n&&(fe("ComponentProvider","Removing Datastore"),U1.delete(e),n.terminate())}(this),Promise.resolve()}}function xY(t,e,n,s={}){t=Jr(t,y0);const r=Gi(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;r&&(Kv(`https://${a}`),Gv("Firestore",!0)),i.host!==VF&&i.host!==a&&_h("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:a,ssl:r,emulatorOptions:s};if(!nl(c,o)&&(t._setSettings(c),s.mockUserToken)){let u,h;if(typeof s.mockUserToken=="string")u=s.mockUserToken,h=rs.MOCK_USER;else{u=PS(s.mockUserToken,t._app?.options.projectId);const d=s.mockUserToken.sub||s.mockUserToken.user_id;if(!d)throw new _e(se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new rs(d)}t._authCredentials=new MK(new I2(u,h))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class pw{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new pw(this.firestore,e,this._query)}}let Fs=class Sf{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Sf(this.firestore,e,this._key)}toJSON(){return{type:Sf._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(Bg(n,Sf._jsonSchema))return new Sf(e,s||null,new Ce(Yt.fromString(n.referencePath)))}};Fs._jsonSchemaVersion="firestore/documentReference/1.0",Fs._jsonSchema={type:mn("string",Fs._jsonSchemaVersion),referencePath:mn("string")};class Kp extends pw{constructor(e,n,s){super(e,n,iw(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fs(this.firestore,null,new Ce(e))}withConverter(e){return new Kp(this.firestore,e,this._path)}}function FF(t,e,...n){if(t=It(t),arguments.length===1&&(e=KS.newId()),HK("doc","path",e),t instanceof y0){const s=Yt.fromString(e,...n);return t1(s),new Fs(t,null,new Ce(s))}{if(!(t instanceof Fs||t instanceof Kp))throw new _e(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Yt.fromString(e,...n));return t1(s),new Fs(t.firestore,t instanceof Kp?t.converter:null,new Ce(s))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const j1="AsyncQueue";class $1{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new gF(this,"async_queue_retry"),this._c=()=>{const s=xb();s&&fe(j1,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=xb();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=xb();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new qa;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Kh(e))throw e;fe(j1,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Wo("INTERNAL UNHANDLED ERROR: ",z1(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=f0.createAndSchedule(this,e,n,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&ke(47125,{Pc:z1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function z1(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function H1(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const s=e;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1}(t,["next","error","complete"])}class Uc extends y0{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new $1,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $1(e),this._firestoreClient=void 0,await e}}}function UF(t,e){const n=typeof t=="object"?t:Xv(),s=typeof t=="string"?t:ay,r=Vg(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=kS("firestore");i&&xY(r,...i)}return r}function v0(t){if(t._terminated)throw new _e(se.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||DY(t),t._firestoreClient}function DY(t){const e=t._freezeSettings(),n=function(s,r,i,o){return new sG(s,r,i,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,MF(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new AY(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(s){const r=s?._online.build();return{_offline:s?._offline.build(r),_online:r}}(t._componentsProvider))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class dr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new dr(Yn.fromBase64String(e))}catch(n){throw new _e(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new dr(Yn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:dr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Bg(e,dr._jsonSchema))return dr.fromBase64String(e.bytes)}}dr._jsonSchemaVersion="firestore/bytes/1.0",dr._jsonSchema={type:mn("string",dr._jsonSchemaVersion),bytes:mn("string")};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gw{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new _e(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class mw{constructor(e){this._methodName=e}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ni{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new _e(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new _e(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return et(this._lat,e._lat)||et(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ni._jsonSchemaVersion}}static fromJSON(e){if(Bg(e,Ni._jsonSchema))return new Ni(e.latitude,e.longitude)}}Ni._jsonSchemaVersion="firestore/geoPoint/1.0",Ni._jsonSchema={type:mn("string",Ni._jsonSchemaVersion),latitude:mn("number"),longitude:mn("number")};/**
* @license
* Copyright 2024 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class xi{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let r=0;r<n.length;++r)if(n[r]!==s[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:xi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Bg(e,xi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new xi(e.vectorValues);throw new _e(se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xi._jsonSchemaVersion="firestore/vectorValue/1.0",xi._jsonSchema={type:mn("string",xi._jsonSchemaVersion),vectorValues:mn("object")};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const OY=/^__.*__$/;class LY{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new xl(e,this.data,this.fieldMask,n,this.fieldTransforms):new jg(e,this.data,n,this.fieldTransforms)}}class qF{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new xl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function BF(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ke(40011,{Ac:t})}}class w0{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new w0({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return my(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(BF(this.Ac)&&OY.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class MY{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||hw(e)}Cc(e,n,s,r=!1){return new w0({Ac:e,methodName:n,Dc:s,path:Xr.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jF(t){const e=t._freezeSettings(),n=hw(t._databaseId);return new MY(t._databaseId,!!e.ignoreUndefinedProperties,n)}function VY(t,e,n,s,r,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,r);b0("Data must be an object, but it was:",o,s);const a=$F(s,o);let c,u;if(i.merge)c=new Ii(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const d of i.mergeFields){const p=AC(e,d,n);if(!o.contains(p))throw new _e(se.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);HF(h,p)||h.push(p)}c=new Ii(h),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new LY(new Vr(a),c,u)}class _w extends mw{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _w}}class E0 extends mw{_toFieldTransform(e){return new PG(e.path,new zp)}isEqual(e){return e instanceof E0}}function FY(t,e,n,s){const r=t.Cc(1,e,n);b0("Data must be an object, but it was:",r,s);const i=[],o=Vr.empty();Nl(s,(c,u)=>{const h=T0(e,c,n);u=It(u);const d=r.yc(h);if(u instanceof _w)i.push(h);else{const p=yw(u,d);p!=null&&(i.push(h),o.set(h,p))}});const a=new Ii(i);return new qF(o,a,r.fieldTransforms)}function UY(t,e,n,s,r,i){const o=t.Cc(1,e,n),a=[AC(e,s,n)],c=[r];if(i.length%2!=0)throw new _e(se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(AC(e,i[p])),c.push(i[p+1]);const u=[],h=Vr.empty();for(let p=a.length-1;p>=0;--p)if(!HF(u,a[p])){const m=a[p];let w=c[p];w=It(w);const R=o.yc(m);if(w instanceof _w)u.push(m);else{const k=yw(w,R);k!=null&&(u.push(m),h.set(m,k))}}const d=new Ii(u);return new qF(h,d,o.fieldTransforms)}function yw(t,e){if(zF(t=It(t)))return b0("Unsupported field value:",e,t),$F(t,e);if(t instanceof mw)return function(n,s){if(!BF(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const r=[];let i=0;for(const o of n){let a=yw(o,s.wc(i));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}return{arrayValue:{values:r}}}(t,e)}return function(n,s){if((n=It(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return RG(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=Bt.fromDate(n);return{timestampValue:dy(s.serializer,r)}}if(n instanceof Bt){const r=new Bt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:dy(s.serializer,r)}}if(n instanceof Ni)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof dr)return{bytesValue:rF(s.serializer,n._byteString)};if(n instanceof Fs){const r=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(r))throw s.Sc(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:r0(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof xi)return function(r,i){return{mapValue:{fields:{[O2]:{stringValue:L2},[ly]:{arrayValue:{values:r.toArray().map(o=>{if(typeof o!="number")throw i.Sc("VectorValues must only contain numeric values.");return e0(i.serializer,o)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${GS(n)}`)}(t,e)}function $F(t,e){const n={};return A2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Nl(t,(s,r)=>{const i=yw(r,e.mc(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function zF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Bt||t instanceof Ni||t instanceof dr||t instanceof Fs||t instanceof mw||t instanceof xi)}function b0(t,e,n){if(!zF(n)||!S2(n)){const s=GS(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function AC(t,e,n){if((e=It(e))instanceof gw)return e._internalPath;if(typeof e=="string")return T0(t,e);throw my("Field path arguments must be of type string or ",t,!1,void 0,n)}const qY=new RegExp("[~\\*/\\[\\]]");function T0(t,e,n){if(e.search(qY)>=0)throw my(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new gw(...e.split("."))._internalPath}catch{throw my(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function my(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new _e(se.INVALID_ARGUMENT,a+t+c)}function HF(t,e){return t.some(n=>n.isEqual(e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class WF{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Fs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new BY(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(KF("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class BY extends WF{data(){return super.data()}}function KF(t,e){return typeof e=="string"?T0(t,e):e instanceof gw?e._internalPath:e._delegate._internalPath}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function jY(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new _e(se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $Y{convertValue(e,n="none"){switch(ll(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(al(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ke(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Nl(e,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertVectorValue(e){const n=e.fields?.[ly].arrayValue?.values?.map(s=>dn(s.doubleValue));return new xi(n)}convertGeoPoint(e){return new Ni(dn(e.latitude),dn(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=sw(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Bp(e));default:return null}}convertTimestamp(e){const n=ol(e);return new Bt(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=Yt.fromString(e);Et(uF(s),9688,{name:e});const r=new jp(s.get(1),s.get(3)),i=new Ce(s.popFirst(5));return r.isEqual(n)||Wo(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function zY(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class Rf{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ac extends WF{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new d_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(KF("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new _e(se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ac._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()||(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED")),n}}Ac._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ac._jsonSchema={type:mn("string",Ac._jsonSchemaVersion),bundleSource:mn("string","DocumentSnapshot"),bundleName:mn("string"),bundle:mn("string")};class d_ extends Ac{data(e={}){return super.data(e)}}class Yu{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Rf(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new d_(this._firestore,this._userDataWriter,s.key,s,new Rf(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new _e(se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const a=new d_(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Rf(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new d_(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Rf(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),u=i.indexOf(o.doc.key)),{type:HY(o.type),doc:a,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new _e(se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Yu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=KS.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function HY(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ke(61501,{type:t})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function kC(t){t=Jr(t,Fs);const e=Jr(t.firestore,Uc);return NY(v0(e),t._key).then(n=>QF(e,t,n))}Yu._jsonSchemaVersion="firestore/querySnapshot/1.0",Yu._jsonSchema={type:mn("string",Yu._jsonSchemaVersion),bundleSource:mn("string","QuerySnapshot"),bundleName:mn("string"),bundle:mn("string")};class GF extends $Y{constructor(e){super(),this.firestore=e}convertBytes(e){return new dr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fs(this.firestore,null,n)}}function PC(t,e,n){t=Jr(t,Fs);const s=Jr(t.firestore,Uc),r=zY(t.converter,e,n);return C0(s,[VY(jF(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Zr.none())])}function WY(t,e,n,...s){t=Jr(t,Fs);const r=Jr(t.firestore,Uc),i=jF(r);let o;return o=typeof(e=It(e))=="string"||e instanceof gw?UY(i,"updateDoc",t._key,e,n,s):FY(i,"updateDoc",t._key,e),C0(r,[o.toMutation(t._key,Zr.exists(!0))])}function KY(t){return C0(Jr(t.firestore,Uc),[new t0(t._key,Zr.none())])}function GY(t,...e){t=It(t);let n={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||H1(e[s])||(n=e[s++]);const r={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(H1(e[s])){const c=e[s];e[s]=c.next?.bind(c),e[s+1]=c.error?.bind(c),e[s+2]=c.complete?.bind(c)}let i,o,a;if(t instanceof Fs)o=Jr(t.firestore,Uc),a=iw(t._key.path),i={next:c=>{e[s]&&e[s](QF(o,t,c))},error:e[s+1],complete:e[s+2]};else{const c=Jr(t,pw);o=Jr(c.firestore,Uc),a=c._query;const u=new GF(o);i={next:h=>{e[s]&&e[s](new Yu(o,u,c,h))},error:e[s+1],complete:e[s+2]},jY(t._query)}return function(c,u,h,d){const p=new OF(d),m=new IF(u,p,h);return c.asyncQueue.enqueueAndForget(async()=>TF(await RC(c),m)),()=>{p.Nu(),c.asyncQueue.enqueueAndForget(async()=>CF(await RC(c),m))}}(v0(o),a,r,i)}function C0(t,e){return function(n,s){const r=new qa;return n.asyncQueue.enqueueAndForget(async()=>vY(await PY(n),s,r)),r.promise}(v0(t),e)}function QF(t,e,n){const s=n.docs.get(e._key),r=new GF(t);return new Ac(t,r,e._key,s,new Rf(n.hasPendingWrites,n.fromCache),e.converter)}function f_(){return new E0("serverTimestamp")}(function(t,e=!0){(function(n){Hh=n})(Pl),sl(new $o("firestore",(n,{instanceIdentifier:s,options:r})=>{const i=n.getProvider("app").getImmediate(),o=new Uc(new VK(n.getProvider("auth-internal")),new qK(i,n.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new _e(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jp(a.options.projectId,c)}(i,s),i);return r={useFetchStreams:e,...r},o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),gr(XP,JP,t),gr(XP,JP,"esm2020")})();var QY="firebase",YY="12.0.0";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/gr(QY,YY,"app");/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const YF="firebasestorage.googleapis.com",XF="storageBucket",XY=120*1e3,JY=600*1e3;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class cn extends Qi{constructor(e,n,s=0){super(Ob(e),`Firebase Storage: ${n} (${Ob(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,cn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ob(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var on;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(on||(on={}));function Ob(t){return"storage/"+t}function I0(){const t="An unknown error occurred, please check the error payload for server response.";return new cn(on.UNKNOWN,t)}function ZY(t){return new cn(on.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function eX(t){return new cn(on.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function tX(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new cn(on.UNAUTHENTICATED,t)}function nX(){return new cn(on.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function sX(t){return new cn(on.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function rX(){return new cn(on.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function iX(){return new cn(on.CANCELED,"User canceled the upload/download.")}function oX(t){return new cn(on.INVALID_URL,"Invalid URL '"+t+"'.")}function aX(t){return new cn(on.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function lX(){return new cn(on.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+XF+"' property when initializing the app?")}function cX(){return new cn(on.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function uX(){return new cn(on.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function hX(t){return new cn(on.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function NC(t){return new cn(on.INVALID_ARGUMENT,t)}function JF(){return new cn(on.APP_DELETED,"The Firebase app was deleted.")}function dX(t){return new cn(on.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ep(t,e){return new cn(on.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function rf(t){throw new cn(on.INTERNAL_ERROR,"Internal error: "+t)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ds{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=Ds.makeFromUrl(e,n)}catch{return new Ds(e,"")}if(s.path==="")return s;throw aX(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function u(F){F.path_=decodeURIComponent(F.path)}const h="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${d}/${h}/b/${r}/o${p}`,"i"),w={bucket:1,path:3},R=n===YF?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",O=new RegExp(`^https?://${R}/${r}/${k}`,"i"),M=[{regex:a,indices:c,postModify:i},{regex:m,indices:w,postModify:u},{regex:O,indices:{bucket:1,path:2},postModify:u}];for(let F=0;F<M.length;F++){const q=M[F],H=q.regex.exec(e);if(H){const J=H[q.indices.bucket];let I=H[q.indices.path];I||(I=""),s=new Ds(J,I),q.postModify(s);break}}if(s==null)throw oX(e);return s}}class fX{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function pX(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function c(){return a===2}let u=!1;function h(...k){u||(u=!0,e.apply(null,k))}function d(k){r=setTimeout(()=>{r=null,t(m,c())},k)}function p(){i&&clearTimeout(i)}function m(k,...O){if(u){p();return}if(k){p(),h.call(null,k,...O);return}if(c()||o){p(),h.call(null,k,...O);return}s<64&&(s*=2);let M;a===1?(a=2,M=0):M=(s+Math.random())*1e3,d(M)}let w=!1;function R(k){w||(w=!0,p(),!u&&(r!==null?(k||(a=2),clearTimeout(r),d(0)):k||(a=1)))}return d(0),i=setTimeout(()=>{o=!0,R(!0)},n),R}function gX(t){t(!1)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function mX(t){return t!==void 0}function _X(t){return typeof t=="object"&&!Array.isArray(t)}function S0(t){return typeof t=="string"||t instanceof String}function W1(t){return R0()&&t instanceof Blob}function R0(){return typeof Blob<"u"}function xC(t,e,n,s){if(s<e)throw NC(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw NC(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Wg(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function ZF(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var kc;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(kc||(kc={}));/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function yX(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,r=e.indexOf(t)!==-1;return n||s||r}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class vX{constructor(e,n,s,r,i,o,a,c,u,h,d,p=!0,m=!1){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=d,this.retry=p,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,R)=>{this.resolve_=w,this.reject_=R,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Nm(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===kc.NO_ERROR,c=i.getStatus();if(!a||yX(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===kc.ABORT;s(!1,new Nm(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;s(!0,new Nm(u,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());mX(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=I0();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?JF():iX();o(c)}else{const c=rX();o(c)}};this.canceled_?n(!1,new Nm(!1,null,!0)):this.backoffId_=pX(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&gX(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Nm{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function wX(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function EX(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function bX(t,e){e&&(t["X-Firebase-GMPID"]=e)}function TX(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function CX(t,e,n,s,r,i,o=!0,a=!1){const c=ZF(t.urlParams),u=t.url+c,h=Object.assign({},t.headers);return bX(h,e),wX(h,n),EX(h,i),TX(h,s),new vX(u,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o,a)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function IX(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function SX(...t){const e=IX();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(R0())return new Blob(t);throw new cn(on.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function RX(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function AX(t){if(typeof atob>"u")throw hX("base-64");return atob(t)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Br={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Lb{constructor(e,n){this.data=e,this.contentType=n||null}}function eU(t,e){switch(t){case Br.RAW:return new Lb(tU(e));case Br.BASE64:case Br.BASE64URL:return new Lb(nU(t,e));case Br.DATA_URL:return new Lb(PX(e),NX(e))}throw I0()}function tU(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const r=s,i=t.charCodeAt(++n);s=65536|(r&1023)<<10|i&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function kX(t){let e;try{e=decodeURIComponent(t)}catch{throw ep(Br.DATA_URL,"Malformed data URL.")}return tU(e)}function nU(t,e){switch(t){case Br.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw ep(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Br.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw ep(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=AX(e)}catch(r){throw r.message.includes("polyfill")?r:ep(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class sU{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw ep(Br.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=xX(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function PX(t){const e=new sU(t);return e.base64?nU(Br.BASE64,e.rest):kX(e.rest)}function NX(t){return new sU(t).contentType}function xX(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Aa{constructor(e,n){let s=0,r="";W1(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(W1(this.data_)){const s=this.data_,r=RX(s,e,n);return r===null?null:new Aa(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new Aa(s,!0)}}static getBlob(...e){if(R0()){const n=e.map(s=>s instanceof Aa?s.data_:s);return new Aa(SX.apply(null,n))}else{const n=e.map(o=>S0(o)?eU(Br.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new Aa(r,!0)}}uploadData(){return this.data_}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function A0(t){let e;try{e=JSON.parse(t)}catch{return null}return _X(e)?e:null}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function DX(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function OX(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function rU(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function LX(t,e){return e}class Ts{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||LX}}let xm=null;function MX(t){return!S0(t)||t.length<2?t:rU(t)}function iU(){if(xm)return xm;const t=[];t.push(new Ts("bucket")),t.push(new Ts("generation")),t.push(new Ts("metageneration")),t.push(new Ts("name","fullPath",!0));function e(i,o){return MX(o)}const n=new Ts("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new Ts("size");return r.xform=s,t.push(r),t.push(new Ts("timeCreated")),t.push(new Ts("updated")),t.push(new Ts("md5Hash",null,!0)),t.push(new Ts("cacheControl",null,!0)),t.push(new Ts("contentDisposition",null,!0)),t.push(new Ts("contentEncoding",null,!0)),t.push(new Ts("contentLanguage",null,!0)),t.push(new Ts("contentType",null,!0)),t.push(new Ts("metadata","customMetadata",!0)),xm=t,xm}function VX(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new Ds(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function FX(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return VX(s,t),s}function oU(t,e,n){const s=A0(e);return s===null?null:FX(t,s,n)}function UX(t,e,n,s){const r=A0(e);if(r===null||!S0(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(a=>{const c=t.bucket,u=t.fullPath,h="/b/"+o(c)+"/o/"+o(u),d=Wg(h,n,s),p=ZF({alt:"media",token:a});return d+p})[0]}function qX(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const K1="prefixes",G1="items";function BX(t,e,n){const s={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[K1])for(const r of n[K1]){const i=r.replace(/\/$/,""),o=t._makeStorageReference(new Ds(e,i));s.prefixes.push(o)}if(n[G1])for(const r of n[G1]){const i=t._makeStorageReference(new Ds(e,r.name));s.items.push(i)}return s}function jX(t,e,n){const s=A0(n);return s===null?null:BX(t,e,s)}class vw{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function k0(t){if(!t)throw I0()}function $X(t,e){function n(s,r){const i=oU(t,r,e);return k0(i!==null),i}return n}function zX(t,e){function n(s,r){const i=jX(t,e,r);return k0(i!==null),i}return n}function HX(t,e){function n(s,r){const i=oU(t,r,e);return k0(i!==null),UX(i,r,t.host,t._protocol)}return n}function P0(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=nX():r=tX():n.getStatus()===402?r=eX(t.bucket):n.getStatus()===403?r=sX(t.path):r=s,r.status=n.getStatus(),r.serverResponse=s.serverResponse,r}return e}function aU(t){const e=P0(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=ZY(t.path)),i.serverResponse=r.serverResponse,i}return n}function WX(t,e,n,s,r){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),s&&(i.pageToken=s),r&&(i.maxResults=r);const o=e.bucketOnlyServerUrl(),a=Wg(o,t.host,t._protocol),c="GET",u=t.maxOperationRetryTime,h=new vw(a,c,zX(t,e.bucket),u);return h.urlParams=i,h.errorHandler=P0(e),h}function KX(t,e,n){const s=e.fullServerUrl(),r=Wg(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new vw(r,i,HX(t,n),o);return a.errorHandler=aU(e),a}function GX(t,e){const n=e.fullServerUrl(),s=Wg(n,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function o(c,u){}const a=new vw(s,r,o,i);return a.successCodes=[200,204],a.errorHandler=aU(e),a}function QX(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function YX(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=QX(null,e)),s}function XX(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let F="";for(let q=0;q<2;q++)F=F+Math.random().toString().slice(2);return F}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const u=YX(e,s,r),h=qX(u,n),d="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+c+"--",m=Aa.getBlob(d,s,p);if(m===null)throw cX();const w={name:u.fullPath},R=Wg(i,t.host,t._protocol),k="POST",O=t.maxUploadRetryTime,M=new vw(R,k,$X(t,n),O);return M.urlParams=w,M.headers=o,M.body=m.uploadData(),M.errorHandler=P0(e),M}class JX{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=kc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=kc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=kc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r,i){if(this.sent_)throw rf("cannot .send() more than once");if(Gi(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw rf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw rf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw rf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw rf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class ZX extends JX{initXhr(){this.xhr_.responseType="text"}}function ww(){return new ZX}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qc{constructor(e,n){this._service=e,n instanceof Ds?this._location=n:this._location=Ds.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new qc(e,n)}get root(){const e=new Ds(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return rU(this._location.path)}get storage(){return this._service}get parent(){const e=DX(this._location.path);if(e===null)return null;const n=new Ds(this._location.bucket,e);return new qc(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw dX(e)}}function eJ(t,e,n){t._throwIfRoot("uploadBytes");const s=XX(t.storage,t._location,iU(),new Aa(e,!0),n);return t.storage.makeRequestWithTokens(s,ww).then(r=>({metadata:r,ref:t}))}function tJ(t,e,n=Br.RAW,s){t._throwIfRoot("uploadString");const r=eU(n,e),i={...s};return i.contentType==null&&r.contentType!=null&&(i.contentType=r.contentType),eJ(t,r.data,i)}function nJ(t){const e={prefixes:[],items:[]};return lU(t,e).then(()=>e)}async function lU(t,e,n){const s=await sJ(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await lU(t,e,s.nextPageToken)}function sJ(t,e){e!=null&&typeof e.maxResults=="number"&&xC("options.maxResults",1,1e3,e.maxResults);const n=e||{},s=WX(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(s,ww)}function rJ(t){t._throwIfRoot("getDownloadURL");const e=KX(t.storage,t._location,iU());return t.storage.makeRequestWithTokens(e,ww).then(n=>{if(n===null)throw uX();return n})}function iJ(t){t._throwIfRoot("deleteObject");const e=GX(t.storage,t._location);return t.storage.makeRequestWithTokens(e,ww)}function oJ(t,e){const n=OX(t._location.path,e),s=new Ds(t._location.bucket,n);return new qc(t.storage,s)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function aJ(t){return/^[A-Za-z]+:\/\//.test(t)}function lJ(t,e){return new qc(t,e)}function cU(t,e){if(t instanceof N0){const n=t;if(n._bucket==null)throw lX();const s=new qc(n,n._bucket);return e!=null?cU(s,e):s}else return e!==void 0?oJ(t,e):t}function cJ(t,e){if(e&&aJ(e)){if(t instanceof N0)return lJ(t,e);throw NC("To use ref(service, url), the first argument must be a Storage instance.")}else return cU(t,e)}function Q1(t,e){const n=e?.[XF];return n==null?null:Ds.makeFromBucketSpec(n,t)}function uJ(t,e,n,s={}){t.host=`${e}:${n}`;const r=Gi(e);r&&(Kv(`https://${t.host}/b`),Gv("Storage",!0)),t._isUsingEmulator=!0,t._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(t._overrideAuthToken=typeof i=="string"?i:PS(i,t.app.options.projectId))}class N0{constructor(e,n,s,r,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=YF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=XY,this._maxUploadRetryTime=JY,this._requests=new Set,r!=null?this._bucket=Ds.makeFromBucketSpec(r,this._host):this._bucket=Q1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ds.makeFromBucketSpec(this._url,e):this._bucket=Q1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Zs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qc(this,e)}_makeRequest(e,n,s,r,i=!0){if(this._deleted)return new fX(JF());{const o=CX(e,this._appId,s,r,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const Y1="@firebase/storage",X1="0.14.0";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const uU="storage";function hJ(t,e,n,s){return t=It(t),tJ(t,e,n,s)}function dJ(t){return t=It(t),nJ(t)}function fJ(t){return t=It(t),rJ(t)}function pJ(t){return t=It(t),iJ(t)}function gJ(t,e){return t=It(t),cJ(t,e)}function mJ(t=Xv(),e){t=It(t);const n=Vg(t,uU).getImmediate({identifier:e}),s=kS("storage");return s&&_J(n,...s),n}function _J(t,e,n,s={}){uJ(t,e,n,s)}function yJ(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new N0(n,s,r,e,Pl)}function vJ(){sl(new $o(uU,yJ,"PUBLIC").setMultipleInstances(!0)),gr(Y1,X1,""),gr(Y1,X1,"esm2020")}vJ();var J1={};const Z1="@firebase/database",eN="1.1.0";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let hU="";function wJ(t){hU=t}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class EJ{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),In(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Vp(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class bJ{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return ra(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const dU=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new EJ(e)}}catch{}return new bJ},mc=dU("localStorage"),TJ=dU("sessionStorage");/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Xu=new Yv("@firebase/database"),CJ=function(){let t=1;return function(){return t++}}(),fU=function(t){const e=UW(t),n=new LW;n.update(e);const s=n.digest();return AS.encodeByteArray(s)},Kg=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Kg.apply(null,s):typeof s=="object"?e+=In(s):e+=s,e+=" "}return e};let tp=null,tN=!0;const IJ=function(t,e){ue(!0,"Can't turn on custom loggers persistently."),Xu.logLevel=Ye.VERBOSE,tp=Xu.log.bind(Xu)},cs=function(...t){if(tN===!0&&(tN=!1,tp===null&&TJ.get("logging_enabled")===!0&&IJ()),tp){const e=Kg.apply(null,t);tp(e)}},Gg=function(t){return function(...e){cs(t,...e)}},DC=function(...t){const e="FIREBASE INTERNAL ERROR: "+Kg(...t);Xu.error(e)},Go=function(...t){const e=`FIREBASE FATAL ERROR: ${Kg(...t)}`;throw Xu.error(e),new Error(e)},zs=function(...t){const e="FIREBASE WARNING: "+Kg(...t);Xu.warn(e)},SJ=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&zs("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},pU=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},RJ=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Th="[MIN_NAME]",Bc="[MAX_NAME]",Qh=function(t,e){if(t===e)return 0;if(t===Th||e===Bc)return-1;if(e===Th||t===Bc)return 1;{const n=nN(t),s=nN(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},AJ=function(t,e){return t===e?0:t<e?-1:1},of=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+In(e))},x0=function(t){if(typeof t!="object"||t===null)return In(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=In(e[s]),n+=":",n+=x0(t[e[s]]);return n+="}",n},gU=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let r=0;r<n;r+=e)r+e>n?s.push(t.substring(r,n)):s.push(t.substring(r,r+e));return s};function Ws(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const mU=function(t){ue(!pU(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let r,i,o,a,c;t===0?(i=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),i=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-s-n))));const u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(r?1:0),u.reverse();const h=u.join("");let d="";for(c=0;c<64;c+=8){let p=parseInt(h.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),d=d+p}return d.toLowerCase()},kJ=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},PJ=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function NJ(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const xJ=new RegExp("^-?(0*)\\d{1,10}$"),DJ=-2147483648,OJ=2147483647,nN=function(t){if(xJ.test(t)){const e=Number(t);if(e>=DJ&&e<=OJ)return e}return null},Yh=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw zs("Exception was thrown by user callback.",n),e},Math.floor(0))}},LJ=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},np=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class MJ{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,Zs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){zs(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class VJ{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(cs("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',zs(e)}}class p_{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}p_.OWNER="owner";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const D0="5",_U="v",yU="s",vU="r",wU="f",EU=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,bU="ls",TU="p",OC="ac",CU="websocket",IU="long_polling";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class SU{constructor(e,n,s,r,i=!1,o="",a=!1,c=!1,u=null){this.secure=n,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=mc.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&mc.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function FJ(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function RU(t,e,n){ue(typeof e=="string","typeof type must == string"),ue(typeof n=="object","typeof params must == object");let s;if(e===CU)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===IU)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);FJ(t)&&(n.ns=t.namespace);const r=[];return Ws(n,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class UJ{constructor(){this.counters_={}}incrementCounter(e,n=1){ra(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return pW(this.counters_)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Mb={},Vb={};function O0(t){const e=t.toString();return Mb[e]||(Mb[e]=new UJ),Mb[e]}function qJ(t,e){const n=t.toString();return Vb[n]||(Vb[n]=e()),Vb[n]}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class BJ{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&Yh(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const sN="start",jJ="close",$J="pLPCommand",zJ="pRTLPCB",AU="id",kU="pw",PU="ser",HJ="cb",WJ="seg",KJ="ts",GJ="d",QJ="dframe",NU=1870,xU=30,YJ=NU-xU,XJ=25e3,JJ=3e4;class Uu{constructor(e,n,s,r,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Gg(e),this.stats_=O0(n),this.urlFn=c=>(this.appCheckToken&&(c[OC]=this.appCheckToken),RU(n,IU,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new BJ(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(JJ)),RJ(()=>{if(this.isClosed_)return;this.scriptTagHolder=new L0((...i)=>{const[o,a,c,u,h]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===sN)this.id=a,this.password=c;else if(o===jJ)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[sN]="t",s[PU]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[HJ]=this.scriptTagHolder.uniqueCallbackIdentifier),s[_U]=D0,this.transportSessionId&&(s[yU]=this.transportSessionId),this.lastSessionId&&(s[bU]=this.lastSessionId),this.applicationId&&(s[TU]=this.applicationId),this.appCheckToken&&(s[OC]=this.appCheckToken),typeof location<"u"&&location.hostname&&EU.test(location.hostname)&&(s[vU]=wU);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Uu.forceAllow_=!0}static forceDisallow(){Uu.forceDisallow_=!0}static isAvailable(){return Uu.forceAllow_?!0:!Uu.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!kJ()&&!PJ()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=In(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=vV(n),r=gU(s,YJ);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[QJ]="t",s[AU]=e,s[kU]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=In(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class L0{constructor(e,n,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=CJ(),window[$J+this.uniqueCallbackIdentifier]=e,window[zJ+this.uniqueCallbackIdentifier]=n,this.myIFrame=L0.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){cs("frame writing exception"),a.stack&&cs(a.stack),cs(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||cs("No IE domain setting required")}catch{const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[AU]=this.myID,e[kU]=this.myPW,e[PU]=this.currentSerial;let n=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+xU+s.length<=NU;){const i=this.pendingSegs.shift();s=s+"&"+WJ+r+"="+i.seg+"&"+KJ+r+"="+i.ts+"&"+GJ+r+"="+i.d,r++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(s,Math.floor(XJ)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{cs("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ZJ=16384,eZ=45e3;let _y=null;typeof MozWebSocket<"u"?_y=MozWebSocket:typeof WebSocket<"u"&&(_y=WebSocket);class Fr{constructor(e,n,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Gg(this.connId),this.stats_=O0(n),this.connURL=Fr.connectionURL_(n,o,a,r,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,r,i){const o={};return o[_U]=D0,typeof location<"u"&&location.hostname&&EU.test(location.hostname)&&(o[vU]=wU),n&&(o[yU]=n),s&&(o[bU]=s),r&&(o[OC]=r),i&&(o[TU]=i),RU(e,CU,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,mc.set("previous_websocket_failure",!0);try{let s;SW(),this.mySock=new _y(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){Fr.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&_y!==null&&!Fr.forceDisallow_}static previouslyFailed(){return mc.isInMemoryStorage||mc.get("previous_websocket_failure")===!0}markConnectionHealthy(){mc.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=Vp(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ue(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=In(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=gU(n,ZJ);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(eZ))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Fr.responsesRequiredToBeHealthy=2;Fr.healthyTimeout=3e4;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Gp{static get ALL_TRANSPORTS(){return[Uu,Fr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Fr&&Fr.isAvailable();let s=n&&!Fr.previouslyFailed();if(e.webSocketOnly&&(n||zs("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Fr];else{const r=this.transports_=[];for(const i of Gp.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);Gp.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Gp.globalTransportInitialized_=!1;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const tZ=6e4,nZ=5e3,sZ=10*1024,rZ=100*1024,Fb="t",rN="d",iZ="s",iN="r",oZ="e",oN="o",aN="a",lN="n",cN="p",aZ="h";class lZ{constructor(e,n,s,r,i,o,a,c,u,h){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Gg("c:"+this.id+":"),this.transportManager_=new Gp(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=np(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>rZ?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>sZ?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Fb in e){const n=e[Fb];n===aN?this.upgradeIfSecondaryHealthy_():n===iN?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===oN&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=of("t",e),s=of("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:cN,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:aN,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:lN,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=of("t",e),s=of("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=of(Fb,e);if(rN in e){const s=e[rN];if(n===aZ){const r={...s};this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===lN){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===iZ?this.onConnectionShutdown_(s):n===iN?this.onReset_(s):n===oZ?DC("Server Error: "+s):n===oN?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):DC("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),D0!==s&&zs("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),np(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(tZ))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):np(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(nZ))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:cN,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(mc.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class DU{put(e,n,s,r){}merge(e,n,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class OU{constructor(e){this.allowedEvents_=e,this.listeners_={},ue(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const r=this.getInitialEvent(e);r&&n.apply(s,r)}off(e,n,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===n&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){ue(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class yy extends OU{static getInstance(){return new yy}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!NS()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return ue(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const uN=32,hN=768;class Pt{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function dt(){return new Pt("")}function We(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function hl(t){return t.pieces_.length-t.pieceNum_}function Ot(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Pt(t.pieces_,e)}function LU(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function cZ(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function MU(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function VU(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Pt(e,0)}function Rn(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Pt)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&n.push(s[r])}return new Pt(n,0)}function Je(t){return t.pieceNum_>=t.pieces_.length}function Os(t,e){const n=We(t),s=We(e);if(n===null)return e;if(n===s)return Os(Ot(t),Ot(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function M0(t,e){if(hl(t)!==hl(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function jr(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(hl(t)>hl(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class uZ{constructor(e,n){this.errorPrefix_=n,this.parts_=MU(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Qv(this.parts_[s]);FU(this)}}function hZ(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Qv(e),FU(t)}function dZ(t){const e=t.parts_.pop();t.byteLength_-=Qv(e),t.parts_.length>0&&(t.byteLength_-=1)}function FU(t){if(t.byteLength_>hN)throw new Error(t.errorPrefix_+"has a key path longer than "+hN+" bytes ("+t.byteLength_+").");if(t.parts_.length>uN)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+uN+") or object contains a cycle "+lc(t))}function lc(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class V0 extends OU{static getInstance(){return new V0}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return ue(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const af=1e3,fZ=300*1e3,dN=30*1e3,pZ=1.3,gZ=3e4,mZ="server_kill",fN=3;class Fo extends DU{constructor(e,n,s,r,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=Fo.nextPersistentConnectionId_++,this.log_=Gg("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=af,this.maxReconnectDelay_=fZ,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");V0.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&yy.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const r=++this.requestNumber_,i={r,a:e,b:n};this.log_(In(i)),ue(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const n=new Wv,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:i=>{const o=i.d;i.s==="ok"?n.resolve(o):n.reject(o)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),ue(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ue(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,u=a.s;Fo.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&ra(e,"w")){const s=gh(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();zs(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||OW(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=dN)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=DW(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),ue(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,n)}sendUnlisten_(e,n,s,r){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,r){const i={p:n,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,s,r){this.putInternal("p",e,n,s,r)}merge(e,n,s,r){this.putInternal("m",e,n,s,r)}putInternal(e,n,s,r,i){this.initConnection_();const o={p:n,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+In(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):DC("Unrecognized action received from server: "+In(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ue(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=af,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=af,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>gZ&&(this.reconnectDelay_=af),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*pZ)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Fo.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,s())},u=function(d){ue(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:c,sendRequest:u};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,p]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?cs("getToken() completed but was canceled"):(cs("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=p&&p.token,a=new lZ(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,m=>{zs(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(mZ)},i))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&zs(d),c())}}}interrupt(e){cs("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){cs("Resuming connection for reason: "+e),delete this.interruptReasons_[e],XT(this.interruptReasons_)&&(this.reconnectDelay_=af,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(i=>x0(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const s=new Pt(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(n),i.delete(n),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,n){cs("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=fN&&(this.reconnectDelay_=dN,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){cs("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=fN&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+hU.replace(/\./g,"-")]=1,NS()?e["framework.cordova"]=1:CV()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=yy.getInstance().currentlyOnline();return XT(this.interruptReasons_)&&e}}Fo.nextPersistentConnectionId_=0;Fo.nextConnectionId_=0;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ge{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Ge(e,n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ew{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new Ge(Th,e),r=new Ge(Th,n);return this.compare(s,r)!==0}minPost(){return Ge.MIN}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Dm;class UU extends Ew{static get __EMPTY_NODE(){return Dm}static set __EMPTY_NODE(e){Dm=e}compare(e,n){return Qh(e.name,n.name)}isDefinedOn(e){throw jh("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Ge.MIN}maxPost(){return new Ge(Bc,Dm)}makePost(e,n){return ue(typeof e=="string","KeyIndex indexValue must always be a string."),new Ge(e,Dm)}toString(){return".key"}}const Ju=new UU;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Om{constructor(e,n,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let Js=class Af{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??Af.RED,this.left=r??Si.EMPTY_NODE,this.right=i??Si.EMPTY_NODE}copy(e,n,s,r,i){return new Af(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Si.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,r;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return Si.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Af.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Af.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}};Js.RED=!0;Js.BLACK=!1;class _Z{copy(e,n,s,r,i){return this}insert(e,n,s){return new Js(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}let Si=class g_{constructor(e,n=g_.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new g_(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Js.BLACK,null,null))}remove(e){return new g_(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Js.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,r=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Om(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Om(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Om(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Om(this.root_,null,this.comparator_,!0,e)}};Si.EMPTY_NODE=new _Z;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function yZ(t,e){return Qh(t.name,e.name)}function F0(t,e){return Qh(t,e)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let LC;function vZ(t){LC=t}const qU=function(t){return typeof t=="number"?"number:"+mU(t):"string:"+t},BU=function(t){if(t.isLeafNode()){const e=t.val();ue(typeof e=="string"||typeof e=="number"||typeof e=="object"&&ra(e,".sv"),"Priority must be a string or number.")}else ue(t===LC||t.isEmpty(),"priority of unexpected type.");ue(t===LC||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let pN,jc=class Dr{static set __childrenNodeConstructor(e){pN=e}static get __childrenNodeConstructor(){return pN}constructor(e,n=Dr.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,ue(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),BU(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Dr(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Dr.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Je(e)?this:We(e)===".priority"?this.priorityNode_:Dr.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Dr.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=We(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(ue(s!==".priority"||hl(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,Dr.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ot(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+qU(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=mU(this.value_):e+=this.value_,this.lazyHash_=fU(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Dr.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Dr.__childrenNodeConstructor?-1:(ue(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,r=Dr.VALUE_TYPE_ORDER.indexOf(n),i=Dr.VALUE_TYPE_ORDER.indexOf(s);return ue(r>=0,"Unknown leaf type: "+n),ue(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}};jc.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let jU,$U;function wZ(t){jU=t}function EZ(t){$U=t}class bZ extends Ew{compare(e,n){const s=e.node.getPriority(),r=n.node.getPriority(),i=s.compareTo(r);return i===0?Qh(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Ge.MIN}maxPost(){return new Ge(Bc,new jc("[PRIORITY-POST]",$U))}makePost(e,n){const s=jU(e);return new Ge(n,new jc("[PRIORITY-POST]",s))}toString(){return".priority"}}const nn=new bZ;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const TZ=Math.log(2);class CZ{constructor(e){const n=i=>parseInt(Math.log(i)/TZ,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const vy=function(t,e,n,s){t.sort(e);const r=function(c,u){const h=u-c;let d,p;if(h===0)return null;if(h===1)return d=t[c],p=n?n(d):d,new Js(p,d.node,Js.BLACK,null,null);{const m=parseInt(h/2,10)+c,w=r(c,m),R=r(m+1,u);return d=t[m],p=n?n(d):d,new Js(p,d.node,Js.BLACK,w,R)}},i=function(c){let u=null,h=null,d=t.length;const p=function(w,R){const k=d-w,O=d;d-=w;const M=r(k+1,O),F=t[k],q=n?n(F):F;m(new Js(q,F.node,R,null,M))},m=function(w){u?(u.left=w,u=w):(h=w,u=w)};for(let w=0;w<c.count;++w){const R=c.nextBitIsOne(),k=Math.pow(2,c.count-(w+1));R?p(k,Js.BLACK):(p(k,Js.BLACK),p(k,Js.RED))}return h},o=new CZ(t.length),a=i(o);return new Si(s||e,a)};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Ub;const fu={};class Oo{static get Default(){return ue(fu&&nn,"ChildrenNode.ts has not been loaded"),Ub=Ub||new Oo({".priority":fu},{".priority":nn}),Ub}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=gh(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Si?n:null}hasIndex(e){return ra(this.indexSet_,e.toString())}addIndex(e,n){ue(e!==Ju,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=n.getIterator(Ge.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=vy(s,e.getCompare()):a=fu;const c=e.toString(),u={...this.indexSet_};u[c]=e;const h={...this.indexes_};return h[c]=a,new Oo(h,u)}addToIndexes(e,n){const s=J_(this.indexes_,(r,i)=>{const o=gh(this.indexSet_,i);if(ue(o,"Missing index implementation for "+i),r===fu)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(Ge.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),vy(a,o.getCompare())}else return fu;else{const a=n.get(e.name);let c=r;return a&&(c=c.remove(new Ge(e.name,a))),c.insert(e,e.node)}});return new Oo(s,this.indexSet_)}removeFromIndexes(e,n){const s=J_(this.indexes_,r=>{if(r===fu)return r;{const i=n.get(e.name);return i?r.remove(new Ge(e.name,i)):r}});return new Oo(s,this.indexSet_)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let lf;class Re{static get EMPTY_NODE(){return lf||(lf=new Re(new Si(F0),null,Oo.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&BU(this.priorityNode_),this.children_.isEmpty()&&ue(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||lf}updatePriority(e){return this.children_.isEmpty()?this:new Re(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?lf:n}}getChild(e){const n=We(e);return n===null?this:this.getImmediateChild(n).getChild(Ot(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(ue(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new Ge(e,n);let r,i;n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?lf:this.priorityNode_;return new Re(r,o,i)}}updateChild(e,n){const s=We(e);if(s===null)return n;{ue(We(e)!==".priority"||hl(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(Ot(e),n);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,r=0,i=!0;if(this.forEachChild(nn,(o,a)=>{n[o]=a.val(e),s++,i&&Re.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+qU(this.getPriority().val())+":"),this.forEachChild(nn,(n,s)=>{const r=s.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":fU(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new Ge(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new Ge(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new Ge(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,Ge.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,Ge.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Qg?-1:0}withIndex(e){if(e===Ju||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Re(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Ju||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(nn),r=n.getIterator(nn);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Ju?null:this.indexMap_.get(e.toString())}}Re.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class IZ extends Re{constructor(){super(new Si(F0),Re.EMPTY_NODE,Oo.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Re.EMPTY_NODE}isEmpty(){return!1}}const Qg=new IZ;Object.defineProperties(Ge,{MIN:{value:new Ge(Th,Re.EMPTY_NODE)},MAX:{value:new Ge(Bc,Qg)}});UU.__EMPTY_NODE=Re.EMPTY_NODE;jc.__childrenNodeConstructor=Re;vZ(Qg);EZ(Qg);/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const SZ=!0;function Fn(t,e=null){if(t===null)return Re.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),ue(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new jc(n,Fn(e))}if(!(t instanceof Array)&&SZ){const n=[];let s=!1;if(Ws(t,(i,o)=>{if(i.substring(0,1)!=="."){const a=Fn(o);a.isEmpty()||(s=s||!a.getPriority().isEmpty(),n.push(new Ge(i,a)))}}),n.length===0)return Re.EMPTY_NODE;const r=vy(n,yZ,i=>i.name,F0);if(s){const i=vy(n,nn.getCompare());return new Re(r,Fn(e),new Oo({".priority":i},{".priority":nn}))}else return new Re(r,Fn(e),Oo.Default)}else{let n=Re.EMPTY_NODE;return Ws(t,(s,r)=>{if(ra(t,s)&&s.substring(0,1)!=="."){const i=Fn(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(s,i))}}),n.updatePriority(Fn(e))}}wZ(Fn);/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class RZ extends Ew{constructor(e){super(),this.indexPath_=e,ue(!Je(e)&&We(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),r=this.extractChild(n.node),i=s.compareTo(r);return i===0?Qh(e.name,n.name):i}makePost(e,n){const s=Fn(e),r=Re.EMPTY_NODE.updateChild(this.indexPath_,s);return new Ge(n,r)}maxPost(){const e=Re.EMPTY_NODE.updateChild(this.indexPath_,Qg);return new Ge(Bc,e)}toString(){return MU(this.indexPath_,0).join("/")}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class AZ extends Ew{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Qh(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Ge.MIN}maxPost(){return Ge.MAX}makePost(e,n){const s=Fn(e);return new Ge(n,s)}toString(){return".value"}}const kZ=new AZ;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function zU(t){return{type:"value",snapshotNode:t}}function Ch(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Qp(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Yp(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function PZ(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class U0{constructor(e){this.index_=e}updateChild(e,n,s,r,i,o){ue(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(r).equals(s.getChild(r))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Qp(n,a)):ue(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ch(n,s)):o.trackChildChange(Yp(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(nn,(r,i)=>{n.hasChild(r)||s.trackChildChange(Qp(r,i))}),n.isLeafNode()||n.forEachChild(nn,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(Yp(r,i,o))}else s.trackChildChange(Ch(r,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Re.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Xp{constructor(e){this.indexedFilter_=new U0(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Xp.getStartPost_(e),this.endPost_=Xp.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,r,i,o){return this.matches(new Ge(n,s))||(s=Re.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,r,i,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=Re.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(Re.EMPTY_NODE);const i=this;return n.forEachChild(nn,(o,a)=>{i.matches(new Ge(o,a))||(r=r.updateImmediateChild(o,Re.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class NZ{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Xp(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,r,i,o){return this.rangedFilter_.matches(new Ge(n,s))||(s=Re.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,r,i,o):this.fullLimitUpdateChild_(e,n,s,i,o)}updateFullNode(e,n,s){let r;if(n.isLeafNode()||n.isEmpty())r=Re.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=Re.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(Re.EMPTY_NODE);let i;this.reverse_?i=r.getReverseIterator(this.index_):i=r.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,Re.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,r,i){let o;if(this.reverse_){const d=this.index_.getCompare();o=(p,m)=>d(m,p)}else o=this.index_.getCompare();const a=e;ue(a.numChildren()===this.limit_,"");const c=new Ge(n,s),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(a.hasChild(n)){const d=a.getImmediateChild(n);let p=r.getChildAfterChild(this.index_,u,this.reverse_);for(;p!=null&&(p.name===n||a.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);const m=p==null?1:o(p,c);if(h&&!s.isEmpty()&&m>=0)return i?.trackChildChange(Yp(n,s,d)),a.updateImmediateChild(n,s);{i?.trackChildChange(Qp(n,d));const w=a.updateImmediateChild(n,Re.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(i?.trackChildChange(Ch(p.name,p.node)),w.updateImmediateChild(p.name,p.node)):w}}else return s.isEmpty()?e:h&&o(u,c)>=0?(i!=null&&(i.trackChildChange(Qp(u.name,u.node)),i.trackChildChange(Ch(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(u.name,Re.EMPTY_NODE)):e}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class q0{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=nn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ue(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ue(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Th}hasEnd(){return this.endSet_}getIndexEndValue(){return ue(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ue(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Bc}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ue(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===nn}copy(){const e=new q0;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function xZ(t){return t.loadsAllData()?new U0(t.getIndex()):t.hasLimit()?new NZ(t):new Xp(t)}function gN(t){const e={};if(t.isDefault())return e;let n;if(t.index_===nn?n="$priority":t.index_===kZ?n="$value":t.index_===Ju?n="$key":(ue(t.index_ instanceof RZ,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=In(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=In(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+In(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=In(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+In(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function mN(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==nn&&(e.i=t.index_.toString()),e}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class wy extends DU{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(ue(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=Gg("p:rest:"),this.listens_={}}listen(e,n,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=wy.getListenId_(e,s),a={};this.listens_[o]=a;const c=gN(e._queryParams);this.restRequest_(i+".json",c,(u,h)=>{let d=h;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(i,d,!1,s),gh(this.listens_,o)===a){let p;u?u===401?p="permission_denied":p="rest_error:"+u:p="ok",r(p,null)}})}unlisten(e,n){const s=wy.getListenId_(e,n);delete this.listens_[s]}get(e){const n=gN(e._queryParams),s=e._path.toString(),r=new Wv;return this.restRequest_(s+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(n.auth=r.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+$h(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=Vp(a.responseText)}catch{zs("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,c)}else a.status!==401&&a.status!==404&&zs("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class DZ{constructor(){this.rootNode_=Re.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Ey(){return{value:null,children:new Map}}function HU(t,e,n){if(Je(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=We(e);t.children.has(s)||t.children.set(s,Ey());const r=t.children.get(s);e=Ot(e),HU(r,e,n)}}function MC(t,e,n){t.value!==null?n(e,t.value):OZ(t,(s,r)=>{const i=new Pt(e.toString()+"/"+s);MC(r,i,n)})}function OZ(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class LZ{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&Ws(this.last_,(s,r)=>{n[s]=n[s]-r}),this.last_=e,n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const _N=10*1e3,MZ=30*1e3,VZ=300*1e3;class FZ{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new LZ(e);const s=_N+(MZ-_N)*Math.random();np(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Ws(e,(r,i)=>{i>0&&ra(this.statsToReport_,r)&&(n[r]=i,s=!0)}),s&&this.server_.reportStats(n),np(this.reportStats_.bind(this),Math.floor(Math.random()*2*VZ))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var $r;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})($r||($r={}));function WU(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function B0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function j0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class by{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=$r.ACK_USER_WRITE,this.source=WU()}operationForChild(e){if(Je(this.path)){if(this.affectedTree.value!=null)return ue(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Pt(e));return new by(dt(),n,this.revert)}}else return ue(We(this.path)===e,"operationForChild called for unrelated child."),new by(Ot(this.path),this.affectedTree,this.revert)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Jp{constructor(e,n){this.source=e,this.path=n,this.type=$r.LISTEN_COMPLETE}operationForChild(e){return Je(this.path)?new Jp(this.source,dt()):new Jp(this.source,Ot(this.path))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $c{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=$r.OVERWRITE}operationForChild(e){return Je(this.path)?new $c(this.source,dt(),this.snap.getImmediateChild(e)):new $c(this.source,Ot(this.path),this.snap)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Zp{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=$r.MERGE}operationForChild(e){if(Je(this.path)){const n=this.children.subtree(new Pt(e));return n.isEmpty()?null:n.value?new $c(this.source,dt(),n.value):new Zp(this.source,dt(),n)}else return ue(We(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Zp(this.source,Ot(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class dl{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Je(e))return this.isFullyInitialized()&&!this.filtered_;const n=We(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class UZ{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function qZ(t,e,n,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(PZ(o.childName,o.snapshotNode))}),cf(t,r,"child_removed",e,s,n),cf(t,r,"child_added",e,s,n),cf(t,r,"child_moved",i,s,n),cf(t,r,"child_changed",e,s,n),cf(t,r,"value",e,s,n),r}function cf(t,e,n,s,r,i){const o=s.filter(a=>a.type===n);o.sort((a,c)=>jZ(t,a,c)),o.forEach(a=>{const c=BZ(t,a,i);r.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,t.query_))})})}function BZ(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function jZ(t,e,n){if(e.childName==null||n.childName==null)throw jh("Should only compare child_ events.");const s=new Ge(e.childName,e.snapshotNode),r=new Ge(n.childName,n.snapshotNode);return t.index_.compare(s,r)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function bw(t,e){return{eventCache:t,serverCache:e}}function sp(t,e,n,s){return bw(new dl(e,n,s),t.serverCache)}function KU(t,e,n,s){return bw(t.eventCache,new dl(e,n,s))}function Ty(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function zc(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let qb;const $Z=()=>(qb||(qb=new Si(AJ)),qb);class Ut{static fromObject(e){let n=new Ut(null);return Ws(e,(s,r)=>{n=n.set(new Pt(s),r)}),n}constructor(e,n=$Z()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:dt(),value:this.value};if(Je(e))return null;{const s=We(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(Ot(e),n);return i!=null?{path:Rn(new Pt(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Je(e))return this;{const n=We(e),s=this.children.get(n);return s!==null?s.subtree(Ot(e)):new Ut(null)}}set(e,n){if(Je(e))return new Ut(n,this.children);{const s=We(e),r=(this.children.get(s)||new Ut(null)).set(Ot(e),n),i=this.children.insert(s,r);return new Ut(this.value,i)}}remove(e){if(Je(e))return this.children.isEmpty()?new Ut(null):new Ut(null,this.children);{const n=We(e),s=this.children.get(n);if(s){const r=s.remove(Ot(e));let i;return r.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,r),this.value===null&&i.isEmpty()?new Ut(null):new Ut(this.value,i)}else return this}}get(e){if(Je(e))return this.value;{const n=We(e),s=this.children.get(n);return s?s.get(Ot(e)):null}}setTree(e,n){if(Je(e))return n;{const s=We(e),r=(this.children.get(s)||new Ut(null)).setTree(Ot(e),n);let i;return r.isEmpty()?i=this.children.remove(s):i=this.children.insert(s,r),new Ut(this.value,i)}}fold(e){return this.fold_(dt(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(Rn(e,r),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,dt(),n)}findOnPath_(e,n,s){const r=this.value?s(n,this.value):!1;if(r)return r;if(Je(e))return null;{const i=We(e),o=this.children.get(i);return o?o.findOnPath_(Ot(e),Rn(n,i),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,dt(),n)}foreachOnPath_(e,n,s){if(Je(e))return this;{this.value&&s(n,this.value);const r=We(e),i=this.children.get(r);return i?i.foreachOnPath_(Ot(e),Rn(n,r),s):new Ut(null)}}foreach(e){this.foreach_(dt(),e)}foreach_(e,n){this.children.inorderTraversal((s,r)=>{r.foreach_(Rn(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ei{constructor(e){this.writeTree_=e}static empty(){return new ei(new Ut(null))}}function rp(t,e,n){if(Je(e))return new ei(new Ut(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=Os(r,e);return i=i.updateChild(o,n),new ei(t.writeTree_.set(r,i))}else{const r=new Ut(n),i=t.writeTree_.setTree(e,r);return new ei(i)}}}function yN(t,e,n){let s=t;return Ws(n,(r,i)=>{s=rp(s,Rn(e,r),i)}),s}function vN(t,e){if(Je(e))return ei.empty();{const n=t.writeTree_.setTree(e,new Ut(null));return new ei(n)}}function VC(t,e){return ou(t,e)!=null}function ou(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Os(n.path,e)):null}function wN(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(nn,(s,r)=>{e.push(new Ge(s,r))}):t.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new Ge(s,r.value))}),e}function ja(t,e){if(Je(e))return t;{const n=ou(t,e);return n!=null?new ei(new Ut(n)):new ei(t.writeTree_.subtree(e))}}function FC(t){return t.writeTree_.isEmpty()}function Ih(t,e){return GU(dt(),t.writeTree_,e)}function GU(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(ue(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):n=GU(Rn(t,r),i,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Rn(t,".priority"),s)),n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Tw(t,e){return JU(e,t)}function zZ(t,e,n,s,r){ue(s>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:r}),r&&(t.visibleWrites=rp(t.visibleWrites,e,n)),t.lastWriteId=s}function HZ(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function WZ(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);ue(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let r=s.visible,i=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&KZ(a,s.path)?r=!1:jr(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return GZ(t),!0;if(s.snap)t.visibleWrites=vN(t.visibleWrites,s.path);else{const a=s.children;Ws(a,c=>{t.visibleWrites=vN(t.visibleWrites,Rn(s.path,c))})}return!0}else return!1}function KZ(t,e){if(t.snap)return jr(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&jr(Rn(t.path,n),e))return!0;return!1}function GZ(t){t.visibleWrites=QU(t.allWrites,QZ,dt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function QZ(t){return t.visible}function QU(t,e,n){let s=ei.empty();for(let r=0;r<t.length;++r){const i=t[r];if(e(i)){const o=i.path;let a;if(i.snap)jr(n,o)?(a=Os(n,o),s=rp(s,a,i.snap)):jr(o,n)&&(a=Os(o,n),s=rp(s,dt(),i.snap.getChild(a)));else if(i.children){if(jr(n,o))a=Os(n,o),s=yN(s,a,i.children);else if(jr(o,n))if(a=Os(o,n),Je(a))s=yN(s,dt(),i.children);else{const c=gh(i.children,We(a));if(c){const u=c.getChild(Ot(a));s=rp(s,dt(),u)}}}else throw jh("WriteRecord should have .snap or .children")}}return s}function YU(t,e,n,s,r){if(!s&&!r){const i=ou(t.visibleWrites,e);if(i!=null)return i;{const o=ja(t.visibleWrites,e);if(FC(o))return n;if(n==null&&!VC(o,dt()))return null;{const a=n||Re.EMPTY_NODE;return Ih(o,a)}}}else{const i=ja(t.visibleWrites,e);if(!r&&FC(i))return n;if(!r&&n==null&&!VC(i,dt()))return null;{const o=function(u){return(u.visible||r)&&(!s||!~s.indexOf(u.writeId))&&(jr(u.path,e)||jr(e,u.path))},a=QU(t.allWrites,o,e),c=n||Re.EMPTY_NODE;return Ih(a,c)}}}function YZ(t,e,n){let s=Re.EMPTY_NODE;const r=ou(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(nn,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(n){const i=ja(t.visibleWrites,e);return n.forEachChild(nn,(o,a)=>{const c=Ih(ja(i,new Pt(o)),a);s=s.updateImmediateChild(o,c)}),wN(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=ja(t.visibleWrites,e);return wN(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function XZ(t,e,n,s,r){ue(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=Rn(e,n);if(VC(t.visibleWrites,i))return null;{const o=ja(t.visibleWrites,i);return FC(o)?r.getChild(n):Ih(o,r.getChild(n))}}function JZ(t,e,n,s){const r=Rn(e,n),i=ou(t.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(n)){const o=ja(t.visibleWrites,r);return Ih(o,s.getNode().getImmediateChild(n))}else return null}function ZZ(t,e){return ou(t.visibleWrites,e)}function eee(t,e,n,s,r,i,o){let a;const c=ja(t.visibleWrites,e),u=ou(c,dt());if(u!=null)a=u;else if(n!=null)a=Ih(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],d=o.getCompare(),p=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let m=p.getNext();for(;m&&h.length<r;)d(m,s)!==0&&h.push(m),m=p.getNext();return h}else return[]}function tee(){return{visibleWrites:ei.empty(),allWrites:[],lastWriteId:-1}}function Cy(t,e,n,s){return YU(t.writeTree,t.treePath,e,n,s)}function $0(t,e){return YZ(t.writeTree,t.treePath,e)}function EN(t,e,n,s){return XZ(t.writeTree,t.treePath,e,n,s)}function Iy(t,e){return ZZ(t.writeTree,Rn(t.treePath,e))}function nee(t,e,n,s,r,i){return eee(t.writeTree,t.treePath,e,n,s,r,i)}function z0(t,e,n){return JZ(t.writeTree,t.treePath,e,n)}function XU(t,e){return JU(Rn(t.treePath,e),t.writeTree)}function JU(t,e){return{treePath:t,writeTree:e}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class see{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;ue(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),ue(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(s,Yp(s,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(s,Qp(s,r.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(s,Ch(s,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(s,Yp(s,e.snapshotNode,r.oldSnap));else throw jh("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ree{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const ZU=new ree;class H0{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new dl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return z0(this.writes_,e,s)}}getChildAfterChild(e,n,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:zc(this.viewCache_),i=nee(this.writes_,r,n,1,s,e);return i.length===0?null:i[0]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function iee(t){return{filter:t}}function oee(t,e){ue(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),ue(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function aee(t,e,n,s,r){const i=new see;let o,a;if(n.type===$r.OVERWRITE){const u=n;u.source.fromUser?o=UC(t,e,u.path,u.snap,s,r,i):(ue(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Je(u.path),o=Sy(t,e,u.path,u.snap,s,r,a,i))}else if(n.type===$r.MERGE){const u=n;u.source.fromUser?o=cee(t,e,u.path,u.children,s,r,i):(ue(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=qC(t,e,u.path,u.children,s,r,a,i))}else if(n.type===$r.ACK_USER_WRITE){const u=n;u.revert?o=dee(t,e,u.path,s,r,i):o=uee(t,e,u.path,u.affectedTree,s,r,i)}else if(n.type===$r.LISTEN_COMPLETE)o=hee(t,e,n.path,s,i);else throw jh("Unknown operation type: "+n.type);const c=i.getChanges();return lee(e,o,c),{viewCache:o,changes:c}}function lee(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=Ty(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&n.push(zU(Ty(e)))}}function e4(t,e,n,s,r,i){const o=e.eventCache;if(Iy(s,n)!=null)return e;{let a,c;if(Je(n))if(ue(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=zc(e),h=u instanceof Re?u:Re.EMPTY_NODE,d=$0(s,h);a=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const u=Cy(s,zc(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const u=We(n);if(u===".priority"){ue(hl(n)===1,"Can't have a priority with additional path components");const h=o.getNode();c=e.serverCache.getNode();const d=EN(s,n,h,c);d!=null?a=t.filter.updatePriority(h,d):a=o.getNode()}else{const h=Ot(n);let d;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();const p=EN(s,n,o.getNode(),c);p!=null?d=o.getNode().getImmediateChild(u).updateChild(h,p):d=o.getNode().getImmediateChild(u)}else d=z0(s,u,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),u,d,h,r,i):a=o.getNode()}}return sp(e,a,o.isFullyInitialized()||Je(n),t.filter.filtersNodes())}}function Sy(t,e,n,s,r,i,o,a){const c=e.serverCache;let u;const h=o?t.filter:t.filter.getIndexedFilter();if(Je(n))u=h.updateFullNode(c.getNode(),s,null);else if(h.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(n,s);u=h.updateFullNode(c.getNode(),m,null)}else{const m=We(n);if(!c.isCompleteForPath(n)&&hl(n)>1)return e;const w=Ot(n),R=c.getNode().getImmediateChild(m).updateChild(w,s);m===".priority"?u=h.updatePriority(c.getNode(),R):u=h.updateChild(c.getNode(),m,R,w,ZU,null)}const d=KU(e,u,c.isFullyInitialized()||Je(n),h.filtersNodes()),p=new H0(r,d,i);return e4(t,d,n,r,p,a)}function UC(t,e,n,s,r,i,o){const a=e.eventCache;let c,u;const h=new H0(r,e,i);if(Je(n))u=t.filter.updateFullNode(e.eventCache.getNode(),s,o),c=sp(e,u,!0,t.filter.filtersNodes());else{const d=We(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),s),c=sp(e,u,a.isFullyInitialized(),a.isFiltered());else{const p=Ot(n),m=a.getNode().getImmediateChild(d);let w;if(Je(p))w=s;else{const R=h.getCompleteChild(d);R!=null?LU(p)===".priority"&&R.getChild(VU(p)).isEmpty()?w=R:w=R.updateChild(p,s):w=Re.EMPTY_NODE}if(m.equals(w))c=e;else{const R=t.filter.updateChild(a.getNode(),d,w,p,h,o);c=sp(e,R,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function bN(t,e){return t.eventCache.isCompleteForChild(e)}function cee(t,e,n,s,r,i,o){let a=e;return s.foreach((c,u)=>{const h=Rn(n,c);bN(e,We(h))&&(a=UC(t,a,h,u,r,i,o))}),s.foreach((c,u)=>{const h=Rn(n,c);bN(e,We(h))||(a=UC(t,a,h,u,r,i,o))}),a}function TN(t,e,n){return n.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function qC(t,e,n,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;Je(n)?u=s:u=new Ut(null).setTree(n,s);const h=e.serverCache.getNode();return u.children.inorderTraversal((d,p)=>{if(h.hasChild(d)){const m=e.serverCache.getNode().getImmediateChild(d),w=TN(t,m,p);c=Sy(t,c,new Pt(d),w,r,i,o,a)}}),u.children.inorderTraversal((d,p)=>{const m=!e.serverCache.isCompleteForChild(d)&&p.value===null;if(!h.hasChild(d)&&!m){const w=e.serverCache.getNode().getImmediateChild(d),R=TN(t,w,p);c=Sy(t,c,new Pt(d),R,r,i,o,a)}}),c}function uee(t,e,n,s,r,i,o){if(Iy(r,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(Je(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Sy(t,e,n,c.getNode().getChild(n),r,i,a,o);if(Je(n)){let u=new Ut(null);return c.getNode().forEachChild(Ju,(h,d)=>{u=u.set(new Pt(h),d)}),qC(t,e,n,u,r,i,a,o)}else return e}else{let u=new Ut(null);return s.foreach((h,d)=>{const p=Rn(n,h);c.isCompleteForPath(p)&&(u=u.set(h,c.getNode().getChild(p)))}),qC(t,e,n,u,r,i,a,o)}}function hee(t,e,n,s,r){const i=e.serverCache,o=KU(e,i.getNode(),i.isFullyInitialized()||Je(n),i.isFiltered());return e4(t,o,n,s,ZU,r)}function dee(t,e,n,s,r,i){let o;if(Iy(s,n)!=null)return e;{const a=new H0(s,e,r),c=e.eventCache.getNode();let u;if(Je(n)||We(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=Cy(s,zc(e));else{const d=e.serverCache.getNode();ue(d instanceof Re,"serverChildren would be complete if leaf node"),h=$0(s,d)}h=h,u=t.filter.updateFullNode(c,h,i)}else{const h=We(n);let d=z0(s,h,e.serverCache);d==null&&e.serverCache.isCompleteForChild(h)&&(d=c.getImmediateChild(h)),d!=null?u=t.filter.updateChild(c,h,d,Ot(n),a,i):e.eventCache.getNode().hasChild(h)?u=t.filter.updateChild(c,h,Re.EMPTY_NODE,Ot(n),a,i):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Cy(s,zc(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,i)))}return o=e.serverCache.isFullyInitialized()||Iy(s,dt())!=null,sp(e,u,o,t.filter.filtersNodes())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class fee{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new U0(s.getIndex()),i=xZ(s);this.processor_=iee(i);const o=n.serverCache,a=n.eventCache,c=r.updateFullNode(Re.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Re.EMPTY_NODE,a.getNode(),null),h=new dl(c,o.isFullyInitialized(),r.filtersNodes()),d=new dl(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=bw(d,h),this.eventGenerator_=new UZ(this.query_)}get query(){return this.query_}}function pee(t){return t.viewCache_.serverCache.getNode()}function gee(t){return Ty(t.viewCache_)}function mee(t,e){const n=zc(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Je(e)&&!n.getImmediateChild(We(e)).isEmpty())?n.getChild(e):null}function CN(t){return t.eventRegistrations_.length===0}function _ee(t,e){t.eventRegistrations_.push(e)}function IN(t,e,n){const s=[];if(n){ue(e==null,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return s}function SN(t,e,n,s){e.type===$r.MERGE&&e.source.queryId!==null&&(ue(zc(t.viewCache_),"We should always have a full cache before handling merges"),ue(Ty(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,i=aee(t.processor_,r,e,n,s);return oee(t.processor_,i.viewCache),ue(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,t4(t,i.changes,i.viewCache.eventCache.getNode(),null)}function yee(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(nn,(r,i)=>{s.push(Ch(r,i))}),n.isFullyInitialized()&&s.push(zU(n.getNode())),t4(t,s,n.getNode(),e)}function t4(t,e,n,s){const r=s?[s]:t.eventRegistrations_;return qZ(t.eventGenerator_,e,n,r)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Ry;class n4{constructor(){this.views=new Map}}function vee(t){ue(!Ry,"__referenceConstructor has already been defined"),Ry=t}function wee(){return ue(Ry,"Reference.ts has not been loaded"),Ry}function Eee(t){return t.views.size===0}function W0(t,e,n,s){const r=e.source.queryId;if(r!==null){const i=t.views.get(r);return ue(i!=null,"SyncTree gave us an op for an invalid query."),SN(i,e,n,s)}else{let i=[];for(const o of t.views.values())i=i.concat(SN(o,e,n,s));return i}}function s4(t,e,n,s,r){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=Cy(n,r?s:null),c=!1;a?c=!0:s instanceof Re?(a=$0(n,s),c=!1):(a=Re.EMPTY_NODE,c=!1);const u=bw(new dl(a,c,!1),new dl(s,r,!1));return new fee(e,u)}return o}function bee(t,e,n,s,r,i){const o=s4(t,e,s,r,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),_ee(o,n),yee(o,n)}function Tee(t,e,n,s){const r=e._queryIdentifier,i=[];let o=[];const a=fl(t);if(r==="default")for(const[c,u]of t.views.entries())o=o.concat(IN(u,n,s)),CN(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||i.push(u.query));else{const c=t.views.get(r);c&&(o=o.concat(IN(c,n,s)),CN(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!fl(t)&&i.push(new(wee())(e._repo,e._path)),{removed:i,events:o}}function r4(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function $a(t,e){let n=null;for(const s of t.views.values())n=n||mee(s,e);return n}function i4(t,e){if(e._queryParams.loadsAllData())return Cw(t);{const n=e._queryIdentifier;return t.views.get(n)}}function o4(t,e){return i4(t,e)!=null}function fl(t){return Cw(t)!=null}function Cw(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Ay;function Cee(t){ue(!Ay,"__referenceConstructor has already been defined"),Ay=t}function Iee(){return ue(Ay,"Reference.ts has not been loaded"),Ay}let See=1;class RN{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ut(null),this.pendingWriteTree_=tee(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function a4(t,e,n,s,r){return zZ(t.pendingWriteTree_,e,n,s,r),r?Xg(t,new $c(WU(),e,n)):[]}function _c(t,e,n=!1){const s=HZ(t.pendingWriteTree_,e);if(WZ(t.pendingWriteTree_,e)){let r=new Ut(null);return s.snap!=null?r=r.set(dt(),!0):Ws(s.children,i=>{r=r.set(new Pt(i),!0)}),Xg(t,new by(s.path,r,n))}else return[]}function Yg(t,e,n){return Xg(t,new $c(B0(),e,n))}function Ree(t,e,n){const s=Ut.fromObject(n);return Xg(t,new Zp(B0(),e,s))}function Aee(t,e){return Xg(t,new Jp(B0(),e))}function kee(t,e,n){const s=G0(t,n);if(s){const r=Q0(s),i=r.path,o=r.queryId,a=Os(i,e),c=new Jp(j0(o),a);return Y0(t,i,c)}else return[]}function ky(t,e,n,s,r=!1){const i=e._path,o=t.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||o4(o,e))){const c=Tee(o,e,n,s);Eee(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const u=c.removed;if(a=c.events,!r){const h=u.findIndex(p=>p._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(i,(p,m)=>fl(m));if(h&&!d){const p=t.syncPointTree_.subtree(i);if(!p.isEmpty()){const m=xee(p);for(let w=0;w<m.length;++w){const R=m[w],k=R.query,O=h4(t,R);t.listenProvider_.startListening(ip(k),eg(t,k),O.hashFn,O.onComplete)}}}!d&&u.length>0&&!s&&(h?t.listenProvider_.stopListening(ip(e),null):u.forEach(p=>{const m=t.queryToTagMap.get(Iw(p));t.listenProvider_.stopListening(ip(p),m)}))}Dee(t,u)}return a}function l4(t,e,n,s){const r=G0(t,s);if(r!=null){const i=Q0(r),o=i.path,a=i.queryId,c=Os(o,e),u=new $c(j0(a),c,n);return Y0(t,o,u)}else return[]}function Pee(t,e,n,s){const r=G0(t,s);if(r){const i=Q0(r),o=i.path,a=i.queryId,c=Os(o,e),u=Ut.fromObject(n),h=new Zp(j0(a),c,u);return Y0(t,o,h)}else return[]}function BC(t,e,n,s=!1){const r=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(r,(p,m)=>{const w=Os(p,r);i=i||$a(m,w),o=o||fl(m)});let a=t.syncPointTree_.get(r);a?(o=o||fl(a),i=i||$a(a,dt())):(a=new n4,t.syncPointTree_=t.syncPointTree_.set(r,a));let c;i!=null?c=!0:(c=!1,i=Re.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((p,m)=>{const w=$a(m,dt());w&&(i=i.updateImmediateChild(p,w))}));const u=o4(a,e);if(!u&&!e._queryParams.loadsAllData()){const p=Iw(e);ue(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");const m=Oee();t.queryToTagMap.set(p,m),t.tagToQueryMap.set(m,p)}const h=Tw(t.pendingWriteTree_,r);let d=bee(a,e,n,h,i,c);if(!u&&!o&&!s){const p=i4(a,e);d=d.concat(Lee(t,e,p))}return d}function K0(t,e,n){const s=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(i,o)=>{const a=Os(i,e),c=$a(o,a);if(c)return c});return YU(s,e,r,n,!0)}function Nee(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(u,h)=>{const d=Os(u,n);s=s||$a(h,d)});let r=t.syncPointTree_.get(n);r?s=s||$a(r,dt()):(r=new n4,t.syncPointTree_=t.syncPointTree_.set(n,r));const i=s!=null,o=i?new dl(s,!0,!1):null,a=Tw(t.pendingWriteTree_,e._path),c=s4(r,e,a,i?o.getNode():Re.EMPTY_NODE,i);return gee(c)}function Xg(t,e){return c4(e,t.syncPointTree_,null,Tw(t.pendingWriteTree_,dt()))}function c4(t,e,n,s){if(Je(t.path))return u4(t,e,n,s);{const r=e.get(dt());n==null&&r!=null&&(n=$a(r,dt()));let i=[];const o=We(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const u=n?n.getImmediateChild(o):null,h=XU(s,o);i=i.concat(c4(a,c,u,h))}return r&&(i=i.concat(W0(r,t,s,n))),i}}function u4(t,e,n,s){const r=e.get(dt());n==null&&r!=null&&(n=$a(r,dt()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,u=XU(s,o),h=t.operationForChild(o);h&&(i=i.concat(u4(h,a,c,u)))}),r&&(i=i.concat(W0(r,t,s,n))),i}function h4(t,e){const n=e.query,s=eg(t,n);return{hashFn:()=>(pee(e)||Re.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?kee(t,n._path,s):Aee(t,n._path);{const i=NJ(r,n);return ky(t,n,null,i)}}}}function eg(t,e){const n=Iw(e);return t.queryToTagMap.get(n)}function Iw(t){return t._path.toString()+"$"+t._queryIdentifier}function G0(t,e){return t.tagToQueryMap.get(e)}function Q0(t){const e=t.indexOf("$");return ue(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Pt(t.substr(0,e))}}function Y0(t,e,n){const s=t.syncPointTree_.get(e);ue(s,"Missing sync point for query tag that we're tracking");const r=Tw(t.pendingWriteTree_,e);return W0(s,n,r,null)}function xee(t){return t.fold((e,n,s)=>{if(n&&fl(n))return[Cw(n)];{let r=[];return n&&(r=r4(n)),Ws(s,(i,o)=>{r=r.concat(o)}),r}})}function ip(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Iee())(t._repo,t._path):t}function Dee(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const r=Iw(s),i=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(i)}}}function Oee(){return See++}function Lee(t,e,n){const s=e._path,r=eg(t,e),i=h4(t,n),o=t.listenProvider_.startListening(ip(e),r,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(s);if(r)ue(!fl(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((u,h,d)=>{if(!Je(u)&&h&&fl(h))return[Cw(h).query];{let p=[];return h&&(p=p.concat(r4(h).map(m=>m.query))),Ws(d,(m,w)=>{p=p.concat(w)}),p}});for(let u=0;u<c.length;++u){const h=c[u];t.listenProvider_.stopListening(ip(h),eg(t,h))}}return o}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class X0{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new X0(n)}node(){return this.node_}}class J0{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Rn(this.path_,e);return new J0(this.syncTree_,n)}node(){return K0(this.syncTree_,this.path_)}}const Mee=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},AN=function(t,e,n){if(!t||typeof t!="object")return t;if(ue(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Vee(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Fee(t[".sv"],e);ue(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Vee=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:ue(!1,"Unexpected server value: "+t)}},Fee=function(t,e,n){t.hasOwnProperty("increment")||ue(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&ue(!1,"Unexpected increment value: "+s);const r=e.node();if(ue(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const i=r.getValue();return typeof i!="number"?s:i+s},Uee=function(t,e,n,s){return Z0(e,new J0(n,t),s)},d4=function(t,e,n){return Z0(t,new X0(e),n)};function Z0(t,e,n){const s=t.getPriority().val(),r=AN(s,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=AN(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new jc(a,Fn(r)):t}else{const o=t;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new jc(r))),o.forEachChild(nn,(a,c)=>{const u=Z0(c,e.getImmediateChild(a),n);u!==c&&(i=i.updateImmediateChild(a,u))}),i}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class eR{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function tR(t,e){let n=e instanceof Pt?e:new Pt(e),s=t,r=We(n);for(;r!==null;){const i=gh(s.node.children,r)||{children:{},childCount:0};s=new eR(r,s,i),n=Ot(n),r=We(n)}return s}function Xh(t){return t.node.value}function f4(t,e){t.node.value=e,jC(t)}function p4(t){return t.node.childCount>0}function qee(t){return Xh(t)===void 0&&!p4(t)}function Sw(t,e){Ws(t.node.children,(n,s)=>{e(new eR(n,t,s))})}function g4(t,e,n,s){n&&e(t),Sw(t,r=>{g4(r,e,!0)})}function Bee(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Jg(t){return new Pt(t.parent===null?t.name:Jg(t.parent)+"/"+t.name)}function jC(t){t.parent!==null&&jee(t.parent,t.name,t)}function jee(t,e,n){const s=qee(n),r=ra(t.node.children,e);s&&r?(delete t.node.children[e],t.node.childCount--,jC(t)):!s&&!r&&(t.node.children[e]=n.node,t.node.childCount++,jC(t))}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const $ee=/[\[\].#$\/\u0000-\u001F\u007F]/,zee=/[\[\].#$\u0000-\u001F\u007F]/,Bb=10*1024*1024,m4=function(t){return typeof t=="string"&&t.length!==0&&!$ee.test(t)},_4=function(t){return typeof t=="string"&&t.length!==0&&!zee.test(t)},Hee=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),_4(t)},Wee=function(t,e,n,s){nR(xS(t,"value"),e,n)},nR=function(t,e,n){const s=n instanceof Pt?new uZ(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+lc(s));if(typeof e=="function")throw new Error(t+"contains a function "+lc(s)+" with contents = "+e.toString());if(pU(e))throw new Error(t+"contains "+e.toString()+" "+lc(s));if(typeof e=="string"&&e.length>Bb/3&&Qv(e)>Bb)throw new Error(t+"contains a string greater than "+Bb+" utf8 bytes "+lc(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(Ws(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!m4(o)))throw new Error(t+" contains an invalid key ("+o+") "+lc(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);hZ(s,o),nR(t,a,s),dZ(s)}),r&&i)throw new Error(t+' contains ".value" child '+lc(s)+" in addition to actual children.")}},y4=function(t,e,n,s){if(!_4(n))throw new Error(xS(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Kee=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),y4(t,e,n)},v4=function(t,e){if(We(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Gee=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!m4(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Hee(n))throw new Error(xS(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Qee{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function sR(t,e){let n=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();n!==null&&!M0(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(r)}n&&t.eventLists_.push(n)}function w4(t,e,n){sR(t,n),E4(t,s=>M0(s,e))}function $i(t,e,n){sR(t,n),E4(t,s=>jr(s,e)||jr(e,s))}function E4(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const r=t.eventLists_[s];if(r){const i=r.path;e(i)?(Yee(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Yee(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();tp&&cs("event: "+n.toString()),Yh(s)}}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Xee="repo_interrupt",Jee=25;class Zee{constructor(e,n,s,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Qee,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ey(),this.transactionQueueTree_=new eR,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function ete(t,e,n){if(t.stats_=O0(t.repoInfo_),t.forceRestClient_||LJ())t.server_=new wy(t.repoInfo_,(s,r,i,o)=>{kN(t,s,r,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>PN(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{In(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new Fo(t.repoInfo_,e,(s,r,i,o)=>{kN(t,s,r,i,o)},s=>{PN(t,s)},s=>{nte(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=qJ(t.repoInfo_,()=>new FZ(t.stats_,t.server_)),t.infoData_=new DZ,t.infoSyncTree_=new RN({startListening:(s,r,i,o)=>{let a=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(a=Yg(t.infoSyncTree_,s._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),iR(t,"connected",!1),t.serverSyncTree_=new RN({startListening:(s,r,i,o)=>(t.server_.listen(s,i,r,(a,c)=>{const u=o(a,c);$i(t.eventQueue_,s._path,u)}),[]),stopListening:(s,r)=>{t.server_.unlisten(s,r)}})}function tte(t){const e=t.infoData_.getNode(new Pt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e}function rR(t){return Mee({timestamp:tte(t)})}function kN(t,e,n,s,r){t.dataUpdateCount++;const i=new Pt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(s){const c=J_(n,u=>Fn(u));o=Pee(t.serverSyncTree_,i,c,r)}else{const c=Fn(n);o=l4(t.serverSyncTree_,i,c,r)}else if(s){const c=J_(n,u=>Fn(u));o=Ree(t.serverSyncTree_,i,c)}else{const c=Fn(n);o=Yg(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=Aw(t,i)),$i(t.eventQueue_,a,o)}function PN(t,e){iR(t,"connected",e),e===!1&&ite(t)}function nte(t,e){Ws(e,(n,s)=>{iR(t,n,s)})}function iR(t,e,n){const s=new Pt("/.info/"+e),r=Fn(n);t.infoData_.updateSnapshot(s,r);const i=Yg(t.infoSyncTree_,s,r);$i(t.eventQueue_,s,i)}function b4(t){return t.nextWriteId_++}function ste(t,e,n){const s=Nee(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(r=>{const i=Fn(r).withIndex(e._queryParams.getIndex());BC(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Yg(t.serverSyncTree_,e._path,i);else{const a=eg(t.serverSyncTree_,e);o=l4(t.serverSyncTree_,e._path,i,a)}return $i(t.eventQueue_,e._path,o),ky(t.serverSyncTree_,e,n,null,!0),i},r=>(Rw(t,"get for query "+In(e)+" failed: "+r),Promise.reject(new Error(r))))}function rte(t,e,n,s,r){Rw(t,"set",{path:e.toString(),value:n,priority:s});const i=rR(t),o=Fn(n,s),a=K0(t.serverSyncTree_,e),c=d4(o,a,i),u=b4(t),h=a4(t.serverSyncTree_,e,c,u,!0);sR(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(p,m)=>{const w=p==="ok";w||zs("set at "+e+" failed: "+p);const R=_c(t.serverSyncTree_,u,!w);$i(t.eventQueue_,e,R),cte(t,r,p,m)});const d=R4(t,e);Aw(t,d),$i(t.eventQueue_,d,[])}function ite(t){Rw(t,"onDisconnectEvents");const e=rR(t),n=Ey();MC(t.onDisconnect_,dt(),(r,i)=>{const o=Uee(r,i,t.serverSyncTree_,e);HU(n,r,o)});let s=[];MC(n,dt(),(r,i)=>{s=s.concat(Yg(t.serverSyncTree_,r,i));const o=R4(t,r);Aw(t,o)}),t.onDisconnect_=Ey(),$i(t.eventQueue_,dt(),s)}function ote(t,e,n){let s;We(e._path)===".info"?s=BC(t.infoSyncTree_,e,n):s=BC(t.serverSyncTree_,e,n),w4(t.eventQueue_,e._path,s)}function ate(t,e,n){let s;We(e._path)===".info"?s=ky(t.infoSyncTree_,e,n):s=ky(t.serverSyncTree_,e,n),w4(t.eventQueue_,e._path,s)}function lte(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Xee)}function Rw(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),cs(n,...e)}function cte(t,e,n,s){e&&Yh(()=>{if(n==="ok")e(null);else{const r=(n||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function T4(t,e,n){return K0(t.serverSyncTree_,e,n)||Re.EMPTY_NODE}function oR(t,e=t.transactionQueueTree_){if(e||kw(t,e),Xh(e)){const n=I4(t,e);ue(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&ute(t,Jg(e),n)}else p4(e)&&Sw(e,n=>{oR(t,n)})}function ute(t,e,n){const s=n.map(u=>u.currentWriteId),r=T4(t,e,s);let i=r;const o=r.hash();for(let u=0;u<n.length;u++){const h=n[u];ue(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const d=Os(e,h.path);i=i.updateChild(d,h.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,u=>{Rw(t,"transaction put response",{path:c.toString(),status:u});let h=[];if(u==="ok"){const d=[];for(let p=0;p<n.length;p++)n[p].status=2,h=h.concat(_c(t.serverSyncTree_,n[p].currentWriteId)),n[p].onComplete&&d.push(()=>n[p].onComplete(null,!0,n[p].currentOutputSnapshotResolved)),n[p].unwatcher();kw(t,tR(t.transactionQueueTree_,e)),oR(t,t.transactionQueueTree_),$i(t.eventQueue_,e,h);for(let p=0;p<d.length;p++)Yh(d[p])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{zs("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}Aw(t,e)}},o)}function Aw(t,e){const n=C4(t,e),s=Jg(n),r=I4(t,n);return hte(t,r,s),s}function hte(t,e,n){if(e.length===0)return;const s=[];let r=[];const i=e.filter(o=>o.status===0).map(o=>o.currentWriteId);for(let o=0;o<e.length;o++){const a=e[o],c=Os(n,a.path);let u=!1,h;if(ue(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)u=!0,h=a.abortReason,r=r.concat(_c(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=Jee)u=!0,h="maxretry",r=r.concat(_c(t.serverSyncTree_,a.currentWriteId,!0));else{const d=T4(t,a.path,i);a.currentInputSnapshot=d;const p=e[o].update(d.val());if(p!==void 0){nR("transaction failed: Data returned ",p,a.path);let m=Fn(p);typeof p=="object"&&p!=null&&ra(p,".priority")||(m=m.updatePriority(d.getPriority()));const w=a.currentWriteId,R=rR(t),k=d4(m,d,R);a.currentOutputSnapshotRaw=m,a.currentOutputSnapshotResolved=k,a.currentWriteId=b4(t),i.splice(i.indexOf(w),1),r=r.concat(a4(t.serverSyncTree_,a.path,k,a.currentWriteId,a.applyLocally)),r=r.concat(_c(t.serverSyncTree_,w,!0))}else u=!0,h="nodata",r=r.concat(_c(t.serverSyncTree_,a.currentWriteId,!0))}$i(t.eventQueue_,n,r),r=[],u&&(e[o].status=2,function(d){setTimeout(d,Math.floor(0))}(e[o].unwatcher),e[o].onComplete&&(h==="nodata"?s.push(()=>e[o].onComplete(null,!1,e[o].currentInputSnapshot)):s.push(()=>e[o].onComplete(new Error(h),!1,null))))}kw(t,t.transactionQueueTree_);for(let o=0;o<s.length;o++)Yh(s[o]);oR(t,t.transactionQueueTree_)}function C4(t,e){let n,s=t.transactionQueueTree_;for(n=We(e);n!==null&&Xh(s)===void 0;)s=tR(s,n),e=Ot(e),n=We(e);return s}function I4(t,e){const n=[];return S4(t,e,n),n.sort((s,r)=>s.order-r.order),n}function S4(t,e,n){const s=Xh(e);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);Sw(e,r=>{S4(t,r,n)})}function kw(t,e){const n=Xh(e);if(n){let s=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[s]=n[r],s++);n.length=s,f4(e,n.length>0?n:void 0)}Sw(e,s=>{kw(t,s)})}function R4(t,e){const n=Jg(C4(t,e)),s=tR(t.transactionQueueTree_,e);return Bee(s,r=>{jb(t,r)}),jb(t,s),g4(s,r=>{jb(t,r)}),n}function jb(t,e){const n=Xh(e);if(n){const s=[];let r=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(ue(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(ue(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(_c(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?f4(e,void 0):n.length=i+1,$i(t.eventQueue_,Jg(e),r);for(let o=0;o<s.length;o++)Yh(s[o])}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function dte(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let r=n[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function fte(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):zs(`Invalid query segment '${n}' in query '${t}'`)}return e}const NN=function(t,e){const n=pte(t),s=n.namespace;n.domain==="firebase.com"&&Go(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Go("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||SJ();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new SU(n.host,n.secure,s,r,e,"",s!==n.subdomain),path:new Pt(n.pathString)}},pte=function(t){let e="",n="",s="",r="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let h=t.indexOf("/");h===-1&&(h=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(h,d)),h<d&&(r=dte(t.substring(h,d)));const p=fte(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const w=e.indexOf(".");s=e.substring(0,w).toLowerCase(),n=e.substring(w+1),i=s}"ns"in p&&(i=p.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gte{constructor(e,n,s,r){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+In(this.snapshot.exportVal())}}class mte{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class A4{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return ue(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class aR{constructor(e,n,s,r){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=r}get key(){return Je(this._path)?null:LU(this._path)}get ref(){return new ia(this._repo,this._path)}get _queryIdentifier(){const e=mN(this._queryParams),n=x0(e);return n==="{}"?"default":n}get _queryObject(){return mN(this._queryParams)}isEqual(e){if(e=It(e),!(e instanceof aR))return!1;const n=this._repo===e._repo,s=M0(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+cZ(this._path)}}class ia extends aR{constructor(e,n){super(e,n,new q0,!1)}get parent(){const e=VU(this._path);return e===null?null:new ia(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class tg{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Pt(e),s=$C(this.ref,e);return new tg(this._node.getChild(n),s,nn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,s)=>e(new tg(s,$C(this.ref,n),nn)))}hasChild(e){const n=new Pt(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function _te(t,e){return t=It(t),t._checkNotDeleted("ref"),e!==void 0?$C(t._root,e):t._root}function $C(t,e){return t=It(t),We(t._path)===null?Kee("child","path",e):y4("child","path",e),new ia(t._repo,Rn(t._path,e))}function yte(t){return v4("remove",t._path),k4(t,null)}function k4(t,e){t=It(t),v4("set",t._path),Wee("set",e,t._path);const n=new Wv;return rte(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function vte(t){t=It(t);const e=new A4(()=>{}),n=new Pw(e);return ste(t._repo,t,n).then(s=>new tg(s,new ia(t._repo,t._path),t._queryParams.getIndex()))}class Pw{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new gte("value",this,new tg(e.snapshotNode,new ia(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new mte(this,e,n):null}matches(e){return e instanceof Pw?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function wte(t,e,n,s,r){const i=new A4(n,void 0),o=new Pw(i);return ote(t._repo,t,o),()=>ate(t._repo,t,o)}function Ete(t,e,n,s){return wte(t,"value",e)}vee(ia);Cee(ia);/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const bte="FIREBASE_DATABASE_EMULATOR_HOST",zC={};let Tte=!1;function Cte(t,e,n,s){const r=e.lastIndexOf(":"),i=e.substring(0,r),o=Gi(i);t.repoInfo_=new SU(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function Ite(t,e,n,s,r){let i=s||t.options.databaseURL;i===void 0&&(t.options.projectId||Go("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),cs("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=NN(i,r),a=o.repoInfo,c;typeof process<"u"&&J1&&(c=J1[bte]),c?(i=`http://${c}?ns=${a.namespace}`,o=NN(i,r),a=o.repoInfo):o.repoInfo.secure;const u=new VJ(t.name,t.options,e);Gee("Invalid Firebase Database URL",o),Je(o.path)||Go("Database URL must point to the root of a Firebase Database (not including a child path).");const h=Rte(a,t,u,new MJ(t,n));return new Ate(h,t)}function Ste(t,e){const n=zC[e];(!n||n[t.key]!==t)&&Go(`Database ${e}(${t.repoInfo_}) has already been deleted.`),lte(t),delete n[t.key]}function Rte(t,e,n,s){let r=zC[e.name];r||(r={},zC[e.name]=r);let i=r[t.toURLString()];return i&&Go("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Zee(t,Tte,n,s),r[t.toURLString()]=i,i}class Ate{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(ete(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ia(this._repo,dt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Ste(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Go("Cannot call "+e+" on a deleted database.")}}function P4(t=Xv(),e){const n=Vg(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=kS("database");s&&kte(n,...s)}return n}function kte(t,e,n,s={}){t=It(t),t._checkNotDeleted("useEmulator");const r=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(r===t._repoInternal.repoInfo_.host&&nl(s,i.repoInfo_.emulatorOptions))return;Go("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&Go('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new p_(p_.OWNER);else if(s.mockUserToken){const a=typeof s.mockUserToken=="string"?s.mockUserToken:PS(s.mockUserToken,t.app.options.projectId);o=new p_(a)}Gi(e)&&(Kv(e),Gv("Database",!0)),Cte(i,r,s,o)}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Pte(t){wJ(Pl),sl(new $o("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return Ite(s,r,i,n)},"PUBLIC").setMultipleInstances(!0)),gr(Z1,eN,t),gr(Z1,eN,"esm2020")}Fo.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Fo.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Pte();var ec={};const Tn={apiKey:ec.FIREBASE_API_KEY||"AIzaSyC2RcDl7MRYRKMkX2szBsF67a9jHub0VV4",authDomain:ec.FIREBASE_AUTH_DOMAIN||"slide-view-91a09.firebaseapp.com",projectId:ec.FIREBASE_PROJECT_ID||"slide-view-91a09",storageBucket:ec.FIREBASE_STORAGE_BUCKET||"slide-view-91a09.appspot.com",messagingSenderId:ec.FIREBASE_MESSAGING_SENDER_ID||"951171862827",appId:ec.FIREBASE_APP_ID||"1:951171862827:web:14701b2a5f1cba5b96756e",databaseURL:ec.FIREBASE_DATABASE_URL||"https://slide-view-91a09-default-rtdb.asia-southeast1.firebasedatabase.app/"};console.log("🔐 Firebase 설정 확인:",{apiKey:Tn.apiKey?"설정됨":"설정 안됨",authDomain:Tn.authDomain?"설정됨":"설정 안됨",projectId:Tn.projectId?"설정됨":"설정 안됨",storageBucket:Tn.storageBucket?"설정됨":"설정 안됨",messagingSenderId:Tn.messagingSenderId?"설정됨":"설정 안됨",appId:Tn.appId?"설정됨":"설정 안됨",databaseURL:Tn.databaseURL?"설정됨":"없음"});console.log("🔐 Firebase 설정 값 확인:",{apiKey:Tn.apiKey?`${Tn.apiKey.substring(0,10)}...`:"없음",authDomain:Tn.authDomain,projectId:Tn.projectId,databaseURL:Tn.databaseURL?"설정됨":"없음"});(!Tn.apiKey||!Tn.authDomain||!Tn.projectId)&&console.warn("⚠️ Firebase 설정이 완전하지 않습니다. 환경 변수를 확인해주세요.");let Qt,Zt,yc,Py,Ny;Tn.apiKey&&Tn.authDomain&&Tn.projectId?(Qt=AV(Tn),Zt=_2(Qt),yc=new Ci,Py=UF(Qt),Ny=mJ(Qt),P4(Qt)):(console.warn("⚠️ Firebase가 초기화되지 않았습니다. 일부 기능(인증, 투표 등)이 작동하지 않을 수 있습니다."),Zt=null,yc=null,Py=null,Ny=null);const Nte=Object.freeze(Object.defineProperty({__proto__:null,get auth(){return Zt},get db(){return Py},get firebaseApp(){return Qt},get googleProvider(){return yc},get storage(){return Ny}},Symbol.toStringTag,{value:"Module"}));function N4(){return or(tV)}const Vt=jo(null),di=jo(!0),Lm=jo(null);let pu=null,xN=!1;function x4(){const t=N4(),e=Qt?UF(Qt):null;e?console.log("✅ Firestore 초기화 완료"):console.error("❌ Firestore가 초기화되지 않았습니다."),Qt?console.log("✅ Firebase 설정 완료"):console.warn("⚠️ Firebase가 설정되지 않았습니다. 일부 기능이 제한될 수 있습니다.");const n=async c=>{if(!e)throw console.log("⚠️ Firestore가 초기화되지 않았습니다."),new Error("Firestore is not initialized.");const u=3;let h=0;for(;h<u;)try{console.log("🔍 사용자 정보 확인 중:",c.email,`(시도 ${h+1}/${u})`);const d=FF(e,"users",c.uid),p=await kC(d);if(p.exists()){const m=p.data();return console.log("✅ 기존 사용자 발견:",m),await PC(d,{lastLoginAt:f_()},{merge:!0}),{...c,role:m.role||"student"}}else{console.log("🆕 새 사용자 등록 시작:",c.email);const m=!1,w=["place.coach@gmail.com","jplee@milestonz.com"],R=w.includes(c.email||"");console.log("🔍 관리자 이메일 확인:",{userEmail:c.email,adminEmails:w,isAdminEmail:R});const k={uid:c.uid,email:c.email,displayName:c.displayName,photoURL:c.photoURL,role:R?"admin":"student",createdAt:f_(),lastLoginAt:f_()};console.log("💾 새 사용자 정보 저장 중:",k),await PC(d,k),console.log("✅ 새 사용자 등록 완료:",c.email);const O=await kC(d);if(O.exists())console.log("✅ 사용자 등록 확인 완료:",O.data());else throw console.error("❌ 사용자 등록 확인 실패: 문서가 존재하지 않음"),new Error("사용자 등록이 완료되지 않았습니다.");return{...c,role:R?"admin":"student"}}}catch(d){if(h++,console.error(`❌ Firestore 접근 오류 (시도 ${h}/${u}):`,d),console.error("❌ 오류 코드:",d.code),console.error("❌ 오류 메시지:",d.message),d.code==="permission-denied")throw console.error("❌ Firestore 권한 오류. 사용자 등록이 불가능합니다."),console.error("❌ 오류 상세 정보:",{code:d.code,message:d.message,firebaseApp:!!Qt,db:!!e,auth:!!Zt,userUid:c.uid,userEmail:c.email}),new Error("Firebase 프로젝트 설정을 확인해주세요. Firestore가 활성화되어 있고 Security Rules가 올바르게 설정되어 있는지 확인하세요.");if(h<u)console.log(`⏳ ${h*1e3}ms 후 재시도...`),await new Promise(p=>setTimeout(p,h*1e3));else throw console.error("❌ 모든 재시도 실패. 사용자 등록이 불가능합니다."),new Error("사용자 정보를 저장할 수 없습니다. 잠시 후 다시 시도해주세요.")}return{...c,role:"student"}},s=async()=>{if(!di.value){di.value=!0,Lm.value=null;try{if(!Zt||!yc)throw new Error("Firebase is not configured.");const c=await p2(Zt,yc);console.log("✅ Google 로그인 팝업 성공:",c.user.email);try{if(Qt&&e)Vt.value=await n(c.user),console.log("✅ 로그인 후 사용자 역할 설정 완료:",Vt.value.role);else{console.log("⚠️ Firebase가 초기화되지 않아 인증을 완료할 수 없습니다."),Vt.value=null,Zt&&await Ru(Zt),t.notify({type:"warning",message:"Firebase 설정을 확인해주세요. 로그인할 수 없습니다.",timeout:5e3}),di.value=!1;return}console.log("✅ 로그인 후 인증 상태 업데이트 완료:",{isAuthenticated:!!Vt.value,userRole:Vt.value?.role,userEmail:Vt.value?.email})}catch(u){console.error("❌ 로그인 후 사용자 역할 가져오기 실패:",u),Vt.value=null,Zt&&await Ru(Zt),t.notify({type:"warning",message:"Firebase 설정 또는 권한 오류로 로그인할 수 없습니다.",timeout:5e3}),di.value=!1;return}di.value=!1,t.notify({type:"positive",message:"로그인에 성공했습니다!",timeout:2e3})}catch(c){console.error("❌ Google 로그인 팝업 실패:",c),Lm.value=c.message,t.notify({type:"negative",message:"로그인을 시작할 수 없습니다."}),di.value=!1}}},r=async()=>{if(console.log("🔍 useAuth: logout 함수 호출됨"),console.log("🔍 useAuth: auth 객체 확인:",!!Zt),!Zt){console.log("❌ useAuth: auth 객체가 없음");return}try{pu&&(console.log("🔍 useAuth: Firestore 리스너 정리"),pu(),pu=null),console.log("🔍 useAuth: Firebase signOut 실행"),await Ru(Zt),console.log("✅ useAuth: Firebase signOut 성공"),Vt.value=null,console.log("✅ useAuth: 사용자 상태 초기화 완료"),console.log("✅ 로그아웃 성공")}catch(c){console.error("❌ useAuth: 로그아웃 실패:",c),t.notify({type:"negative",message:"로그아웃 중 오류가 발생했습니다."})}},i=()=>{if(!xN){if(xN=!0,console.log("🔐 Firebase 초기화 상태 확인:",{firebaseApp:!!Qt,auth:!!Zt,db:!!e}),!Zt){console.log("⚠️ Firebase Auth가 초기화되지 않음"),di.value=!1;return}console.log("🔐 Firebase Auth 초기화 시작"),pu=n2(Zt,async c=>{if(console.log("🔄 onAuthStateChanged 실행. 사용자:",c?c.email:"없음"),c)if(console.log("✅ 인증된 사용자 감지:",{uid:c.uid,email:c.email,displayName:c.displayName,emailVerified:c.emailVerified}),Qt&&e)try{Vt.value=await n(c),console.log("✅ 사용자 역할 설정 완료:",Vt.value.role),console.log("✅ 인증 상태 업데이트 완료:",{isAuthenticated:!!Vt.value,userRole:Vt.value?.role,userEmail:Vt.value?.email})}catch(u){console.error("❌ 사용자 역할 가져오기 실패:",u),console.error("❌ 오류 코드:",u.code),console.error("❌ 오류 메시지:",u.message),Vt.value=null,Zt&&await Ru(Zt),Lm.value=u.message,t.notify({type:"warning",message:"사용자 등록/권한 확인 실패로 로그인할 수 없습니다. 관리자에게 문의하세요.",timeout:5e3}),di.value=!1;return}else console.log("⚠️ Firebase가 초기화되지 않아 사용자 역할을 가져올 수 없습니다."),Vt.value=null,Zt&&await Ru(Zt),t.notify({type:"warning",message:"Firebase 설정이 필요합니다. 로그인할 수 없습니다.",timeout:5e3});else console.log("ℹ️ 인증되지 않은 사용자"),Vt.value=null,console.log("✅ 인증 해제 상태 업데이트 완료");di.value=!1})}};Fv(()=>{pu&&pu()});const o=()=>{console.log("🔍 현재 사용자 정보:",{user:Vt.value,isAuthenticated:!!Vt.value,userRole:Vt.value?.role,firebaseApp:!!Qt,firestore:!!e})},a=()=>(console.log("🔧 Firebase 설정 상태 확인:"),console.log("  - Firebase App:",!!Qt),console.log("  - Firebase Auth:",!!Zt),console.log("  - Firestore DB:",!!e),console.log("  - Google Provider:",!!yc),Qt&&console.log("  - Firebase Config:",{apiKey:Qt.options.apiKey?"설정됨":"설정 안됨",authDomain:Qt.options.authDomain?"설정됨":"설정 안됨",projectId:Qt.options.projectId?"설정됨":"설정 안됨",storageBucket:Qt.options.storageBucket?"설정됨":"설정 안됨"}),{firebaseApp:!!Qt,auth:!!Zt,db:!!e,googleProvider:!!yc});return{user:be(()=>Vt.value),loading:be(()=>di.value),error:be(()=>Lm.value),isAuthenticated:be(()=>!!Vt.value),displayName:be(()=>Vt.value?.displayName||"사용자"),email:be(()=>Vt.value?.email||""),photoURL:be(()=>Vt.value?.photoURL||""),isFirebaseConfigured:be(()=>!!Qt),userRole:be(()=>Vt.value?.role||"unknown"),signInWithGoogle:s,logout:r,initAuth:i,debugUserInfo:o,checkFirebaseConfig:a}}const xte={id:"app"},Dte=Dg({__name:"App",setup(t){const{initAuth:e,isAuthenticated:n,userRole:s,loading:r,debugUserInfo:i}=x4(),o=gV(),a=mV();return Mv(()=>{e()}),Hu([n,s,r],([c,u,h])=>{h||(console.log(`인증 상태 감시: isAuthenticated=${c}, userRole=${u}, loading=${h}`),console.log(`현재 경로: ${a.path}`),i(),c?u==="admin"?(console.log("관리자로 확인됨. 현재 경로 유지."),(a.path==="/login"||a.path.startsWith("/study")&&a.name!=="StudentView")&&o.push("/")):u==="student"&&(a.path.startsWith("/study")||(console.log("학생으로 확인됨. 학생 페이지로 이동합니다."),o.push("/study/default"))):a.path.startsWith("/study")?console.log("미인증 사용자가 학생 페이지 접근. 로그인 페이지로 이동합니다."):console.log("미인증 사용자. 현재 경로 유지."))}),(c,u)=>{const h=uM("router-view");return bS(),AM("div",xte,[gs(h)])}}}),Ote=t=>t,Lte=Ote,Mte=[{path:"/",component:()=>Eo(()=>os(()=>import("./MainLayout-CbUPrBs9-h46N59WV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])),_a([0,1,2,3,4,5,6,7,8,9,10,11,12,13])),children:[{path:"",component:()=>Eo(()=>os(()=>import("./IndexPage-BLAmILuN-HA-OPItk.js"),__vite__mapDeps([12,1,2,3,10,13,8,9,14,11])),_a([14,1,2,3,10,15,8,9,16,12,17]))},{path:"survey-results",component:()=>Eo(()=>os(()=>import("./SurveyResults-DhayuQfj-D0iteWpb.js"),__vite__mapDeps([15,6,3,1,2,5,16,13,17])),_a([18,6,3,1,2,5,19,15,20,21]))}]},{path:"/logout",component:()=>Eo(()=>os(()=>import("./LogoutPage-D1GfaPnm-1CZDGcS4.js"),__vite__mapDeps([18,2,3,10,13,4])),_a([22,2,3,10,15,4,23]))},{path:"/poll-result",component:()=>Eo(()=>os(()=>import("./PollResultPage-B3rDVM-7-BRBHzC5g.js"),__vite__mapDeps([19,6,3,13,17])),_a([24,6,3,15,20,21,25]))},{path:"/study/:courseId",component:()=>Eo(()=>os(()=>import("./StudentView-ZIAbzNqK-CBiLqkGJ.js"),__vite__mapDeps([20,1,2,3,5,7,4,8,9,10,6,14,13,16,17])),_a([26,1,2,3,5,7,4,8,9,10,6,11,16,15,19,20,21,27])),beforeEnter:(t,e,n)=>{const s=localStorage.getItem("isGuestMode")==="true",r=localStorage.getItem("guestUserId"),i=s&&r,o=!0,a=localStorage.getItem("enableStudentMode")==="true",c=o;console.log("🔍 라우터 가드 디버깅:",{isGuestMode:s,guestUserId:r,isGuestAuthenticated:i,envStudentMode:o,localStudentMode:a,isStudentModeEnabled:c,courseId:t.params.courseId,localStorage:{isGuestMode:localStorage.getItem("isGuestMode"),guestUserId:localStorage.getItem("guestUserId"),enableStudentMode:localStorage.getItem("enableStudentMode")}});{console.log("✅ 학생 페이지 접근 허용:",{isGuestAuthenticated:i,isStudentModeEnabled:c,courseId:t.params.courseId}),n();return}}},{path:"/:catchAll(.*)*",component:()=>Eo(()=>os(()=>import("./ErrorNotFound-BPK_S1F5-DtaYr84p.js"),[]),[])}],$b=Lte(function(){return cW({scrollBehavior:()=>({left:0,top:0}),routes:Mte,history:FH("/")})});async function Vte(t,e){const n=t(Dte);n.use(aH,e);const s=qh(typeof $b=="function"?await $b({}):$b);return{app:n,router:s}}const HC={xs:18,sm:24,md:32,lg:38,xl:46},Nw={size:String};function xw(t,e=HC){return be(()=>t.size!==void 0?{fontSize:t.size in e?`${e[t.size]}px`:t.size}:null)}function D4(t,e){return t!==void 0&&t()||e}function Fte(t,e){if(t!==void 0){const n=t();if(n!=null)return n.slice()}return e}function qu(t,e){return t!==void 0?e.concat(t()):e}function O4(t,e){return t===void 0?e:e!==void 0?e.concat(t()):t()}function Ute(t,e,n,s,r,i){e.key=s+r;const o=Oe(t,e,n);return r===!0?mS(o,i()):o}const DN="0 0 24 24",zb=t=>t,Hb=t=>`ionicons ${t}`,L4={"mdi-":t=>`mdi ${t}`,"icon-":zb,"bt-":t=>`bt ${t}`,"eva-":t=>`eva ${t}`,"ion-md":Hb,"ion-ios":Hb,"ion-logo":Hb,"iconfont ":zb,"ti-":t=>`themify-icon ${t}`,"bi-":t=>`bootstrap-icons ${t}`,"i-":zb},M4={o_:"-outlined",r_:"-round",s_:"-sharp"},V4={sym_o_:"-outlined",sym_r_:"-rounded",sym_s_:"-sharp"},qte=new RegExp("^("+Object.keys(L4).join("|")+")"),Bte=new RegExp("^("+Object.keys(M4).join("|")+")"),ON=new RegExp("^("+Object.keys(V4).join("|")+")"),jte=/^[Mm]\s?[-+]?\.?\d/,$te=/^img:/,zte=/^svguse:/,Hte=/^ion-/,Wte=/^(fa-(classic|sharp|solid|regular|light|brands|duotone|thin)|[lf]a[srlbdk]?) /,ng=Bh({name:"QIcon",props:{...Nw,tag:{type:String,default:"i"},name:String,color:String,left:Boolean,right:Boolean},setup(t,{slots:e}){const{proxy:{$q:n}}=kl(),s=xw(t),r=be(()=>"q-icon"+(t.left===!0?" on-left":"")+(t.right===!0?" on-right":"")+(t.color!==void 0?` text-${t.color}`:"")),i=be(()=>{let o,a=t.name;if(a==="none"||!a)return{none:!0};if(n.iconMapFn!==null){const h=n.iconMapFn(a);if(h!==void 0)if(h.icon!==void 0){if(a=h.icon,a==="none"||!a)return{none:!0}}else return{cls:h.cls,content:h.content!==void 0?h.content:" "}}if(jte.test(a)===!0){const[h,d=DN]=a.split("|");return{svg:!0,viewBox:d,nodes:h.split("&&").map(p=>{const[m,w,R]=p.split("@@");return Oe("path",{style:w,d:m,transform:R})})}}if($te.test(a)===!0)return{img:!0,src:a.substring(4)};if(zte.test(a)===!0){const[h,d=DN]=a.split("|");return{svguse:!0,src:h.substring(7),viewBox:d}}let c=" ";const u=a.match(qte);if(u!==null)o=L4[u[1]](a);else if(Wte.test(a)===!0)o=a;else if(Hte.test(a)===!0)o=`ionicons ion-${n.platform.is.ios===!0?"ios":"md"}${a.substring(3)}`;else if(ON.test(a)===!0){o="notranslate material-symbols";const h=a.match(ON);h!==null&&(a=a.substring(6),o+=V4[h[1]]),c=a}else{o="notranslate material-icons";const h=a.match(Bte);h!==null&&(a=a.substring(2),o+=M4[h[1]]),c=a}return{cls:o,content:c}});return()=>{const o={class:r.value,style:s.value,"aria-hidden":"true"};return i.value.none===!0?Oe(t.tag,o,D4(e.default)):i.value.img===!0?Oe(t.tag,o,qu(e.default,[Oe("img",{src:i.value.src})])):i.value.svg===!0?Oe(t.tag,o,qu(e.default,[Oe("svg",{viewBox:i.value.viewBox||"0 0 24 24"},i.value.nodes)])):i.value.svguse===!0?Oe(t.tag,o,qu(e.default,[Oe("svg",{viewBox:i.value.viewBox},[Oe("use",{"xlink:href":i.value.src})])])):(i.value.cls!==void 0&&(o.class+=" "+i.value.cls),Oe(t.tag,o,qu(e.default,[i.value.content])))}}}),F4=Bh({name:"QAvatar",props:{...Nw,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(t,{slots:e}){const n=xw(t),s=be(()=>"q-avatar"+(t.color?` bg-${t.color}`:"")+(t.textColor?` text-${t.textColor} q-chip--colored`:"")+(t.square===!0?" q-avatar--square":t.rounded===!0?" rounded-borders":"")),r=be(()=>t.fontSize?{fontSize:t.fontSize}:null);return()=>{const i=t.icon!==void 0?[Oe(ng,{name:t.icon})]:void 0;return Oe("div",{class:s.value,style:n.value},[Oe("div",{class:"q-avatar__content row flex-center overflow-hidden",style:r.value},O4(e.default,i))])}}}),U4={size:{type:[String,Number],default:"1em"},color:String};function q4(t){return{cSize:be(()=>t.size in HC?`${HC[t.size]}px`:t.size),classes:be(()=>"q-spinner"+(t.color?` text-${t.color}`:""))}}const lR=Bh({name:"QSpinner",props:{...U4,thickness:{type:Number,default:5}},setup(t){const{cSize:e,classes:n}=q4(t);return()=>Oe("svg",{class:n.value+" q-spinner-mat",width:e.value,height:e.value,viewBox:"25 25 50 50"},[Oe("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none",stroke:"currentColor","stroke-width":t.thickness,"stroke-miterlimit":"10"})])}});function B4(t,e){const n=t.style;for(const s in e)n[s]=e[s]}function Kte(t){if(t==null)return;if(typeof t=="string")try{return document.querySelector(t)||void 0}catch{return}const e=Ma(t);if(e)return e.$el||e}function Gte(t,e){if(t==null||t.contains(e)===!0)return!0;for(let n=t.nextElementSibling;n!==null;n=n.nextElementSibling)if(n.contains(e))return!0;return!1}function Qte(t,e=250){let n=!1,s;return function(){return n===!1&&(n=!0,setTimeout(()=>{n=!1},e),s=t.apply(this,arguments)),s}}function LN(t,e,n,s){n.modifiers.stop===!0&&IS(t);const r=n.modifiers.color;let i=n.modifiers.center;i=i===!0||s===!0;const o=document.createElement("span"),a=document.createElement("span"),c=WM(t),{left:u,top:h,width:d,height:p}=e.getBoundingClientRect(),m=Math.sqrt(d*d+p*p),w=m/2,R=`${(d-m)/2}px`,k=i?R:`${c.left-u-w}px`,O=`${(p-m)/2}px`,M=i?O:`${c.top-h-w}px`;a.className="q-ripple__inner",B4(a,{height:`${m}px`,width:`${m}px`,transform:`translate3d(${k},${M},0) scale3d(.2,.2,1)`,opacity:0}),o.className=`q-ripple${r?" text-"+r:""}`,o.setAttribute("dir","ltr"),o.appendChild(a),e.appendChild(o);const F=()=>{o.remove(),clearTimeout(q)};n.abort.push(F);let q=setTimeout(()=>{a.classList.add("q-ripple__inner--enter"),a.style.transform=`translate3d(${R},${O},0) scale3d(1,1,1)`,a.style.opacity=.2,q=setTimeout(()=>{a.classList.remove("q-ripple__inner--enter"),a.classList.add("q-ripple__inner--leave"),a.style.opacity=0,q=setTimeout(()=>{o.remove(),n.abort.splice(n.abort.indexOf(F),1)},275)},250)},50)}function MN(t,{modifiers:e,value:n,arg:s}){const r=Object.assign({},t.cfg.ripple,e,n);t.modifiers={early:r.early===!0,stop:r.stop===!0,center:r.center===!0,color:r.color||s,keyCodes:[].concat(r.keyCodes||13)}}const j4=HM({name:"ripple",beforeMount(t,e){const n=e.instance.$.appContext.config.globalProperties.$q.config||{};if(n.ripple===!1)return;const s={cfg:n,enabled:e.value!==!1,modifiers:{},abort:[],start(r){s.enabled===!0&&r.qSkipRipple!==!0&&r.type===(s.modifiers.early===!0?"pointerdown":"click")&&LN(r,t,s,r.qKeyEvent===!0)},keystart:Qte(r=>{s.enabled===!0&&r.qSkipRipple!==!0&&K_(r,s.modifiers.keyCodes)===!0&&r.type===`key${s.modifiers.early===!0?"down":"up"}`&&LN(r,t,s,!0)},300)};MN(s,e),t.__qripple=s,KM(s,"main",[[t,"pointerdown","start","passive"],[t,"click","start","passive"],[t,"keydown","keystart","passive"],[t,"keyup","keystart","passive"]])},updated(t,e){if(e.oldValue!==e.value){const n=t.__qripple;n!==void 0&&(n.enabled=e.value!==!1,n.enabled===!0&&Object(e.value)===e.value&&MN(n,e))}},beforeUnmount(t){const e=t.__qripple;e!==void 0&&(e.abort.forEach(n=>{n()}),GM(e,"main"),delete t._qripple)}}),$4={left:"start",center:"center",right:"end",between:"between",around:"around",evenly:"evenly",stretch:"stretch"},Yte=Object.keys($4),z4={align:{type:String,validator:t=>Yte.includes(t)}};function H4(t){return be(()=>{const e=t.align===void 0?t.vertical===!0?"stretch":"left":t.align;return`${t.vertical===!0?"items":"justify"}-${$4[e]}`})}function Xte(t){if(Object(t.$parent)===t.$parent)return t.$parent;let{parent:e}=t.$;for(;Object(e)===e;){if(Object(e.proxy)===e.proxy)return e.proxy;e=e.parent}}function W4(t){return t.appContext.config.globalProperties.$router!==void 0}function Jte(t){return t.isUnmounted===!0||t.isDeactivated===!0}function VN(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}function FN(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Zte(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(Array.isArray(r)===!1||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function UN(t,e){return Array.isArray(e)===!0?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function ene(t,e){return Array.isArray(t)===!0?UN(t,e):Array.isArray(e)===!0?UN(e,t):t===e}function tne(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(ene(t[n],e[n])===!1)return!1;return!0}const K4={to:[String,Object],replace:Boolean,href:String,target:String,disable:Boolean},nne={...K4,exact:Boolean,activeClass:{type:String,default:"q-router-link--active"},exactActiveClass:{type:String,default:"q-router-link--exact-active"}};function G4({fallbackTag:t,useDisableForRouterLinkProps:e=!0}={}){const n=kl(),{props:s,proxy:r,emit:i}=n,o=W4(n),a=be(()=>s.disable!==!0&&s.href!==void 0),c=be(e===!0?()=>o===!0&&s.disable!==!0&&a.value!==!0&&s.to!==void 0&&s.to!==null&&s.to!=="":()=>o===!0&&a.value!==!0&&s.to!==void 0&&s.to!==null&&s.to!==""),u=be(()=>c.value===!0?M(s.to):null),h=be(()=>u.value!==null),d=be(()=>a.value===!0||h.value===!0),p=be(()=>s.type==="a"||d.value===!0?"a":s.tag||t||"div"),m=be(()=>a.value===!0?{href:s.href,target:s.target}:h.value===!0?{href:u.value.href,target:s.target}:{}),w=be(()=>{if(h.value===!1)return-1;const{matched:H}=u.value,{length:J}=H,I=H[J-1];if(I===void 0)return-1;const v=r.$route.matched;if(v.length===0)return-1;const y=v.findIndex(FN.bind(null,I));if(y!==-1)return y;const C=VN(H[J-2]);return J>1&&VN(I)===C&&v[v.length-1].path!==C?v.findIndex(FN.bind(null,H[J-2])):y}),R=be(()=>h.value===!0&&w.value!==-1&&Zte(r.$route.params,u.value.params)),k=be(()=>R.value===!0&&w.value===r.$route.matched.length-1&&tne(r.$route.params,u.value.params)),O=be(()=>h.value===!0?k.value===!0?` ${s.exactActiveClass} ${s.activeClass}`:s.exact===!0?"":R.value===!0?` ${s.activeClass}`:"":"");function M(H){try{return r.$router.resolve(H)}catch{}return null}function F(H,{returnRouterError:J,to:I=s.to,replace:v=s.replace}={}){if(s.disable===!0)return H.preventDefault(),Promise.resolve(!1);if(H.metaKey||H.altKey||H.ctrlKey||H.shiftKey||H.button!==void 0&&H.button!==0||s.target==="_blank")return Promise.resolve(!1);H.preventDefault();const y=r.$router[v===!0?"replace":"push"](I);return J===!0?y:y.then(()=>{}).catch(()=>{})}function q(H){if(h.value===!0){const J=I=>F(H,I);i("click",H,J),H.defaultPrevented!==!0&&J()}else i("click",H)}return{hasRouterLink:h,hasHrefLink:a,hasLink:d,linkTag:p,resolvedLink:u,linkIsActive:R,linkIsExactActive:k,linkClass:O,linkAttrs:m,getLink:M,navigateToRouterLink:F,navigateOnClick:q}}const qN={none:0,xs:4,sm:8,md:16,lg:24,xl:32},sne={xs:8,sm:10,md:14,lg:20,xl:24},rne=["button","submit","reset"],ine=/[^\s]\/[^\s]/,one=["flat","outline","push","unelevated"];function ane(t,e){return t.flat===!0?"flat":t.outline===!0?"outline":t.push===!0?"push":t.unelevated===!0?"unelevated":e}const lne={...Nw,...K4,type:{type:String,default:"button"},label:[Number,String],icon:String,iconRight:String,...one.reduce((t,e)=>(t[e]=Boolean)&&t,{}),square:Boolean,rounded:Boolean,glossy:Boolean,size:String,fab:Boolean,fabMini:Boolean,padding:String,color:String,textColor:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,tabindex:[Number,String],ripple:{type:[Boolean,Object],default:!0},align:{...z4.align,default:"center"},stack:Boolean,stretch:Boolean,loading:{type:Boolean,default:null},disable:Boolean},cne={...lne,round:Boolean};function une(t){const e=xw(t,sne),n=H4(t),{hasRouterLink:s,hasLink:r,linkTag:i,linkAttrs:o,navigateOnClick:a}=G4({fallbackTag:"button"}),c=be(()=>{const k=t.fab===!1&&t.fabMini===!1?e.value:{};return t.padding!==void 0?Object.assign({},k,{padding:t.padding.split(/\s+/).map(O=>O in qN?qN[O]+"px":O).join(" "),minWidth:"0",minHeight:"0"}):k}),u=be(()=>t.rounded===!0||t.fab===!0||t.fabMini===!0),h=be(()=>t.disable!==!0&&t.loading!==!0),d=be(()=>h.value===!0?t.tabindex||0:-1),p=be(()=>ane(t,"standard")),m=be(()=>{const k={tabindex:d.value};return r.value===!0?Object.assign(k,o.value):rne.includes(t.type)===!0&&(k.type=t.type),i.value==="a"?(t.disable===!0?k["aria-disabled"]="true":k.href===void 0&&(k.role="button"),s.value!==!0&&ine.test(t.type)===!0&&(k.type=t.type)):t.disable===!0&&(k.disabled="",k["aria-disabled"]="true"),t.loading===!0&&t.percentage!==void 0&&Object.assign(k,{role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":t.percentage}),k}),w=be(()=>{let k;t.color!==void 0?t.flat===!0||t.outline===!0?k=`text-${t.textColor||t.color}`:k=`bg-${t.color} text-${t.textColor||"white"}`:t.textColor&&(k=`text-${t.textColor}`);const O=t.round===!0?"round":`rectangle${u.value===!0?" q-btn--rounded":t.square===!0?" q-btn--square":""}`;return`q-btn--${p.value} q-btn--${O}`+(k!==void 0?" "+k:"")+(h.value===!0?" q-btn--actionable q-focusable q-hoverable":t.disable===!0?" disabled":"")+(t.fab===!0?" q-btn--fab":t.fabMini===!0?" q-btn--fab-mini":"")+(t.noCaps===!0?" q-btn--no-uppercase":"")+(t.dense===!0?" q-btn--dense":"")+(t.stretch===!0?" no-border-radius self-stretch":"")+(t.glossy===!0?" glossy":"")+(t.square?" q-btn--square":"")}),R=be(()=>n.value+(t.stack===!0?" column":" row")+(t.noWrap===!0?" no-wrap text-no-wrap":"")+(t.loading===!0?" q-btn__content--hidden":""));return{classes:w,style:c,innerClasses:R,attributes:m,hasLink:r,linkTag:i,navigateOnClick:a,isActionable:h}}const{passiveCapture:lr}=tl;let gu=null,mu=null,_u=null;const Q4=Bh({name:"QBtn",props:{...cne,percentage:Number,darkPercentage:Boolean,onTouchstart:[Function,Array]},emits:["click","keydown","mousedown","keyup"],setup(t,{slots:e,emit:n}){const{proxy:s}=kl(),{classes:r,style:i,innerClasses:o,attributes:a,hasLink:c,linkTag:u,navigateOnClick:h,isActionable:d}=une(t),p=jo(null),m=jo(null);let w=null,R,k=null;const O=be(()=>t.label!==void 0&&t.label!==null&&t.label!==""),M=be(()=>t.disable===!0||t.ripple===!1?!1:{keyCodes:c.value===!0?[13,32]:[13],...t.ripple===!0?{}:t.ripple}),F=be(()=>({center:t.round})),q=be(()=>{const K=Math.max(0,Math.min(100,t.percentage));return K>0?{transition:"transform 0.6s",transform:`translateX(${K-100}%)`}:{}}),H=be(()=>{if(t.loading===!0)return{onMousedown:E,onTouchstart:E,onClick:E,onKeydown:E,onKeyup:E};if(d.value===!0){const K={onClick:I,onKeydown:v,onMousedown:C};if(s.$q.platform.has.touch===!0){const oe=t.onTouchstart!==void 0?"":"Passive";K[`onTouchstart${oe}`]=y}return K}return{onClick:oc}}),J=be(()=>({ref:p,class:"q-btn q-btn-item non-selectable no-outline "+r.value,style:i.value,...a.value,...H.value}));function I(K){if(p.value!==null){if(K!==void 0){if(K.defaultPrevented===!0)return;const oe=document.activeElement;if(t.type==="submit"&&oe!==document.body&&p.value.contains(oe)===!1&&oe.contains(p.value)===!1){K.qAvoidFocus!==!0&&p.value.focus();const ge=()=>{document.removeEventListener("keydown",oc,!0),document.removeEventListener("keyup",ge,lr),p.value?.removeEventListener("blur",ge,lr)};document.addEventListener("keydown",oc,!0),document.addEventListener("keyup",ge,lr),p.value.addEventListener("blur",ge,lr)}}h(K)}}function v(K){p.value!==null&&(n("keydown",K),K_(K,[13,32])===!0&&mu!==p.value&&(mu!==null&&T(),K.defaultPrevented!==!0&&(K.qAvoidFocus!==!0&&p.value.focus(),mu=p.value,p.value.classList.add("q-btn--active"),document.addEventListener("keyup",S,!0),p.value.addEventListener("blur",S,lr)),oc(K)))}function y(K){p.value!==null&&(n("touchstart",K),K.defaultPrevented!==!0&&(gu!==p.value&&(gu!==null&&T(),gu=p.value,w=K.target,w.addEventListener("touchcancel",S,lr),w.addEventListener("touchend",S,lr)),R=!0,k!==null&&clearTimeout(k),k=setTimeout(()=>{k=null,R=!1},200)))}function C(K){p.value!==null&&(K.qSkipRipple=R===!0,n("mousedown",K),K.defaultPrevented!==!0&&_u!==p.value&&(_u!==null&&T(),_u=p.value,p.value.classList.add("q-btn--active"),document.addEventListener("mouseup",S,lr)))}function S(K){if(p.value!==null&&!(K?.type==="blur"&&document.activeElement===p.value)){if(K?.type==="keyup"){if(mu===p.value&&K_(K,[13,32])===!0){const oe=new MouseEvent("click",K);oe.qKeyEvent=!0,K.defaultPrevented===!0&&W_(oe),K.cancelBubble===!0&&IS(oe),p.value.dispatchEvent(oe),oc(K),K.qKeyEvent=!0}n("keyup",K)}T()}}function T(K){const oe=m.value;K!==!0&&(gu===p.value||_u===p.value)&&oe!==null&&oe!==document.activeElement&&(oe.setAttribute("tabindex",-1),oe.focus()),gu===p.value&&(w!==null&&(w.removeEventListener("touchcancel",S,lr),w.removeEventListener("touchend",S,lr)),gu=w=null),_u===p.value&&(document.removeEventListener("mouseup",S,lr),_u=null),mu===p.value&&(document.removeEventListener("keyup",S,!0),p.value?.removeEventListener("blur",S,lr),mu=null),p.value?.classList.remove("q-btn--active")}function E(K){oc(K),K.qSkipRipple=!0}return Vv(()=>{T(!0)}),Object.assign(s,{click:K=>{d.value===!0&&I(K)}}),()=>{let K=[];t.icon!==void 0&&K.push(Oe(ng,{name:t.icon,left:t.stack!==!0&&O.value===!0,role:"img"})),O.value===!0&&K.push(Oe("span",{class:"block"},[t.label])),K=qu(e.default,K),t.iconRight!==void 0&&t.round===!1&&K.push(Oe(ng,{name:t.iconRight,right:t.stack!==!0&&O.value===!0,role:"img"}));const oe=[Oe("span",{class:"q-focus-helper",ref:m})];return t.loading===!0&&t.percentage!==void 0&&oe.push(Oe("span",{class:"q-btn__progress absolute-full overflow-hidden"+(t.darkPercentage===!0?" q-btn__progress--dark":"")},[Oe("span",{class:"q-btn__progress-indicator fit block",style:q.value})])),oe.push(Oe("span",{class:"q-btn__content text-center col items-center q-anchor--skip "+o.value},K)),t.loading!==null&&oe.push(Oe(VM,{name:"q-transition--fade"},()=>t.loading===!0?[Oe("span",{key:"loading",class:"absolute-full flex flex-center"},e.loading!==void 0?e.loading():[Oe(lR)])]:null)),mS(Oe(u.value,J.value,oe),[[j4,M.value,void 0,F.value]])}}});let hne=1,dne=document.body;function Y4(t,e){const n=document.createElement("div");if(n.id=e!==void 0?`q-portal--${e}--${hne++}`:t,Q_.globalNodes!==void 0){const s=Q_.globalNodes.class;s!==void 0&&(n.className=s)}return dne.appendChild(n),n}function fne(t){t.remove()}let pne=0;const m_={},__={},Or={},X4={},gne=/^\s*$/,J4=[],mne=[void 0,null,!0,!1,""],cR=["top-left","top-right","bottom-left","bottom-right","top","bottom","left","right","center"],_ne=["top-left","top-right","bottom-left","bottom-right"],kf={positive:{icon:t=>t.iconSet.type.positive,color:"positive"},negative:{icon:t=>t.iconSet.type.negative,color:"negative"},warning:{icon:t=>t.iconSet.type.warning,color:"warning",textColor:"dark"},info:{icon:t=>t.iconSet.type.info,color:"info"},ongoing:{group:!1,timeout:0,spinner:!0,color:"grey-8"}};function Z4(t,e,n){if(!t)return uf("parameter required");let s;const r={textColor:"white"};if(t.ignoreDefaults!==!0&&Object.assign(r,m_),dh(t)===!1&&(r.type&&Object.assign(r,kf[r.type]),t={message:t}),Object.assign(r,kf[t.type||r.type],t),typeof r.icon=="function"&&(r.icon=r.icon(e)),r.spinner?(r.spinner===!0&&(r.spinner=lR),r.spinner=qh(r.spinner)):r.spinner=!1,r.meta={hasMedia:!!(r.spinner!==!1||r.icon||r.avatar),hasText:BN(r.message)||BN(r.caption)},r.position){if(cR.includes(r.position)===!1)return uf("wrong position",t)}else r.position="bottom";if(mne.includes(r.timeout)===!0)r.timeout=5e3;else{const c=Number(r.timeout);if(isNaN(c)||c<0)return uf("wrong timeout",t);r.timeout=Number.isFinite(c)?c:0}r.timeout===0?r.progress=!1:r.progress===!0&&(r.meta.progressClass="q-notification__progress"+(r.progressClass?` ${r.progressClass}`:""),r.meta.progressStyle={animationDuration:`${r.timeout+1e3}ms`});const i=(Array.isArray(t.actions)===!0?t.actions:[]).concat(t.ignoreDefaults!==!0&&Array.isArray(m_.actions)===!0?m_.actions:[]).concat(Array.isArray(kf[t.type]?.actions)===!0?kf[t.type].actions:[]),{closeBtn:o}=r;if(o&&i.push({label:typeof o=="string"?o:e.lang.label.close}),r.actions=i.map(({handler:c,noDismiss:u,...h})=>({flat:!0,...h,onClick:typeof c=="function"?()=>{c(),u!==!0&&a()}:()=>{a()}})),r.multiLine===void 0&&(r.multiLine=r.actions.length>1),Object.assign(r.meta,{class:`q-notification row items-stretch q-notification--${r.multiLine===!0?"multi-line":"standard"}`+(r.color!==void 0?` bg-${r.color}`:"")+(r.textColor!==void 0?` text-${r.textColor}`:"")+(r.classes!==void 0?` ${r.classes}`:""),wrapperClass:"q-notification__wrapper col relative-position border-radius-inherit "+(r.multiLine===!0?"column no-wrap justify-center":"row items-center"),contentClass:"q-notification__content row items-center"+(r.multiLine===!0?"":" col"),leftClass:r.meta.hasText===!0?"additional":"single",attrs:{role:"alert",...r.attrs}}),r.group===!1?(r.group=void 0,r.meta.group=void 0):((r.group===void 0||r.group===!0)&&(r.group=[r.message,r.caption,r.multiline].concat(r.actions.map(c=>`${c.label}*${c.icon}`)).join("|")),r.meta.group=r.group+"|"+r.position),r.actions.length===0?r.actions=void 0:r.meta.actionsClass="q-notification__actions row items-center "+(r.multiLine===!0?"justify-end":"col-auto")+(r.meta.hasMedia===!0?" q-notification__actions--with-media":""),n!==void 0){n.notif.meta.timer&&(clearTimeout(n.notif.meta.timer),n.notif.meta.timer=void 0),r.meta.uid=n.notif.meta.uid;const c=Or[r.position].value.indexOf(n.notif);Or[r.position].value[c]=r}else{const c=__[r.meta.group];if(c===void 0){if(r.meta.uid=pne++,r.meta.badge=1,["left","right","center"].indexOf(r.position)!==-1)Or[r.position].value.splice(Math.floor(Or[r.position].value.length/2),0,r);else{const u=r.position.indexOf("top")!==-1?"unshift":"push";Or[r.position].value[u](r)}r.group!==void 0&&(__[r.meta.group]=r)}else{if(c.meta.timer&&(clearTimeout(c.meta.timer),c.meta.timer=void 0),r.badgePosition!==void 0){if(_ne.includes(r.badgePosition)===!1)return uf("wrong badgePosition",t)}else r.badgePosition=`top-${r.position.indexOf("left")!==-1?"right":"left"}`;r.meta.uid=c.meta.uid,r.meta.badge=c.meta.badge+1,r.meta.badgeClass=`q-notification__badge q-notification__badge--${r.badgePosition}`+(r.badgeColor!==void 0?` bg-${r.badgeColor}`:"")+(r.badgeTextColor!==void 0?` text-${r.badgeTextColor}`:"")+(r.badgeClass?` ${r.badgeClass}`:"");const u=Or[r.position].value.indexOf(c);Or[r.position].value[u]=__[r.meta.group]=r}}const a=()=>{yne(r),s=void 0};if(r.timeout>0&&(r.meta.timer=setTimeout(()=>{r.meta.timer=void 0,a()},r.timeout+1e3)),r.group!==void 0)return c=>{c!==void 0?uf("trying to update a grouped one which is forbidden",t):a()};if(s={dismiss:a,config:t,notif:r},n!==void 0){Object.assign(n,s);return}return c=>{if(s!==void 0)if(c===void 0)s.dismiss();else{const u=Object.assign({},s.config,c,{group:!1,position:r.position});Z4(u,e,s)}}}function yne(t){t.meta.timer&&(clearTimeout(t.meta.timer),t.meta.timer=void 0);const e=Or[t.position].value.indexOf(t);if(e!==-1){t.group!==void 0&&delete __[t.meta.group];const n=J4[""+t.meta.uid];if(n){const{width:s,height:r}=getComputedStyle(n);n.style.left=`${n.offsetLeft}px`,n.style.width=s,n.style.height=r}Or[t.position].value.splice(e,1),typeof t.onDismiss=="function"&&t.onDismiss()}}function BN(t){return t!=null&&gne.test(t)!==!0}function uf(t,e){return console.error(`Notify: ${t}`,e),!1}function vne(){return Bh({name:"QNotifications",devtools:{hide:!0},setup(){return()=>Oe("div",{class:"q-notifications"},cR.map(t=>Oe(wz,{key:t,class:X4[t],tag:"div",name:`q-notification--${t}`},()=>Or[t].value.map(e=>{const n=e.meta,s=[];if(n.hasMedia===!0&&(e.spinner!==!1?s.push(Oe(e.spinner,{class:"q-notification__spinner q-notification__spinner--"+n.leftClass,color:e.spinnerColor,size:e.spinnerSize})):e.icon?s.push(Oe(ng,{class:"q-notification__icon q-notification__icon--"+n.leftClass,name:e.icon,color:e.iconColor,size:e.iconSize,role:"img"})):e.avatar&&s.push(Oe(F4,{class:"q-notification__avatar q-notification__avatar--"+n.leftClass},()=>Oe("img",{src:e.avatar,"aria-hidden":"true"})))),n.hasText===!0){let i;const o={class:"q-notification__message col"};if(e.html===!0)o.innerHTML=e.caption?`<div>${e.message}</div><div class="q-notification__caption">${e.caption}</div>`:e.message;else{const a=[e.message];i=e.caption?[Oe("div",a),Oe("div",{class:"q-notification__caption"},[e.caption])]:a}s.push(Oe("div",o,i))}const r=[Oe("div",{class:n.contentClass},s)];return e.progress===!0&&r.push(Oe("div",{key:`${n.uid}|p|${n.badge}`,class:n.progressClass,style:n.progressStyle})),e.actions!==void 0&&r.push(Oe("div",{class:n.actionsClass},e.actions.map(i=>Oe(Q4,i)))),n.badge>1&&r.push(Oe("div",{key:`${n.uid}|${n.badge}`,class:e.meta.badgeClass,style:e.badgeStyle},[n.badge])),Oe("div",{ref:i=>{J4[""+n.uid]=i},key:n.uid,class:n.class,...n.attrs},[Oe("div",{class:n.wrapperClass},r)])}))))}})}const wne={setDefaults(t){dh(t)===!0&&Object.assign(m_,t)},registerType(t,e){dh(e)===!0&&(kf[t]=e)},install({$q:t,parentApp:e}){if(t.notify=this.create=n=>Z4(n,t),t.notify.setDefaults=this.setDefaults,t.notify.registerType=this.registerType,t.config.notify!==void 0&&this.setDefaults(t.config.notify),this.__installed!==!0){cR.forEach(s=>{Or[s]=jo([]);const r=["left","center","right"].includes(s)===!0?"center":s.indexOf("top")!==-1?"top":"bottom",i=s.indexOf("left")!==-1?"start":s.indexOf("right")!==-1?"end":"center",o=["left","right"].includes(s)?`items-${s==="left"?"start":"end"} justify-center`:s==="center"?"flex-center":`items-${i}`;X4[s]=`q-notifications__list q-notifications__list--${r} fixed column no-wrap ${o}`});const n=Y4("q-notify");rH(vne(),e).mount(n)}}},Ene={config:{},plugins:{Notify:wne}},bne="/";async function Tne({app:t,router:e},n){let s=!1;const r=a=>{try{return e.resolve(a).href}catch{}return Object(a)===a?null:a},i=a=>{if(s=!0,typeof a=="string"&&/^https?:\/\//.test(a)){window.location.href=a;return}const c=r(a);c!==null&&(window.location.href=c)},o=window.location.href.replace(window.location.origin,"");for(let a=0;s===!1&&a<n.length;a++)try{await n[a]({app:t,router:e,ssrContext:null,redirect:i,urlPath:o,publicPath:bne})}catch(c){if(c&&c.url){i(c.url);return}console.error("[Quasar] boot error:",c);return}s!==!0&&(t.use(e),t.mount("#q-app"))}Vte($M,Ene).then(t=>{const[e,n]=Promise.allSettled!==void 0?["allSettled",s=>s.map(r=>{if(r.status==="rejected"){console.error("[Quasar] boot error:",r.reason);return}return r.value.default})]:["all",s=>s.map(r=>r.default)];return Promise[e]([Eo(()=>os(()=>import("./pinia-CU9SUkzn-Dk66cb7x.js"),__vite__mapDeps([21,9])),_a([28,9]))]).then(s=>{const r=n(s).filter(i=>typeof i=="function");Tne(t,r)})});const lve=Object.freeze(Object.defineProperty({__proto__:null,$:tl,A:Ute,B:O4,C:oc,D:Dg,E:AM,F:TS,G:gs,H:bS,I:Q4,J:IS,K:Qr,L:Lg,M:W_,N:Mv,O:mV,P:kM,Q:ng,R:j4,S:GL,T:F5,U:bL,V:NM,W:gV,X:N4,Y:el,Z:Vv,_:hh,a:su,a$:eV,a0:zf,a1:Fv,a2:qu,get a3(){return Qt},a4:P4,a5:Ete,a6:_te,a7:XM,get a8(){return Ny},a9:gJ,aA:GM,aB:Uz,aC:KM,aD:WM,aE:Vz,aF:QM,aG:oM,aH:iM,aI:Jte,aJ:Zz,aK:dh,aL:_2,aM:hr,aN:i5,aO:F4,aP:Rz,aQ:VM,aR:hS,aS:sz,aT:lR,aU:uM,aV:lM,aW:Gte,aX:t_,aY:cM,aZ:yS,a_:W4,aa:hJ,get ab(){return Py},ac:FF,ad:WY,ae:f_,af:fJ,ag:dJ,ah:pJ,ai:PC,aj:kC,ak:GY,al:Eo,am:KY,an:nne,ao:G4,ap:K_,aq:Fte,ar:x4,as:k4,at:vte,au:Pv,av:Nv,aw:Ma,ax:yte,ay:mS,az:HM,b:Ic,b0:sH,b1:nH,b2:xz,b3:H_,b4:Xte,b5:G$,b6:Y4,b7:fne,b8:Fz,b9:z4,ba:H4,bb:BS,bc:So,bd:Ro,be:Ci,bf:rl,bg:Ao,bh:t2,bi:i2,bj:m2,bk:$S,bl:XV,bm:VV,bn:iC,bo:h2,bp:YV,bq:n2,br:e2,bs:xV,bt:FV,bu:p2,bv:Ru,bw:U4,bx:q4,by:Nte,c:V$,d:be,e:f$,f:or,g:IL,h:p5,i:qn,j:Bh,k:kl,l:Oe,m:qh,n:pS,o:p$,p:D4,q:eH,r:jo,s:Xz,t:lt,u:Jz,v:Kte,w:Hu,x:B4,y:Nw,z:xw},Symbol.toStringTag,{value:"Module"}));/**
* @vue/shared v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function uR(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const kt={},Zu=[],Di=()=>{},Cne=()=>!1,Dw=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),hR=t=>t.startsWith("onUpdate:"),Dn=Object.assign,dR=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Ine=Object.prototype.hasOwnProperty,wt=(t,e)=>Ine.call(t,e),xe=Array.isArray,eh=t=>Ow(t)==="[object Map]",e6=t=>Ow(t)==="[object Set]",$e=t=>typeof t=="function",an=t=>typeof t=="string",Dl=t=>typeof t=="symbol",zt=t=>t!==null&&typeof t=="object",t6=t=>(zt(t)||$e(t))&&$e(t.then)&&$e(t.catch),n6=Object.prototype.toString,Ow=t=>n6.call(t),Sne=t=>Ow(t).slice(8,-1),s6=t=>Ow(t)==="[object Object]",fR=t=>an(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,op=uR(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Lw=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Rne=/-(\w)/g,wr=Lw(t=>t.replace(Rne,(e,n)=>n?n.toUpperCase():"")),Ane=/\B([A-Z])/g,au=Lw(t=>t.replace(Ane,"-$1").toLowerCase()),Mw=Lw(t=>t.charAt(0).toUpperCase()+t.slice(1)),Wb=Lw(t=>t?`on${Mw(t)}`:""),za=(t,e)=>!Object.is(t,e),Kb=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},WC=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},kne=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Pne=t=>{const e=an(t)?Number(t):NaN;return isNaN(e)?t:e};let jN;const Vw=()=>jN||(jN=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function pR(t){if(xe(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=an(s)?One(s):pR(s);if(r)for(const i in r)e[i]=r[i]}return e}else if(an(t)||zt(t))return t}const Nne=/;(?![^(]*\))/g,xne=/:([^]+)/,Dne=/\/\*[^]*?\*\//g;function One(t){const e={};return t.replace(Dne,"").split(Nne).forEach(n=>{if(n){const s=n.split(xne);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function gR(t){let e="";if(an(t))e=t;else if(xe(t))for(let n=0;n<t.length;n++){const s=gR(t[n]);s&&(e+=s+" ")}else if(zt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Lne="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Mne=uR(Lne);function r6(t){return!!t||t===""}const i6=t=>!!(t&&t.__v_isRef===!0),Vne=t=>an(t)?t:t==null?"":xe(t)||zt(t)&&(t.toString===n6||!$e(t.toString))?i6(t)?Vne(t.value):JSON.stringify(t,o6,2):String(t),o6=(t,e)=>i6(e)?o6(t,e.value):eh(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r],i)=>(n[Gb(s,i)+" =>"]=r,n),{})}:e6(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Gb(n))}:Dl(e)?Gb(e):zt(e)&&!xe(e)&&!s6(e)?String(e):e,Gb=(t,e="")=>{var n;return Dl(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ss;class a6{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ss,!e&&ss&&(this.index=(ss.scopes||(ss.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=ss;try{return ss=this,e()}finally{ss=n}}}on(){++this._on===1&&(this.prevScope=ss,ss=this)}off(){this._on>0&&--this._on===0&&(ss=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function cve(t){return new a6(t)}function Fne(){return ss}function uve(t,e=!1){ss&&ss.cleanups.push(t)}let Dt;const Qb=new WeakSet;class l6{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ss&&ss.active&&ss.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Qb.has(this)&&(Qb.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||u6(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,$N(this),h6(this);const e=Dt,n=ti;Dt=this,ti=!0;try{return this.fn()}finally{d6(this),Dt=e,ti=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)yR(e);this.deps=this.depsTail=void 0,$N(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Qb.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){KC(this)&&this.run()}get dirty(){return KC(this)}}let c6=0,ap,lp;function u6(t,e=!1){if(t.flags|=8,e){t.next=lp,lp=t;return}t.next=ap,ap=t}function mR(){c6++}function _R(){if(--c6>0)return;if(lp){let e=lp;for(lp=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;ap;){let e=ap;for(ap=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function h6(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function d6(t){let e,n=t.depsTail,s=n;for(;s;){const r=s.prevDep;s.version===-1?(s===n&&(n=r),yR(s),Une(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}t.deps=e,t.depsTail=n}function KC(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(f6(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function f6(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===sg)||(t.globalVersion=sg,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!KC(t))))return;t.flags|=2;const e=t.dep,n=Dt,s=ti;Dt=t,ti=!0;try{h6(t);const r=t.fn(t._value);(e.version===0||za(r,t._value))&&(t.flags|=128,t._value=r,e.version++)}catch(r){throw e.version++,r}finally{Dt=n,ti=s,d6(t),t.flags&=-3}}function yR(t,e=!1){const{dep:n,prevSub:s,nextSub:r}=t;if(s&&(s.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)yR(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function Une(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let ti=!0;const p6=[];function Qo(){p6.push(ti),ti=!1}function Yo(){const t=p6.pop();ti=t===void 0?!0:t}function $N(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Dt;Dt=void 0;try{e()}finally{Dt=n}}}let sg=0;class qne{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class vR{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Dt||!ti||Dt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Dt)n=this.activeLink=new qne(Dt,this),Dt.deps?(n.prevDep=Dt.depsTail,Dt.depsTail.nextDep=n,Dt.depsTail=n):Dt.deps=Dt.depsTail=n,g6(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=Dt.depsTail,n.nextDep=void 0,Dt.depsTail.nextDep=n,Dt.depsTail=n,Dt.deps===n&&(Dt.deps=s)}return n}trigger(e){this.version++,sg++,this.notify(e)}notify(e){mR();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{_R()}}}function g6(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)g6(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const xy=new WeakMap,Pc=Symbol(""),GC=Symbol(""),rg=Symbol("");function us(t,e,n){if(ti&&Dt){let s=xy.get(t);s||xy.set(t,s=new Map);let r=s.get(n);r||(s.set(n,r=new vR),r.map=s,r.key=n),r.track()}}function ko(t,e,n,s,r,i){const o=xy.get(t);if(!o){sg++;return}const a=c=>{c&&c.trigger()};if(mR(),e==="clear")o.forEach(a);else{const c=xe(t),u=c&&fR(n);if(c&&n==="length"){const h=Number(s);o.forEach((d,p)=>{(p==="length"||p===rg||!Dl(p)&&p>=h)&&a(d)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),u&&a(o.get(rg)),e){case"add":c?u&&a(o.get("length")):(a(o.get(Pc)),eh(t)&&a(o.get(GC)));break;case"delete":c||(a(o.get(Pc)),eh(t)&&a(o.get(GC)));break;case"set":eh(t)&&a(o.get(Pc));break}}_R()}function Bne(t,e){const n=xy.get(t);return n&&n.get(e)}function yu(t){const e=ut(t);return e===t?e:(us(e,"iterate",rg),mr(t)?e:e.map(Kn))}function Fw(t){return us(t=ut(t),"iterate",rg),t}const jne={__proto__:null,[Symbol.iterator](){return Yb(this,Symbol.iterator,Kn)},concat(...t){return yu(this).concat(...t.map(e=>xe(e)?yu(e):e))},entries(){return Yb(this,"entries",t=>(t[1]=Kn(t[1]),t))},every(t,e){return _o(this,"every",t,e,void 0,arguments)},filter(t,e){return _o(this,"filter",t,e,n=>n.map(Kn),arguments)},find(t,e){return _o(this,"find",t,e,Kn,arguments)},findIndex(t,e){return _o(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return _o(this,"findLast",t,e,Kn,arguments)},findLastIndex(t,e){return _o(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return _o(this,"forEach",t,e,void 0,arguments)},includes(...t){return Xb(this,"includes",t)},indexOf(...t){return Xb(this,"indexOf",t)},join(t){return yu(this).join(t)},lastIndexOf(...t){return Xb(this,"lastIndexOf",t)},map(t,e){return _o(this,"map",t,e,void 0,arguments)},pop(){return hf(this,"pop")},push(...t){return hf(this,"push",t)},reduce(t,...e){return zN(this,"reduce",t,e)},reduceRight(t,...e){return zN(this,"reduceRight",t,e)},shift(){return hf(this,"shift")},some(t,e){return _o(this,"some",t,e,void 0,arguments)},splice(...t){return hf(this,"splice",t)},toReversed(){return yu(this).toReversed()},toSorted(t){return yu(this).toSorted(t)},toSpliced(...t){return yu(this).toSpliced(...t)},unshift(...t){return hf(this,"unshift",t)},values(){return Yb(this,"values",Kn)}};function Yb(t,e,n){const s=Fw(t),r=s[e]();return s!==t&&!mr(t)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.value&&(i.value=n(i.value)),i}),r}const $ne=Array.prototype;function _o(t,e,n,s,r,i){const o=Fw(t),a=o!==t&&!mr(t),c=o[e];if(c!==$ne[e]){const d=c.apply(t,i);return a?Kn(d):d}let u=n;o!==t&&(a?u=function(d,p){return n.call(this,Kn(d),p,t)}:n.length>2&&(u=function(d,p){return n.call(this,d,p,t)}));const h=c.call(o,u,s);return a&&r?r(h):h}function zN(t,e,n,s){const r=Fw(t);let i=n;return r!==t&&(mr(t)?n.length>3&&(i=function(o,a,c){return n.call(this,o,a,c,t)}):i=function(o,a,c){return n.call(this,o,Kn(a),c,t)}),r[e](i,...s)}function Xb(t,e,n){const s=ut(t);us(s,"iterate",rg);const r=s[e](...n);return(r===-1||r===!1)&&bR(n[0])?(n[0]=ut(n[0]),s[e](...n)):r}function hf(t,e,n=[]){Qo(),mR();const s=ut(t)[e].apply(t,n);return _R(),Yo(),s}const zne=uR("__proto__,__v_isRef,__isVue"),m6=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Dl));function Hne(t){Dl(t)||(t=String(t));const e=ut(this);return us(e,"has",t),e.hasOwnProperty(t)}class _6{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return i;if(n==="__v_raw")return s===(r?i?tse:E6:i?w6:v6).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=xe(e);if(!r){let c;if(o&&(c=jne[n]))return c;if(n==="hasOwnProperty")return Hne}const a=Reflect.get(e,n,Qn(e)?e:s);return(Dl(n)?m6.has(n):zne(n))||(r||us(e,"get",n),i)?a:Qn(a)?o&&fR(n)?a:a.value:zt(a)?r?T6(a):Jh(a):a}}class y6 extends _6{constructor(e=!1){super(!1,e)}set(e,n,s,r){let i=e[n];if(!this._isShallow){const c=pl(i);if(!mr(s)&&!pl(s)&&(i=ut(i),s=ut(s)),!xe(e)&&Qn(i)&&!Qn(s))return c?!1:(i.value=s,!0)}const o=xe(e)&&fR(n)?Number(n)<e.length:wt(e,n),a=Reflect.set(e,n,s,Qn(e)?e:r);return e===ut(r)&&(o?za(s,i)&&ko(e,"set",n,s):ko(e,"add",n,s)),a}deleteProperty(e,n){const s=wt(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&s&&ko(e,"delete",n,void 0),r}has(e,n){const s=Reflect.has(e,n);return(!Dl(n)||!m6.has(n))&&us(e,"has",n),s}ownKeys(e){return us(e,"iterate",xe(e)?"length":Pc),Reflect.ownKeys(e)}}class Wne extends _6{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Kne=new y6,Gne=new Wne,Qne=new y6(!0);const QC=t=>t,Mm=t=>Reflect.getPrototypeOf(t);function Yne(t,e,n){return function(...s){const r=this.__v_raw,i=ut(r),o=eh(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=r[t](...s),h=n?QC:e?Dy:Kn;return!e&&us(i,"iterate",c?GC:Pc),{next(){const{value:d,done:p}=u.next();return p?{value:d,done:p}:{value:a?[h(d[0]),h(d[1])]:h(d),done:p}},[Symbol.iterator](){return this}}}}function Vm(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Xne(t,e){const n={get(r){const i=this.__v_raw,o=ut(i),a=ut(r);t||(za(r,a)&&us(o,"get",r),us(o,"get",a));const{has:c}=Mm(o),u=e?QC:t?Dy:Kn;if(c.call(o,r))return u(i.get(r));if(c.call(o,a))return u(i.get(a));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!t&&us(ut(r),"iterate",Pc),Reflect.get(r,"size",r)},has(r){const i=this.__v_raw,o=ut(i),a=ut(r);return t||(za(r,a)&&us(o,"has",r),us(o,"has",a)),r===a?i.has(r):i.has(r)||i.has(a)},forEach(r,i){const o=this,a=o.__v_raw,c=ut(a),u=e?QC:t?Dy:Kn;return!t&&us(c,"iterate",Pc),a.forEach((h,d)=>r.call(i,u(h),u(d),o))}};return Dn(n,t?{add:Vm("add"),set:Vm("set"),delete:Vm("delete"),clear:Vm("clear")}:{add(r){!e&&!mr(r)&&!pl(r)&&(r=ut(r));const i=ut(this);return Mm(i).has.call(i,r)||(i.add(r),ko(i,"add",r,r)),this},set(r,i){!e&&!mr(i)&&!pl(i)&&(i=ut(i));const o=ut(this),{has:a,get:c}=Mm(o);let u=a.call(o,r);u||(r=ut(r),u=a.call(o,r));const h=c.call(o,r);return o.set(r,i),u?za(i,h)&&ko(o,"set",r,i):ko(o,"add",r,i),this},delete(r){const i=ut(this),{has:o,get:a}=Mm(i);let c=o.call(i,r);c||(r=ut(r),c=o.call(i,r)),a&&a.call(i,r);const u=i.delete(r);return c&&ko(i,"delete",r,void 0),u},clear(){const r=ut(this),i=r.size!==0,o=r.clear();return i&&ko(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=Yne(r,t,e)}),n}function wR(t,e){const n=Xne(t,e);return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(wt(n,r)&&r in s?n:s,r,i)}const Jne={get:wR(!1,!1)},Zne={get:wR(!1,!0)},ese={get:wR(!0,!1)};const v6=new WeakMap,w6=new WeakMap,E6=new WeakMap,tse=new WeakMap;function nse(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function sse(t){return t.__v_skip||!Object.isExtensible(t)?0:nse(Sne(t))}function Jh(t){return pl(t)?t:ER(t,!1,Kne,Jne,v6)}function b6(t){return ER(t,!1,Qne,Zne,w6)}function T6(t){return ER(t,!0,Gne,ese,E6)}function ER(t,e,n,s,r){if(!zt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=sse(t);if(i===0)return t;const o=r.get(t);if(o)return o;const a=new Proxy(t,i===2?s:n);return r.set(t,a),a}function th(t){return pl(t)?th(t.__v_raw):!!(t&&t.__v_isReactive)}function pl(t){return!!(t&&t.__v_isReadonly)}function mr(t){return!!(t&&t.__v_isShallow)}function bR(t){return t?!!t.__v_raw:!1}function ut(t){const e=t&&t.__v_raw;return e?ut(e):t}function Zg(t){return!wt(t,"__v_skip")&&Object.isExtensible(t)&&WC(t,"__v_skip",!0),t}const Kn=t=>zt(t)?Jh(t):t,Dy=t=>zt(t)?T6(t):t;function Qn(t){return t?t.__v_isRef===!0:!1}function gl(t){return C6(t,!1)}function rse(t){return C6(t,!0)}function C6(t,e){return Qn(t)?t:new ise(t,e)}class ise{constructor(e,n){this.dep=new vR,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:ut(e),this._value=n?e:Kn(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||mr(e)||pl(e);e=s?e:ut(e),za(e,n)&&(this._rawValue=e,this._value=s?e:Kn(e),this.dep.trigger())}}function Nc(t){return Qn(t)?t.value:t}const ose={get:(t,e,n)=>e==="__v_raw"?t:Nc(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return Qn(r)&&!Qn(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function I6(t){return th(t)?t:new Proxy(t,ose)}function hve(t){const e=xe(t)?new Array(t.length):{};for(const n in t)e[n]=lse(t,n);return e}class ase{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return Bne(ut(this._object),this._key)}}function lse(t,e,n){const s=t[e];return Qn(s)?s:new ase(t,e,n)}class cse{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new vR(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=sg-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Dt!==this)return u6(this,!0),!0}get value(){const e=this.dep.track();return f6(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function use(t,e,n=!1){let s,r;return $e(t)?s=t:(s=t.get,r=t.set),new cse(s,r,n)}const Fm={},Oy=new WeakMap;let cc;function hse(t,e=!1,n=cc){if(n){let s=Oy.get(n);s||Oy.set(n,s=[]),s.push(t)}}function dse(t,e,n=kt){const{immediate:s,deep:r,once:i,scheduler:o,augmentJob:a,call:c}=n,u=q=>r?q:mr(q)||r===!1||r===0?Po(q,1):Po(q);let h,d,p,m,w=!1,R=!1;if(Qn(t)?(d=()=>t.value,w=mr(t)):th(t)?(d=()=>u(t),w=!0):xe(t)?(R=!0,w=t.some(q=>th(q)||mr(q)),d=()=>t.map(q=>{if(Qn(q))return q.value;if(th(q))return u(q);if($e(q))return c?c(q,2):q()})):$e(t)?e?d=c?()=>c(t,2):t:d=()=>{if(p){Qo();try{p()}finally{Yo()}}const q=cc;cc=h;try{return c?c(t,3,[m]):t(m)}finally{cc=q}}:d=Di,e&&r){const q=d,H=r===!0?1/0:r;d=()=>Po(q(),H)}const k=Fne(),O=()=>{h.stop(),k&&k.active&&dR(k.effects,h)};if(i&&e){const q=e;e=(...H)=>{q(...H),O()}}let M=R?new Array(t.length).fill(Fm):Fm;const F=q=>{if(!(!(h.flags&1)||!h.dirty&&!q))if(e){const H=h.run();if(r||w||(R?H.some((J,I)=>za(J,M[I])):za(H,M))){p&&p();const J=cc;cc=h;try{const I=[H,M===Fm?void 0:R&&M[0]===Fm?[]:M,m];M=H,c?c(e,3,I):e(...I)}finally{cc=J}}}else h.run()};return a&&a(F),h=new l6(d),h.scheduler=o?()=>o(F,!1):F,m=q=>hse(q,!1,h),p=h.onStop=()=>{const q=Oy.get(h);if(q){if(c)c(q,4);else for(const H of q)H();Oy.delete(h)}},e?s?F(!0):M=h.run():o?o(F.bind(null,!0),!0):h.run(),O.pause=h.pause.bind(h),O.resume=h.resume.bind(h),O.stop=O,O}function Po(t,e=1/0,n){if(e<=0||!zt(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,Qn(t))Po(t.value,e,n);else if(xe(t))for(let s=0;s<t.length;s++)Po(t[s],e,n);else if(e6(t)||eh(t))t.forEach(s=>{Po(s,e,n)});else if(s6(t)){for(const s in t)Po(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Po(t[s],e,n)}return t}/**
* @vue/runtime-core v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function em(t,e,n,s){try{return s?t(...s):t()}catch(r){Uw(r,e,n)}}function li(t,e,n,s){if($e(t)){const r=em(t,e,n,s);return r&&t6(r)&&r.catch(i=>{Uw(i,e,n)}),r}if(xe(t)){const r=[];for(let i=0;i<t.length;i++)r.push(li(t[i],e,n,s));return r}}function Uw(t,e,n,s=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||kt;if(e){let a=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](t,c,u)===!1)return}a=a.parent}if(i){Qo(),em(i,null,10,[t,c,u]),Yo();return}}fse(t,n,r,s,o)}function fse(t,e,n,s=!0,r=!1){if(r)throw t;console.error(t)}const Ps=[];let vi=-1;const nh=[];let Ta=null,Du=0;const S6=Promise.resolve();let Ly=null;function R6(t){const e=Ly||S6;return t?e.then(this?t.bind(this):t):e}function pse(t){let e=vi+1,n=Ps.length;for(;e<n;){const s=e+n>>>1,r=Ps[s],i=ig(r);i<t||i===t&&r.flags&2?e=s+1:n=s}return e}function TR(t){if(!(t.flags&1)){const e=ig(t),n=Ps[Ps.length-1];!n||!(t.flags&2)&&e>=ig(n)?Ps.push(t):Ps.splice(pse(e),0,t),t.flags|=1,A6()}}function A6(){Ly||(Ly=S6.then(P6))}function gse(t){xe(t)?nh.push(...t):Ta&&t.id===-1?Ta.splice(Du+1,0,t):t.flags&1||(nh.push(t),t.flags|=1),A6()}function HN(t,e,n=vi+1){for(;n<Ps.length;n++){const s=Ps[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Ps.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function k6(t){if(nh.length){const e=[...new Set(nh)].sort((n,s)=>ig(n)-ig(s));if(nh.length=0,Ta){Ta.push(...e);return}for(Ta=e,Du=0;Du<Ta.length;Du++){const n=Ta[Du];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Ta=null,Du=0}}const ig=t=>t.id==null?t.flags&2?-1:1/0:t.id;function P6(t){try{for(vi=0;vi<Ps.length;vi++){const e=Ps[vi];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),em(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;vi<Ps.length;vi++){const e=Ps[vi];e&&(e.flags&=-2)}vi=-1,Ps.length=0,k6(),Ly=null,(Ps.length||nh.length)&&P6()}}let sr=null,N6=null;function My(t){const e=sr;return sr=t,N6=t&&t.type.__scopeId||null,e}function mse(t,e=sr,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&ix(-1);const i=My(e);let o;try{o=t(...r)}finally{My(i),s._d&&ix(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function x6(t,e){if(sr===null)return t;const n=Hw(sr),s=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,a,c=kt]=e[r];i&&($e(i)&&(i={mounted:i,updated:i}),i.deep&&Po(o),s.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:c}))}return t}function tc(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let c=a.dir[s];c&&(Qo(),li(c,n,8,[t.el,a,t,e]),Yo())}}const D6=Symbol("_vte"),O6=t=>t.__isTeleport,cp=t=>t&&(t.disabled||t.disabled===""),WN=t=>t&&(t.defer||t.defer===""),KN=t=>typeof SVGElement<"u"&&t instanceof SVGElement,GN=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,YC=(t,e)=>{const n=t&&t.to;return an(n)?e?e(n):null:n},L6={name:"Teleport",__isTeleport:!0,process(t,e,n,s,r,i,o,a,c,u){const{mc:h,pc:d,pbc:p,o:{insert:m,querySelector:w,createText:R,createComment:k}}=u,O=cp(e.props);let{shapeFlag:M,children:F,dynamicChildren:q}=e;if(t==null){const H=e.el=R(""),J=e.anchor=R("");m(H,n,s),m(J,n,s);const I=(y,C)=>{M&16&&(r&&r.isCE&&(r.ce._teleportTarget=y),h(F,y,C,r,i,o,a,c))},v=()=>{const y=e.target=YC(e.props,w),C=M6(y,e,R,m);y&&(o!=="svg"&&KN(y)?o="svg":o!=="mathml"&&GN(y)&&(o="mathml"),O||(I(y,C),y_(e,!1)))};O&&(I(n,J),y_(e,!0)),WN(e.props)?(e.el.__isMounted=!1,As(()=>{v(),delete e.el.__isMounted},i)):v()}else{if(WN(e.props)&&t.el.__isMounted===!1){As(()=>{L6.process(t,e,n,s,r,i,o,a,c,u)},i);return}e.el=t.el,e.targetStart=t.targetStart;const H=e.anchor=t.anchor,J=e.target=t.target,I=e.targetAnchor=t.targetAnchor,v=cp(t.props),y=v?n:J,C=v?H:I;if(o==="svg"||KN(J)?o="svg":(o==="mathml"||GN(J))&&(o="mathml"),q?(p(t.dynamicChildren,q,y,r,i,o,a),PR(t,e,!0)):c||d(t,e,y,C,r,i,o,a,!1),O)v?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Um(e,n,H,u,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const S=e.target=YC(e.props,w);S&&Um(e,S,null,u,0)}else v&&Um(e,J,I,u,1);y_(e,O)}},remove(t,e,n,{um:s,o:{remove:r}},i){const{shapeFlag:o,children:a,anchor:c,targetStart:u,targetAnchor:h,target:d,props:p}=t;if(d&&(r(u),r(h)),i&&r(c),o&16){const m=i||!cp(p);for(let w=0;w<a.length;w++){const R=a[w];s(R,e,n,m,!!R.dynamicChildren)}}},move:Um,hydrate:_se};function Um(t,e,n,{o:{insert:s},m:r},i=2){i===0&&s(t.targetAnchor,e,n);const{el:o,anchor:a,shapeFlag:c,children:u,props:h}=t,d=i===2;if(d&&s(o,e,n),(!d||cp(h))&&c&16)for(let p=0;p<u.length;p++)r(u[p],e,n,2);d&&s(a,e,n)}function _se(t,e,n,s,r,i,{o:{nextSibling:o,parentNode:a,querySelector:c,insert:u,createText:h}},d){const p=e.target=YC(e.props,c);if(p){const m=cp(e.props),w=p._lpa||p.firstChild;if(e.shapeFlag&16)if(m)e.anchor=d(o(t),e,a(t),n,s,r,i),e.targetStart=w,e.targetAnchor=w&&o(w);else{e.anchor=o(t);let R=w;for(;R;){if(R&&R.nodeType===8){if(R.data==="teleport start anchor")e.targetStart=R;else if(R.data==="teleport anchor"){e.targetAnchor=R,p._lpa=e.targetAnchor&&o(e.targetAnchor);break}}R=o(R)}e.targetAnchor||M6(p,e,h,u),d(w&&o(w),e,p,n,s,r,i)}y_(e,m)}return e.anchor&&o(e.anchor)}const dve=L6;function y_(t,e){const n=t.ctx;if(n&&n.ut){let s,r;for(e?(s=t.el,r=t.anchor):(s=t.targetStart,r=t.targetAnchor);s&&s!==r;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function M6(t,e,n,s){const r=e.targetStart=n(""),i=e.targetAnchor=n("");return r[D6]=i,t&&(s(r,t),s(i,t)),i}const Ca=Symbol("_leaveCb"),qm=Symbol("_enterCb");function V6(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return IR(()=>{t.isMounted=!0}),SR(()=>{t.isUnmounting=!0}),t}const cr=[Function,Array],F6={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:cr,onEnter:cr,onAfterEnter:cr,onEnterCancelled:cr,onBeforeLeave:cr,onLeave:cr,onAfterLeave:cr,onLeaveCancelled:cr,onBeforeAppear:cr,onAppear:cr,onAfterAppear:cr,onAppearCancelled:cr},U6=t=>{const e=t.subTree;return e.component?U6(e.component):e},yse={name:"BaseTransition",props:F6,setup(t,{slots:e}){const n=lu(),s=V6();return()=>{const r=e.default&&CR(e.default(),!0);if(!r||!r.length)return;const i=q6(r),o=ut(t),{mode:a}=o;if(s.isLeaving)return Jb(i);const c=QN(i);if(!c)return Jb(i);let u=og(c,o,s,n,d=>u=d);c.type!==xs&&Hc(c,u);let h=n.subTree&&QN(n.subTree);if(h&&h.type!==xs&&!fc(c,h)&&U6(n).type!==xs){let d=og(h,o,s,n);if(Hc(h,d),a==="out-in"&&c.type!==xs)return s.isLeaving=!0,d.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete d.afterLeave,h=void 0},Jb(i);a==="in-out"&&c.type!==xs?d.delayLeave=(p,m,w)=>{const R=B6(s,h);R[String(h.key)]=h,p[Ca]=()=>{m(),p[Ca]=void 0,delete u.delayedLeave,h=void 0},u.delayedLeave=()=>{w(),delete u.delayedLeave,h=void 0}}:h=void 0}else h&&(h=void 0);return i}}};function q6(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==xs){e=n;break}}return e}const vse=yse;function B6(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function og(t,e,n,s,r){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:h,onEnterCancelled:d,onBeforeLeave:p,onLeave:m,onAfterLeave:w,onLeaveCancelled:R,onBeforeAppear:k,onAppear:O,onAfterAppear:M,onAppearCancelled:F}=e,q=String(t.key),H=B6(n,t),J=(y,C)=>{y&&li(y,s,9,C)},I=(y,C)=>{const S=C[1];J(y,C),xe(y)?y.every(T=>T.length<=1)&&S():y.length<=1&&S()},v={mode:o,persisted:a,beforeEnter(y){let C=c;if(!n.isMounted)if(i)C=k||c;else return;y[Ca]&&y[Ca](!0);const S=H[q];S&&fc(t,S)&&S.el[Ca]&&S.el[Ca](),J(C,[y])},enter(y){let C=u,S=h,T=d;if(!n.isMounted)if(i)C=O||u,S=M||h,T=F||d;else return;let E=!1;const K=y[qm]=oe=>{E||(E=!0,oe?J(T,[y]):J(S,[y]),v.delayedLeave&&v.delayedLeave(),y[qm]=void 0)};C?I(C,[y,K]):K()},leave(y,C){const S=String(t.key);if(y[qm]&&y[qm](!0),n.isUnmounting)return C();J(p,[y]);let T=!1;const E=y[Ca]=K=>{T||(T=!0,C(),K?J(R,[y]):J(w,[y]),y[Ca]=void 0,H[S]===t&&delete H[S])};H[S]=t,m?I(m,[y,E]):E()},clone(y){const C=og(y,e,n,s,r);return r&&r(C),C}};return v}function Jb(t){if(Bw(t))return t=ml(t),t.children=null,t}function QN(t){if(!Bw(t))return O6(t.type)&&t.children?q6(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&$e(n.default))return n.default()}}function Hc(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Hc(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function CR(t,e=!1,n){let s=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===Mr?(o.patchFlag&128&&r++,s=s.concat(CR(o.children,e,a))):(e||o.type!==xs)&&s.push(a!=null?ml(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}/*! #__NO_SIDE_EFFECTS__ */function qw(t,e){return $e(t)?Dn({name:t.name},e,{setup:t}):t}function j6(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function up(t,e,n,s,r=!1){if(xe(t)){t.forEach((w,R)=>up(w,e&&(xe(e)?e[R]:e),n,s,r));return}if(hp(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&up(t,e,n,s.component.subTree);return}const i=s.shapeFlag&4?Hw(s.component):s.el,o=r?null:i,{i:a,r:c}=t,u=e&&e.r,h=a.refs===kt?a.refs={}:a.refs,d=a.setupState,p=ut(d),m=d===kt?()=>!1:w=>wt(p,w);if(u!=null&&u!==c&&(an(u)?(h[u]=null,m(u)&&(d[u]=null)):Qn(u)&&(u.value=null)),$e(c))em(c,a,12,[o,h]);else{const w=an(c),R=Qn(c);if(w||R){const k=()=>{if(t.f){const O=w?m(c)?d[c]:h[c]:c.value;r?xe(O)&&dR(O,i):xe(O)?O.includes(i)||O.push(i):w?(h[c]=[i],m(c)&&(d[c]=h[c])):(c.value=[i],t.k&&(h[t.k]=c.value))}else w?(h[c]=o,m(c)&&(d[c]=o)):R&&(c.value=o,t.k&&(h[t.k]=o))};o?(k.id=-1,As(k,n)):k()}}}Vw().requestIdleCallback;Vw().cancelIdleCallback;const hp=t=>!!t.type.__asyncLoader,Bw=t=>t.type.__isKeepAlive;function wse(t,e){$6(t,"a",e)}function Ese(t,e){$6(t,"da",e)}function $6(t,e,n=ps){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(jw(e,s,n),n){let r=n.parent;for(;r&&r.parent;)Bw(r.parent.vnode)&&bse(s,e,n,r),r=r.parent}}function bse(t,e,n,s){const r=jw(e,t,s,!0);RR(()=>{dR(s[e],r)},n)}function jw(t,e,n=ps,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{Qo();const a=tm(n),c=li(e,n,t,o);return a(),Yo(),c});return s?r.unshift(i):r.push(i),i}}const oa=t=>(e,n=ps)=>{(!lg||t==="sp")&&jw(t,(...s)=>e(...s),n)},Tse=oa("bm"),IR=oa("m"),Cse=oa("bu"),z6=oa("u"),SR=oa("bum"),RR=oa("um"),Ise=oa("sp"),Sse=oa("rtg"),Rse=oa("rtc");function Ase(t,e=ps){jw("ec",t,e)}const kse="components";function Pse(t,e){return xse(kse,t,!0,e)||t}const Nse=Symbol.for("v-ndc");function xse(t,e,n=!0,s=!1){const r=sr||ps;if(r){const i=r.type;{const a=Ere(i,!1);if(a&&(a===e||a===wr(e)||a===Mw(wr(e))))return i}const o=YN(r[t]||i[t],e)||YN(r.appContext[t],e);return!o&&s?i:o}}function YN(t,e){return t&&(t[e]||t[wr(e)]||t[Mw(wr(e))])}function fve(t,e,n,s){let r;const i=n,o=xe(t);if(o||an(t)){const a=o&&th(t);let c=!1,u=!1;a&&(c=!mr(t),u=pl(t),t=Fw(t)),r=new Array(t.length);for(let h=0,d=t.length;h<d;h++)r[h]=e(c?u?Dy(Kn(t[h])):Kn(t[h]):t[h],h,void 0,i)}else if(typeof t=="number"){r=new Array(t);for(let a=0;a<t;a++)r[a]=e(a+1,a,void 0,i)}else if(zt(t))if(t[Symbol.iterator])r=Array.from(t,(a,c)=>e(a,c,void 0,i));else{const a=Object.keys(t);r=new Array(a.length);for(let c=0,u=a.length;c<u;c++){const h=a[c];r[c]=e(t[h],h,c,i)}}else r=[];return r}const XC=t=>t?h9(t)?Hw(t):XC(t.parent):null,dp=Dn(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>XC(t.parent),$root:t=>XC(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>W6(t),$forceUpdate:t=>t.f||(t.f=()=>{TR(t.update)}),$nextTick:t=>t.n||(t.n=R6.bind(t.proxy)),$watch:t=>Zse.bind(t)}),Zb=(t,e)=>t!==kt&&!t.__isScriptSetup&&wt(t,e),Dse={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:c}=t;let u;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(Zb(s,e))return o[e]=1,s[e];if(r!==kt&&wt(r,e))return o[e]=2,r[e];if((u=t.propsOptions[0])&&wt(u,e))return o[e]=3,i[e];if(n!==kt&&wt(n,e))return o[e]=4,n[e];JC&&(o[e]=0)}}const h=dp[e];let d,p;if(h)return e==="$attrs"&&us(t.attrs,"get",""),h(t);if((d=a.__cssModules)&&(d=d[e]))return d;if(n!==kt&&wt(n,e))return o[e]=4,n[e];if(p=c.config.globalProperties,wt(p,e))return p[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return Zb(r,e)?(r[e]=n,!0):s!==kt&&wt(s,e)?(s[e]=n,!0):wt(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!n[o]||t!==kt&&wt(t,o)||Zb(e,o)||(a=i[0])&&wt(a,o)||wt(s,o)||wt(dp,o)||wt(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:wt(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function XN(t){return xe(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let JC=!0;function Ose(t){const e=W6(t),n=t.proxy,s=t.ctx;JC=!1,e.beforeCreate&&JN(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:c,inject:u,created:h,beforeMount:d,mounted:p,beforeUpdate:m,updated:w,activated:R,deactivated:k,beforeDestroy:O,beforeUnmount:M,destroyed:F,unmounted:q,render:H,renderTracked:J,renderTriggered:I,errorCaptured:v,serverPrefetch:y,expose:C,inheritAttrs:S,components:T,directives:E,filters:K}=e;if(u&&Lse(u,s,null),o)for(const de in o){const ve=o[de];$e(ve)&&(s[de]=ve.bind(n))}if(r){const de=r.call(n,n);zt(de)&&(t.data=Jh(de))}if(JC=!0,i)for(const de in i){const ve=i[de],Kt=$e(ve)?ve.bind(n,n):$e(ve.get)?ve.get.bind(n,n):Di,Ht=!$e(ve)&&$e(ve.set)?ve.set.bind(n):Di,Wt=Ee({get:Kt,set:Ht});Object.defineProperty(s,de,{enumerable:!0,configurable:!0,get:()=>Wt.value,set:Fe=>Wt.value=Fe})}if(a)for(const de in a)H6(a[de],s,n,de);if(c){const de=$e(c)?c.call(n):c;Reflect.ownKeys(de).forEach(ve=>{v_(ve,de[ve])})}h&&JN(h,t,"c");function ge(de,ve){xe(ve)?ve.forEach(Kt=>de(Kt.bind(n))):ve&&de(ve.bind(n))}if(ge(Tse,d),ge(IR,p),ge(Cse,m),ge(z6,w),ge(wse,R),ge(Ese,k),ge(Ase,v),ge(Rse,J),ge(Sse,I),ge(SR,M),ge(RR,q),ge(Ise,y),xe(C))if(C.length){const de=t.exposed||(t.exposed={});C.forEach(ve=>{Object.defineProperty(de,ve,{get:()=>n[ve],set:Kt=>n[ve]=Kt,enumerable:!0})})}else t.exposed||(t.exposed={});H&&t.render===Di&&(t.render=H),S!=null&&(t.inheritAttrs=S),T&&(t.components=T),E&&(t.directives=E),y&&j6(t)}function Lse(t,e,n=Di){xe(t)&&(t=ZC(t));for(const s in t){const r=t[s];let i;zt(r)?"default"in r?i=_r(r.from||s,r.default,!0):i=_r(r.from||s):i=_r(r),Qn(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function JN(t,e,n){li(xe(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function H6(t,e,n,s){let r=s.includes(".")?r9(n,s):()=>n[s];if(an(t)){const i=e[t];$e(i)&&fp(r,i)}else if($e(t))fp(r,t.bind(n));else if(zt(t))if(xe(t))t.forEach(i=>H6(i,e,n,s));else{const i=$e(t.handler)?t.handler.bind(n):e[t.handler];$e(i)&&fp(r,i,t)}}function W6(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!r.length&&!n&&!s?c=e:(c={},r.length&&r.forEach(u=>Vy(c,u,o,!0)),Vy(c,e,o)),zt(e)&&i.set(e,c),c}function Vy(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&Vy(t,i,n,!0),r&&r.forEach(o=>Vy(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=Mse[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Mse={data:ZN,props:ex,emits:ex,methods:Pf,computed:Pf,beforeCreate:Ss,created:Ss,beforeMount:Ss,mounted:Ss,beforeUpdate:Ss,updated:Ss,beforeDestroy:Ss,beforeUnmount:Ss,destroyed:Ss,unmounted:Ss,activated:Ss,deactivated:Ss,errorCaptured:Ss,serverPrefetch:Ss,components:Pf,directives:Pf,watch:Fse,provide:ZN,inject:Vse};function ZN(t,e){return e?t?function(){return Dn($e(t)?t.call(this,this):t,$e(e)?e.call(this,this):e)}:e:t}function Vse(t,e){return Pf(ZC(t),ZC(e))}function ZC(t){if(xe(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Ss(t,e){return t?[...new Set([].concat(t,e))]:e}function Pf(t,e){return t?Dn(Object.create(null),t,e):e}function ex(t,e){return t?xe(t)&&xe(e)?[...new Set([...t,...e])]:Dn(Object.create(null),XN(t),XN(e??{})):e}function Fse(t,e){if(!t)return e;if(!e)return t;const n=Dn(Object.create(null),t);for(const s in e)n[s]=Ss(t[s],e[s]);return n}function K6(){return{app:null,config:{isNativeTag:Cne,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Use=0;function qse(t,e){return function(s,r=null){$e(s)||(s=Dn({},s)),r!=null&&!zt(r)&&(r=null);const i=K6(),o=new WeakSet,a=[];let c=!1;const u=i.app={_uid:Use++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:Tre,get config(){return i.config},set config(h){},use(h,...d){return o.has(h)||(h&&$e(h.install)?(o.add(h),h.install(u,...d)):$e(h)&&(o.add(h),h(u,...d))),u},mixin(h){return i.mixins.includes(h)||i.mixins.push(h),u},component(h,d){return d?(i.components[h]=d,u):i.components[h]},directive(h,d){return d?(i.directives[h]=d,u):i.directives[h]},mount(h,d,p){if(!c){const m=u._ceVNode||Ls(s,r);return m.appContext=i,p===!0?p="svg":p===!1&&(p=void 0),t(m,h,p),c=!0,u._container=h,h.__vue_app__=u,Hw(m.component)}},onUnmount(h){a.push(h)},unmount(){c&&(li(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(h,d){return i.provides[h]=d,u},runWithContext(h){const d=xc;xc=u;try{return h()}finally{xc=d}}};return u}}let xc=null;function v_(t,e){if(ps){let n=ps.provides;const s=ps.parent&&ps.parent.provides;s===n&&(n=ps.provides=Object.create(s)),n[t]=e}}function _r(t,e,n=!1){const s=lu();if(s||xc){let r=xc?xc._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&$e(e)?e.call(s&&s.proxy):e}}function pve(){return!!(lu()||xc)}const G6={},Q6=()=>Object.create(G6),Y6=t=>Object.getPrototypeOf(t)===G6;function Bse(t,e,n,s=!1){const r={},i=Q6();t.propsDefaults=Object.create(null),X6(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:b6(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function jse(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=ut(r),[c]=t.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let d=0;d<h.length;d++){let p=h[d];if($w(t.emitsOptions,p))continue;const m=e[p];if(c)if(wt(i,p))m!==i[p]&&(i[p]=m,u=!0);else{const w=wr(p);r[w]=eI(c,a,w,m,t,!1)}else m!==i[p]&&(i[p]=m,u=!0)}}}else{X6(t,e,r,i)&&(u=!0);let h;for(const d in a)(!e||!wt(e,d)&&((h=au(d))===d||!wt(e,h)))&&(c?n&&(n[d]!==void 0||n[h]!==void 0)&&(r[d]=eI(c,a,d,void 0,t,!0)):delete r[d]);if(i!==a)for(const d in i)(!e||!wt(e,d))&&(delete i[d],u=!0)}u&&ko(t.attrs,"set","")}function X6(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(op(c))continue;const u=e[c];let h;r&&wt(r,h=wr(c))?!i||!i.includes(h)?n[h]=u:(a||(a={}))[h]=u:$w(t.emitsOptions,c)||(!(c in s)||u!==s[c])&&(s[c]=u,o=!0)}if(i){const c=ut(n),u=a||kt;for(let h=0;h<i.length;h++){const d=i[h];n[d]=eI(r,c,d,u[d],t,!wt(u,d))}}return o}function eI(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=wt(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&$e(c)){const{propsDefaults:u}=r;if(n in u)s=u[n];else{const h=tm(r);s=u[n]=c.call(null,e),h()}}else s=c;r.ce&&r.ce._setProp(n,s)}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===au(n))&&(s=!0))}return s}const $se=new WeakMap;function J6(t,e,n=!1){const s=n?$se:e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let c=!1;if(!$e(t)){const h=d=>{c=!0;const[p,m]=J6(d,e,!0);Dn(o,p),m&&a.push(...m)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!i&&!c)return zt(t)&&s.set(t,Zu),Zu;if(xe(i))for(let h=0;h<i.length;h++){const d=wr(i[h]);tx(d)&&(o[d]=kt)}else if(i)for(const h in i){const d=wr(h);if(tx(d)){const p=i[h],m=o[d]=xe(p)||$e(p)?{type:p}:Dn({},p),w=m.type;let R=!1,k=!0;if(xe(w))for(let O=0;O<w.length;++O){const M=w[O],F=$e(M)&&M.name;if(F==="Boolean"){R=!0;break}else F==="String"&&(k=!1)}else R=$e(w)&&w.name==="Boolean";m[0]=R,m[1]=k,(R||wt(m,"default"))&&a.push(d)}}const u=[o,a];return zt(t)&&s.set(t,u),u}function tx(t){return t[0]!=="$"&&!op(t)}const AR=t=>t==="_"||t==="__"||t==="_ctx"||t==="$stable",kR=t=>xe(t)?t.map(Ti):[Ti(t)],zse=(t,e,n)=>{if(e._n)return e;const s=mse((...r)=>kR(e(...r)),n);return s._c=!1,s},Z6=(t,e,n)=>{const s=t._ctx;for(const r in t){if(AR(r))continue;const i=t[r];if($e(i))e[r]=zse(r,i,s);else if(i!=null){const o=kR(i);e[r]=()=>o}}},e9=(t,e)=>{const n=kR(e);t.slots.default=()=>n},t9=(t,e,n)=>{for(const s in e)(n||!AR(s))&&(t[s]=e[s])},Hse=(t,e,n)=>{const s=t.slots=Q6();if(t.vnode.shapeFlag&32){const r=e.__;r&&WC(s,"__",r,!0);const i=e._;i?(t9(s,e,n),n&&WC(s,"_",i,!0)):Z6(e,s)}else e&&e9(t,e)},Wse=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=kt;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:t9(r,e,n):(i=!e.$stable,Z6(e,r)),o=e}else e&&(e9(t,e),o={default:1});if(i)for(const a in r)!AR(a)&&o[a]==null&&delete r[a]},As=ore;function Kse(t){return Gse(t)}function Gse(t,e){const n=Vw();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:c,setText:u,setElementText:h,parentNode:d,nextSibling:p,setScopeId:m=Di,insertStaticContent:w}=t,R=(b,A,N,L=null,U=null,B=null,G=void 0,$=null,j=!!A.dynamicChildren)=>{if(b===A)return;b&&!fc(b,A)&&(L=V(b),Fe(b,U,B,!0),b=null),A.patchFlag===-2&&(j=!1,A.dynamicChildren=null);const{type:W,ref:Z,shapeFlag:X}=A;switch(W){case zw:k(b,A,N,L);break;case xs:O(b,A,N,L);break;case tT:b==null&&M(A,N,L,G);break;case Mr:T(b,A,N,L,U,B,G,$,j);break;default:X&1?H(b,A,N,L,U,B,G,$,j):X&6?E(b,A,N,L,U,B,G,$,j):(X&64||X&128)&&W.process(b,A,N,L,U,B,G,$,j,ee)}Z!=null&&U?up(Z,b&&b.ref,B,A||b,!A):Z==null&&b&&b.ref!=null&&up(b.ref,null,B,b,!0)},k=(b,A,N,L)=>{if(b==null)s(A.el=a(A.children),N,L);else{const U=A.el=b.el;A.children!==b.children&&u(U,A.children)}},O=(b,A,N,L)=>{b==null?s(A.el=c(A.children||""),N,L):A.el=b.el},M=(b,A,N,L)=>{[b.el,b.anchor]=w(b.children,A,N,L,b.el,b.anchor)},F=({el:b,anchor:A},N,L)=>{let U;for(;b&&b!==A;)U=p(b),s(b,N,L),b=U;s(A,N,L)},q=({el:b,anchor:A})=>{let N;for(;b&&b!==A;)N=p(b),r(b),b=N;r(A)},H=(b,A,N,L,U,B,G,$,j)=>{A.type==="svg"?G="svg":A.type==="math"&&(G="mathml"),b==null?J(A,N,L,U,B,G,$,j):y(b,A,U,B,G,$,j)},J=(b,A,N,L,U,B,G,$)=>{let j,W;const{props:Z,shapeFlag:X,transition:ne,dirs:ce}=b;if(j=b.el=o(b.type,B,Z&&Z.is,Z),X&8?h(j,b.children):X&16&&v(b.children,j,null,L,U,eT(b,B),G,$),ce&&tc(b,null,L,"created"),I(j,b,b.scopeId,G,L),Z){for(const le in Z)le!=="value"&&!op(le)&&i(j,le,null,Z[le],B,L);"value"in Z&&i(j,"value",null,Z.value,B),(W=Z.onVnodeBeforeMount)&&fi(W,L,b)}ce&&tc(b,null,L,"beforeMount");const ae=Qse(U,ne);ae&&ne.beforeEnter(j),s(j,A,N),((W=Z&&Z.onVnodeMounted)||ae||ce)&&As(()=>{W&&fi(W,L,b),ae&&ne.enter(j),ce&&tc(b,null,L,"mounted")},U)},I=(b,A,N,L,U)=>{if(N&&m(b,N),L)for(let B=0;B<L.length;B++)m(b,L[B]);if(U){let B=U.subTree;if(A===B||o9(B.type)&&(B.ssContent===A||B.ssFallback===A)){const G=U.vnode;I(b,G,G.scopeId,G.slotScopeIds,U.parent)}}},v=(b,A,N,L,U,B,G,$,j=0)=>{for(let W=j;W<b.length;W++){const Z=b[W]=$?Ia(b[W]):Ti(b[W]);R(null,Z,A,N,L,U,B,G,$)}},y=(b,A,N,L,U,B,G)=>{const $=A.el=b.el;let{patchFlag:j,dynamicChildren:W,dirs:Z}=A;j|=b.patchFlag&16;const X=b.props||kt,ne=A.props||kt;let ce;if(N&&nc(N,!1),(ce=ne.onVnodeBeforeUpdate)&&fi(ce,N,A,b),Z&&tc(A,b,N,"beforeUpdate"),N&&nc(N,!0),(X.innerHTML&&ne.innerHTML==null||X.textContent&&ne.textContent==null)&&h($,""),W?C(b.dynamicChildren,W,$,N,L,eT(A,U),B):G||ve(b,A,$,null,N,L,eT(A,U),B,!1),j>0){if(j&16)S($,X,ne,N,U);else if(j&2&&X.class!==ne.class&&i($,"class",null,ne.class,U),j&4&&i($,"style",X.style,ne.style,U),j&8){const ae=A.dynamicProps;for(let le=0;le<ae.length;le++){const we=ae[le],rt=X[we],pt=ne[we];(pt!==rt||we==="value")&&i($,we,rt,pt,U,N)}}j&1&&b.children!==A.children&&h($,A.children)}else!G&&W==null&&S($,X,ne,N,U);((ce=ne.onVnodeUpdated)||Z)&&As(()=>{ce&&fi(ce,N,A,b),Z&&tc(A,b,N,"updated")},L)},C=(b,A,N,L,U,B,G)=>{for(let $=0;$<A.length;$++){const j=b[$],W=A[$],Z=j.el&&(j.type===Mr||!fc(j,W)||j.shapeFlag&198)?d(j.el):N;R(j,W,Z,null,L,U,B,G,!0)}},S=(b,A,N,L,U)=>{if(A!==N){if(A!==kt)for(const B in A)!op(B)&&!(B in N)&&i(b,B,A[B],null,U,L);for(const B in N){if(op(B))continue;const G=N[B],$=A[B];G!==$&&B!=="value"&&i(b,B,$,G,U,L)}"value"in N&&i(b,"value",A.value,N.value,U)}},T=(b,A,N,L,U,B,G,$,j)=>{const W=A.el=b?b.el:a(""),Z=A.anchor=b?b.anchor:a("");let{patchFlag:X,dynamicChildren:ne,slotScopeIds:ce}=A;ce&&($=$?$.concat(ce):ce),b==null?(s(W,N,L),s(Z,N,L),v(A.children||[],N,Z,U,B,G,$,j)):X>0&&X&64&&ne&&b.dynamicChildren?(C(b.dynamicChildren,ne,N,U,B,G,$),(A.key!=null||U&&A===U.subTree)&&PR(b,A,!0)):ve(b,A,N,Z,U,B,G,$,j)},E=(b,A,N,L,U,B,G,$,j)=>{A.slotScopeIds=$,b==null?A.shapeFlag&512?U.ctx.activate(A,N,L,G,j):K(A,N,L,U,B,G,j):oe(b,A,j)},K=(b,A,N,L,U,B,G)=>{const $=b.component=mre(b,L,U);if(Bw(b)&&($.ctx.renderer=ee),_re($,!1,G),$.asyncDep){if(U&&U.registerDep($,ge,G),!b.el){const j=$.subTree=Ls(xs);O(null,j,A,N),b.placeholder=j.el}}else ge($,b,A,N,U,B,G)},oe=(b,A,N)=>{const L=A.component=b.component;if(rre(b,A,N))if(L.asyncDep&&!L.asyncResolved){de(L,A,N);return}else L.next=A,L.update();else A.el=b.el,L.vnode=A},ge=(b,A,N,L,U,B,G)=>{const $=()=>{if(b.isMounted){let{next:X,bu:ne,u:ce,parent:ae,vnode:le}=b;{const Ct=n9(b);if(Ct){X&&(X.el=le.el,de(b,X,G)),Ct.asyncDep.then(()=>{b.isUnmounted||$()});return}}let we=X,rt;nc(b,!1),X?(X.el=le.el,de(b,X,G)):X=le,ne&&Kb(ne),(rt=X.props&&X.props.onVnodeBeforeUpdate)&&fi(rt,ae,X,le),nc(b,!0);const pt=sx(b),Mt=b.subTree;b.subTree=pt,R(Mt,pt,d(Mt.el),V(Mt),b,U,B),X.el=pt.el,we===null&&ire(b,pt.el),ce&&As(ce,U),(rt=X.props&&X.props.onVnodeUpdated)&&As(()=>fi(rt,ae,X,le),U)}else{let X;const{el:ne,props:ce}=A,{bm:ae,m:le,parent:we,root:rt,type:pt}=b,Mt=hp(A);nc(b,!1),ae&&Kb(ae),!Mt&&(X=ce&&ce.onVnodeBeforeMount)&&fi(X,we,A),nc(b,!0);{rt.ce&&rt.ce._def.shadowRoot!==!1&&rt.ce._injectChildStyle(pt);const Ct=b.subTree=sx(b);R(null,Ct,N,L,b,U,B),A.el=Ct.el}if(le&&As(le,U),!Mt&&(X=ce&&ce.onVnodeMounted)){const Ct=A;As(()=>fi(X,we,Ct),U)}(A.shapeFlag&256||we&&hp(we.vnode)&&we.vnode.shapeFlag&256)&&b.a&&As(b.a,U),b.isMounted=!0,A=N=L=null}};b.scope.on();const j=b.effect=new l6($);b.scope.off();const W=b.update=j.run.bind(j),Z=b.job=j.runIfDirty.bind(j);Z.i=b,Z.id=b.uid,j.scheduler=()=>TR(Z),nc(b,!0),W()},de=(b,A,N)=>{A.component=b;const L=b.vnode.props;b.vnode=A,b.next=null,jse(b,A.props,L,N),Wse(b,A.children,N),Qo(),HN(b),Yo()},ve=(b,A,N,L,U,B,G,$,j=!1)=>{const W=b&&b.children,Z=b?b.shapeFlag:0,X=A.children,{patchFlag:ne,shapeFlag:ce}=A;if(ne>0){if(ne&128){Ht(W,X,N,L,U,B,G,$,j);return}else if(ne&256){Kt(W,X,N,L,U,B,G,$,j);return}}ce&8?(Z&16&&Tt(W,U,B),X!==W&&h(N,X)):Z&16?ce&16?Ht(W,X,N,L,U,B,G,$,j):Tt(W,U,B,!0):(Z&8&&h(N,""),ce&16&&v(X,N,L,U,B,G,$,j))},Kt=(b,A,N,L,U,B,G,$,j)=>{b=b||Zu,A=A||Zu;const W=b.length,Z=A.length,X=Math.min(W,Z);let ne;for(ne=0;ne<X;ne++){const ce=A[ne]=j?Ia(A[ne]):Ti(A[ne]);R(b[ne],ce,N,null,U,B,G,$,j)}W>Z?Tt(b,U,B,!0,!1,X):v(A,N,L,U,B,G,$,j,X)},Ht=(b,A,N,L,U,B,G,$,j)=>{let W=0;const Z=A.length;let X=b.length-1,ne=Z-1;for(;W<=X&&W<=ne;){const ce=b[W],ae=A[W]=j?Ia(A[W]):Ti(A[W]);if(fc(ce,ae))R(ce,ae,N,null,U,B,G,$,j);else break;W++}for(;W<=X&&W<=ne;){const ce=b[X],ae=A[ne]=j?Ia(A[ne]):Ti(A[ne]);if(fc(ce,ae))R(ce,ae,N,null,U,B,G,$,j);else break;X--,ne--}if(W>X){if(W<=ne){const ce=ne+1,ae=ce<Z?A[ce].el:L;for(;W<=ne;)R(null,A[W]=j?Ia(A[W]):Ti(A[W]),N,ae,U,B,G,$,j),W++}}else if(W>ne)for(;W<=X;)Fe(b[W],U,B,!0),W++;else{const ce=W,ae=W,le=new Map;for(W=ae;W<=ne;W++){const ht=A[W]=j?Ia(A[W]):Ti(A[W]);ht.key!=null&&le.set(ht.key,W)}let we,rt=0;const pt=ne-ae+1;let Mt=!1,Ct=0;const Us=new Array(pt);for(W=0;W<pt;W++)Us[W]=0;for(W=ce;W<=X;W++){const ht=b[W];if(rt>=pt){Fe(ht,U,B,!0);continue}let jn;if(ht.key!=null)jn=le.get(ht.key);else for(we=ae;we<=ne;we++)if(Us[we-ae]===0&&fc(ht,A[we])){jn=we;break}jn===void 0?Fe(ht,U,B,!0):(Us[jn-ae]=W+1,jn>=Ct?Ct=jn:Mt=!0,R(ht,A[jn],N,null,U,B,G,$,j),rt++)}const Jt=Mt?Yse(Us):Zu;for(we=Jt.length-1,W=pt-1;W>=0;W--){const ht=ae+W,jn=A[ht],Ji=A[ht+1],ui=ht+1<Z?Ji.el||Ji.placeholder:L;Us[W]===0?R(null,jn,N,ui,U,B,G,$,j):Mt&&(we<0||W!==Jt[we]?Wt(jn,N,ui,2):we--)}}},Wt=(b,A,N,L,U=null)=>{const{el:B,type:G,transition:$,children:j,shapeFlag:W}=b;if(W&6){Wt(b.component.subTree,A,N,L);return}if(W&128){b.suspense.move(A,N,L);return}if(W&64){G.move(b,A,N,ee);return}if(G===Mr){s(B,A,N);for(let X=0;X<j.length;X++)Wt(j[X],A,N,L);s(b.anchor,A,N);return}if(G===tT){F(b,A,N);return}if(L!==2&&W&1&&$)if(L===0)$.beforeEnter(B),s(B,A,N),As(()=>$.enter(B),U);else{const{leave:X,delayLeave:ne,afterLeave:ce}=$,ae=()=>{b.ctx.isUnmounted?r(B):s(B,A,N)},le=()=>{X(B,()=>{ae(),ce&&ce()})};ne?ne(B,ae,le):le()}else s(B,A,N)},Fe=(b,A,N,L=!1,U=!1)=>{const{type:B,props:G,ref:$,children:j,dynamicChildren:W,shapeFlag:Z,patchFlag:X,dirs:ne,cacheIndex:ce}=b;if(X===-2&&(U=!1),$!=null&&(Qo(),up($,null,N,b,!0),Yo()),ce!=null&&(A.renderCache[ce]=void 0),Z&256){A.ctx.deactivate(b);return}const ae=Z&1&&ne,le=!hp(b);let we;if(le&&(we=G&&G.onVnodeBeforeUnmount)&&fi(we,A,b),Z&6)hn(b.component,N,L);else{if(Z&128){b.suspense.unmount(N,L);return}ae&&tc(b,null,A,"beforeUnmount"),Z&64?b.type.remove(b,A,N,ee,L):W&&!W.hasOnce&&(B!==Mr||X>0&&X&64)?Tt(W,A,N,!1,!0):(B===Mr&&X&384||!U&&Z&16)&&Tt(j,A,N),L&&De(b)}(le&&(we=G&&G.onVnodeUnmounted)||ae)&&As(()=>{we&&fi(we,A,b),ae&&tc(b,null,A,"unmounted")},N)},De=b=>{const{type:A,el:N,anchor:L,transition:U}=b;if(A===Mr){Bn(N,L);return}if(A===tT){q(b);return}const B=()=>{r(N),U&&!U.persisted&&U.afterLeave&&U.afterLeave()};if(b.shapeFlag&1&&U&&!U.persisted){const{leave:G,delayLeave:$}=U,j=()=>G(N,B);$?$(b.el,B,j):j()}else B()},Bn=(b,A)=>{let N;for(;b!==A;)N=p(b),r(b),b=N;r(A)},hn=(b,A,N)=>{const{bum:L,scope:U,job:B,subTree:G,um:$,m:j,a:W,parent:Z,slots:{__:X}}=b;nx(j),nx(W),L&&Kb(L),Z&&xe(X)&&X.forEach(ne=>{Z.renderCache[ne]=void 0}),U.stop(),B&&(B.flags|=8,Fe(G,b,A,N)),$&&As($,A),As(()=>{b.isUnmounted=!0},A),A&&A.pendingBranch&&!A.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===A.pendingId&&(A.deps--,A.deps===0&&A.resolve())},Tt=(b,A,N,L=!1,U=!1,B=0)=>{for(let G=B;G<b.length;G++)Fe(b[G],A,N,L,U)},V=b=>{if(b.shapeFlag&6)return V(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const A=p(b.anchor||b.el),N=A&&A[D6];return N?p(N):A};let Y=!1;const Q=(b,A,N)=>{b==null?A._vnode&&Fe(A._vnode,null,null,!0):R(A._vnode||null,b,A,null,null,null,N),A._vnode=b,Y||(Y=!0,HN(),k6(),Y=!1)},ee={p:R,um:Fe,m:Wt,r:De,mt:K,mc:v,pc:ve,pbc:C,n:V,o:t};return{render:Q,hydrate:void 0,createApp:qse(Q)}}function eT({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function nc({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Qse(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function PR(t,e,n=!1){const s=t.children,r=e.children;if(xe(s)&&xe(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=Ia(r[i]),a.el=o.el),!n&&a.patchFlag!==-2&&PR(o,a)),a.type===zw&&(a.el=o.el),a.type===xs&&!a.el&&(a.el=o.el)}}function Yse(t){const e=t.slice(),n=[0];let s,r,i,o,a;const c=t.length;for(s=0;s<c;s++){const u=t[s];if(u!==0){if(r=n[n.length-1],t[r]<u){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<u?i=a+1:o=a;u<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function n9(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:n9(e)}function nx(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Xse=Symbol.for("v-scx"),Jse=()=>_r(Xse);function fp(t,e,n){return s9(t,e,n)}function s9(t,e,n=kt){const{immediate:s,deep:r,flush:i,once:o}=n,a=Dn({},n),c=e&&s||!e&&i!=="post";let u;if(lg){if(i==="sync"){const m=Jse();u=m.__watcherHandles||(m.__watcherHandles=[])}else if(!c){const m=()=>{};return m.stop=Di,m.resume=Di,m.pause=Di,m}}const h=ps;a.call=(m,w,R)=>li(m,h,w,R);let d=!1;i==="post"?a.scheduler=m=>{As(m,h&&h.suspense)}:i!=="sync"&&(d=!0,a.scheduler=(m,w)=>{w?m():TR(m)}),a.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,h&&(m.id=h.uid,m.i=h))};const p=dse(t,e,a);return lg&&(u?u.push(p):c&&p()),p}function Zse(t,e,n){const s=this.proxy,r=an(t)?t.includes(".")?r9(s,t):()=>s[t]:t.bind(s,s);let i;$e(e)?i=e:(i=e.handler,n=e);const o=tm(this),a=s9(r,i.bind(s),n);return o(),a}function r9(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}const ere=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${wr(e)}Modifiers`]||t[`${au(e)}Modifiers`];function tre(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||kt;let r=n;const i=e.startsWith("update:"),o=i&&ere(s,e.slice(7));o&&(o.trim&&(r=n.map(h=>an(h)?h.trim():h)),o.number&&(r=n.map(kne)));let a,c=s[a=Wb(e)]||s[a=Wb(wr(e))];!c&&i&&(c=s[a=Wb(au(e))]),c&&li(c,t,6,r);const u=s[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,li(u,t,6,r)}}function i9(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!$e(t)){const c=u=>{const h=i9(u,e,!0);h&&(a=!0,Dn(o,h))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(zt(t)&&s.set(t,null),null):(xe(i)?i.forEach(c=>o[c]=null):Dn(o,i),zt(t)&&s.set(t,o),o)}function $w(t,e){return!t||!Dw(e)?!1:(e=e.slice(2).replace(/Once$/,""),wt(t,e[0].toLowerCase()+e.slice(1))||wt(t,au(e))||wt(t,e))}function sx(t){const{type:e,vnode:n,proxy:s,withProxy:r,propsOptions:[i],slots:o,attrs:a,emit:c,render:u,renderCache:h,props:d,data:p,setupState:m,ctx:w,inheritAttrs:R}=t,k=My(t);let O,M;try{if(n.shapeFlag&4){const q=r||s,H=q;O=Ti(u.call(H,q,h,d,m,p,w)),M=a}else{const q=e;O=Ti(q.length>1?q(d,{attrs:a,slots:o,emit:c}):q(d,null)),M=e.props?a:nre(a)}}catch(q){pp.length=0,Uw(q,t,1),O=Ls(xs)}let F=O;if(M&&R!==!1){const q=Object.keys(M),{shapeFlag:H}=F;q.length&&H&7&&(i&&q.some(hR)&&(M=sre(M,i)),F=ml(F,M,!1,!0))}return n.dirs&&(F=ml(F,null,!1,!0),F.dirs=F.dirs?F.dirs.concat(n.dirs):n.dirs),n.transition&&Hc(F,n.transition),O=F,My(k),O}const nre=t=>{let e;for(const n in t)(n==="class"||n==="style"||Dw(n))&&((e||(e={}))[n]=t[n]);return e},sre=(t,e)=>{const n={};for(const s in t)(!hR(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function rre(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?rx(s,o,u):!!o;if(c&8){const h=e.dynamicProps;for(let d=0;d<h.length;d++){const p=h[d];if(o[p]!==s[p]&&!$w(u,p))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?rx(s,o,u):!0:!!o;return!1}function rx(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!$w(n,i))return!0}return!1}function ire({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const o9=t=>t.__isSuspense;function ore(t,e){e&&e.pendingBranch?xe(t)?e.effects.push(...t):e.effects.push(t):gse(t)}const Mr=Symbol.for("v-fgt"),zw=Symbol.for("v-txt"),xs=Symbol.for("v-cmt"),tT=Symbol.for("v-stc"),pp=[];let rr=null;function a9(t=!1){pp.push(rr=t?null:[])}function are(){pp.pop(),rr=pp[pp.length-1]||null}let ag=1;function ix(t,e=!1){ag+=t,t<0&&rr&&e&&(rr.hasOnce=!0)}function l9(t){return t.dynamicChildren=ag>0?rr||Zu:null,are(),ag>0&&rr&&rr.push(t),t}function lre(t,e,n,s,r,i){return l9(u9(t,e,n,s,r,i,!0))}function cre(t,e,n,s,r){return l9(Ls(t,e,n,s,r,!0))}function Fy(t){return t?t.__v_isVNode===!0:!1}function fc(t,e){return t.type===e.type&&t.key===e.key}const c9=({key:t})=>t??null,w_=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?an(t)||Qn(t)||$e(t)?{i:sr,r:t,k:e,f:!!n}:t:null);function u9(t,e=null,n=null,s=0,r=null,i=t===Mr?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&c9(e),ref:e&&w_(e),scopeId:N6,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:sr};return a?(NR(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=an(n)?8:16),ag>0&&!o&&rr&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&rr.push(c),c}const Ls=ure;function ure(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===Nse)&&(t=xs),Fy(t)){const a=ml(t,e,!0);return n&&NR(a,n),ag>0&&!i&&rr&&(a.shapeFlag&6?rr[rr.indexOf(t)]=a:rr.push(a)),a.patchFlag=-2,a}if(bre(t)&&(t=t.__vccOpts),e){e=hre(e);let{class:a,style:c}=e;a&&!an(a)&&(e.class=gR(a)),zt(c)&&(bR(c)&&!xe(c)&&(c=Dn({},c)),e.style=pR(c))}const o=an(t)?1:o9(t)?128:O6(t)?64:zt(t)?4:$e(t)?2:0;return u9(t,e,n,s,r,o,i,!0)}function hre(t){return t?bR(t)||Y6(t)?Dn({},t):t:null}function ml(t,e,n=!1,s=!1){const{props:r,ref:i,patchFlag:o,children:a,transition:c}=t,u=e?fre(r||{},e):r,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&c9(u),ref:e&&e.ref?n&&i?xe(i)?i.concat(w_(e)):[i,w_(e)]:w_(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Mr?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&ml(t.ssContent),ssFallback:t.ssFallback&&ml(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&s&&Hc(h,c.clone(h)),h}function dre(t=" ",e=0){return Ls(zw,null,t,e)}function gve(t="",e=!1){return e?(a9(),cre(xs,null,t)):Ls(xs,null,t)}function Ti(t){return t==null||typeof t=="boolean"?Ls(xs):xe(t)?Ls(Mr,null,t.slice()):Fy(t)?Ia(t):Ls(zw,null,String(t))}function Ia(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:ml(t)}function NR(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(xe(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),NR(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!Y6(e)?e._ctx=sr:r===3&&sr&&(sr.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else $e(e)?(e={default:e,_ctx:sr},n=32):(e=String(e),s&64?(n=16,e=[dre(e)]):n=8);t.children=e,t.shapeFlag|=n}function fre(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=gR([e.class,s.class]));else if(r==="style")e.style=pR([e.style,s.style]);else if(Dw(r)){const i=e[r],o=s[r];o&&i!==o&&!(xe(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function fi(t,e,n,s=null){li(t,e,7,[n,s])}const pre=K6();let gre=0;function mre(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||pre,i={uid:gre++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new a6(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:J6(s,r),emitsOptions:i9(s,r),emit:null,emitted:null,propsDefaults:kt,inheritAttrs:s.inheritAttrs,ctx:kt,data:kt,props:kt,attrs:kt,slots:kt,refs:kt,setupState:kt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=tre.bind(null,i),t.ce&&t.ce(i),i}let ps=null;const lu=()=>ps||sr;let Uy,tI;{const t=Vw(),e=(n,s)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(s),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};Uy=e("__VUE_INSTANCE_SETTERS__",n=>ps=n),tI=e("__VUE_SSR_SETTERS__",n=>lg=n)}const tm=t=>{const e=ps;return Uy(t),t.scope.on(),()=>{t.scope.off(),Uy(e)}},ox=()=>{ps&&ps.scope.off(),Uy(null)};function h9(t){return t.vnode.shapeFlag&4}let lg=!1;function _re(t,e=!1,n=!1){e&&tI(e);const{props:s,children:r}=t.vnode,i=h9(t);Bse(t,s,i,e),Hse(t,r,n||e);const o=i?yre(t,e):void 0;return e&&tI(!1),o}function yre(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Dse);const{setup:s}=n;if(s){Qo();const r=t.setupContext=s.length>1?wre(t):null,i=tm(t),o=em(s,t,0,[t.props,r]),a=t6(o);if(Yo(),i(),(a||t.sp)&&!hp(t)&&j6(t),a){if(o.then(ox,ox),e)return o.then(c=>{ax(t,c)}).catch(c=>{Uw(c,t,0)});t.asyncDep=o}else ax(t,o)}else d9(t)}function ax(t,e,n){$e(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:zt(e)&&(t.setupState=I6(e)),d9(t)}function d9(t,e,n){const s=t.type;t.render||(t.render=s.render||Di);{const r=tm(t);Qo();try{Ose(t)}finally{Yo(),r()}}}const vre={get(t,e){return us(t,"get",""),t[e]}};function wre(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,vre),slots:t.slots,emit:t.emit,expose:e}}function Hw(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(I6(Zg(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in dp)return dp[n](t)},has(e,n){return n in e||n in dp}})):t.proxy}function Ere(t,e=!0){return $e(t)?t.displayName||t.name:t.name||e&&t.__name}function bre(t){return $e(t)&&"__vccOpts"in t}const Ee=(t,e)=>use(t,e,lg);function Ve(t,e,n){const s=arguments.length;return s===2?zt(e)&&!xe(e)?Fy(e)?Ls(t,null,[e]):Ls(t,e):Ls(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Fy(n)&&(n=[n]),Ls(t,e,n))}const Tre="3.5.18";/**
* @vue/runtime-dom v3.5.18
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let nI;const lx=typeof window<"u"&&window.trustedTypes;if(lx)try{nI=lx.createPolicy("vue",{createHTML:t=>t})}catch{}const f9=nI?t=>nI.createHTML(t):t=>t,Cre="http://www.w3.org/2000/svg",Ire="http://www.w3.org/1998/Math/MathML",To=typeof document<"u"?document:null,cx=To&&To.createElement("template"),Sre={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e==="svg"?To.createElementNS(Cre,t):e==="mathml"?To.createElementNS(Ire,t):n?To.createElement(t,{is:n}):To.createElement(t);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>To.createTextNode(t),createComment:t=>To.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>To.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{cx.innerHTML=f9(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const a=cx.content;if(s==="svg"||s==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},da="transition",df="animation",Sh=Symbol("_vtc"),p9={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},g9=Dn({},F6,p9),Rre=t=>(t.displayName="Transition",t.props=g9,t),Are=Rre((t,{slots:e})=>Ve(vse,m9(t),e)),sc=(t,e=[])=>{xe(t)?t.forEach(n=>n(...e)):t&&t(...e)},ux=t=>t?xe(t)?t.some(e=>e.length>1):t.length>1:!1;function m9(t){const e={};for(const T in t)T in p9||(e[T]=t[T]);if(t.css===!1)return e;const{name:n="v",type:s,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:u=o,appearToClass:h=a,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:p=`${n}-leave-active`,leaveToClass:m=`${n}-leave-to`}=t,w=kre(r),R=w&&w[0],k=w&&w[1],{onBeforeEnter:O,onEnter:M,onEnterCancelled:F,onLeave:q,onLeaveCancelled:H,onBeforeAppear:J=O,onAppear:I=M,onAppearCancelled:v=F}=e,y=(T,E,K,oe)=>{T._enterCancelled=oe,ma(T,E?h:a),ma(T,E?u:o),K&&K()},C=(T,E)=>{T._isLeaving=!1,ma(T,d),ma(T,m),ma(T,p),E&&E()},S=T=>(E,K)=>{const oe=T?I:M,ge=()=>y(E,T,K);sc(oe,[E,ge]),hx(()=>{ma(E,T?c:i),mi(E,T?h:a),ux(oe)||dx(E,s,R,ge)})};return Dn(e,{onBeforeEnter(T){sc(O,[T]),mi(T,i),mi(T,o)},onBeforeAppear(T){sc(J,[T]),mi(T,c),mi(T,u)},onEnter:S(!1),onAppear:S(!0),onLeave(T,E){T._isLeaving=!0;const K=()=>C(T,E);mi(T,d),T._enterCancelled?(mi(T,p),sI()):(sI(),mi(T,p)),hx(()=>{T._isLeaving&&(ma(T,d),mi(T,m),ux(q)||dx(T,s,k,K))}),sc(q,[T,K])},onEnterCancelled(T){y(T,!1,void 0,!0),sc(F,[T])},onAppearCancelled(T){y(T,!0,void 0,!0),sc(v,[T])},onLeaveCancelled(T){C(T),sc(H,[T])}})}function kre(t){if(t==null)return null;if(zt(t))return[nT(t.enter),nT(t.leave)];{const e=nT(t);return[e,e]}}function nT(t){return Pne(t)}function mi(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Sh]||(t[Sh]=new Set)).add(e)}function ma(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const n=t[Sh];n&&(n.delete(e),n.size||(t[Sh]=void 0))}function hx(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Pre=0;function dx(t,e,n,s){const r=t._endId=++Pre,i=()=>{r===t._endId&&s()};if(n!=null)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=_9(t,e);if(!o)return s();const u=o+"end";let h=0;const d=()=>{t.removeEventListener(u,p),i()},p=m=>{m.target===t&&++h>=c&&d()};setTimeout(()=>{h<c&&d()},a+1),t.addEventListener(u,p)}function _9(t,e){const n=window.getComputedStyle(t),s=w=>(n[w]||"").split(", "),r=s(`${da}Delay`),i=s(`${da}Duration`),o=fx(r,i),a=s(`${df}Delay`),c=s(`${df}Duration`),u=fx(a,c);let h=null,d=0,p=0;e===da?o>0&&(h=da,d=o,p=i.length):e===df?u>0&&(h=df,d=u,p=c.length):(d=Math.max(o,u),h=d>0?o>u?da:df:null,p=h?h===da?i.length:c.length:0);const m=h===da&&/\b(transform|all)(,|$)/.test(s(`${da}Property`).toString());return{type:h,timeout:d,propCount:p,hasTransform:m}}function fx(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>px(n)+px(t[s])))}function px(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function sI(){return document.body.offsetHeight}function Nre(t,e,n){const s=t[Sh];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const qy=Symbol("_vod"),y9=Symbol("_vsh"),mve={beforeMount(t,{value:e},{transition:n}){t[qy]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):ff(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:s}){!e!=!n&&(s?e?(s.beforeEnter(t),ff(t,!0),s.enter(t)):s.leave(t,()=>{ff(t,!1)}):ff(t,e))},beforeUnmount(t,{value:e}){ff(t,e)}};function ff(t,e){t.style.display=e?t[qy]:"none",t[y9]=!e}const xre=Symbol(""),Dre=/(^|;)\s*display\s*:/;function Ore(t,e,n){const s=t.style,r=an(n);let i=!1;if(n&&!r){if(e)if(an(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&E_(s,a,"")}else for(const o in e)n[o]==null&&E_(s,o,"");for(const o in n)o==="display"&&(i=!0),E_(s,o,n[o])}else if(r){if(e!==n){const o=s[xre];o&&(n+=";"+o),s.cssText=n,i=Dre.test(n)}}else e&&t.removeAttribute("style");qy in t&&(t[qy]=i?s.display:"",t[y9]&&(s.display="none"))}const gx=/\s*!important$/;function E_(t,e,n){if(xe(n))n.forEach(s=>E_(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=Lre(t,e);gx.test(n)?t.setProperty(au(s),n.replace(gx,""),"important"):t[s]=n}}const mx=["Webkit","Moz","ms"],sT={};function Lre(t,e){const n=sT[e];if(n)return n;let s=wr(e);if(s!=="filter"&&s in t)return sT[e]=s;s=Mw(s);for(let r=0;r<mx.length;r++){const i=mx[r]+s;if(i in t)return sT[e]=i}return e}const _x="http://www.w3.org/1999/xlink";function yx(t,e,n,s,r,i=Mne(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(_x,e.slice(6,e.length)):t.setAttributeNS(_x,e,n):n==null||i&&!r6(n)?t.removeAttribute(e):t.setAttribute(e,i?"":Dl(n)?String(n):n)}function vx(t,e,n,s,r){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?f9(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(a!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=r6(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(r||e)}function Mre(t,e,n,s){t.addEventListener(e,n,s)}function Vre(t,e,n,s){t.removeEventListener(e,n,s)}const wx=Symbol("_vei");function Fre(t,e,n,s,r=null){const i=t[wx]||(t[wx]={}),o=i[e];if(s&&o)o.value=s;else{const[a,c]=Ure(e);if(s){const u=i[e]=jre(s,r);Mre(t,a,u,c)}else o&&(Vre(t,a,o,c),i[e]=void 0)}}const Ex=/(?:Once|Passive|Capture)$/;function Ure(t){let e;if(Ex.test(t)){e={};let s;for(;s=t.match(Ex);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):au(t.slice(2)),e]}let rT=0;const qre=Promise.resolve(),Bre=()=>rT||(qre.then(()=>rT=0),rT=Date.now());function jre(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;li($re(s,n.value),e,5,[s])};return n.value=t,n.attached=Bre(),n}function $re(t,e){if(xe(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const bx=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,zre=(t,e,n,s,r,i)=>{const o=r==="svg";e==="class"?Nre(t,s,o):e==="style"?Ore(t,n,s):Dw(e)?hR(e)||Fre(t,e,n,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Hre(t,e,s,o))?(vx(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&yx(t,e,s,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!an(s))?vx(t,wr(e),s,i,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),yx(t,e,s,o))};function Hre(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&bx(e)&&$e(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return bx(e)&&an(n)?!1:e in t}const v9=new WeakMap,w9=new WeakMap,By=Symbol("_moveCb"),Tx=Symbol("_enterCb"),Wre=t=>(delete t.props.mode,t),Kre=Wre({name:"TransitionGroup",props:Dn({},g9,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=lu(),s=V6();let r,i;return z6(()=>{if(!r.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!Jre(r[0].el,n.vnode.el,o)){r=[];return}r.forEach(Qre),r.forEach(Yre);const a=r.filter(Xre);sI(),a.forEach(c=>{const u=c.el,h=u.style;mi(u,o),h.transform=h.webkitTransform=h.transitionDuration="";const d=u[By]=p=>{p&&p.target!==u||(!p||/transform$/.test(p.propertyName))&&(u.removeEventListener("transitionend",d),u[By]=null,ma(u,o))};u.addEventListener("transitionend",d)}),r=[]}),()=>{const o=ut(t),a=m9(o);let c=o.tag||Mr;if(r=[],i)for(let u=0;u<i.length;u++){const h=i[u];h.el&&h.el instanceof Element&&(r.push(h),Hc(h,og(h,a,s,n)),v9.set(h,h.el.getBoundingClientRect()))}i=e.default?CR(e.default()):[];for(let u=0;u<i.length;u++){const h=i[u];h.key!=null&&Hc(h,og(h,a,s,n))}return Ls(c,null,i)}}}),Gre=Kre;function Qre(t){const e=t.el;e[By]&&e[By](),e[Tx]&&e[Tx]()}function Yre(t){w9.set(t,t.el.getBoundingClientRect())}function Xre(t){const e=v9.get(t),n=w9.get(t),s=e.left-n.left,r=e.top-n.top;if(s||r){const i=t.el.style;return i.transform=i.webkitTransform=`translate(${s}px,${r}px)`,i.transitionDuration="0s",t}}function Jre(t,e,n){const s=t.cloneNode(),r=t[Sh];r&&r.forEach(a=>{a.split(/\s+/).forEach(c=>c&&s.classList.remove(c))}),n.split(/\s+/).forEach(a=>a&&s.classList.add(a)),s.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(s);const{hasTransform:o}=_9(s);return i.removeChild(s),o}const Zre=["ctrl","shift","alt","meta"],eie={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Zre.some(n=>t[`${n}Key`]&&!e.includes(n))},_ve=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=(r,...i)=>{for(let o=0;o<e.length;o++){const a=eie[e[o]];if(a&&a(r,e))return}return t(r,...i)})},tie=Dn({patchProp:zre},Sre);let Cx;function nie(){return Cx||(Cx=Kse(tie))}const E9=(...t)=>{const e=nie().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=rie(s);if(!r)return;const i=e._component;!$e(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,sie(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function sie(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function rie(t){return an(t)?document.querySelector(t):t}function Ww(t,e,n,s){return Object.defineProperty(t,e,{get:n,set:s,enumerable:!0}),t}function yve(t,e){for(const n in e)Ww(t,n,e[n]);return t}const Wc=gl(!1);let rI;function iie(t,e){const n=/(edg|edge|edga|edgios)\/([\w.]+)/.exec(t)||/(opr)[\/]([\w.]+)/.exec(t)||/(vivaldi)[\/]([\w.]+)/.exec(t)||/(chrome|crios)[\/]([\w.]+)/.exec(t)||/(version)(applewebkit)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(t)||/(webkit)[\/]([\w.]+).*(version)[\/]([\w.]+).*(safari)[\/]([\w.]+)/.exec(t)||/(firefox|fxios)[\/]([\w.]+)/.exec(t)||/(webkit)[\/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[\/]([\w.]+)/.exec(t)||[];return{browser:n[5]||n[3]||n[1]||"",version:n[4]||n[2]||"0",platform:e[0]||""}}function oie(t){return/(ipad)/.exec(t)||/(ipod)/.exec(t)||/(windows phone)/.exec(t)||/(iphone)/.exec(t)||/(kindle)/.exec(t)||/(silk)/.exec(t)||/(android)/.exec(t)||/(win)/.exec(t)||/(mac)/.exec(t)||/(linux)/.exec(t)||/(cros)/.exec(t)||/(playbook)/.exec(t)||/(bb)/.exec(t)||/(blackberry)/.exec(t)||[]}const b9="ontouchstart"in window||window.navigator.maxTouchPoints>0;function aie(t){const e=t.toLowerCase(),n=oie(e),s=iie(e,n),r={mobile:!1,desktop:!1,cordova:!1,capacitor:!1,nativeMobile:!1,electron:!1,bex:!1,linux:!1,mac:!1,win:!1,cros:!1,chrome:!1,firefox:!1,opera:!1,safari:!1,vivaldi:!1,edge:!1,edgeChromium:!1,ie:!1,webkit:!1,android:!1,ios:!1,ipad:!1,iphone:!1,ipod:!1,kindle:!1,winphone:!1,blackberry:!1,playbook:!1,silk:!1};s.browser&&(r[s.browser]=!0,r.version=s.version,r.versionNumber=parseInt(s.version,10)),s.platform&&(r[s.platform]=!0);const i=r.android||r.ios||r.bb||r.blackberry||r.ipad||r.iphone||r.ipod||r.kindle||r.playbook||r.silk||r["windows phone"];if(i===!0||e.indexOf("mobile")!==-1?r.mobile=!0:r.desktop=!0,r["windows phone"]&&(r.winphone=!0,delete r["windows phone"]),r.edga||r.edgios||r.edg?(r.edge=!0,s.browser="edge"):r.crios?(r.chrome=!0,s.browser="chrome"):r.fxios&&(r.firefox=!0,s.browser="firefox"),(r.ipod||r.ipad||r.iphone)&&(r.ios=!0),r.vivaldi&&(s.browser="vivaldi",r.vivaldi=!0),(r.chrome||r.opr||r.safari||r.vivaldi||r.mobile===!0&&r.ios!==!0&&i!==!0)&&(r.webkit=!0),r.opr&&(s.browser="opera",r.opera=!0),r.safari&&(r.blackberry||r.bb?(s.browser="blackberry",r.blackberry=!0):r.playbook?(s.browser="playbook",r.playbook=!0):r.android?(s.browser="android",r.android=!0):r.kindle?(s.browser="kindle",r.kindle=!0):r.silk&&(s.browser="silk",r.silk=!0)),r.name=s.browser,r.platform=s.platform,e.indexOf("electron")!==-1)r.electron=!0;else if(document.location.href.indexOf("-extension://")!==-1)r.bex=!0;else{if(window.Capacitor!==void 0?(r.capacitor=!0,r.nativeMobile=!0,r.nativeMobileWrapper="capacitor"):(window._cordovaNative!==void 0||window.cordova!==void 0)&&(r.cordova=!0,r.nativeMobile=!0,r.nativeMobileWrapper="cordova"),Wc.value===!0&&(rI={is:{...r}}),b9===!0&&r.mac===!0&&(r.desktop===!0&&r.safari===!0||r.nativeMobile===!0&&r.android!==!0&&r.ios!==!0&&r.ipad!==!0)){delete r.mac,delete r.desktop;const o=Math.min(window.innerHeight,window.innerWidth)>414?"ipad":"iphone";Object.assign(r,{mobile:!0,ios:!0,platform:o,[o]:!0})}r.mobile!==!0&&window.navigator.userAgentData&&window.navigator.userAgentData.mobile&&(delete r.desktop,r.mobile=!0)}return r}const Ix=navigator.userAgent||navigator.vendor||window.opera,lie={has:{touch:!1,webStorage:!1},within:{iframe:!1}},Oi={userAgent:Ix,is:aie(Ix),has:{touch:b9},within:{iframe:window.self!==window.top}},iI={install(t){const{$q:e}=t;Wc.value===!0?(t.onSSRHydrated.push(()=>{Object.assign(e.platform,Oi),Wc.value=!1}),e.platform=Jh(this)):e.platform=this}};{let t;Ww(Oi.has,"webStorage",()=>{if(t!==void 0)return t;try{if(window.localStorage)return t=!0,!0}catch{}return t=!1,!1}),Object.assign(iI,Oi),Wc.value===!0&&(Object.assign(iI,rI,lie),rI=null)}function nm(t){return Zg(qw(t))}function cie(t){return Zg(t)}const Kw=(t,e)=>{const n=Jh(t);for(const s in t)Ww(e,s,()=>n[s],r=>{n[s]=r});return e},Kc={hasPassive:!1,passiveCapture:!0,notPassiveCapture:!0};try{const t=Object.defineProperty({},"passive",{get(){Object.assign(Kc,{hasPassive:!0,passive:{passive:!0},notPassive:{passive:!1},passiveCapture:{passive:!0,capture:!0},notPassiveCapture:{passive:!1,capture:!0}})}});window.addEventListener("qtest",null,t),window.removeEventListener("qtest",null,t)}catch{}function cg(){}function vve(t){return t.button===0}function uie(t){return t.touches&&t.touches[0]?t=t.touches[0]:t.changedTouches&&t.changedTouches[0]?t=t.changedTouches[0]:t.targetTouches&&t.targetTouches[0]&&(t=t.targetTouches[0]),{top:t.clientY,left:t.clientX}}function wve(t){if(t.path)return t.path;if(t.composedPath)return t.composedPath();const e=[];let n=t.target;for(;n;){if(e.push(n),n.tagName==="HTML")return e.push(document),e.push(window),e;n=n.parentElement}}function T9(t){t.stopPropagation()}function oI(t){t.cancelable!==!1&&t.preventDefault()}function vu(t){t.cancelable!==!1&&t.preventDefault(),t.stopPropagation()}function Eve(t,e){if(t===void 0||e===!0&&t.__dragPrevented===!0)return;const n=e===!0?s=>{s.__dragPrevented=!0,s.addEventListener("dragstart",oI,Kc.notPassiveCapture)}:s=>{delete s.__dragPrevented,s.removeEventListener("dragstart",oI,Kc.notPassiveCapture)};t.querySelectorAll("a, img").forEach(n)}function hie(t,e,n){const s=`__q_${e}_evt`;t[s]=t[s]!==void 0?t[s].concat(n):n,n.forEach(r=>{r[0].addEventListener(r[1],t[r[2]],Kc[r[3]])})}function die(t,e){const n=`__q_${e}_evt`;t[n]!==void 0&&(t[n].forEach(s=>{s[0].removeEventListener(s[1],t[s[2]],Kc[s[3]])}),t[n]=void 0)}function fie(t,e=250,n){let s=null;function r(){const i=arguments,o=()=>{s=null,t.apply(this,i)};s!==null&&clearTimeout(s),s=setTimeout(o,e)}return r.cancel=()=>{s!==null&&clearTimeout(s)},r}const iT=["sm","md","lg","xl"],{passive:Sx}=Kc,pie=Kw({width:0,height:0,name:"xs",sizes:{sm:600,md:1024,lg:1440,xl:1920},lt:{sm:!0,md:!0,lg:!0,xl:!0},gt:{xs:!1,sm:!1,md:!1,lg:!1},xs:!0,sm:!1,md:!1,lg:!1,xl:!1},{setSizes:cg,setDebounce:cg,install({$q:t,onSSRHydrated:e}){if(t.screen=this,this.__installed===!0){t.config.screen!==void 0&&(t.config.screen.bodyClasses===!1?document.body.classList.remove(`screen--${this.name}`):this.__update(!0));return}const{visualViewport:n}=window,s=n||window,r=document.scrollingElement||document.documentElement,i=n===void 0||Oi.is.mobile===!0?()=>[Math.max(window.innerWidth,r.clientWidth),Math.max(window.innerHeight,r.clientHeight)]:()=>[n.width*n.scale+window.innerWidth-r.clientWidth,n.height*n.scale+window.innerHeight-r.clientHeight],o=t.config.screen?.bodyClasses===!0;this.__update=d=>{const[p,m]=i();if(m!==this.height&&(this.height=m),p!==this.width)this.width=p;else if(d!==!0)return;let w=this.sizes;this.gt.xs=p>=w.sm,this.gt.sm=p>=w.md,this.gt.md=p>=w.lg,this.gt.lg=p>=w.xl,this.lt.sm=p<w.sm,this.lt.md=p<w.md,this.lt.lg=p<w.lg,this.lt.xl=p<w.xl,this.xs=this.lt.sm,this.sm=this.gt.xs===!0&&this.lt.md===!0,this.md=this.gt.sm===!0&&this.lt.lg===!0,this.lg=this.gt.md===!0&&this.lt.xl===!0,this.xl=this.gt.lg,w=this.xs===!0&&"xs"||this.sm===!0&&"sm"||this.md===!0&&"md"||this.lg===!0&&"lg"||"xl",w!==this.name&&(o===!0&&(document.body.classList.remove(`screen--${this.name}`),document.body.classList.add(`screen--${w}`)),this.name=w)};let a,c={},u=16;this.setSizes=d=>{iT.forEach(p=>{d[p]!==void 0&&(c[p]=d[p])})},this.setDebounce=d=>{u=d};const h=()=>{const d=getComputedStyle(document.body);d.getPropertyValue("--q-size-sm")&&iT.forEach(p=>{this.sizes[p]=parseInt(d.getPropertyValue(`--q-size-${p}`),10)}),this.setSizes=p=>{iT.forEach(m=>{p[m]&&(this.sizes[m]=p[m])}),this.__update(!0)},this.setDebounce=p=>{a!==void 0&&s.removeEventListener("resize",a,Sx),a=p>0?fie(this.__update,p):this.__update,s.addEventListener("resize",a,Sx)},this.setDebounce(u),Object.keys(c).length!==0?(this.setSizes(c),c=void 0):this.__update(),o===!0&&this.name==="xs"&&document.body.classList.add("screen--xs")};Wc.value===!0?e.push(h):h()}}),ts=Kw({isActive:!1,mode:!1},{__media:void 0,set(t){ts.mode=t,t==="auto"?(ts.__media===void 0&&(ts.__media=window.matchMedia("(prefers-color-scheme: dark)"),ts.__updateMedia=()=>{ts.set("auto")},ts.__media.addListener(ts.__updateMedia)),t=ts.__media.matches):ts.__media!==void 0&&(ts.__media.removeListener(ts.__updateMedia),ts.__media=void 0),ts.isActive=t===!0,document.body.classList.remove(`body--${t===!0?"light":"dark"}`),document.body.classList.add(`body--${t===!0?"dark":"light"}`)},toggle(){ts.set(ts.isActive===!1)},install({$q:t,ssrContext:e}){const n=t.config.dark;t.dark=this,this.__installed!==!0&&this.set(n!==void 0?n:!1)}});function gie(t,e,n=document.body){if(typeof t!="string")throw new TypeError("Expected a string as propName");if(typeof e!="string")throw new TypeError("Expected a string as value");if(!(n instanceof Element))throw new TypeError("Expected a DOM element");n.style.setProperty(`--q-${t}`,e)}let C9=!1;function mie(t){C9=t.isComposing===!0}function _ie(t){return C9===!0||t!==Object(t)||t.isComposing===!0||t.qKeyEvent===!0}function aI(t,e){return _ie(t)===!0?!1:[].concat(e).includes(t.keyCode)}function I9(t){if(t.ios===!0)return"ios";if(t.android===!0)return"android"}function yie({is:t,has:e,within:n},s){const r=[t.desktop===!0?"desktop":"mobile",`${e.touch===!1?"no-":""}touch`];if(t.mobile===!0){const i=I9(t);i!==void 0&&r.push("platform-"+i)}if(t.nativeMobile===!0){const i=t.nativeMobileWrapper;r.push(i),r.push("native-mobile"),t.ios===!0&&(s[i]===void 0||s[i].iosStatusBarPadding!==!1)&&r.push("q-ios-padding")}else t.electron===!0?r.push("electron"):t.bex===!0&&r.push("bex");return n.iframe===!0&&r.push("within-iframe"),r}function vie(){const{is:t}=Oi,e=document.body.className,n=new Set(e.replace(/ {2}/g," ").split(" "));if(t.nativeMobile!==!0&&t.electron!==!0&&t.bex!==!0){if(t.desktop===!0)n.delete("mobile"),n.delete("platform-ios"),n.delete("platform-android"),n.add("desktop");else if(t.mobile===!0){n.delete("desktop"),n.add("mobile"),n.delete("platform-ios"),n.delete("platform-android");const r=I9(t);r!==void 0&&n.add(`platform-${r}`)}}Oi.has.touch===!0&&(n.delete("no-touch"),n.add("touch")),Oi.within.iframe===!0&&n.add("within-iframe");const s=Array.from(n).join(" ");e!==s&&(document.body.className=s)}function wie(t){for(const e in t)gie(e,t[e])}const Eie={install(t){if(this.__installed!==!0){if(Wc.value===!0)vie();else{const{$q:e}=t;e.config.brand!==void 0&&wie(e.config.brand);const n=yie(Oi,e.config);document.body.classList.add.apply(document.body.classList,n)}Oi.is.ios===!0&&document.body.addEventListener("touchstart",cg),window.addEventListener("keydown",mie,!0)}}},S9=()=>!0;function bie(t){return typeof t=="string"&&t!==""&&t!=="/"&&t!=="#/"}function Tie(t){return t.startsWith("#")===!0&&(t=t.substring(1)),t.startsWith("/")===!1&&(t="/"+t),t.endsWith("/")===!0&&(t=t.substring(0,t.length-1)),"#"+t}function Cie(t){if(t.backButtonExit===!1)return()=>!1;if(t.backButtonExit==="*")return S9;const e=["#/"];return Array.isArray(t.backButtonExit)===!0&&e.push(...t.backButtonExit.filter(bie).map(Tie)),()=>e.includes(window.location.hash)}const Iie={__history:[],add:cg,remove:cg,install({$q:t}){if(this.__installed===!0)return;const{cordova:e,capacitor:n}=Oi.is;if(e!==!0&&n!==!0)return;const s=t.config[e===!0?"cordova":"capacitor"];if(s?.backButton===!1||n===!0&&(window.Capacitor===void 0||window.Capacitor.Plugins.App===void 0))return;this.add=o=>{o.condition===void 0&&(o.condition=S9),this.__history.push(o)},this.remove=o=>{const a=this.__history.indexOf(o);a>=0&&this.__history.splice(a,1)};const r=Cie(Object.assign({backButtonExit:!0},s)),i=()=>{if(this.__history.length){const o=this.__history[this.__history.length-1];o.condition()===!0&&(this.__history.pop(),o.handler())}else r()===!0?navigator.app.exitApp():window.history.back()};e===!0?document.addEventListener("deviceready",()=>{document.addEventListener("backbutton",i,!1)}):window.Capacitor.Plugins.App.addListener("backButton",i)}},Rx={isoName:"en-US",nativeName:"English (US)",label:{clear:"Clear",ok:"OK",cancel:"Cancel",close:"Close",set:"Set",select:"Select",reset:"Reset",remove:"Remove",update:"Update",create:"Create",search:"Search",filter:"Filter",refresh:"Refresh",expand:t=>t?`Expand "${t}"`:"Expand",collapse:t=>t?`Collapse "${t}"`:"Collapse"},date:{days:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),daysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),firstDayOfWeek:0,format24h:!1,pluralDay:"days",prevMonth:"Previous month",nextMonth:"Next month",prevYear:"Previous year",nextYear:"Next year",today:"Today",prevRangeYears:t=>`Previous ${t} years`,nextRangeYears:t=>`Next ${t} years`},table:{noData:"No data available",noResults:"No matching records found",loading:"Loading...",selectedRecords:t=>t===1?"1 record selected.":(t===0?"No":t)+" records selected.",recordsPerPage:"Records per page:",allRows:"All",pagination:(t,e,n)=>t+"-"+e+" of "+n,columns:"Columns"},pagination:{first:"First page",prev:"Previous page",next:"Next page",last:"Last page"},editor:{url:"URL",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",unorderedList:"Unordered List",orderedList:"Ordered List",subscript:"Subscript",superscript:"Superscript",hyperlink:"Hyperlink",toggleFullscreen:"Toggle Fullscreen",quote:"Quote",left:"Left align",center:"Center align",right:"Right align",justify:"Justify align",print:"Print",outdent:"Decrease indentation",indent:"Increase indentation",removeFormat:"Remove formatting",formatting:"Formatting",fontSize:"Font Size",align:"Align",hr:"Insert Horizontal Rule",undo:"Undo",redo:"Redo",heading1:"Heading 1",heading2:"Heading 2",heading3:"Heading 3",heading4:"Heading 4",heading5:"Heading 5",heading6:"Heading 6",paragraph:"Paragraph",code:"Code",size1:"Very small",size2:"A bit small",size3:"Normal",size4:"Medium-large",size5:"Big",size6:"Very big",size7:"Maximum",defaultFont:"Default Font",viewSource:"View Source"},tree:{noNodes:"No nodes available",noResults:"No matching nodes found"}};function Ax(){const t=Array.isArray(navigator.languages)===!0&&navigator.languages.length!==0?navigator.languages[0]:navigator.language;if(typeof t=="string")return t.split(/[-_]/).map((e,n)=>n===0?e.toLowerCase():n>1||e.length<4?e.toUpperCase():e[0].toUpperCase()+e.slice(1).toLowerCase()).join("-")}const Sa=Kw({__qLang:{}},{getLocale:Ax,set(t=Rx,e){const n={...t,rtl:t.rtl===!0,getLocale:Ax};{if(n.set=Sa.set,Sa.__langConfig===void 0||Sa.__langConfig.noHtmlAttrs!==!0){const s=document.documentElement;s.setAttribute("dir",n.rtl===!0?"rtl":"ltr"),s.setAttribute("lang",n.isoName)}Object.assign(Sa.__qLang,n)}},install({$q:t,lang:e,ssrContext:n}){t.lang=Sa.__qLang,Sa.__langConfig=t.config.lang,this.__installed===!0?e!==void 0&&this.set(e):(this.props=new Proxy(this.__qLang,{get(){return Reflect.get(...arguments)},ownKeys(s){return Reflect.ownKeys(s).filter(r=>r!=="set"&&r!=="getLocale")}}),this.set(e||Rx))}}),Sie={name:"material-icons",type:{positive:"check_circle",negative:"warning",info:"info",warning:"priority_high"},arrow:{up:"arrow_upward",right:"arrow_forward",down:"arrow_downward",left:"arrow_back",dropdown:"arrow_drop_down"},chevron:{left:"chevron_left",right:"chevron_right"},colorPicker:{spectrum:"gradient",tune:"tune",palette:"style"},pullToRefresh:{icon:"refresh"},carousel:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down",navigationIcon:"lens"},chip:{remove:"cancel",selected:"check"},datetime:{arrowLeft:"chevron_left",arrowRight:"chevron_right",now:"access_time",today:"today"},editor:{bold:"format_bold",italic:"format_italic",strikethrough:"strikethrough_s",underline:"format_underlined",unorderedList:"format_list_bulleted",orderedList:"format_list_numbered",subscript:"vertical_align_bottom",superscript:"vertical_align_top",hyperlink:"link",toggleFullscreen:"fullscreen",quote:"format_quote",left:"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify",print:"print",outdent:"format_indent_decrease",indent:"format_indent_increase",removeFormat:"format_clear",formatting:"text_format",fontSize:"format_size",align:"format_align_left",hr:"remove",undo:"undo",redo:"redo",heading:"format_size",code:"code",size:"format_size",font:"font_download",viewSource:"code"},expansionItem:{icon:"keyboard_arrow_down",denseIcon:"arrow_drop_down"},fab:{icon:"add",activeIcon:"close"},field:{clear:"cancel",error:"error"},pagination:{first:"first_page",prev:"keyboard_arrow_left",next:"keyboard_arrow_right",last:"last_page"},rating:{icon:"grade"},stepper:{done:"check",active:"edit",error:"warning"},tabs:{left:"chevron_left",right:"chevron_right",up:"keyboard_arrow_up",down:"keyboard_arrow_down"},table:{arrowUp:"arrow_upward",warning:"warning",firstPage:"first_page",prevPage:"chevron_left",nextPage:"chevron_right",lastPage:"last_page"},tree:{icon:"play_arrow"},uploader:{done:"done",clear:"clear",add:"add_box",upload:"cloud_upload",removeQueue:"clear_all",removeUploaded:"done_all"}},jy=Kw({iconMapFn:null,__qIconSet:{}},{set(t,e){const n={...t};n.set=jy.set,Object.assign(jy.__qIconSet,n)},install({$q:t,iconSet:e,ssrContext:n}){t.config.iconMapFn!==void 0&&(this.iconMapFn=t.config.iconMapFn),t.iconSet=this.__qIconSet,Ww(t,"iconMapFn",()=>this.iconMapFn,s=>{this.iconMapFn=s}),this.__installed===!0?e!==void 0&&this.set(e):(this.props=new Proxy(this.__qIconSet,{get(){return Reflect.get(...arguments)},ownKeys(s){return Reflect.ownKeys(s).filter(r=>r!=="set")}}),this.set(e||Sie))}}),R9="_q_",bve="_q_l_",Tve="_q_pc_",Cve="_q_fo_";function Ive(){}const $y={};let A9=!1;function Rie(){A9=!0}function oT(t,e){if(t===e)return!0;if(t!==null&&e!==null&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let n,s;if(t.constructor===Array){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(oT(t[s],e[s])!==!0)return!1;return!0}if(t.constructor===Map){if(t.size!==e.size)return!1;let i=t.entries();for(s=i.next();s.done!==!0;){if(e.has(s.value[0])!==!0)return!1;s=i.next()}for(i=t.entries(),s=i.next();s.done!==!0;){if(oT(s.value[1],e.get(s.value[0]))!==!0)return!1;s=i.next()}return!0}if(t.constructor===Set){if(t.size!==e.size)return!1;const i=t.entries();for(s=i.next();s.done!==!0;){if(e.has(s.value[0])!==!0)return!1;s=i.next()}return!0}if(t.buffer!=null&&t.buffer.constructor===ArrayBuffer){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(t[s]!==e[s])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const r=Object.keys(t).filter(i=>t[i]!==void 0);if(n=r.length,n!==Object.keys(e).filter(i=>e[i]!==void 0).length)return!1;for(s=n;s--!==0;){const i=r[s];if(oT(t[i],e[i])!==!0)return!1}return!0}return t!==t&&e!==e}function ug(t){return t!==null&&typeof t=="object"&&Array.isArray(t)!==!0}function Sve(t){return Object.prototype.toString.call(t)==="[object Date]"}function Rve(t){return typeof t=="number"&&isFinite(t)}const kx=[iI,Eie,ts,pie,Iie,Sa,jy];function Aie(t,e){const n=E9(t);n.config.globalProperties=e.config.globalProperties;const{reload:s,...r}=e._context;return Object.assign(n._context,r),n}function Px(t,e){e.forEach(n=>{n.install(t),n.__installed=!0})}function kie(t,e,n){t.config.globalProperties.$q=n.$q,t.provide(R9,n.$q),Px(n,kx),e.components!==void 0&&Object.values(e.components).forEach(s=>{ug(s)===!0&&s.name!==void 0&&t.component(s.name,s)}),e.directives!==void 0&&Object.values(e.directives).forEach(s=>{ug(s)===!0&&s.name!==void 0&&t.directive(s.name,s)}),e.plugins!==void 0&&Px(n,Object.values(e.plugins).filter(s=>typeof s.install=="function"&&kx.includes(s)===!1)),Wc.value===!0&&(n.$q.onSSRHydrated=()=>{n.onSSRHydrated.forEach(s=>{s()}),n.$q.onSSRHydrated=()=>{}})}const Pie=function(t,e={}){const n={version:"2.18.2"};A9===!1?(e.config!==void 0&&Object.assign($y,e.config),n.config={...$y},Rie()):n.config=e.config||{},kie(t,e,{parentApp:t,$q:n,lang:e.lang,iconSet:e.iconSet,onSSRHydrated:[]})},Nie={name:"Quasar",version:"2.18.2",install:Pie,lang:Sa,iconSet:jy};/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Ou=typeof document<"u";function k9(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function xie(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&k9(t.default)}const yt=Object.assign;function aT(t,e){const n={};for(const s in e){const r=e[s];n[s]=ci(r)?r.map(t):t(r)}return n}const gp=()=>{},ci=Array.isArray,P9=/#/g,Die=/&/g,Oie=/\//g,Lie=/=/g,Mie=/\?/g,N9=/\+/g,Vie=/%5B/g,Fie=/%5D/g,x9=/%5E/g,Uie=/%60/g,D9=/%7B/g,qie=/%7C/g,O9=/%7D/g,Bie=/%20/g;function xR(t){return encodeURI(""+t).replace(qie,"|").replace(Vie,"[").replace(Fie,"]")}function jie(t){return xR(t).replace(D9,"{").replace(O9,"}").replace(x9,"^")}function lI(t){return xR(t).replace(N9,"%2B").replace(Bie,"+").replace(P9,"%23").replace(Die,"%26").replace(Uie,"`").replace(D9,"{").replace(O9,"}").replace(x9,"^")}function $ie(t){return lI(t).replace(Lie,"%3D")}function zie(t){return xR(t).replace(P9,"%23").replace(Mie,"%3F")}function Hie(t){return t==null?"":zie(t).replace(Oie,"%2F")}function hg(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const Wie=/\/$/,Kie=t=>t.replace(Wie,"");function lT(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("#");let c=e.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(s=e.slice(0,c),i=e.slice(c+1,a>-1?a:e.length),r=t(i)),a>-1&&(s=s||e.slice(0,a),o=e.slice(a,e.length)),s=Xie(s??e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:hg(o)}}function Gie(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Nx(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Qie(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&Rh(e.matched[s],n.matched[r])&&L9(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Rh(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function L9(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Yie(t[n],e[n]))return!1;return!0}function Yie(t,e){return ci(t)?xx(t,e):ci(e)?xx(e,t):t===e}function xx(t,e){return ci(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function Xie(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/"),r=s[s.length-1];(r===".."||r===".")&&s.push("");let i=n.length-1,o,a;for(o=0;o<s.length;o++)if(a=s[o],a!==".")if(a==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+s.slice(o).join("/")}const fa={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var dg;(function(t){t.pop="pop",t.push="push"})(dg||(dg={}));var mp;(function(t){t.back="back",t.forward="forward",t.unknown=""})(mp||(mp={}));function Jie(t){if(!t)if(Ou){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),Kie(t)}const Zie=/^[^#]+#/;function eoe(t,e){return t.replace(Zie,"#")+e}function toe(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const Gw=()=>({left:window.scrollX,top:window.scrollY});function noe(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=toe(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Dx(t,e){return(history.state?history.state.position-e:-1)+t}const cI=new Map;function soe(t,e){cI.set(t,e)}function roe(t){const e=cI.get(t);return cI.delete(t),e}let ioe=()=>location.protocol+"//"+location.host;function M9(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let a=r.includes(t.slice(i))?t.slice(i).length:1,c=r.slice(a);return c[0]!=="/"&&(c="/"+c),Nx(c,"")}return Nx(n,t)+s+r}function ooe(t,e,n,s){let r=[],i=[],o=null;const a=({state:p})=>{const m=M9(t,location),w=n.value,R=e.value;let k=0;if(p){if(n.value=m,e.value=p,o&&o===w){o=null;return}k=R?p.position-R.position:0}else s(m);r.forEach(O=>{O(n.value,w,{delta:k,type:dg.pop,direction:k?k>0?mp.forward:mp.back:mp.unknown})})};function c(){o=n.value}function u(p){r.push(p);const m=()=>{const w=r.indexOf(p);w>-1&&r.splice(w,1)};return i.push(m),m}function h(){const{history:p}=window;p.state&&p.replaceState(yt({},p.state,{scroll:Gw()}),"")}function d(){for(const p of i)p();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",h,{passive:!0}),{pauseListeners:c,listen:u,destroy:d}}function Ox(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?Gw():null}}function aoe(t){const{history:e,location:n}=window,s={value:M9(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,h){const d=t.indexOf("#"),p=d>-1?(n.host&&document.querySelector("base")?t:t.slice(d))+c:ioe()+t+c;try{e[h?"replaceState":"pushState"](u,"",p),r.value=u}catch(m){console.error(m),n[h?"replace":"assign"](p)}}function o(c,u){const h=yt({},e.state,Ox(r.value.back,c,r.value.forward,!0),u,{position:r.value.position});i(c,h,!0),s.value=c}function a(c,u){const h=yt({},r.value,e.state,{forward:c,scroll:Gw()});i(h.current,h,!0);const d=yt({},Ox(s.value,c,null),{position:h.position+1},u);i(c,d,!1),s.value=c}return{location:s,state:r,push:a,replace:o}}function loe(t){t=Jie(t);const e=aoe(t),n=ooe(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=yt({location:"",base:t,go:s,createHref:eoe.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function coe(t){return typeof t=="string"||t&&typeof t=="object"}function V9(t){return typeof t=="string"||typeof t=="symbol"}const F9=Symbol("");var Lx;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Lx||(Lx={}));function Ah(t,e){return yt(new Error,{type:t,[F9]:!0},e)}function yo(t,e){return t instanceof Error&&F9 in t&&(e==null||!!(t.type&e))}const Mx="[^/]+?",uoe={sensitive:!1,strict:!1,start:!0,end:!0},hoe=/[.+*?^${}()[\]/\\]/g;function doe(t,e){const n=yt({},uoe,e),s=[];let r=n.start?"^":"";const i=[];for(const u of t){const h=u.length?[]:[90];n.strict&&!u.length&&(r+="/");for(let d=0;d<u.length;d++){const p=u[d];let m=40+(n.sensitive?.25:0);if(p.type===0)d||(r+="/"),r+=p.value.replace(hoe,"\\$&"),m+=40;else if(p.type===1){const{value:w,repeatable:R,optional:k,regexp:O}=p;i.push({name:w,repeatable:R,optional:k});const M=O||Mx;if(M!==Mx){m+=10;try{new RegExp(`(${M})`)}catch(q){throw new Error(`Invalid custom RegExp for param "${w}" (${M}): `+q.message)}}let F=R?`((?:${M})(?:/(?:${M}))*)`:`(${M})`;d||(F=k&&u.length<2?`(?:/${F})`:"/"+F),k&&(F+="?"),r+=F,m+=20,k&&(m+=-8),R&&(m+=-20),M===".*"&&(m+=-50)}h.push(m)}s.push(h)}if(n.strict&&n.end){const u=s.length-1;s[u][s[u].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(u){const h=u.match(o),d={};if(!h)return null;for(let p=1;p<h.length;p++){const m=h[p]||"",w=i[p-1];d[w.name]=m&&w.repeatable?m.split("/"):m}return d}function c(u){let h="",d=!1;for(const p of t){(!d||!h.endsWith("/"))&&(h+="/"),d=!1;for(const m of p)if(m.type===0)h+=m.value;else if(m.type===1){const{value:w,repeatable:R,optional:k}=m,O=w in u?u[w]:"";if(ci(O)&&!R)throw new Error(`Provided param "${w}" is an array but it is not repeatable (* or + modifiers)`);const M=ci(O)?O.join("/"):O;if(!M)if(k)p.length<2&&(h.endsWith("/")?h=h.slice(0,-1):d=!0);else throw new Error(`Missing required param "${w}"`);h+=M}}return h||"/"}return{re:o,score:s,keys:i,parse:a,stringify:c}}function foe(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function U9(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=foe(s[n],r[n]);if(i)return i;n++}if(Math.abs(r.length-s.length)===1){if(Vx(s))return 1;if(Vx(r))return-1}return r.length-s.length}function Vx(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const poe={type:0,value:""},goe=/[a-zA-Z0-9_]/;function moe(t){if(!t)return[[]];if(t==="/")return[[poe]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(m){throw new Error(`ERR (${n})/"${u}": ${m}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,c,u="",h="";function d(){u&&(n===0?i.push({type:0,value:u}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:h,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function p(){u+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:c==="/"?(u&&d(),o()):c===":"?(d(),n=1):p();break;case 4:p(),n=s;break;case 1:c==="("?n=2:goe.test(c)?p():(d(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+c:n=3:h+=c;break;case 3:d(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,h="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${u}"`),d(),o(),r}function _oe(t,e,n){const s=doe(moe(t.path),n),r=yt(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function yoe(t,e){const n=[],s=new Map;e=Bx({strict:!1,end:!0,sensitive:!1},e);function r(d){return s.get(d)}function i(d,p,m){const w=!m,R=Ux(d);R.aliasOf=m&&m.record;const k=Bx(e,d),O=[R];if("alias"in d){const q=typeof d.alias=="string"?[d.alias]:d.alias;for(const H of q)O.push(Ux(yt({},R,{components:m?m.record.components:R.components,path:H,aliasOf:m?m.record:R})))}let M,F;for(const q of O){const{path:H}=q;if(p&&H[0]!=="/"){const J=p.record.path,I=J[J.length-1]==="/"?"":"/";q.path=p.record.path+(H&&I+H)}if(M=_oe(q,p,k),m?m.alias.push(M):(F=F||M,F!==M&&F.alias.push(M),w&&d.name&&!qx(M)&&o(d.name)),q9(M)&&c(M),R.children){const J=R.children;for(let I=0;I<J.length;I++)i(J[I],M,m&&m.children[I])}m=m||M}return F?()=>{o(F)}:gp}function o(d){if(V9(d)){const p=s.get(d);p&&(s.delete(d),n.splice(n.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=n.indexOf(d);p>-1&&(n.splice(p,1),d.record.name&&s.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return n}function c(d){const p=Eoe(d,n);n.splice(p,0,d),d.record.name&&!qx(d)&&s.set(d.record.name,d)}function u(d,p){let m,w={},R,k;if("name"in d&&d.name){if(m=s.get(d.name),!m)throw Ah(1,{location:d});k=m.record.name,w=yt(Fx(p.params,m.keys.filter(F=>!F.optional).concat(m.parent?m.parent.keys.filter(F=>F.optional):[]).map(F=>F.name)),d.params&&Fx(d.params,m.keys.map(F=>F.name))),R=m.stringify(w)}else if(d.path!=null)R=d.path,m=n.find(F=>F.re.test(R)),m&&(w=m.parse(R),k=m.record.name);else{if(m=p.name?s.get(p.name):n.find(F=>F.re.test(p.path)),!m)throw Ah(1,{location:d,currentLocation:p});k=m.record.name,w=yt({},p.params,d.params),R=m.stringify(w)}const O=[];let M=m;for(;M;)O.unshift(M.record),M=M.parent;return{name:k,path:R,params:w,matched:O,meta:woe(O)}}t.forEach(d=>i(d));function h(){n.length=0,s.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:h,getRoutes:a,getRecordMatcher:r}}function Fx(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function Ux(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:voe(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function voe(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="object"?n[s]:n;return e}function qx(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function woe(t){return t.reduce((e,n)=>yt(e,n.meta),{})}function Bx(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function Eoe(t,e){let n=0,s=e.length;for(;n!==s;){const i=n+s>>1;U9(t,e[i])<0?s=i:n=i+1}const r=boe(t);return r&&(s=e.lastIndexOf(r,s-1)),s}function boe(t){let e=t;for(;e=e.parent;)if(q9(e)&&U9(t,e)===0)return e}function q9({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function Toe(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(N9," "),o=i.indexOf("="),a=hg(o<0?i:i.slice(0,o)),c=o<0?null:hg(i.slice(o+1));if(a in e){let u=e[a];ci(u)||(u=e[a]=[u]),u.push(c)}else e[a]=c}return e}function jx(t){let e="";for(let n in t){const s=t[n];if(n=$ie(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(ci(s)?s.map(i=>i&&lI(i)):[s&&lI(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function Coe(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=ci(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}const Ioe=Symbol(""),$x=Symbol(""),Qw=Symbol(""),DR=Symbol(""),uI=Symbol("");function pf(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Ra(t,e,n,s,r,i=o=>o()){const o=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((a,c)=>{const u=p=>{p===!1?c(Ah(4,{from:n,to:e})):p instanceof Error?c(p):coe(p)?c(Ah(2,{from:e,to:p})):(o&&s.enterCallbacks[r]===o&&typeof p=="function"&&o.push(p),a())},h=i(()=>t.call(s&&s.instances[r],e,n,u));let d=Promise.resolve(h);t.length<3&&(d=d.then(u)),d.catch(p=>c(p))})}function cT(t,e,n,s,r=i=>i()){const i=[];for(const o of t)for(const a in o.components){let c=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(k9(c)){const h=(c.__vccOpts||c)[e];h&&i.push(Ra(h,n,s,o,a,r))}else{let u=c();i.push(()=>u.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=xie(h)?h.default:h;o.mods[a]=h,o.components[a]=d;const m=(d.__vccOpts||d)[e];return m&&Ra(m,n,s,o,a,r)()}))}}return i}function zx(t){const e=_r(Qw),n=_r(DR),s=Ee(()=>{const c=Nc(t.to);return e.resolve(c)}),r=Ee(()=>{const{matched:c}=s.value,{length:u}=c,h=c[u-1],d=n.matched;if(!h||!d.length)return-1;const p=d.findIndex(Rh.bind(null,h));if(p>-1)return p;const m=Hx(c[u-2]);return u>1&&Hx(h)===m&&d[d.length-1].path!==m?d.findIndex(Rh.bind(null,c[u-2])):p}),i=Ee(()=>r.value>-1&&Poe(n.params,s.value.params)),o=Ee(()=>r.value>-1&&r.value===n.matched.length-1&&L9(n.params,s.value.params));function a(c={}){if(koe(c)){const u=e[Nc(t.replace)?"replace":"push"](Nc(t.to)).catch(gp);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:s,href:Ee(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}function Soe(t){return t.length===1?t[0]:t}const Roe=qw({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:zx,setup(t,{slots:e}){const n=Jh(zx(t)),{options:s}=_r(Qw),r=Ee(()=>({[Wx(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[Wx(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&Soe(e.default(n));return t.custom?i:Ve("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),Aoe=Roe;function koe(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Poe(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!ci(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function Hx(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Wx=(t,e,n)=>t??e??n,Noe=qw({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=_r(uI),r=Ee(()=>t.route||s.value),i=_r($x,0),o=Ee(()=>{let u=Nc(i);const{matched:h}=r.value;let d;for(;(d=h[u])&&!d.components;)u++;return u}),a=Ee(()=>r.value.matched[o.value]);v_($x,Ee(()=>o.value+1)),v_(Ioe,a),v_(uI,r);const c=gl();return fp(()=>[c.value,a.value,t.name],([u,h,d],[p,m,w])=>{h&&(h.instances[d]=u,m&&m!==h&&u&&u===p&&(h.leaveGuards.size||(h.leaveGuards=m.leaveGuards),h.updateGuards.size||(h.updateGuards=m.updateGuards))),u&&h&&(!m||!Rh(h,m)||!p)&&(h.enterCallbacks[d]||[]).forEach(R=>R(u))},{flush:"post"}),()=>{const u=r.value,h=t.name,d=a.value,p=d&&d.components[h];if(!p)return Kx(n.default,{Component:p,route:u});const m=d.props[h],w=m?m===!0?u.params:typeof m=="function"?m(u):m:null,k=Ve(p,yt({},w,e,{onVnodeUnmounted:O=>{O.component.isUnmounted&&(d.instances[h]=null)},ref:c}));return Kx(n.default,{Component:k,route:u})||k}}});function Kx(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const xoe=Noe;function Doe(t){const e=yoe(t.routes,t),n=t.parseQuery||Toe,s=t.stringifyQuery||jx,r=t.history,i=pf(),o=pf(),a=pf(),c=rse(fa);let u=fa;Ou&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=aT.bind(null,V=>""+V),d=aT.bind(null,Hie),p=aT.bind(null,hg);function m(V,Y){let Q,ee;return V9(V)?(Q=e.getRecordMatcher(V),ee=Y):ee=V,e.addRoute(ee,Q)}function w(V){const Y=e.getRecordMatcher(V);Y&&e.removeRoute(Y)}function R(){return e.getRoutes().map(V=>V.record)}function k(V){return!!e.getRecordMatcher(V)}function O(V,Y){if(Y=yt({},Y||c.value),typeof V=="string"){const N=lT(n,V,Y.path),L=e.resolve({path:N.path},Y),U=r.createHref(N.fullPath);return yt(N,L,{params:p(L.params),hash:hg(N.hash),redirectedFrom:void 0,href:U})}let Q;if(V.path!=null)Q=yt({},V,{path:lT(n,V.path,Y.path).path});else{const N=yt({},V.params);for(const L in N)N[L]==null&&delete N[L];Q=yt({},V,{params:d(N)}),Y.params=d(Y.params)}const ee=e.resolve(Q,Y),x=V.hash||"";ee.params=h(p(ee.params));const b=Gie(s,yt({},V,{hash:jie(x),path:ee.path})),A=r.createHref(b);return yt({fullPath:b,hash:x,query:s===jx?Coe(V.query):V.query||{}},ee,{redirectedFrom:void 0,href:A})}function M(V){return typeof V=="string"?lT(n,V,c.value.path):yt({},V)}function F(V,Y){if(u!==V)return Ah(8,{from:Y,to:V})}function q(V){return I(V)}function H(V){return q(yt(M(V),{replace:!0}))}function J(V){const Y=V.matched[V.matched.length-1];if(Y&&Y.redirect){const{redirect:Q}=Y;let ee=typeof Q=="function"?Q(V):Q;return typeof ee=="string"&&(ee=ee.includes("?")||ee.includes("#")?ee=M(ee):{path:ee},ee.params={}),yt({query:V.query,hash:V.hash,params:ee.path!=null?{}:V.params},ee)}}function I(V,Y){const Q=u=O(V),ee=c.value,x=V.state,b=V.force,A=V.replace===!0,N=J(Q);if(N)return I(yt(M(N),{state:typeof N=="object"?yt({},x,N.state):x,force:b,replace:A}),Y||Q);const L=Q;L.redirectedFrom=Y;let U;return!b&&Qie(s,ee,Q)&&(U=Ah(16,{to:L,from:ee}),Wt(ee,ee,!0,!1)),(U?Promise.resolve(U):C(L,ee)).catch(B=>yo(B)?yo(B,2)?B:Ht(B):ve(B,L,ee)).then(B=>{if(B){if(yo(B,2))return I(yt({replace:A},M(B.to),{state:typeof B.to=="object"?yt({},x,B.to.state):x,force:b}),Y||L)}else B=T(L,ee,!0,A,x);return S(L,ee,B),B})}function v(V,Y){const Q=F(V,Y);return Q?Promise.reject(Q):Promise.resolve()}function y(V){const Y=Bn.values().next().value;return Y&&typeof Y.runWithContext=="function"?Y.runWithContext(V):V()}function C(V,Y){let Q;const[ee,x,b]=Ooe(V,Y);Q=cT(ee.reverse(),"beforeRouteLeave",V,Y);for(const N of ee)N.leaveGuards.forEach(L=>{Q.push(Ra(L,V,Y))});const A=v.bind(null,V,Y);return Q.push(A),Tt(Q).then(()=>{Q=[];for(const N of i.list())Q.push(Ra(N,V,Y));return Q.push(A),Tt(Q)}).then(()=>{Q=cT(x,"beforeRouteUpdate",V,Y);for(const N of x)N.updateGuards.forEach(L=>{Q.push(Ra(L,V,Y))});return Q.push(A),Tt(Q)}).then(()=>{Q=[];for(const N of b)if(N.beforeEnter)if(ci(N.beforeEnter))for(const L of N.beforeEnter)Q.push(Ra(L,V,Y));else Q.push(Ra(N.beforeEnter,V,Y));return Q.push(A),Tt(Q)}).then(()=>(V.matched.forEach(N=>N.enterCallbacks={}),Q=cT(b,"beforeRouteEnter",V,Y,y),Q.push(A),Tt(Q))).then(()=>{Q=[];for(const N of o.list())Q.push(Ra(N,V,Y));return Q.push(A),Tt(Q)}).catch(N=>yo(N,8)?N:Promise.reject(N))}function S(V,Y,Q){a.list().forEach(ee=>y(()=>ee(V,Y,Q)))}function T(V,Y,Q,ee,x){const b=F(V,Y);if(b)return b;const A=Y===fa,N=Ou?history.state:{};Q&&(ee||A?r.replace(V.fullPath,yt({scroll:A&&N&&N.scroll},x)):r.push(V.fullPath,x)),c.value=V,Wt(V,Y,Q,A),Ht()}let E;function K(){E||(E=r.listen((V,Y,Q)=>{if(!hn.listening)return;const ee=O(V),x=J(ee);if(x){I(yt(x,{replace:!0,force:!0}),ee).catch(gp);return}u=ee;const b=c.value;Ou&&soe(Dx(b.fullPath,Q.delta),Gw()),C(ee,b).catch(A=>yo(A,12)?A:yo(A,2)?(I(yt(M(A.to),{force:!0}),ee).then(N=>{yo(N,20)&&!Q.delta&&Q.type===dg.pop&&r.go(-1,!1)}).catch(gp),Promise.reject()):(Q.delta&&r.go(-Q.delta,!1),ve(A,ee,b))).then(A=>{A=A||T(ee,b,!1),A&&(Q.delta&&!yo(A,8)?r.go(-Q.delta,!1):Q.type===dg.pop&&yo(A,20)&&r.go(-1,!1)),S(ee,b,A)}).catch(gp)}))}let oe=pf(),ge=pf(),de;function ve(V,Y,Q){Ht(V);const ee=ge.list();return ee.length?ee.forEach(x=>x(V,Y,Q)):console.error(V),Promise.reject(V)}function Kt(){return de&&c.value!==fa?Promise.resolve():new Promise((V,Y)=>{oe.add([V,Y])})}function Ht(V){return de||(de=!V,K(),oe.list().forEach(([Y,Q])=>V?Q(V):Y()),oe.reset()),V}function Wt(V,Y,Q,ee){const{scrollBehavior:x}=t;if(!Ou||!x)return Promise.resolve();const b=!Q&&roe(Dx(V.fullPath,0))||(ee||!Q)&&history.state&&history.state.scroll||null;return R6().then(()=>x(V,Y,b)).then(A=>A&&noe(A)).catch(A=>ve(A,V,Y))}const Fe=V=>r.go(V);let De;const Bn=new Set,hn={currentRoute:c,listening:!0,addRoute:m,removeRoute:w,clearRoutes:e.clearRoutes,hasRoute:k,getRoutes:R,resolve:O,options:t,push:q,replace:H,go:Fe,back:()=>Fe(-1),forward:()=>Fe(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:ge.add,isReady:Kt,install(V){const Y=this;V.component("RouterLink",Aoe),V.component("RouterView",xoe),V.config.globalProperties.$router=Y,Object.defineProperty(V.config.globalProperties,"$route",{enumerable:!0,get:()=>Nc(c)}),Ou&&!De&&c.value===fa&&(De=!0,q(r.location).catch(x=>{}));const Q={};for(const x in fa)Object.defineProperty(Q,x,{get:()=>c.value[x],enumerable:!0});V.provide(Qw,Y),V.provide(DR,b6(Q)),V.provide(uI,c);const ee=V.unmount;Bn.add(V),V.unmount=function(){Bn.delete(V),Bn.size<1&&(u=fa,E&&E(),E=null,c.value=fa,De=!1,de=!1),ee()}}};function Tt(V){return V.reduce((Y,Q)=>Y.then(()=>y(Q)),Promise.resolve())}return hn}function Ooe(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(u=>Rh(u,a))?s.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(u=>Rh(u,c))||r.push(c))}return[n,s,r]}function Loe(){return _r(Qw)}function Moe(t){return _r(DR)}const Voe=()=>{};var Gx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const he=function(t,e){if(!t)throw Zh(e)},Zh=function(t){return new Error("Firebase Database ("+B9.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Foe=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},OR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,h=i>>2,d=(i&3)<<4|a>>4;let p=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(p=64)),s.push(n[h],n[d],n[p],n[m])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(j9(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Foe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const d=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||u==null||d==null)throw new Uoe;const p=i<<2|a>>4;if(s.push(p),u!==64){const m=a<<4&240|u>>2;if(s.push(m),d!==64){const w=u<<6&192|d;s.push(w)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Uoe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $9=function(t){const e=j9(t);return OR.encodeByteArray(e,!0)},zy=function(t){return $9(t).replace(/\./g,"")},Hy=function(t){try{return OR.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qoe(t){return z9(void 0,t)}function z9(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Boe(n)||(t[n]=z9(t[n],e[n]));return t}function Boe(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function joe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $oe=()=>joe().__FIREBASE_DEFAULTS__,zoe=()=>{if(typeof process>"u"||typeof Gx>"u")return;const t=Gx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Hoe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Hy(t[1]);return e&&JSON.parse(e)},Yw=()=>{try{return Voe()||$oe()||zoe()||Hoe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},H9=t=>Yw()?.emulatorHosts?.[t],LR=t=>{const e=H9(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},W9=()=>Yw()?.config,K9=t=>Yw()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Jw(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[zy(JSON.stringify(n)),zy(JSON.stringify(o)),""].join(".")}const _p={};function Woe(){const t={prod:[],emulator:[]};for(const e of Object.keys(_p))_p[e]?t.emulator.push(e):t.prod.push(e);return t}function Koe(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Qx=!1;function Zw(t,e){if(typeof window>"u"||typeof document>"u"||!Yi(window.location.host)||_p[t]===e||_p[t]||Qx)return;_p[t]=e;function n(p){return`__firebase__banner__${p}`}const s="__firebase__banner",i=Woe().prod.length>0;function o(){const p=document.getElementById(s);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,m){p.setAttribute("width","24"),p.setAttribute("id",m),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function u(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Qx=!0,o()},p}function h(p,m){p.setAttribute("id",m),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=Koe(s),m=n("text"),w=document.getElementById(m)||document.createElement("span"),R=n("learnmore"),k=document.getElementById(R)||document.createElement("a"),O=n("preprendIcon"),M=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const F=p.element;a(F),h(k,R);const q=u();c(M,O),F.append(M,w,k,q),document.body.appendChild(F)}i?(w.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function VR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ys())}function Goe(){const t=Yw()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Qoe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Yoe(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function G9(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Xoe(){const t=ys();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Joe(){return B9.NODE_ADMIN===!0}function Zoe(){return!Goe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function eae(){try{return typeof indexedDB=="object"}catch{return!1}}function tae(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nae="FirebaseError";class Xi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=nae,Object.setPrototypeOf(this,Xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sm.prototype.create)}}class sm{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?sae(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Xi(r,a,s)}}function sae(t,e){return t.replace(rae,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const rae=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(t){return JSON.parse(t)}function An(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q9=function(t){let e={},n={},s={},r="";try{const i=t.split(".");e=fg(Hy(i[0])||""),n=fg(Hy(i[1])||""),r=i[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:r}},iae=function(t){const e=Q9(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},oae=function(t){const e=Q9(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aa(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function kh(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function hI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Wy(t,e,n){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=e.call(n,t[r],r,t));return s}function _l(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(Yx(i)&&Yx(o)){if(!_l(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Yx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ed(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aae{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)s[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)s[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){const p=s[d-3]^s[d-8]^s[d-14]^s[d-16];s[d]=(p<<1|p>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],u,h;for(let d=0;d<80;d++){d<40?d<20?(u=a^i&(o^a),h=1518500249):(u=i^o^a,h=1859775393):d<60?(u=i&o|a&(i|o),h=2400959708):(u=i^o^a,h=3395469782);const p=(r<<5|r>>>27)+u+c+h+s[d]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=p}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<n;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function lae(t,e){const n=new cae(t,e);return n.subscribe.bind(n)}class cae{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");uae(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=uT),r.error===void 0&&(r.error=uT),r.complete===void 0&&(r.complete=uT);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uae(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function uT(){}function FR(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hae=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,he(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},eE=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t){return t&&t._delegate?t._delegate:t}class Xo{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dae{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Xw;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pae(e))try{this.getOrInitializeService({instanceIdentifier:uc})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=uc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=uc){return this.instances.has(e)}getOptions(e=uc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:fae(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=uc){return this.component?this.component.multipleInstances?e:uc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function fae(t){return t===uc?void 0:t}function pae(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gae{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new dae(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Xe||(Xe={}));const mae={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},_ae=Xe.INFO,yae={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},vae=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=yae[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tE{constructor(e){this.name=e,this._logLevel=_ae,this._logHandler=vae,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mae[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}}const wae=(t,e)=>e.some(n=>t instanceof n);let Xx,Jx;function Eae(){return Xx||(Xx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bae(){return Jx||(Jx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Y9=new WeakMap,dI=new WeakMap,X9=new WeakMap,hT=new WeakMap,UR=new WeakMap;function Tae(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ha(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Y9.set(n,t)}).catch(()=>{}),UR.set(e,t),e}function Cae(t){if(dI.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});dI.set(t,e)}let fI={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return dI.get(t);if(e==="objectStoreNames")return t.objectStoreNames||X9.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ha(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Iae(t){fI=t(fI)}function Sae(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(dT(this),e,...n);return X9.set(s,e.sort?e.sort():[e]),Ha(s)}:bae().includes(t)?function(...e){return t.apply(dT(this),e),Ha(Y9.get(this))}:function(...e){return Ha(t.apply(dT(this),e))}}function Rae(t){return typeof t=="function"?Sae(t):(t instanceof IDBTransaction&&Cae(t),wae(t,Eae())?new Proxy(t,fI):t)}function Ha(t){if(t instanceof IDBRequest)return Tae(t);if(hT.has(t))return hT.get(t);const e=Rae(t);return e!==t&&(hT.set(t,e),UR.set(e,t)),e}const dT=t=>UR.get(t);function Aae(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=Ha(o);return s&&o.addEventListener("upgradeneeded",c=>{s(Ha(o.result),c.oldVersion,c.newVersion,Ha(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const kae=["get","getKey","getAll","getAllKeys","count"],Pae=["put","add","delete","clear"],fT=new Map;function Zx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(fT.get(e))return fT.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=Pae.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||kae.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),r&&c.done]))[0]};return fT.set(e,i),i}Iae(t=>({...t,get:(e,n,s)=>Zx(e,n)||t.get(e,n,s),has:(e,n)=>!!Zx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(xae(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function xae(t){return t.getComponent()?.type==="VERSION"}const pI="@firebase/app",eD="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo=new tE("@firebase/app"),Dae="@firebase/app-compat",Oae="@firebase/analytics-compat",Lae="@firebase/analytics",Mae="@firebase/app-check-compat",Vae="@firebase/app-check",Fae="@firebase/auth",Uae="@firebase/auth-compat",qae="@firebase/database",Bae="@firebase/data-connect",jae="@firebase/database-compat",$ae="@firebase/functions",zae="@firebase/functions-compat",Hae="@firebase/installations",Wae="@firebase/installations-compat",Kae="@firebase/messaging",Gae="@firebase/messaging-compat",Qae="@firebase/performance",Yae="@firebase/performance-compat",Xae="@firebase/remote-config",Jae="@firebase/remote-config-compat",Zae="@firebase/storage",ele="@firebase/storage-compat",tle="@firebase/firestore",nle="@firebase/ai",sle="@firebase/firestore-compat",rle="firebase",ile="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI="[DEFAULT]",ole={[pI]:"fire-core",[Dae]:"fire-core-compat",[Lae]:"fire-analytics",[Oae]:"fire-analytics-compat",[Vae]:"fire-app-check",[Mae]:"fire-app-check-compat",[Fae]:"fire-auth",[Uae]:"fire-auth-compat",[qae]:"fire-rtdb",[Bae]:"fire-data-connect",[jae]:"fire-rtdb-compat",[$ae]:"fire-fn",[zae]:"fire-fn-compat",[Hae]:"fire-iid",[Wae]:"fire-iid-compat",[Kae]:"fire-fcm",[Gae]:"fire-fcm-compat",[Qae]:"fire-perf",[Yae]:"fire-perf-compat",[Xae]:"fire-rc",[Jae]:"fire-rc-compat",[Zae]:"fire-gcs",[ele]:"fire-gcs-compat",[tle]:"fire-fst",[sle]:"fire-fst-compat",[nle]:"fire-vertex","fire-js":"fire-js",[rle]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ky=new Map,ale=new Map,mI=new Map;function tD(t,e){try{t.container.addComponent(e)}catch(n){Jo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function yl(t){const e=t.name;if(mI.has(e))return Jo.debug(`There were multiple attempts to register component ${e}.`),!1;mI.set(e,t);for(const n of Ky.values())tD(n,t);for(const n of ale.values())tD(n,t);return!0}function rm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function er(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lle={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Wa=new sm("app","Firebase",lle);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cle{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Xo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Wa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol=ile;function J9(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:gI,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw Wa.create("bad-app-name",{appName:String(r)});if(n||(n=W9()),!n)throw Wa.create("no-options");const i=Ky.get(r);if(i){if(_l(n,i.options)&&_l(s,i.config))return i;throw Wa.create("duplicate-app",{appName:r})}const o=new gae(r);for(const c of mI.values())o.addComponent(c);const a=new cle(n,s,o);return Ky.set(r,a),a}function nE(t=gI){const e=Ky.get(t);if(!e&&t===gI&&W9())return J9();if(!e)throw Wa.create("no-app",{appName:t});return e}function yr(t,e,n){let s=ole[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jo.warn(o.join(" "));return}yl(new Xo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ule="firebase-heartbeat-database",hle=1,pg="firebase-heartbeat-store";let pT=null;function Z9(){return pT||(pT=Aae(ule,hle,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(pg)}catch(n){console.warn(n)}}}}).catch(t=>{throw Wa.create("idb-open",{originalErrorMessage:t.message})})),pT}async function dle(t){try{const n=(await Z9()).transaction(pg),s=await n.objectStore(pg).get(eq(t));return await n.done,s}catch(e){if(e instanceof Xi)Jo.warn(e.message);else{const n=Wa.create("idb-get",{originalErrorMessage:e?.message});Jo.warn(n.message)}}}async function nD(t,e){try{const s=(await Z9()).transaction(pg,"readwrite");await s.objectStore(pg).put(e,eq(t)),await s.done}catch(n){if(n instanceof Xi)Jo.warn(n.message);else{const s=Wa.create("idb-set",{originalErrorMessage:n?.message});Jo.warn(s.message)}}}function eq(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fle=1024,ple=30;class gle{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new _le(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=sD();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>ple){const r=yle(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Jo.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=sD(),{heartbeatsToSend:n,unsentEntries:s}=mle(this._heartbeatsCache.heartbeats),r=zy(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return Jo.warn(e),""}}}function sD(){return new Date().toISOString().substring(0,10)}function mle(t,e=fle){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),rD(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),rD(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class _le{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return eae()?tae().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await dle(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return nD(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return nD(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function rD(t){return zy(JSON.stringify({version:2,heartbeats:t})).length}function yle(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vle(t){yl(new Xo("platform-logger",e=>new Nae(e),"PRIVATE")),yl(new Xo("heartbeat",e=>new gle(e),"PRIVATE")),yr(pI,eD,t),yr(pI,eD,"esm2020"),yr("fire-js","")}vle("");function tq(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wle=tq,nq=new sm("auth","Firebase",tq());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy=new tE("@firebase/auth");function Ele(t,...e){Gy.logLevel<=Xe.WARN&&Gy.warn(`Auth (${Ol}): ${t}`,...e)}function b_(t,...e){Gy.logLevel<=Xe.ERROR&&Gy.error(`Auth (${Ol}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(t,...e){throw BR(t,...e)}function ni(t,...e){return BR(t,...e)}function qR(t,e,n){const s={...wle(),[e]:n};return new sm("auth","Firebase",s).create(e,{appName:t.name})}function Dc(t){return qR(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ble(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&zi(t,"argument-error"),qR(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function BR(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return nq.create(t,...e)}function Me(t,e,...n){if(!t)throw BR(e,...n)}function Lo(t){const e="INTERNAL ASSERTION FAILED: "+t;throw b_(e),new Error(e)}function Zo(t,e){t||Lo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(){return typeof self<"u"&&self.location?.href||""}function Tle(){return iD()==="http:"||iD()==="https:"}function iD(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cle(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Tle()||Yoe()||"connection"in navigator)?navigator.onLine:!0}function Ile(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zo(n>e,"Short delay should be less than long delay!"),this.isMobile=VR()||G9()}get(){return Cle()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(t,e){Zo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sq{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Lo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Lo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Lo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sle={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rle=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Ale=new im(3e4,6e4);function $R(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function td(t,e,n,s,r={}){return rq(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=ed({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...i};return Qoe()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Yi(t.emulatorConfig.host)&&(u.credentials="include"),sq.fetch()(await iq(t,t.config.apiHost,n,a),u)})}async function rq(t,e,n){t._canInitEmulator=!1;const s={...Sle,...e};try{const r=new Ple(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Bm(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bm(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Bm(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Bm(t,"user-disabled",o);const h=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw qR(t,h,u);zi(t,h)}}catch(r){if(r instanceof Xi)throw r;zi(t,"network-request-failed",{message:String(r)})}}async function kle(t,e,n,s,r={}){const i=await td(t,e,n,s,r);return"mfaPendingCredential"in i&&zi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function iq(t,e,n,s){const r=`${e}${n}?${s}`,i=t,o=i.config.emulator?jR(t.config,r):`${t.config.apiScheme}://${r}`;return Rle.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class Ple{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(ni(this.auth,"network-request-failed")),Ale.get())})}}function Bm(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=ni(t,e,s);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nle(t,e){return td(t,"POST","/v1/accounts:delete",e)}async function Qy(t,e){return td(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function xle(t,e=!1){const n=St(t),s=await n.getIdToken(e),r=zR(s);Me(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i?.sign_in_provider;return{claims:r,token:s,authTime:yp(gT(r.auth_time)),issuedAtTime:yp(gT(r.iat)),expirationTime:yp(gT(r.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function gT(t){return Number(t)*1e3}function zR(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return b_("JWT malformed, contained fewer than 3 sections"),null;try{const r=Hy(n);return r?JSON.parse(r):(b_("Failed to decode base64 JWT payload"),null)}catch(r){return b_("Caught error parsing JWT payload as JSON",r?.toString()),null}}function oD(t){const e=zR(t);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gg(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Xi&&Dle(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function Dle({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ole{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=yp(this.lastLoginAt),this.creationTime=yp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yy(t){const e=t.auth,n=await t.getIdToken(),s=await gg(t,Qy(e,{idToken:n}));Me(s?.users.length,e,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const i=r.providerUserInfo?.length?oq(r.providerUserInfo):[],o=Mle(t.providerData,i),a=t.isAnonymous,c=!(t.email&&r.passwordHash)&&!o?.length,u=a?c:!1,h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new yI(r.createdAt,r.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function Lle(t){const e=St(t);await Yy(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Mle(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function oq(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vle(t,e){const n=await rq(t,{},async()=>{const s=ed({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=await iq(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:s};return t.emulatorConfig&&Yi(t.emulatorConfig.host)&&(c.credentials="include"),sq.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Fle(t,e){return td(t,"POST","/v2/accounts:revokeToken",$R(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const n=oD(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await Vle(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new sh;return s&&(Me(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(Me(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(Me(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new sh,this.toJSON())}_performRefresh(){return Lo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pa(t,e){Me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class zr{constructor({uid:e,auth:n,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new Ole(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new yI(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await gg(this,this.stsTokenManager.getToken(this.auth,e));return Me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return xle(this,e)}reload(){return Lle(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Yy(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(er(this.auth.app))return Promise.reject(Dc(this.auth));const e=await this.getIdToken();return await gg(this,Nle(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,r=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:d,emailVerified:p,isAnonymous:m,providerData:w,stsTokenManager:R}=n;Me(d&&R,e,"internal-error");const k=sh.fromJSON(this.name,R);Me(typeof d=="string",e,"internal-error"),pa(s,e.name),pa(r,e.name),Me(typeof p=="boolean",e,"internal-error"),Me(typeof m=="boolean",e,"internal-error"),pa(i,e.name),pa(o,e.name),pa(a,e.name),pa(c,e.name),pa(u,e.name),pa(h,e.name);const O=new zr({uid:d,auth:e,email:r,emailVerified:p,displayName:s,isAnonymous:m,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:k,createdAt:u,lastLoginAt:h});return w&&Array.isArray(w)&&(O.providerData=w.map(M=>({...M}))),c&&(O._redirectEventId=c),O}static async _fromIdTokenResponse(e,n,s=!1){const r=new sh;r.updateFromServerResponse(n);const i=new zr({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Yy(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];Me(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?oq(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!i?.length,a=new sh;a.updateFromIdToken(s);const c=new zr({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new yI(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!i?.length};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD=new Map;function Mo(t){Zo(t instanceof Function,"Expected a class definition");let e=aD.get(t);return e?(Zo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,aD.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aq{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}aq.type="NONE";const lD=aq;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t,e,n){return`firebase:${t}:${e}:${n}`}class rh{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=T_(this.userKey,r.apiKey,i),this.fullPersistenceKey=T_("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Qy(this.auth,{idToken:e}).catch(()=>{});return n?zr._fromGetAccountInfoResponse(this.auth,n,e):null}return zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new rh(Mo(lD),e,s);const r=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=r[0]||Mo(lD);const o=T_(s,e.config.apiKey,e.name);let a=null;for(const u of n)try{const h=await u._get(o);if(h){let d;if(typeof h=="string"){const p=await Qy(e,{idToken:h}).catch(()=>{});if(!p)break;d=await zr._fromGetAccountInfoResponse(e,p,h)}else d=zr._fromJSON(e,h);u!==i&&(a=d),i=u;break}}catch{}const c=r.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new rh(i,e,s):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new rh(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cD(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hq(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lq(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fq(e))return"Blackberry";if(pq(e))return"Webos";if(cq(e))return"Safari";if((e.includes("chrome/")||uq(e))&&!e.includes("edge/"))return"Chrome";if(dq(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if(s?.length===2)return s[1]}return"Other"}function lq(t=ys()){return/firefox\//i.test(t)}function cq(t=ys()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uq(t=ys()){return/crios\//i.test(t)}function hq(t=ys()){return/iemobile/i.test(t)}function dq(t=ys()){return/android/i.test(t)}function fq(t=ys()){return/blackberry/i.test(t)}function pq(t=ys()){return/webos/i.test(t)}function HR(t=ys()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Ule(t=ys()){return HR(t)&&!!window.navigator?.standalone}function qle(){return Xoe()&&document.documentMode===10}function gq(t=ys()){return HR(t)||dq(t)||pq(t)||fq(t)||/windows phone/i.test(t)||hq(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mq(t,e=[]){let n;switch(t){case"Browser":n=cD(ys());break;case"Worker":n=`${cD(ys())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ol}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ble{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jle(t,e={}){return td(t,"GET","/v2/passwordPolicy",$R(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $le=6;class zle{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??$le,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hle{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new uD(this),this.idTokenSubscription=new uD(this),this.beforeStateQueue=new Ble(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nq,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Mo(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await rh.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Qy(this,{idToken:e}),s=await zr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(er(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=s?._redirectEventId,a=await this.tryRedirectSignIn(e);(!i||i===o)&&a?.user&&(s=a.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Yy(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Ile()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(er(this.app))return Promise.reject(Dc(this));const n=e?St(e):null;return n&&Me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return er(this.app)?Promise.reject(Dc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return er(this.app)?Promise.reject(Dc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Mo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jle(this),n=new zle(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new sm("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await Fle(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Mo(e)||this._popupRedirectResolver;Me(n,this,"argument-error"),this.redirectPersistenceManager=await rh.create(this,[Mo(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,s,r);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mq(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Ele(`Error while retrieving App Check token: ${e.error}`),e?.token}}function sE(t){return St(t)}class uD{constructor(e){this.auth=e,this.observer=null,this.addObserver=lae(n=>this.observer=n)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let WR={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Wle(t){WR=t}function Kle(t){return WR.loadJS(t)}function Gle(){return WR.gapiScript}function Qle(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yle(t,e){const n=rm(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(_l(i,e??{}))return r;zi(r,"already-initialized")}return n.initialize({options:e})}function Xle(t,e){const n=e?.persistence||[],s=(Array.isArray(n)?n:[n]).map(Mo);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e?.popupRedirectResolver)}function Jle(t,e,n){const s=sE(t);Me(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=_q(e),{host:o,port:a}=Zle(e),c=a===null?"":`:${a}`,u={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){Me(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Me(_l(u,s.config.emulator)&&_l(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=u,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,Yi(o)?(Jw(`${i}//${o}${c}`),Zw("Auth",!0)):ece()}function _q(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Zle(t){const e=_q(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:hD(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:hD(o)}}}function hD(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ece(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yq{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Lo("not implemented")}_getIdTokenResponse(e){return Lo("not implemented")}_linkToIdToken(e,n){return Lo("not implemented")}_getReauthenticationResolver(e){return Lo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ih(t,e){return kle(t,"POST","/v1/accounts:signInWithIdp",$R(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tce="http://localhost";class Gc extends yq{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Gc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):zi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...i}=n;if(!s||!r)return null;const o=new Gc(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ih(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,ih(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ih(e,n)}buildRequest(){const e={requestUri:tce,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ed(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om extends KR{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka extends om{constructor(){super("facebook.com")}static credential(e){return Gc._fromParams({providerId:ka.PROVIDER_ID,signInMethod:ka.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ka.credentialFromTaggedObject(e)}static credentialFromError(e){return ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ka.credential(e.oauthAccessToken)}catch{return null}}}ka.FACEBOOK_SIGN_IN_METHOD="facebook.com";ka.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No extends om{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Gc._fromParams({providerId:No.PROVIDER_ID,signInMethod:No.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return No.credentialFromTaggedObject(e)}static credentialFromError(e){return No.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return No.credential(n,s)}catch{return null}}}No.GOOGLE_SIGN_IN_METHOD="google.com";No.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa extends om{constructor(){super("github.com")}static credential(e){return Gc._fromParams({providerId:Pa.PROVIDER_ID,signInMethod:Pa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pa.credentialFromTaggedObject(e)}static credentialFromError(e){return Pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pa.credential(e.oauthAccessToken)}catch{return null}}}Pa.GITHUB_SIGN_IN_METHOD="github.com";Pa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na extends om{constructor(){super("twitter.com")}static credential(e,n){return Gc._fromParams({providerId:Na.PROVIDER_ID,signInMethod:Na.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Na.credentialFromTaggedObject(e)}static credentialFromError(e){return Na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Na.credential(n,s)}catch{return null}}}Na.TWITTER_SIGN_IN_METHOD="twitter.com";Na.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await zr._fromIdTokenResponse(e,s,r),o=dD(s);return new Ph({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=dD(s);return new Ph({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function dD(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy extends Xi{constructor(e,n,s,r){super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,Xy.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new Xy(e,n,s,r)}}function vq(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Xy._fromErrorAndOperation(t,i,e,s):i})}async function nce(t,e,n=!1){const s=await gg(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ph._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sce(t,e,n=!1){const{auth:s}=t;if(er(s.app))return Promise.reject(Dc(s));const r="reauthenticate";try{const i=await gg(t,vq(s,r,e,t),n);Me(i.idToken,s,"internal-error");const o=zR(i.idToken);Me(o,s,"internal-error");const{sub:a}=o;return Me(t.uid===a,s,"user-mismatch"),Ph._forOperation(t,r,i)}catch(i){throw i?.code==="auth/user-not-found"&&zi(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rce(t,e,n=!1){if(er(t.app))return Promise.reject(Dc(t));const s="signIn",r=await vq(t,s,e),i=await Ph._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}function ice(t,e,n,s){return St(t).onIdTokenChanged(e,n,s)}function oce(t,e,n){return St(t).beforeAuthStateChanged(e,n)}function ace(t,e,n,s){return St(t).onAuthStateChanged(e,n,s)}function gf(t){return St(t).signOut()}const Jy="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Jy,"1"),this.storage.removeItem(Jy),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lce=1e3,cce=10;class Eq extends wq{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gq(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);qle()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,cce):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},lce)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Eq.type="LOCAL";const uce=Eq;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bq extends wq{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}bq.type="SESSION";const Tq=bq;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hce(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new rE(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async u=>u(n.origin,i)),c=await hce(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rE.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dce{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const u=GR("",20);r.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(d){const p=d;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(){return window}function fce(t){Li().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cq(){return typeof Li().WorkerGlobalScope<"u"&&typeof Li().importScripts=="function"}async function pce(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gce(){return navigator?.serviceWorker?.controller||null}function mce(){return Cq()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iq="firebaseLocalStorageDb",_ce=1,Zy="firebaseLocalStorage",Sq="fbase_key";class am{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function iE(t,e){return t.transaction([Zy],e?"readwrite":"readonly").objectStore(Zy)}function yce(){const t=indexedDB.deleteDatabase(Iq);return new am(t).toPromise()}function vI(){const t=indexedDB.open(Iq,_ce);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(Zy,{keyPath:Sq})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(Zy)?e(s):(s.close(),await yce(),e(await vI()))})})}async function fD(t,e,n){const s=iE(t,!0).put({[Sq]:e,value:n});return new am(s).toPromise()}async function vce(t,e){const n=iE(t,!1).get(e),s=await new am(n).toPromise();return s===void 0?null:s.value}function pD(t,e){const n=iE(t,!0).delete(e);return new am(n).toPromise()}const wce=800,Ece=3;class Rq{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await vI(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>Ece)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Cq()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rE._getInstance(mce()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await pce(),!this.activeServiceWorker)return;this.sender=new dce(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||gce()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await vI();return await fD(e,Jy,"1"),await pD(e,Jy),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>fD(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>vce(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>pD(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=iE(r,!1).getAll();return new am(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wce)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Rq.type="LOCAL";const bce=Rq;new im(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aq(t,e){return e?Mo(e):(Me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR extends yq{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ih(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ih(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ih(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Tce(t){return rce(t.auth,new QR(t),t.bypassAuthState)}function Cce(t){const{auth:e,user:n}=t;return Me(n,e,"internal-error"),sce(n,new QR(t),t.bypassAuthState)}async function Ice(t){const{auth:e,user:n}=t;return Me(n,e,"internal-error"),nce(n,new QR(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kq{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Tce;case"linkViaPopup":case"linkViaRedirect":return Ice;case"reauthViaPopup":case"reauthViaRedirect":return Cce;default:zi(this.auth,"internal-error")}}resolve(e){Zo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sce=new im(2e3,1e4);async function Rce(t,e,n){if(er(t.app))return Promise.reject(ni(t,"operation-not-supported-in-this-environment"));const s=sE(t);ble(t,e,KR);const r=Aq(s,n);return new vc(s,"signInViaPopup",e,r).executeNotNull()}class vc extends kq{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,vc.currentPopupAction&&vc.currentPopupAction.cancel(),vc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){Zo(this.filter.length===1,"Popup operations only handle one event");const e=GR();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ni(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ni(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ni(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Sce.get())};e()}}vc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ace="pendingRedirect",C_=new Map;class kce extends kq{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=C_.get(this.auth._key());if(!e){try{const s=await Pce(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}C_.set(this.auth._key(),e)}return this.bypassAuthState||C_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Pce(t,e){const n=Dce(e),s=xce(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function Nce(t,e){C_.set(t._key(),e)}function xce(t){return Mo(t._redirectPersistence)}function Dce(t){return T_(Ace,t.config.apiKey,t.name)}async function Oce(t,e,n=!1){if(er(t.app))return Promise.reject(Dc(t));const s=sE(t),r=Aq(s,e),o=await new kce(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lce=600*1e3;class Mce{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Vce(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!Pq(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";n.onError(ni(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Lce&&this.cachedEventUids.clear(),this.cachedEventUids.has(gD(e))}saveEventToCache(e){this.cachedEventUids.add(gD(e)),this.lastProcessedEventTime=Date.now()}}function gD(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Pq({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function Vce(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pq(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fce(t,e={}){return td(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uce=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qce=/^https?/;async function Bce(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Fce(t);for(const n of e)try{if(jce(n))return}catch{}zi(t,"unauthorized-domain")}function jce(t){const e=_I(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!qce.test(n))return!1;if(Uce.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $ce=new im(3e4,6e4);function mD(){const t=Li().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function zce(t){return new Promise((e,n)=>{function s(){mD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mD(),n(ni(t,"network-request-failed"))},timeout:$ce.get()})}if(Li().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Li().gapi?.load)s();else{const r=Qle("iframefcb");return Li()[r]=()=>{gapi.load?s():n(ni(t,"network-request-failed"))},Kle(`${Gle()}?onload=${r}`).catch(i=>n(i))}}).catch(e=>{throw I_=null,e})}let I_=null;function Hce(t){return I_=I_||zce(t),I_}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wce=new im(5e3,15e3),Kce="__/auth/iframe",Gce="emulator/auth/iframe",Qce={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Yce=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Xce(t){const e=t.config;Me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?jR(e,Gce):`https://${t.config.authDomain}/${Kce}`,s={apiKey:e.apiKey,appName:t.name,v:Ol},r=Yce.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${ed(s).slice(1)}`}async function Jce(t){const e=await Hce(t),n=Li().gapi;return Me(n,t,"internal-error"),e.open({where:document.body,url:Xce(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Qce,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=ni(t,"network-request-failed"),a=Li().setTimeout(()=>{i(o)},Wce.get());function c(){Li().clearTimeout(a),r(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zce={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},eue=500,tue=600,nue="_blank",sue="http://localhost";class _D{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rue(t,e,n,s=eue,r=tue){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const c={...Zce,width:s.toString(),height:r.toString(),top:i,left:o},u=ys().toLowerCase();n&&(a=uq(u)?nue:n),lq(u)&&(e=e||sue,c.scrollbars="yes");const h=Object.entries(c).reduce((p,[m,w])=>`${p}${m}=${w},`,"");if(Ule(u)&&a!=="_self")return iue(e||"",a),new _D(null);const d=window.open(e||"",a,h);Me(d,t,"popup-blocked");try{d.focus()}catch{}return new _D(d)}function iue(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oue="__/auth/handler",aue="emulator/auth/handler",lue=encodeURIComponent("fac");async function yD(t,e,n,s,r,i){Me(t.config.authDomain,t,"auth-domain-config-required"),Me(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Ol,eventId:r};if(e instanceof KR){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",hI(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(e instanceof om){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),u=c?`#${lue}=${encodeURIComponent(c)}`:"";return`${cue(t)}?${ed(a).slice(1)}${u}`}function cue({config:t}){return t.emulator?jR(t,aue):`https://${t.authDomain}/${oue}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="webStorageSupport";class uue{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tq,this._completeRedirectFn=Oce,this._overrideRedirectResult=Nce}async _openPopup(e,n,s,r){Zo(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await yD(e,n,s,_I(),r);return rue(e,i,GR())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await yD(e,n,s,_I(),r);return fce(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(Zo(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await Jce(e),s=new Mce(e);return n.register("authEvent",r=>(Me(r?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(mT,{type:mT},r=>{const i=r?.[0]?.[mT];i!==void 0&&n(!!i),zi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Bce(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return gq()||cq()||HR()}}const hue=uue;var vD="@firebase/auth",wD="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class due{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fue(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function pue(t){yl(new Xo("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;Me(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mq(t)},u=new Hle(s,r,i,c);return Xle(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),yl(new Xo("auth-internal",e=>{const n=sE(e.getProvider("auth").getImmediate());return(s=>new due(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),yr(vD,wD,fue(t)),yr(vD,wD,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gue=300,mue=K9("authIdTokenMaxAge")||gue;let ED=null;const _ue=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>mue)return;const r=n?.token;ED!==r&&(ED=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function yue(t=nE()){const e=rm(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Yle(t,{popupRedirectResolver:hue,persistence:[bce,uce,Tq]}),s=K9("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=_ue(i.toString());oce(n,o,()=>o(n.currentUser)),ice(n,a=>o(a))}}const r=H9("auth");return r&&Jle(n,`http://${r}`),n}function vue(){return document.getElementsByTagName("head")?.[0]??document}Wle({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=ni("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",vue().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});pue("Browser");var bD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ka,Nq;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,v){function y(){}y.prototype=v.prototype,I.D=v.prototype,I.prototype=new y,I.prototype.constructor=I,I.C=function(C,S,T){for(var E=Array(arguments.length-2),K=2;K<arguments.length;K++)E[K-2]=arguments[K];return v.prototype[S].apply(C,E)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,n),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(I,v,y){y||(y=0);var C=Array(16);if(typeof v=="string")for(var S=0;16>S;++S)C[S]=v.charCodeAt(y++)|v.charCodeAt(y++)<<8|v.charCodeAt(y++)<<16|v.charCodeAt(y++)<<24;else for(S=0;16>S;++S)C[S]=v[y++]|v[y++]<<8|v[y++]<<16|v[y++]<<24;v=I.g[0],y=I.g[1],S=I.g[2];var T=I.g[3],E=v+(T^y&(S^T))+C[0]+3614090360&4294967295;v=y+(E<<7&4294967295|E>>>25),E=T+(S^v&(y^S))+C[1]+3905402710&4294967295,T=v+(E<<12&4294967295|E>>>20),E=S+(y^T&(v^y))+C[2]+606105819&4294967295,S=T+(E<<17&4294967295|E>>>15),E=y+(v^S&(T^v))+C[3]+3250441966&4294967295,y=S+(E<<22&4294967295|E>>>10),E=v+(T^y&(S^T))+C[4]+4118548399&4294967295,v=y+(E<<7&4294967295|E>>>25),E=T+(S^v&(y^S))+C[5]+1200080426&4294967295,T=v+(E<<12&4294967295|E>>>20),E=S+(y^T&(v^y))+C[6]+2821735955&4294967295,S=T+(E<<17&4294967295|E>>>15),E=y+(v^S&(T^v))+C[7]+4249261313&4294967295,y=S+(E<<22&4294967295|E>>>10),E=v+(T^y&(S^T))+C[8]+1770035416&4294967295,v=y+(E<<7&4294967295|E>>>25),E=T+(S^v&(y^S))+C[9]+2336552879&4294967295,T=v+(E<<12&4294967295|E>>>20),E=S+(y^T&(v^y))+C[10]+4294925233&4294967295,S=T+(E<<17&4294967295|E>>>15),E=y+(v^S&(T^v))+C[11]+2304563134&4294967295,y=S+(E<<22&4294967295|E>>>10),E=v+(T^y&(S^T))+C[12]+1804603682&4294967295,v=y+(E<<7&4294967295|E>>>25),E=T+(S^v&(y^S))+C[13]+4254626195&4294967295,T=v+(E<<12&4294967295|E>>>20),E=S+(y^T&(v^y))+C[14]+2792965006&4294967295,S=T+(E<<17&4294967295|E>>>15),E=y+(v^S&(T^v))+C[15]+1236535329&4294967295,y=S+(E<<22&4294967295|E>>>10),E=v+(S^T&(y^S))+C[1]+4129170786&4294967295,v=y+(E<<5&4294967295|E>>>27),E=T+(y^S&(v^y))+C[6]+3225465664&4294967295,T=v+(E<<9&4294967295|E>>>23),E=S+(v^y&(T^v))+C[11]+643717713&4294967295,S=T+(E<<14&4294967295|E>>>18),E=y+(T^v&(S^T))+C[0]+3921069994&4294967295,y=S+(E<<20&4294967295|E>>>12),E=v+(S^T&(y^S))+C[5]+3593408605&4294967295,v=y+(E<<5&4294967295|E>>>27),E=T+(y^S&(v^y))+C[10]+38016083&4294967295,T=v+(E<<9&4294967295|E>>>23),E=S+(v^y&(T^v))+C[15]+3634488961&4294967295,S=T+(E<<14&4294967295|E>>>18),E=y+(T^v&(S^T))+C[4]+3889429448&4294967295,y=S+(E<<20&4294967295|E>>>12),E=v+(S^T&(y^S))+C[9]+568446438&4294967295,v=y+(E<<5&4294967295|E>>>27),E=T+(y^S&(v^y))+C[14]+3275163606&4294967295,T=v+(E<<9&4294967295|E>>>23),E=S+(v^y&(T^v))+C[3]+4107603335&4294967295,S=T+(E<<14&4294967295|E>>>18),E=y+(T^v&(S^T))+C[8]+1163531501&4294967295,y=S+(E<<20&4294967295|E>>>12),E=v+(S^T&(y^S))+C[13]+2850285829&4294967295,v=y+(E<<5&4294967295|E>>>27),E=T+(y^S&(v^y))+C[2]+4243563512&4294967295,T=v+(E<<9&4294967295|E>>>23),E=S+(v^y&(T^v))+C[7]+1735328473&4294967295,S=T+(E<<14&4294967295|E>>>18),E=y+(T^v&(S^T))+C[12]+2368359562&4294967295,y=S+(E<<20&4294967295|E>>>12),E=v+(y^S^T)+C[5]+4294588738&4294967295,v=y+(E<<4&4294967295|E>>>28),E=T+(v^y^S)+C[8]+2272392833&4294967295,T=v+(E<<11&4294967295|E>>>21),E=S+(T^v^y)+C[11]+1839030562&4294967295,S=T+(E<<16&4294967295|E>>>16),E=y+(S^T^v)+C[14]+4259657740&4294967295,y=S+(E<<23&4294967295|E>>>9),E=v+(y^S^T)+C[1]+2763975236&4294967295,v=y+(E<<4&4294967295|E>>>28),E=T+(v^y^S)+C[4]+1272893353&4294967295,T=v+(E<<11&4294967295|E>>>21),E=S+(T^v^y)+C[7]+4139469664&4294967295,S=T+(E<<16&4294967295|E>>>16),E=y+(S^T^v)+C[10]+3200236656&4294967295,y=S+(E<<23&4294967295|E>>>9),E=v+(y^S^T)+C[13]+681279174&4294967295,v=y+(E<<4&4294967295|E>>>28),E=T+(v^y^S)+C[0]+3936430074&4294967295,T=v+(E<<11&4294967295|E>>>21),E=S+(T^v^y)+C[3]+3572445317&4294967295,S=T+(E<<16&4294967295|E>>>16),E=y+(S^T^v)+C[6]+76029189&4294967295,y=S+(E<<23&4294967295|E>>>9),E=v+(y^S^T)+C[9]+3654602809&4294967295,v=y+(E<<4&4294967295|E>>>28),E=T+(v^y^S)+C[12]+3873151461&4294967295,T=v+(E<<11&4294967295|E>>>21),E=S+(T^v^y)+C[15]+530742520&4294967295,S=T+(E<<16&4294967295|E>>>16),E=y+(S^T^v)+C[2]+3299628645&4294967295,y=S+(E<<23&4294967295|E>>>9),E=v+(S^(y|~T))+C[0]+4096336452&4294967295,v=y+(E<<6&4294967295|E>>>26),E=T+(y^(v|~S))+C[7]+1126891415&4294967295,T=v+(E<<10&4294967295|E>>>22),E=S+(v^(T|~y))+C[14]+2878612391&4294967295,S=T+(E<<15&4294967295|E>>>17),E=y+(T^(S|~v))+C[5]+4237533241&4294967295,y=S+(E<<21&4294967295|E>>>11),E=v+(S^(y|~T))+C[12]+1700485571&4294967295,v=y+(E<<6&4294967295|E>>>26),E=T+(y^(v|~S))+C[3]+2399980690&4294967295,T=v+(E<<10&4294967295|E>>>22),E=S+(v^(T|~y))+C[10]+4293915773&4294967295,S=T+(E<<15&4294967295|E>>>17),E=y+(T^(S|~v))+C[1]+2240044497&4294967295,y=S+(E<<21&4294967295|E>>>11),E=v+(S^(y|~T))+C[8]+1873313359&4294967295,v=y+(E<<6&4294967295|E>>>26),E=T+(y^(v|~S))+C[15]+4264355552&4294967295,T=v+(E<<10&4294967295|E>>>22),E=S+(v^(T|~y))+C[6]+2734768916&4294967295,S=T+(E<<15&4294967295|E>>>17),E=y+(T^(S|~v))+C[13]+1309151649&4294967295,y=S+(E<<21&4294967295|E>>>11),E=v+(S^(y|~T))+C[4]+4149444226&4294967295,v=y+(E<<6&4294967295|E>>>26),E=T+(y^(v|~S))+C[11]+3174756917&4294967295,T=v+(E<<10&4294967295|E>>>22),E=S+(v^(T|~y))+C[2]+718787259&4294967295,S=T+(E<<15&4294967295|E>>>17),E=y+(T^(S|~v))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(S+(E<<21&4294967295|E>>>11))&4294967295,I.g[2]=I.g[2]+S&4294967295,I.g[3]=I.g[3]+T&4294967295}s.prototype.u=function(I,v){v===void 0&&(v=I.length);for(var y=v-this.blockSize,C=this.B,S=this.h,T=0;T<v;){if(S==0)for(;T<=y;)r(this,I,T),T+=this.blockSize;if(typeof I=="string"){for(;T<v;)if(C[S++]=I.charCodeAt(T++),S==this.blockSize){r(this,C),S=0;break}}else for(;T<v;)if(C[S++]=I[T++],S==this.blockSize){r(this,C),S=0;break}}this.h=S,this.o+=v},s.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;var y=8*this.o;for(v=I.length-8;v<I.length;++v)I[v]=y&255,y/=256;for(this.u(I),I=Array(16),v=y=0;4>v;++v)for(var C=0;32>C;C+=8)I[y++]=this.g[v]>>>C&255;return I};function i(I,v){var y=a;return Object.prototype.hasOwnProperty.call(y,I)?y[I]:y[I]=v(I)}function o(I,v){this.h=v;for(var y=[],C=!0,S=I.length-1;0<=S;S--){var T=I[S]|0;C&&T==v||(y[S]=T,C=!1)}this.g=y}var a={};function c(I){return-128<=I&&128>I?i(I,function(v){return new o([v|0],0>v?-1:0)}):new o([I|0],0>I?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return k(u(-I));for(var v=[],y=1,C=0;I>=y;C++)v[C]=I/y|0,y*=4294967296;return new o(v,0)}function h(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return k(h(I.substring(1),v));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=u(Math.pow(v,8)),C=d,S=0;S<I.length;S+=8){var T=Math.min(8,I.length-S),E=parseInt(I.substring(S,S+T),v);8>T?(T=u(Math.pow(v,T)),C=C.j(T).add(u(E))):(C=C.j(y),C=C.add(u(E)))}return C}var d=c(0),p=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(R(this))return-k(this).m();for(var I=0,v=1,y=0;y<this.g.length;y++){var C=this.i(y);I+=(0<=C?C:4294967296+C)*v,v*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(w(this))return"0";if(R(this))return"-"+k(this).toString(I);for(var v=u(Math.pow(I,6)),y=this,C="";;){var S=q(y,v).g;y=O(y,S.j(v));var T=((0<y.g.length?y.g[0]:y.h)>>>0).toString(I);if(y=S,w(y))return T+C;for(;6>T.length;)T="0"+T;C=T+C}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function w(I){if(I.h!=0)return!1;for(var v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function R(I){return I.h==-1}t.l=function(I){return I=O(this,I),R(I)?-1:w(I)?0:1};function k(I){for(var v=I.g.length,y=[],C=0;C<v;C++)y[C]=~I.g[C];return new o(y,~I.h).add(p)}t.abs=function(){return R(this)?k(this):this},t.add=function(I){for(var v=Math.max(this.g.length,I.g.length),y=[],C=0,S=0;S<=v;S++){var T=C+(this.i(S)&65535)+(I.i(S)&65535),E=(T>>>16)+(this.i(S)>>>16)+(I.i(S)>>>16);C=E>>>16,T&=65535,E&=65535,y[S]=E<<16|T}return new o(y,y[y.length-1]&-2147483648?-1:0)};function O(I,v){return I.add(k(v))}t.j=function(I){if(w(this)||w(I))return d;if(R(this))return R(I)?k(this).j(k(I)):k(k(this).j(I));if(R(I))return k(this.j(k(I)));if(0>this.l(m)&&0>I.l(m))return u(this.m()*I.m());for(var v=this.g.length+I.g.length,y=[],C=0;C<2*v;C++)y[C]=0;for(C=0;C<this.g.length;C++)for(var S=0;S<I.g.length;S++){var T=this.i(C)>>>16,E=this.i(C)&65535,K=I.i(S)>>>16,oe=I.i(S)&65535;y[2*C+2*S]+=E*oe,M(y,2*C+2*S),y[2*C+2*S+1]+=T*oe,M(y,2*C+2*S+1),y[2*C+2*S+1]+=E*K,M(y,2*C+2*S+1),y[2*C+2*S+2]+=T*K,M(y,2*C+2*S+2)}for(C=0;C<v;C++)y[C]=y[2*C+1]<<16|y[2*C];for(C=v;C<2*v;C++)y[C]=0;return new o(y,0)};function M(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function F(I,v){this.g=I,this.h=v}function q(I,v){if(w(v))throw Error("division by zero");if(w(I))return new F(d,d);if(R(I))return v=q(k(I),v),new F(k(v.g),k(v.h));if(R(v))return v=q(I,k(v)),new F(k(v.g),v.h);if(30<I.g.length){if(R(I)||R(v))throw Error("slowDivide_ only works with positive integers.");for(var y=p,C=v;0>=C.l(I);)y=H(y),C=H(C);var S=J(y,1),T=J(C,1);for(C=J(C,2),y=J(y,2);!w(C);){var E=T.add(C);0>=E.l(I)&&(S=S.add(y),T=E),C=J(C,1),y=J(y,1)}return v=O(I,S.j(v)),new F(S,v)}for(S=d;0<=I.l(v);){for(y=Math.max(1,Math.floor(I.m()/v.m())),C=Math.ceil(Math.log(y)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),T=u(y),E=T.j(v);R(E)||0<E.l(I);)y-=C,T=u(y),E=T.j(v);w(T)&&(T=p),S=S.add(T),I=O(I,E)}return new F(S,I)}t.A=function(I){return q(this,I).h},t.and=function(I){for(var v=Math.max(this.g.length,I.g.length),y=[],C=0;C<v;C++)y[C]=this.i(C)&I.i(C);return new o(y,this.h&I.h)},t.or=function(I){for(var v=Math.max(this.g.length,I.g.length),y=[],C=0;C<v;C++)y[C]=this.i(C)|I.i(C);return new o(y,this.h|I.h)},t.xor=function(I){for(var v=Math.max(this.g.length,I.g.length),y=[],C=0;C<v;C++)y[C]=this.i(C)^I.i(C);return new o(y,this.h^I.h)};function H(I){for(var v=I.g.length+1,y=[],C=0;C<v;C++)y[C]=I.i(C)<<1|I.i(C-1)>>>31;return new o(y,I.h)}function J(I,v){var y=v>>5;v%=32;for(var C=I.g.length-y,S=[],T=0;T<C;T++)S[T]=0<v?I.i(T+y)>>>v|I.i(T+y+1)<<32-v:I.i(T+y);return new o(S,I.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,Nq=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,Ka=o}).apply(typeof bD<"u"?bD:typeof self<"u"?self:typeof window<"u"?window:{});var jm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xq,Nf,Dq,S_,wI,Oq,Lq,Mq;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,g){return l==Array.prototype||l==Object.prototype||(l[f]=g.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof jm=="object"&&jm];for(var f=0;f<l.length;++f){var g=l[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=n(this);function r(l,f){if(f)e:{var g=s;l=l.split(".");for(var _=0;_<l.length-1;_++){var P=l[_];if(!(P in g))break e;g=g[P]}l=l[l.length-1],_=g[l],f=f(_),f!=_&&f!=null&&e(g,l,{configurable:!0,writable:!0,value:f})}}function i(l,f){l instanceof String&&(l+="");var g=0,_=!1,P={next:function(){if(!_&&g<l.length){var D=g++;return{value:f(D,l[D]),done:!1}}return _=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}r("Array.prototype.values",function(l){return l||function(){return i(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function u(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function h(l,f,g){return l.call.apply(l.bind,arguments)}function d(l,f,g){if(!l)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,_),l.apply(f,P)}}return function(){return l.apply(f,arguments)}}function p(l,f,g){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function m(l,f){var g=Array.prototype.slice.call(arguments,1);return function(){var _=g.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function w(l,f){function g(){}g.prototype=f.prototype,l.aa=f.prototype,l.prototype=new g,l.prototype.constructor=l,l.Qb=function(_,P,D){for(var z=Array(arguments.length-2),Te=2;Te<arguments.length;Te++)z[Te-2]=arguments[Te];return f.prototype[P].apply(_,z)}}function R(l){const f=l.length;if(0<f){const g=Array(f);for(let _=0;_<f;_++)g[_]=l[_];return g}return[]}function k(l,f){for(let g=1;g<arguments.length;g++){const _=arguments[g];if(c(_)){const P=l.length||0,D=_.length||0;l.length=P+D;for(let z=0;z<D;z++)l[P+z]=_[z]}else l.push(_)}}class O{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function M(l){return/^[\s\xa0]*$/.test(l)}function F(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function q(l){return q[" "](l),l}q[" "]=function(){};var H=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function J(l,f,g){for(const _ in l)f.call(g,l[_],_,l)}function I(l,f){for(const g in l)f.call(void 0,l[g],g,l)}function v(l){const f={};for(const g in l)f[g]=l[g];return f}const y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(l,f){let g,_;for(let P=1;P<arguments.length;P++){_=arguments[P];for(g in _)l[g]=_[g];for(let D=0;D<y.length;D++)g=y[D],Object.prototype.hasOwnProperty.call(_,g)&&(l[g]=_[g])}}function S(l){var f=1;l=l.split(":");const g=[];for(;0<f&&l.length;)g.push(l.shift()),f--;return l.length&&g.push(l.join(":")),g}function T(l){a.setTimeout(()=>{throw l},0)}function E(){var l=Kt;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class K{constructor(){this.h=this.g=null}add(f,g){const _=oe.get();_.set(f,g),this.h?this.h.next=_:this.g=_,this.h=_}}var oe=new O(()=>new ge,l=>l.reset());class ge{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let de,ve=!1,Kt=new K,Ht=()=>{const l=a.Promise.resolve(void 0);de=()=>{l.then(Wt)}};var Wt=()=>{for(var l;l=E();){try{l.h.call(l.g)}catch(g){T(g)}var f=oe;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}ve=!1};function Fe(){this.s=this.s,this.C=this.C}Fe.prototype.s=!1,Fe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Fe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function De(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}De.prototype.h=function(){this.defaultPrevented=!0};var Bn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};a.addEventListener("test",g,f),a.removeEventListener("test",g,f)}catch{}return l}();function hn(l,f){if(De.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var g=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(H){e:{try{q(f.nodeName);var P=!0;break e}catch{}P=!1}P||(f=null)}}else g=="mouseover"?f=l.fromElement:g=="mouseout"&&(f=l.toElement);this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Tt[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&hn.aa.h.call(this)}}w(hn,De);var Tt={2:"touch",3:"pen",4:"mouse"};hn.prototype.h=function(){hn.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var V="closure_listenable_"+(1e6*Math.random()|0),Y=0;function Q(l,f,g,_,P){this.listener=l,this.proxy=null,this.src=f,this.type=g,this.capture=!!_,this.ha=P,this.key=++Y,this.da=this.fa=!1}function ee(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function x(l){this.src=l,this.g={},this.h=0}x.prototype.add=function(l,f,g,_,P){var D=l.toString();l=this.g[D],l||(l=this.g[D]=[],this.h++);var z=A(l,f,_,P);return-1<z?(f=l[z],g||(f.fa=!1)):(f=new Q(f,this.src,D,!!_,P),f.fa=g,l.push(f)),f};function b(l,f){var g=f.type;if(g in l.g){var _=l.g[g],P=Array.prototype.indexOf.call(_,f,void 0),D;(D=0<=P)&&Array.prototype.splice.call(_,P,1),D&&(ee(f),l.g[g].length==0&&(delete l.g[g],l.h--))}}function A(l,f,g,_){for(var P=0;P<l.length;++P){var D=l[P];if(!D.da&&D.listener==f&&D.capture==!!g&&D.ha==_)return P}return-1}var N="closure_lm_"+(1e6*Math.random()|0),L={};function U(l,f,g,_,P){if(Array.isArray(f)){for(var D=0;D<f.length;D++)U(l,f[D],g,_,P);return null}return g=ce(g),l&&l[V]?l.K(f,g,u(_)?!!_.capture:!1,P):B(l,f,g,!1,_,P)}function B(l,f,g,_,P,D){if(!f)throw Error("Invalid event type");var z=u(P)?!!P.capture:!!P,Te=X(l);if(Te||(l[N]=Te=new x(l)),g=Te.add(f,g,_,z,D),g.proxy)return g;if(_=G(),g.proxy=_,_.src=l,_.listener=g,l.addEventListener)Bn||(P=z),P===void 0&&(P=!1),l.addEventListener(f.toString(),_,P);else if(l.attachEvent)l.attachEvent(W(f.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return g}function G(){function l(g){return f.call(l.src,l.listener,g)}const f=Z;return l}function $(l,f,g,_,P){if(Array.isArray(f))for(var D=0;D<f.length;D++)$(l,f[D],g,_,P);else _=u(_)?!!_.capture:!!_,g=ce(g),l&&l[V]?(l=l.i,f=String(f).toString(),f in l.g&&(D=l.g[f],g=A(D,g,_,P),-1<g&&(ee(D[g]),Array.prototype.splice.call(D,g,1),D.length==0&&(delete l.g[f],l.h--)))):l&&(l=X(l))&&(f=l.g[f.toString()],l=-1,f&&(l=A(f,g,_,P)),(g=-1<l?f[l]:null)&&j(g))}function j(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[V])b(f.i,l);else{var g=l.type,_=l.proxy;f.removeEventListener?f.removeEventListener(g,_,l.capture):f.detachEvent?f.detachEvent(W(g),_):f.addListener&&f.removeListener&&f.removeListener(_),(g=X(f))?(b(g,l),g.h==0&&(g.src=null,f[N]=null)):ee(l)}}}function W(l){return l in L?L[l]:L[l]="on"+l}function Z(l,f){if(l.da)l=!0;else{f=new hn(f,this);var g=l.listener,_=l.ha||l.src;l.fa&&j(l),l=g.call(_,f)}return l}function X(l){return l=l[N],l instanceof x?l:null}var ne="__closure_events_fn_"+(1e9*Math.random()>>>0);function ce(l){return typeof l=="function"?l:(l[ne]||(l[ne]=function(f){return l.handleEvent(f)}),l[ne])}function ae(){Fe.call(this),this.i=new x(this),this.M=this,this.F=null}w(ae,Fe),ae.prototype[V]=!0,ae.prototype.removeEventListener=function(l,f,g,_){$(this,l,f,g,_)};function le(l,f){var g,_=l.F;if(_)for(g=[];_;_=_.F)g.push(_);if(l=l.M,_=f.type||f,typeof f=="string")f=new De(f,l);else if(f instanceof De)f.target=f.target||l;else{var P=f;f=new De(_,l),C(f,P)}if(P=!0,g)for(var D=g.length-1;0<=D;D--){var z=f.g=g[D];P=we(z,_,!0,f)&&P}if(z=f.g=l,P=we(z,_,!0,f)&&P,P=we(z,_,!1,f)&&P,g)for(D=0;D<g.length;D++)z=f.g=g[D],P=we(z,_,!1,f)&&P}ae.prototype.N=function(){if(ae.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var g=l.g[f],_=0;_<g.length;_++)ee(g[_]);delete l.g[f],l.h--}}this.F=null},ae.prototype.K=function(l,f,g,_){return this.i.add(String(l),f,!1,g,_)},ae.prototype.L=function(l,f,g,_){return this.i.add(String(l),f,!0,g,_)};function we(l,f,g,_){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var P=!0,D=0;D<f.length;++D){var z=f[D];if(z&&!z.da&&z.capture==g){var Te=z.listener,it=z.ha||z.src;z.fa&&b(l.i,z),P=Te.call(it,_)!==!1&&P}}return P&&!_.defaultPrevented}function rt(l,f,g){if(typeof l=="function")g&&(l=p(l,g));else if(l&&typeof l.handleEvent=="function")l=p(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(l,f||0)}function pt(l){l.g=rt(()=>{l.g=null,l.i&&(l.i=!1,pt(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class Mt extends Fe{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:pt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ct(l){Fe.call(this),this.h=l,this.g={}}w(Ct,Fe);var Us=[];function Jt(l){J(l.g,function(f,g){this.g.hasOwnProperty(g)&&j(f)},l),l.g={}}Ct.prototype.N=function(){Ct.aa.N.call(this),Jt(this)},Ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ht=a.JSON.stringify,jn=a.JSON.parse,Ji=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function ui(){}ui.prototype.h=null;function cd(l){return l.h||(l.h=l.i())}function ud(){}var Er={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Vl(){De.call(this,"d")}w(Vl,De);function Fl(){De.call(this,"c")}w(Fl,De);var vs={},hd=null;function Zi(){return hd=hd||new ae}vs.La="serverreachability";function dd(l){De.call(this,vs.La,l)}w(dd,De);function br(l){const f=Zi();le(f,new dd(f))}vs.STAT_EVENT="statevent";function fd(l,f){De.call(this,vs.STAT_EVENT,l),this.stat=f}w(fd,De);function gt(l){const f=Zi();le(f,new fd(f,l))}vs.Ma="timingevent";function pd(l,f){De.call(this,vs.Ma,l),this.size=f}w(pd,De);function Tr(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function Cr(){this.g=!0}Cr.prototype.xa=function(){this.g=!1};function ME(l,f,g,_,P,D){l.info(function(){if(l.g)if(D)for(var z="",Te=D.split("&"),it=0;it<Te.length;it++){var me=Te[it].split("=");if(1<me.length){var ct=me[0];me=me[1];var mt=ct.split("_");z=2<=mt.length&&mt[1]=="type"?z+(ct+"="+me+"&"):z+(ct+"=redacted&")}}else z=null;else z=D;return"XMLHTTP REQ ("+_+") [attempt "+P+"]: "+f+`
`+g+`
`+z})}function VE(l,f,g,_,P,D,z){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+P+"]: "+f+`
`+g+`
`+D+" "+z})}function Gs(l,f,g,_){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+UE(l,g)+(_?" "+_:"")})}function FE(l,f){l.info(function(){return"TIMEOUT: "+f})}Cr.prototype.info=function(){};function UE(l,f){if(!l.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(l=0;l<g.length;l++)if(Array.isArray(g[l])){var _=g[l];if(!(2>_.length)){var P=_[1];if(Array.isArray(P)&&!(1>P.length)){var D=P[0];if(D!="noop"&&D!="stop"&&D!="close")for(var z=1;z<P.length;z++)P[z]=""}}}}return ht(g)}catch{return f}}var eo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ul;function to(){}w(to,ui),to.prototype.g=function(){return new XMLHttpRequest},to.prototype.i=function(){return{}},Ul=new to;function $n(l,f,g,_){this.j=l,this.i=f,this.l=g,this.R=_||1,this.U=new Ct(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new md}function md(){this.i=null,this.g="",this.h=!1}var _d={},ql={};function Bl(l,f,g){l.L=1,l.v=io(En(f)),l.m=g,l.P=!0,yd(l,null)}function yd(l,f){l.F=Date.now(),no(l),l.A=En(l.v);var g=l.A,_=l.R;Array.isArray(_)||(_=[String(_)]),xd(g.i,"t",_),l.C=0,g=l.j.J,l.h=new md,l.g=Yd(l.j,g?f:null,!l.m),0<l.O&&(l.M=new Mt(p(l.Y,l,l.g),l.O)),f=l.U,g=l.g,_=l.ca;var P="readystatechange";Array.isArray(P)||(P&&(Us[0]=P.toString()),P=Us);for(var D=0;D<P.length;D++){var z=U(g,P[D],_||f.handleEvent,!1,f.h||f);if(!z)break;f.g[z.key]=z}f=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),br(),ME(l.i,l.u,l.A,l.l,l.R,l.m)}$n.prototype.ca=function(l){l=l.target;const f=this.M;f&&bn(l)==3?f.j():this.Y(l)},$n.prototype.Y=function(l){try{if(l==this.g)e:{const mt=bn(this.g);var f=this.g.Ba();const Xs=this.g.Z();if(!(3>mt)&&(mt!=3||this.g&&(this.h.h||this.g.oa()||Ud(this.g)))){this.J||mt!=4||f==7||(f==8||0>=Xs?br(3):br(2)),jl(this);var g=this.g.Z();this.X=g;t:if(vd(this)){var _=Ud(this.g);l="";var P=_.length,D=bn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ws(this),Ir(this);var z="";break t}this.h.i=new a.TextDecoder}for(f=0;f<P;f++)this.h.h=!0,l+=this.h.i.decode(_[f],{stream:!(D&&f==P-1)});_.length=0,this.h.g+=l,this.C=0,z=this.h.g}else z=this.g.oa();if(this.o=g==200,VE(this.i,this.u,this.A,this.l,this.R,mt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Te,it=this.g;if((Te=it.g?it.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(Te)){var me=Te;break t}}me=null}if(g=me)Gs(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$l(this,g);else{this.o=!1,this.s=3,gt(12),ws(this),Ir(this);break e}}if(this.P){g=!0;let Gt;for(;!this.J&&this.C<z.length;)if(Gt=qE(this,z),Gt==ql){mt==4&&(this.s=4,gt(14),g=!1),Gs(this.i,this.l,null,"[Incomplete Response]");break}else if(Gt==_d){this.s=4,gt(15),Gs(this.i,this.l,z,"[Invalid Chunk]"),g=!1;break}else Gs(this.i,this.l,Gt,null),$l(this,Gt);if(vd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||z.length!=0||this.h.h||(this.s=1,gt(16),g=!1),this.o=this.o&&g,!g)Gs(this.i,this.l,z,"[Invalid Chunked Response]"),ws(this),Ir(this);else if(0<z.length&&!this.W){this.W=!0;var ct=this.j;ct.g==this&&ct.ba&&!ct.M&&(ct.j.info("Great, no buffering proxy detected. Bytes received: "+z.length),Ql(ct),ct.M=!0,gt(11))}}else Gs(this.i,this.l,z,null),$l(this,z);mt==4&&ws(this),this.o&&!this.J&&(mt==4?Wd(this.j,this):(this.o=!1,no(this)))}else sb(this.g),g==400&&0<z.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),ws(this),Ir(this)}}}catch{}finally{}};function vd(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function qE(l,f){var g=l.C,_=f.indexOf(`
`,g);return _==-1?ql:(g=Number(f.substring(g,_)),isNaN(g)?_d:(_+=1,_+g>f.length?ql:(f=f.slice(_,_+g),l.C=_+g,f)))}$n.prototype.cancel=function(){this.J=!0,ws(this)};function no(l){l.S=Date.now()+l.I,wd(l,l.I)}function wd(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Tr(p(l.ba,l),f)}function jl(l){l.B&&(a.clearTimeout(l.B),l.B=null)}$n.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(FE(this.i,this.A),this.L!=2&&(br(),gt(17)),ws(this),this.s=2,Ir(this)):wd(this,this.S-l)};function Ir(l){l.j.G==0||l.J||Wd(l.j,l)}function ws(l){jl(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,Jt(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function $l(l,f){try{var g=l.j;if(g.G!=0&&(g.g==l||zl(g.h,l))){if(!l.K&&zl(g.h,l)&&g.G==3){try{var _=g.Da.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var P=_;if(P[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<l.F)ho(g),co(g);else break e;Gl(g),gt(18)}}else g.za=P[1],0<g.za-g.T&&37500>P[2]&&g.F&&g.v==0&&!g.C&&(g.C=Tr(p(g.Za,g),6e3));if(1>=Td(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else bs(g,11)}else if((l.K||g.g==l)&&ho(g),!M(f))for(P=g.Da.g.parse(f),f=0;f<P.length;f++){let me=P[f];if(g.T=me[0],me=me[1],g.G==2)if(me[0]=="c"){g.K=me[1],g.ia=me[2];const ct=me[3];ct!=null&&(g.la=ct,g.j.info("VER="+g.la));const mt=me[4];mt!=null&&(g.Aa=mt,g.j.info("SVER="+g.Aa));const Xs=me[5];Xs!=null&&typeof Xs=="number"&&0<Xs&&(_=1.5*Xs,g.L=_,g.j.info("backChannelRequestTimeoutMs_="+_)),_=g;const Gt=l.g;if(Gt){const po=Gt.g?Gt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(po){var D=_.h;D.g||po.indexOf("spdy")==-1&&po.indexOf("quic")==-1&&po.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(Hl(D,D.h),D.h=null))}if(_.D){const Yl=Gt.g?Gt.g.getResponseHeader("X-HTTP-Session-Id"):null;Yl&&(_.ya=Yl,Se(_.I,_.D,Yl))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-l.F,g.j.info("Handshake RTT: "+g.R+"ms")),_=g;var z=l;if(_.qa=Qd(_,_.J?_.ia:null,_.W),z.K){Cd(_.h,z);var Te=z,it=_.L;it&&(Te.I=it),Te.B&&(jl(Te),no(Te)),_.g=z}else zd(_);0<g.i.length&&uo(g)}else me[0]!="stop"&&me[0]!="close"||bs(g,7);else g.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?bs(g,7):Kl(g):me[0]!="noop"&&g.l&&g.l.ta(me),g.v=0)}}br(4)}catch{}}var BE=class{constructor(l,f){this.g=l,this.map=f}};function Ed(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bd(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Td(l){return l.h?1:l.g?l.g.size:0}function zl(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Hl(l,f){l.g?l.g.add(f):l.h=f}function Cd(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Ed.prototype.cancel=function(){if(this.i=Id(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Id(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const g of l.g.values())f=f.concat(g.D);return f}return R(l.i)}function jE(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var f=[],g=l.length,_=0;_<g;_++)f.push(l[_]);return f}f=[],g=0;for(_ in l)f[g++]=l[_];return f}function $E(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var f=[];l=l.length;for(var g=0;g<l;g++)f.push(g);return f}f=[],g=0;for(const _ in l)f[g++]=_;return f}}}function Sd(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var g=$E(l),_=jE(l),P=_.length,D=0;D<P;D++)f.call(void 0,_[D],g&&g[D],l)}var Rd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zE(l,f){if(l){l=l.split("&");for(var g=0;g<l.length;g++){var _=l[g].indexOf("="),P=null;if(0<=_){var D=l[g].substring(0,_);P=l[g].substring(_+1)}else D=l[g];f(D,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function Es(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Es){this.h=l.h,so(this,l.j),this.o=l.o,this.g=l.g,ro(this,l.s),this.l=l.l;var f=l.i,g=new Ar;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),Ad(this,g),this.m=l.m}else l&&(f=String(l).match(Rd))?(this.h=!1,so(this,f[1]||"",!0),this.o=Sr(f[2]||""),this.g=Sr(f[3]||"",!0),ro(this,f[4]),this.l=Sr(f[5]||"",!0),Ad(this,f[6]||"",!0),this.m=Sr(f[7]||"")):(this.h=!1,this.i=new Ar(null,this.h))}Es.prototype.toString=function(){var l=[],f=this.j;f&&l.push(Rr(f,kd,!0),":");var g=this.g;return(g||f=="file")&&(l.push("//"),(f=this.o)&&l.push(Rr(f,kd,!0),"@"),l.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&l.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Rr(g,g.charAt(0)=="/"?KE:WE,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Rr(g,QE)),l.join("")};function En(l){return new Es(l)}function so(l,f,g){l.j=g?Sr(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function ro(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function Ad(l,f,g){f instanceof Ar?(l.i=f,YE(l.i,l.h)):(g||(f=Rr(f,GE)),l.i=new Ar(f,l.h))}function Se(l,f,g){l.i.set(f,g)}function io(l){return Se(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Sr(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Rr(l,f,g){return typeof l=="string"?(l=encodeURI(l).replace(f,HE),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function HE(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var kd=/[#\/\?@]/g,WE=/[#\?:]/g,KE=/[#\?]/g,GE=/[#\?@]/g,QE=/#/g;function Ar(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function zn(l){l.g||(l.g=new Map,l.h=0,l.i&&zE(l.i,function(f,g){l.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=Ar.prototype,t.add=function(l,f){zn(this),this.i=null,l=Qs(this,l);var g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(f),this.h+=1,this};function Pd(l,f){zn(l),f=Qs(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Nd(l,f){return zn(l),f=Qs(l,f),l.g.has(f)}t.forEach=function(l,f){zn(this),this.g.forEach(function(g,_){g.forEach(function(P){l.call(f,P,_,this)},this)},this)},t.na=function(){zn(this);const l=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let _=0;_<f.length;_++){const P=l[_];for(let D=0;D<P.length;D++)g.push(f[_])}return g},t.V=function(l){zn(this);let f=[];if(typeof l=="string")Nd(this,l)&&(f=f.concat(this.g.get(Qs(this,l))));else{l=Array.from(this.g.values());for(let g=0;g<l.length;g++)f=f.concat(l[g])}return f},t.set=function(l,f){return zn(this),this.i=null,l=Qs(this,l),Nd(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function xd(l,f,g){Pd(l,f),0<g.length&&(l.i=null,l.g.set(Qs(l,f),R(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var _=f[g];const D=encodeURIComponent(String(_)),z=this.V(_);for(_=0;_<z.length;_++){var P=D;z[_]!==""&&(P+="="+encodeURIComponent(String(z[_]))),l.push(P)}}return this.i=l.join("&")};function Qs(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function YE(l,f){f&&!l.j&&(zn(l),l.i=null,l.g.forEach(function(g,_){var P=_.toLowerCase();_!=P&&(Pd(this,_),xd(this,P,g))},l)),l.j=f}function XE(l,f){const g=new Cr;if(a.Image){const _=new Image;_.onload=m(Hn,g,"TestLoadImage: loaded",!0,f,_),_.onerror=m(Hn,g,"TestLoadImage: error",!1,f,_),_.onabort=m(Hn,g,"TestLoadImage: abort",!1,f,_),_.ontimeout=m(Hn,g,"TestLoadImage: timeout",!1,f,_),a.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else f(!1)}function JE(l,f){const g=new Cr,_=new AbortController,P=setTimeout(()=>{_.abort(),Hn(g,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:_.signal}).then(D=>{clearTimeout(P),D.ok?Hn(g,"TestPingServer: ok",!0,f):Hn(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(P),Hn(g,"TestPingServer: error",!1,f)})}function Hn(l,f,g,_,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),_(g)}catch{}}function ZE(){this.g=new Ji}function eb(l,f,g){const _=g||"";try{Sd(l,function(P,D){let z=P;u(P)&&(z=ht(P)),f.push(_+D+"="+encodeURIComponent(z))})}catch(P){throw f.push(_+"type="+encodeURIComponent("_badmap")),P}}function oo(l){this.l=l.Ub||null,this.j=l.eb||!1}w(oo,ui),oo.prototype.g=function(){return new ao(this.l,this.j)},oo.prototype.i=function(l){return function(){return l}}({});function ao(l,f){ae.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(ao,ae),t=ao.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,Pr(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,kr(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Pr(this)),this.g&&(this.readyState=3,Pr(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Dd(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Dd(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?kr(this):Pr(this),this.readyState==3&&Dd(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,kr(this))},t.Qa=function(l){this.g&&(this.response=l,kr(this))},t.ga=function(){this.g&&kr(this)};function kr(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Pr(l)}t.setRequestHeader=function(l,f){this.u.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=f.next();return l.join(`\r
`)};function Pr(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ao.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Od(l){let f="";return J(l,function(g,_){f+=_,f+=":",f+=g,f+=`\r
`}),f}function Wl(l,f,g){e:{for(_ in g){var _=!1;break e}_=!0}_||(g=Od(g),typeof l=="string"?g!=null&&encodeURIComponent(String(g)):Se(l,f,g))}function Ue(l){ae.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Ue,ae);var tb=/^https?$/i,nb=["POST","PUT"];t=Ue.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,f,g,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ul.g(),this.v=this.o?cd(this.o):cd(Ul),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(D){Ld(this,D);return}if(l=g||"",g=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var P in _)g.set(P,_[P]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const D of _.keys())g.set(D,_.get(D));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(g.keys()).find(D=>D.toLowerCase()=="content-type"),P=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(nb,f,void 0))||_||P||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[D,z]of g)this.g.setRequestHeader(D,z);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fd(this),this.u=!0,this.g.send(l),this.u=!1}catch(D){Ld(this,D)}};function Ld(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,Md(l),lo(l)}function Md(l){l.A||(l.A=!0,le(l,"complete"),le(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,le(this,"complete"),le(this,"abort"),lo(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),lo(this,!0)),Ue.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Vd(this):this.bb())},t.bb=function(){Vd(this)};function Vd(l){if(l.h&&typeof o<"u"&&(!l.v[1]||bn(l)!=4||l.Z()!=2)){if(l.u&&bn(l)==4)rt(l.Ea,0,l);else if(le(l,"readystatechange"),bn(l)==4){l.h=!1;try{const z=l.Z();e:switch(z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var _;if(_=z===0){var P=String(l.D).match(Rd)[1]||null;!P&&a.self&&a.self.location&&(P=a.self.location.protocol.slice(0,-1)),_=!tb.test(P?P.toLowerCase():"")}g=_}if(g)le(l,"complete"),le(l,"success");else{l.m=6;try{var D=2<bn(l)?l.g.statusText:""}catch{D=""}l.l=D+" ["+l.Z()+"]",Md(l)}}finally{lo(l)}}}}function lo(l,f){if(l.g){Fd(l);const g=l.g,_=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||le(l,"ready");try{g.onreadystatechange=_}catch{}}}function Fd(l){l.I&&(a.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function bn(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<bn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),jn(f)}};function Ud(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function sb(l){const f={};l=(l.g&&2<=bn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(M(l[_]))continue;var g=S(l[_]);const P=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const D=f[P]||[];f[P]=D,D.push(g)}I(f,function(_){return _.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Nr(l,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||f}function qd(l){this.Aa=0,this.i=[],this.j=new Cr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Nr("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Nr("baseRetryDelayMs",5e3,l),this.cb=Nr("retryDelaySeedMs",1e4,l),this.Wa=Nr("forwardChannelMaxRetries",2,l),this.wa=Nr("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Ed(l&&l.concurrentRequestLimit),this.Da=new ZE,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=qd.prototype,t.la=8,t.G=1,t.connect=function(l,f,g,_){gt(0),this.W=l,this.H=f||{},g&&_!==void 0&&(this.H.OSID=g,this.H.OAID=_),this.F=this.X,this.I=Qd(this,null,this.W),uo(this)};function Kl(l){if(Bd(l),l.G==3){var f=l.U++,g=En(l.I);if(Se(g,"SID",l.K),Se(g,"RID",f),Se(g,"TYPE","terminate"),xr(l,g),f=new $n(l,l.j,f),f.L=2,f.v=io(En(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&a.Image&&(new Image().src=f.v,g=!0),g||(f.g=Yd(f.j,null),f.g.ea(f.v)),f.F=Date.now(),no(f)}Gd(l)}function co(l){l.g&&(Ql(l),l.g.cancel(),l.g=null)}function Bd(l){co(l),l.u&&(a.clearTimeout(l.u),l.u=null),ho(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function uo(l){if(!bd(l.h)&&!l.s){l.s=!0;var f=l.Ga;de||Ht(),ve||(de(),ve=!0),Kt.add(f,l),l.B=0}}function rb(l,f){return Td(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Tr(p(l.Ga,l,f),Kd(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const P=new $n(this,this.j,l);let D=this.o;if(this.S&&(D?(D=v(D),C(D,this.S)):D=this.S),this.m!==null||this.O||(P.H=D,D=null),this.P)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var _=this.i[g];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(f+=_,4096<f){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=$d(this,P,f),g=En(this.I),Se(g,"RID",l),Se(g,"CVER",22),this.D&&Se(g,"X-HTTP-Session-Id",this.D),xr(this,g),D&&(this.O?f="headers="+encodeURIComponent(String(Od(D)))+"&"+f:this.m&&Wl(g,this.m,D)),Hl(this.h,P),this.Ua&&Se(g,"TYPE","init"),this.P?(Se(g,"$req",f),Se(g,"SID","null"),P.T=!0,Bl(P,g,null)):Bl(P,g,f),this.G=2}}else this.G==3&&(l?jd(this,l):this.i.length==0||bd(this.h)||jd(this))};function jd(l,f){var g;f?g=f.l:g=l.U++;const _=En(l.I);Se(_,"SID",l.K),Se(_,"RID",g),Se(_,"AID",l.T),xr(l,_),l.m&&l.o&&Wl(_,l.m,l.o),g=new $n(l,l.j,g,l.B+1),l.m===null&&(g.H=l.o),f&&(l.i=f.D.concat(l.i)),f=$d(l,g,1e3),g.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Hl(l.h,g),Bl(g,_,f)}function xr(l,f){l.H&&J(l.H,function(g,_){Se(f,_,g)}),l.l&&Sd({},function(g,_){Se(f,_,g)})}function $d(l,f,g){g=Math.min(l.i.length,g);var _=l.l?p(l.l.Na,l.l,l):null;e:{var P=l.i;let D=-1;for(;;){const z=["count="+g];D==-1?0<g?(D=P[0].g,z.push("ofs="+D)):D=0:z.push("ofs="+D);let Te=!0;for(let it=0;it<g;it++){let me=P[it].g;const ct=P[it].map;if(me-=D,0>me)D=Math.max(0,P[it].g-100),Te=!1;else try{eb(ct,z,"req"+me+"_")}catch{_&&_(ct)}}if(Te){_=z.join("&");break e}}}return l=l.i.splice(0,g),f.D=l,_}function zd(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;de||Ht(),ve||(de(),ve=!0),Kt.add(f,l),l.v=0}}function Gl(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Tr(p(l.Fa,l),Kd(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Hd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Tr(p(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),co(this),Hd(this))};function Ql(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function Hd(l){l.g=new $n(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=En(l.qa);Se(f,"RID","rpc"),Se(f,"SID",l.K),Se(f,"AID",l.T),Se(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&Se(f,"TO",l.ja),Se(f,"TYPE","xmlhttp"),xr(l,f),l.m&&l.o&&Wl(f,l.m,l.o),l.L&&(l.g.I=l.L);var g=l.g;l=l.ia,g.L=1,g.v=io(En(f)),g.m=null,g.P=!0,yd(g,l)}t.Za=function(){this.C!=null&&(this.C=null,co(this),Gl(this),gt(19))};function ho(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Wd(l,f){var g=null;if(l.g==f){ho(l),Ql(l),l.g=null;var _=2}else if(zl(l.h,f))g=f.D,Cd(l.h,f),_=1;else return;if(l.G!=0){if(f.o)if(_==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var P=l.B;_=Zi(),le(_,new pd(_,g)),uo(l)}else zd(l);else if(P=f.s,P==3||P==0&&0<f.X||!(_==1&&rb(l,f)||_==2&&Gl(l)))switch(g&&0<g.length&&(f=l.h,f.i=f.i.concat(g)),P){case 1:bs(l,5);break;case 4:bs(l,10);break;case 3:bs(l,6);break;default:bs(l,2)}}}function Kd(l,f){let g=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(g*=2),g*f}function bs(l,f){if(l.j.info("Error code "+f),f==2){var g=p(l.fb,l),_=l.Xa;const P=!_;_=new Es(_||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||so(_,"https"),io(_),P?XE(_.toString(),g):JE(_.toString(),g)}else gt(2);l.G=0,l.l&&l.l.sa(f),Gd(l),Bd(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function Gd(l){if(l.G=0,l.ka=[],l.l){const f=Id(l.h);(f.length!=0||l.i.length!=0)&&(k(l.ka,f),k(l.ka,l.i),l.h.i.length=0,R(l.i),l.i.length=0),l.l.ra()}}function Qd(l,f,g){var _=g instanceof Es?En(g):new Es(g);if(_.g!="")f&&(_.g=f+"."+_.g),ro(_,_.s);else{var P=a.location;_=P.protocol,f=f?f+"."+P.hostname:P.hostname,P=+P.port;var D=new Es(null);_&&so(D,_),f&&(D.g=f),P&&ro(D,P),g&&(D.l=g),_=D}return g=l.D,f=l.ya,g&&f&&Se(_,g,f),Se(_,"VER",l.la),xr(l,_),_}function Yd(l,f,g){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new Ue(new oo({eb:g})):new Ue(l.pa),f.Ha(l.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xd(){}t=Xd.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function fo(){}fo.prototype.g=function(l,f){return new Rt(l,f)};function Rt(l,f){ae.call(this),this.g=new qd(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!M(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!M(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Ys(this)}w(Rt,ae),Rt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Rt.prototype.close=function(){Kl(this.g)},Rt.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.u&&(g={},g.__data__=ht(l),l=g);f.i.push(new BE(f.Ya++,l)),f.G==3&&uo(f)},Rt.prototype.N=function(){this.g.l=null,delete this.j,Kl(this.g),delete this.g,Rt.aa.N.call(this)};function Jd(l){Vl.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const g in f){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}w(Jd,Vl);function Zd(){Fl.call(this),this.status=1}w(Zd,Fl);function Ys(l){this.g=l}w(Ys,Xd),Ys.prototype.ua=function(){le(this.g,"a")},Ys.prototype.ta=function(l){le(this.g,new Jd(l))},Ys.prototype.sa=function(l){le(this.g,new Zd)},Ys.prototype.ra=function(){le(this.g,"b")},fo.prototype.createWebChannel=fo.prototype.g,Rt.prototype.send=Rt.prototype.o,Rt.prototype.open=Rt.prototype.m,Rt.prototype.close=Rt.prototype.close,Mq=function(){return new fo},Lq=function(){return Zi()},Oq=vs,wI={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},eo.NO_ERROR=0,eo.TIMEOUT=8,eo.HTTP_ERROR=6,S_=eo,gd.COMPLETE="complete",Dq=gd,ud.EventType=Er,Er.OPEN="a",Er.CLOSE="b",Er.ERROR="c",Er.MESSAGE="d",ae.prototype.listen=ae.prototype.K,Nf=ud,Ue.prototype.listenOnce=Ue.prototype.L,Ue.prototype.getLastError=Ue.prototype.Ka,Ue.prototype.getLastErrorCode=Ue.prototype.Ba,Ue.prototype.getStatus=Ue.prototype.Z,Ue.prototype.getResponseJson=Ue.prototype.Oa,Ue.prototype.getResponseText=Ue.prototype.oa,Ue.prototype.send=Ue.prototype.ea,Ue.prototype.setWithCredentials=Ue.prototype.Ha,xq=Ue}).apply(typeof jm<"u"?jm:typeof self<"u"?self:typeof window<"u"?window:{});const TD="@firebase/firestore",CD="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}is.UNAUTHENTICATED=new is(null),is.GOOGLE_CREDENTIALS=new is("google-credentials-uid"),is.FIRST_PARTY=new is("first-party-uid"),is.MOCK_USER=new is("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nd="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=new tE("@firebase/firestore");function Lu(){return Qc.logLevel}function pe(t,...e){if(Qc.logLevel<=Xe.DEBUG){const n=e.map(YR);Qc.debug(`Firestore (${nd}): ${t}`,...n)}}function ea(t,...e){if(Qc.logLevel<=Xe.ERROR){const n=e.map(YR);Qc.error(`Firestore (${nd}): ${t}`,...n)}}function Nh(t,...e){if(Qc.logLevel<=Xe.WARN){const n=e.map(YR);Qc.warn(`Firestore (${nd}): ${t}`,...n)}}function YR(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,Vq(t,s,n)}function Vq(t,e,n){let s=`FIRESTORE (${nd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw ea(s),new Error(s)}function bt(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||Vq(e,r,s)}function He(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ye extends Xi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fq{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wue{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(is.UNAUTHENTICATED))}shutdown(){}}class Eue{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class bue{constructor(e){this.t=e,this.currentUser=is.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){bt(this.o===void 0,42304);let s=this.i;const r=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let i=new Ga;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ga,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ga)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(bt(typeof s.accessToken=="string",31837,{l:s}),new Fq(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return bt(e===null||typeof e=="string",2055,{h:e}),new is(e)}}class Tue{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=is.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Cue{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new Tue(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(is.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ID{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Iue{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,er(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){bt(this.o===void 0,3512);const s=i=>{i.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ID(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(bt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new ID(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sue(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=Sue(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%62))}return s}}function tt(t,e){return t<e?-1:t>e?1:0}function EI(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),i=e.charAt(s);if(r!==i)return _T(r)===_T(i)?tt(r,i):_T(r)?1:-1}return tt(t.length,e.length)}const Rue=55296,Aue=57343;function _T(t){const e=t.charCodeAt(0);return e>=Rue&&e<=Aue}function xh(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD="__name__";class Ei{constructor(e,n,s){n===void 0?n=0:n>e.length&&Pe(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&Pe(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Ei.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ei?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=Ei.compareSegments(e.get(r),n.get(r));if(i!==0)return i}return tt(e.length,n.length)}static compareSegments(e,n){const s=Ei.isNumericId(e),r=Ei.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?Ei.extractNumericId(e).compare(Ei.extractNumericId(n)):EI(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ka.fromString(e.substring(4,e.length-2))}}class Xt extends Ei{construct(e,n,s){return new Xt(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new ye(re.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new Xt(n)}static emptyPath(){return new Xt([])}}const kue=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gn extends Ei{construct(e,n,s){return new Gn(e,n,s)}static isValidIdentifier(e){return kue.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===SD}static keyField(){return new Gn([SD])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new ye(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new ye(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ye(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new ye(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gn(n)}static emptyPath(){return new Gn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(Xt.fromString(e))}static fromName(e){return new Ie(Xt.fromString(e).popFirst(5))}static empty(){return new Ie(Xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Xt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new Xt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pue(t,e,n){if(!n)throw new ye(re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Nue(t,e,n,s){if(e===!0&&s===!0)throw new ye(re.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function RD(t){if(!Ie.isDocumentKey(t))throw new ye(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Uq(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function JR(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Pe(12329,{type:typeof t})}function si(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ye(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=JR(t);throw new ye(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(t,e){const n={typeString:t};return e&&(n.value=e),n}function lm(t,e){if(!Uq(t))throw new ye(re.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const o=t[s];if(r&&typeof o!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${s}' field to equal '${i.value}'`;break}}if(n)throw new ye(re.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=-62135596800,kD=1e6;class jt{static now(){return jt.fromMillis(Date.now())}static fromDate(e){return jt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*kD);return new jt(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ye(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ye(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<AD)throw new ye(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ye(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kD}_compareTo(e){return this.seconds===e.seconds?tt(this.nanoseconds,e.nanoseconds):tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:jt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(lm(e,jt._jsonSchema))return new jt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-AD;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}jt._jsonSchemaVersion="firestore/timestamp/1.0",jt._jsonSchema={type:_n("string",jt._jsonSchemaVersion),seconds:_n("number"),nanoseconds:_n("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{static fromTimestamp(e){return new Be(e)}static min(){return new Be(new jt(0,0))}static max(){return new Be(new jt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg=-1;function xue(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=Be.fromTimestamp(s===1e9?new jt(n+1,0):new jt(n,s));return new vl(r,Ie.empty(),e)}function Due(t){return new vl(t.readTime,t.key,mg)}class vl{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new vl(Be.min(),Ie.empty(),mg)}static max(){return new vl(Be.max(),Ie.empty(),mg)}}function Oue(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ie.comparator(t.documentKey,e.documentKey),n!==0?n:tt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lue="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Mue{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sd(t){if(t.code!==re.FAILED_PRECONDITION||t.message!==Lue)throw t;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new te((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof te?n:te.resolve(n)}catch(n){return te.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):te.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):te.reject(n)}static resolve(e){return new te((n,s)=>{n(e)})}static reject(e){return new te((n,s)=>{s(e)})}static waitFor(e){return new te((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},c=>s(c))}),o=!0,i===r&&n()})}static or(e){let n=te.resolve(!1);for(const s of e)n=n.next(r=>r?te.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new te((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(h=>{o[u]=h,++a,a===i&&s(o)},h=>r(h))}})}static doWhile(e,n){return new te((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}function Vue(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function rd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oE{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}oE.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=-1;function aE(t){return t==null}function ev(t){return t===0&&1/t==-1/0}function Fue(t){return typeof t=="number"&&Number.isInteger(t)&&!ev(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq="";function Uue(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=PD(e)),e=que(t.get(n),e);return PD(e)}function que(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case qq:n+="";break;default:n+=i}}return n}function PD(t){return t+qq+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ll(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Bq(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wn=class bI{constructor(e,n){this.comparator=e,this.root=n||Qa.EMPTY}insert(e,n){return new bI(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Qa.BLACK,null,null))}remove(e){return new bI(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qa.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $m(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $m(this.root,e,this.comparator,!1)}getReverseIterator(){return new $m(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $m(this.root,e,this.comparator,!0)}},$m=class{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Qa=class wo{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??wo.RED,this.left=r??wo.EMPTY,this.right=i??wo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new wo(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return wo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return wo.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}};Qa.EMPTY=null,Qa.RED=!0,Qa.BLACK=!1;Qa.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,n,s,r,i){return this}insert(e,n,s){return new Qa(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.comparator=e,this.data=new wn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xD(this.data.getIterator())}getIteratorFrom(e){return new xD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof Nn)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Nn(this.comparator);return n.data=e,n}}class xD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.fields=e,e.sort(Gn.comparator)}static empty(){return new ir([])}unionWith(e){let n=new Nn(Gn.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new ir(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return xh(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jq extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new jq("Invalid base64 string: "+i):i}}(e);return new Xn(n)}static fromUint8Array(e){const n=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new Xn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xn.EMPTY_BYTE_STRING=new Xn("");const Bue=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wl(t){if(bt(!!t,39018),typeof t=="string"){let e=0;const n=Bue.exec(t);if(bt(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:fn(t.seconds),nanos:fn(t.nanos)}}function fn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function El(t){return typeof t=="string"?Xn.fromBase64String(t):Xn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $q="server_timestamp",zq="__type__",Hq="__previous_value__",Wq="__local_write_time__";function eA(t){return(t?.mapValue?.fields||{})[zq]?.stringValue===$q}function lE(t){const e=t.mapValue.fields[Hq];return eA(e)?lE(e):e}function _g(t){const e=wl(t.mapValue.fields[Wq].timestampValue);return new jt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jue{constructor(e,n,s,r,i,o,a,c,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const tv="(default)";class yg{constructor(e,n){this.projectId=e,this.database=n||tv}static empty(){return new yg("","")}get isDefaultDatabase(){return this.database===tv}isEqual(e){return e instanceof yg&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kq="__type__",$ue="__max__",zm={mapValue:{}},Gq="__vector__",nv="value";function bl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?eA(t)?4:Hue(t)?9007199254740991:zue(t)?10:11:Pe(28295,{value:t})}function Hi(t,e){if(t===e)return!0;const n=bl(t);if(n!==bl(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return _g(t).isEqual(_g(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=wl(r.timestampValue),a=wl(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return El(r.bytesValue).isEqual(El(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return fn(r.geoPointValue.latitude)===fn(i.geoPointValue.latitude)&&fn(r.geoPointValue.longitude)===fn(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return fn(r.integerValue)===fn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=fn(r.doubleValue),a=fn(i.doubleValue);return o===a?ev(o)===ev(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return xh(t.arrayValue.values||[],e.arrayValue.values||[],Hi);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},a=i.mapValue.fields||{};if(ND(o)!==ND(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Hi(o[c],a[c])))return!1;return!0}(t,e);default:return Pe(52216,{left:t})}}function vg(t,e){return(t.values||[]).find(n=>Hi(n,e))!==void 0}function Dh(t,e){if(t===e)return 0;const n=bl(t),s=bl(e);if(n!==s)return tt(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return tt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=fn(i.integerValue||i.doubleValue),c=fn(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return DD(t.timestampValue,e.timestampValue);case 4:return DD(_g(t),_g(e));case 5:return EI(t.stringValue,e.stringValue);case 6:return function(i,o){const a=El(i),c=El(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){const h=tt(a[u],c[u]);if(h!==0)return h}return tt(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=tt(fn(i.latitude),fn(o.latitude));return a!==0?a:tt(fn(i.longitude),fn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return OD(t.arrayValue,e.arrayValue);case 10:return function(i,o){const a=i.fields||{},c=o.fields||{},u=a[nv]?.arrayValue,h=c[nv]?.arrayValue,d=tt(u?.values?.length||0,h?.values?.length||0);return d!==0?d:OD(u,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===zm.mapValue&&o===zm.mapValue)return 0;if(i===zm.mapValue)return 1;if(o===zm.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){const p=EI(c[d],h[d]);if(p!==0)return p;const m=Dh(a[c[d]],u[h[d]]);if(m!==0)return m}return tt(c.length,h.length)}(t.mapValue,e.mapValue);default:throw Pe(23264,{he:n})}}function DD(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return tt(t,e);const n=wl(t),s=wl(e),r=tt(n.seconds,s.seconds);return r!==0?r:tt(n.nanos,s.nanos)}function OD(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=Dh(n[r],s[r]);if(i)return i}return tt(n.length,s.length)}function Oh(t){return TI(t)}function TI(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=wl(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return El(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",r=!0;for(const i of n.values||[])r?r=!1:s+=",",s+=TI(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${TI(n.fields[o])}`;return r+"}"}(t.mapValue):Pe(61005,{value:t})}function R_(t){switch(bl(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lE(t);return e?16+R_(e):16;case 5:return 2*t.stringValue.length;case 6:return El(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+R_(i),0)}(t.arrayValue);case 10:case 11:return function(s){let r=0;return Ll(s.fields,(i,o)=>{r+=i.length+R_(o)}),r}(t.mapValue);default:throw Pe(13486,{value:t})}}function CI(t){return!!t&&"integerValue"in t}function tA(t){return!!t&&"arrayValue"in t}function LD(t){return!!t&&"nullValue"in t}function MD(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function A_(t){return!!t&&"mapValue"in t}function zue(t){return(t?.mapValue?.fields||{})[Kq]?.stringValue===Gq}function vp(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ll(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=vp(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=vp(t.arrayValue.values[n]);return e}return{...t}}function Hue(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===$ue}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e){this.value=e}static empty(){return new js({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!A_(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=vp(n)}setAll(e){let n=Gn.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=vp(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());A_(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Hi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];A_(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Ll(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new js(vp(this.value))}}function Qq(t){const e=[];return Ll(t.fields,(n,s)=>{const r=new Gn([n]);if(A_(s)){const i=Qq(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new ir(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,n,s,r,i,o,a){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new hs(e,0,Be.min(),Be.min(),Be.min(),js.empty(),0)}static newFoundDocument(e,n,s,r){return new hs(e,1,n,Be.min(),s,r,0)}static newNoDocument(e,n){return new hs(e,2,n,Be.min(),Be.min(),js.empty(),0)}static newUnknownDocument(e,n){return new hs(e,3,n,Be.min(),Be.min(),js.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=js.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=js.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e,n){this.position=e,this.inclusive=n}}function VD(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=Ie.comparator(Ie.fromName(o.referenceValue),n.key):s=Dh(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function FD(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Hi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,n="asc"){this.field=e,this.dir=n}}function Wue(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yq{}class kn extends Yq{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new Gue(e,n,s):n==="array-contains"?new Xue(e,s):n==="in"?new Jue(e,s):n==="not-in"?new Zue(e,s):n==="array-contains-any"?new ehe(e,s):new kn(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new Que(e,s):new Yue(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Dh(n,this.value)):n!==null&&bl(this.value)===bl(n)&&this.matchesComparison(Dh(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wi extends Yq{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Wi(e,n)}matches(e){return Xq(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Xq(t){return t.op==="and"}function Jq(t){return Kue(t)&&Xq(t)}function Kue(t){for(const e of t.filters)if(e instanceof Wi)return!1;return!0}function II(t){if(t instanceof kn)return t.field.canonicalString()+t.op.toString()+Oh(t.value);if(Jq(t))return t.filters.map(e=>II(e)).join(",");{const e=t.filters.map(n=>II(n)).join(",");return`${t.op}(${e})`}}function Zq(t,e){return t instanceof kn?function(s,r){return r instanceof kn&&s.op===r.op&&s.field.isEqual(r.field)&&Hi(s.value,r.value)}(t,e):t instanceof Wi?function(s,r){return r instanceof Wi&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,a)=>i&&Zq(o,r.filters[a]),!0):!1}(t,e):void Pe(19439)}function eB(t){return t instanceof kn?function(n){return`${n.field.canonicalString()} ${n.op} ${Oh(n.value)}`}(t):t instanceof Wi?function(n){return n.op.toString()+" {"+n.getFilters().map(eB).join(" ,")+"}"}(t):"Filter"}class Gue extends kn{constructor(e,n,s){super(e,n,s),this.key=Ie.fromName(s.referenceValue)}matches(e){const n=Ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class Que extends kn{constructor(e,n){super(e,"in",n),this.keys=tB("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Yue extends kn{constructor(e,n){super(e,"not-in",n),this.keys=tB("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function tB(t,e){return(e.arrayValue?.values||[]).map(n=>Ie.fromName(n.referenceValue))}class Xue extends kn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return tA(n)&&vg(n.arrayValue,this.value)}}class Jue extends kn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&vg(this.value.arrayValue,n)}}class Zue extends kn{constructor(e,n){super(e,"not-in",n)}matches(e){if(vg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!vg(this.value.arrayValue,n)}}class ehe extends kn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!tA(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>vg(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class the{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function UD(t,e=null,n=[],s=[],r=null,i=null,o=null){return new the(t,e,n,s,r,i,o)}function nA(t){const e=He(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>II(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),aE(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>Oh(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>Oh(s)).join(",")),e.Te=n}return e.Te}function sA(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Wue(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Zq(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!FD(t.startAt,e.startAt)&&FD(t.endAt,e.endAt)}function SI(t){return Ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function nhe(t,e,n,s,r,i,o,a){return new cE(t,e,n,s,r,i,o,a)}function uE(t){return new cE(t)}function qD(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function she(t){return t.collectionGroup!==null}function wp(t){const e=He(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Nn(Gn.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new rv(i,s))}),n.has(Gn.keyField().canonicalString())||e.Ie.push(new rv(Gn.keyField(),s))}return e.Ie}function Mi(t){const e=He(t);return e.Ee||(e.Ee=rhe(e,wp(t))),e.Ee}function rhe(t,e){if(t.limitType==="F")return UD(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new rv(r.field,i)});const n=t.endAt?new sv(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new sv(t.startAt.position,t.startAt.inclusive):null;return UD(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function RI(t,e,n){return new cE(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hE(t,e){return sA(Mi(t),Mi(e))&&t.limitType===e.limitType}function nB(t){return`${nA(Mi(t))}|lt:${t.limitType}`}function Mu(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(r=>eB(r)).join(", ")}]`),aE(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(r=>Oh(r)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(r=>Oh(r)).join(",")),`Target(${s})`}(Mi(t))}; limitType=${t.limitType})`}function dE(t,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):Ie.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(t,e)&&function(s,r){for(const i of wp(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(s,r){return!(s.startAt&&!function(o,a,c){const u=VD(o,a,c);return o.inclusive?u<=0:u<0}(s.startAt,wp(s),r)||s.endAt&&!function(o,a,c){const u=VD(o,a,c);return o.inclusive?u>=0:u>0}(s.endAt,wp(s),r))}(t,e)}function ihe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function sB(t){return(e,n)=>{let s=!1;for(const r of wp(t)){const i=ohe(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function ohe(t,e,n){const s=t.field.isKeyField()?Ie.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),u=a.data.field(i);return c!==null&&u!==null?Dh(c,u):Pe(42886)}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return Pe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ll(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return Bq(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ahe=new wn(Ie.comparator);function ta(){return ahe}const rB=new wn(Ie.comparator);function xf(...t){let e=rB;for(const n of t)e=e.insert(n.key,n);return e}function iB(t){let e=rB;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function wc(){return Ep()}function oB(){return Ep()}function Ep(){return new cu(t=>t.toString(),(t,e)=>t.isEqual(e))}const lhe=new wn(Ie.comparator),che=new Nn(Ie.comparator);function st(...t){let e=che;for(const n of t)e=e.add(n);return e}const uhe=new Nn(tt);function hhe(){return uhe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rA(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ev(e)?"-0":e}}function aB(t){return{integerValue:""+t}}function dhe(t,e){return Fue(e)?aB(e):rA(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fE{constructor(){this._=void 0}}function fhe(t,e,n){return t instanceof wg?function(r,i){const o={fields:{[zq]:{stringValue:$q},[Wq]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&eA(i)&&(i=lE(i)),i&&(o.fields[Hq]=i),{mapValue:o}}(n,e):t instanceof Eg?cB(t,e):t instanceof bg?uB(t,e):function(r,i){const o=lB(r,i),a=BD(o)+BD(r.Ae);return CI(o)&&CI(r.Ae)?aB(a):rA(r.serializer,a)}(t,e)}function phe(t,e,n){return t instanceof Eg?cB(t,e):t instanceof bg?uB(t,e):n}function lB(t,e){return t instanceof iv?function(s){return CI(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class wg extends fE{}class Eg extends fE{constructor(e){super(),this.elements=e}}function cB(t,e){const n=hB(e);for(const s of t.elements)n.some(r=>Hi(r,s))||n.push(s);return{arrayValue:{values:n}}}class bg extends fE{constructor(e){super(),this.elements=e}}function uB(t,e){let n=hB(e);for(const s of t.elements)n=n.filter(r=>!Hi(r,s));return{arrayValue:{values:n}}}class iv extends fE{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function BD(t){return fn(t.integerValue||t.doubleValue)}function hB(t){return tA(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ghe{constructor(e,n){this.field=e,this.transform=n}}function mhe(t,e){return t.field.isEqual(e.field)&&function(s,r){return s instanceof Eg&&r instanceof Eg||s instanceof bg&&r instanceof bg?xh(s.elements,r.elements,Hi):s instanceof iv&&r instanceof iv?Hi(s.Ae,r.Ae):s instanceof wg&&r instanceof wg}(t.transform,e.transform)}class _he{constructor(e,n){this.version=e,this.transformResults=n}}class ri{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ri}static exists(e){return new ri(void 0,e)}static updateTime(e){return new ri(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function k_(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class pE{}function dB(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new iA(t.key,ri.none()):new cm(t.key,t.data,ri.none());{const n=t.data,s=js.empty();let r=new Nn(Gn.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new Ml(t.key,s,new ir(r.toArray()),ri.none())}}function yhe(t,e,n){t instanceof cm?function(r,i,o){const a=r.value.clone(),c=$D(r.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ml?function(r,i,o){if(!k_(r.precondition,i))return void i.convertToUnknownDocument(o.version);const a=$D(r.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(fB(r)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function bp(t,e,n,s){return t instanceof cm?function(i,o,a,c){if(!k_(i.precondition,o))return a;const u=i.value.clone(),h=zD(i.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,s):t instanceof Ml?function(i,o,a,c){if(!k_(i.precondition,o))return a;const u=zD(i.fieldTransforms,c,o),h=o.data;return h.setAll(fB(i)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(t,e,n,s):function(i,o,a){return k_(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function vhe(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=lB(s.transform,r||null);i!=null&&(n===null&&(n=js.empty()),n.set(s.field,i))}return n||null}function jD(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&xh(s,r,(i,o)=>mhe(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class cm extends pE{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ml extends pE{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function fB(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function $D(t,e,n){const s=new Map;bt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,phe(o,a,n[r]))}return s}function zD(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,fhe(i,o,e))}return s}class iA extends pE{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class whe extends pE{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ehe{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&yhe(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=bp(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=bp(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=oB();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const c=dB(o,a);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(Be.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),st())}isEqual(e){return this.batchId===e.batchId&&xh(this.mutations,e.mutations,(n,s)=>jD(n,s))&&xh(this.baseMutations,e.baseMutations,(n,s)=>jD(n,s))}}class oA{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){bt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return lhe}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new oA(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bhe{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class The{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gn,at;function Che(t){switch(t){case re.OK:return Pe(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Pe(15467,{code:t})}}function pB(t){if(t===void 0)return ea("GRPC error has no .code"),re.UNKNOWN;switch(t){case gn.OK:return re.OK;case gn.CANCELLED:return re.CANCELLED;case gn.UNKNOWN:return re.UNKNOWN;case gn.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case gn.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case gn.INTERNAL:return re.INTERNAL;case gn.UNAVAILABLE:return re.UNAVAILABLE;case gn.UNAUTHENTICATED:return re.UNAUTHENTICATED;case gn.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case gn.NOT_FOUND:return re.NOT_FOUND;case gn.ALREADY_EXISTS:return re.ALREADY_EXISTS;case gn.PERMISSION_DENIED:return re.PERMISSION_DENIED;case gn.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case gn.ABORTED:return re.ABORTED;case gn.OUT_OF_RANGE:return re.OUT_OF_RANGE;case gn.UNIMPLEMENTED:return re.UNIMPLEMENTED;case gn.DATA_LOSS:return re.DATA_LOSS;default:return Pe(39323,{code:t})}}(at=gn||(gn={}))[at.OK=0]="OK",at[at.CANCELLED=1]="CANCELLED",at[at.UNKNOWN=2]="UNKNOWN",at[at.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",at[at.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",at[at.NOT_FOUND=5]="NOT_FOUND",at[at.ALREADY_EXISTS=6]="ALREADY_EXISTS",at[at.PERMISSION_DENIED=7]="PERMISSION_DENIED",at[at.UNAUTHENTICATED=16]="UNAUTHENTICATED",at[at.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",at[at.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",at[at.ABORTED=10]="ABORTED",at[at.OUT_OF_RANGE=11]="OUT_OF_RANGE",at[at.UNIMPLEMENTED=12]="UNIMPLEMENTED",at[at.INTERNAL=13]="INTERNAL",at[at.UNAVAILABLE=14]="UNAVAILABLE",at[at.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ihe(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const She=new Ka([4294967295,4294967295],0);function HD(t){const e=Ihe().encode(t),n=new Nq;return n.update(e),new Uint8Array(n.digest())}function WD(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ka([n,s],0),new Ka([r,i],0)]}class aA{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new Df(`Invalid padding: ${n}`);if(s<0)throw new Df(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Df(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new Df(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ka.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply(Ka.fromNumber(s)));return r.compare(She)===1&&(r=new Ka([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=HD(e),[s,r]=WD(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new aA(i,r,n);return s.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=HD(e),[s,r]=WD(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class Df extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,um.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new gE(Be.min(),r,new wn(tt),ta(),st())}}class um{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new um(s,n,st(),st(),st())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class gB{constructor(e,n){this.targetId=e,this.Ce=n}}class mB{constructor(e,n,s=Xn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class KD{constructor(){this.ve=0,this.Fe=GD(),this.Me=Xn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=st(),n=st(),s=st();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:Pe(38017,{changeType:i})}}),new um(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=GD()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,bt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Rhe{constructor(e){this.Ge=e,this.ze=new Map,this.je=ta(),this.Je=Hm(),this.He=Hm(),this.Ye=new wn(tt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:Pe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((s,r)=>{this.rt(r)&&n(r)})}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const i=r.target;if(SI(i))if(s===0){const o=new Ie(i.path);this.et(n,o,hs.newNoDocument(o,Be.min()))}else bt(s===1,20013,{expectedCount:s});else{const o=this._t(n);if(o!==s){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let o,a;try{o=El(s).toUint8Array()}catch(c){if(c instanceof jq)return Nh("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new aA(o,r,i)}catch(c){return Nh(c instanceof Df?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),r++)}),r}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&SI(a.target)){const c=new Ie(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,hs.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let s=st();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.ot(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new gE(e,n,this.Ye,this.je,s);return this.je=ta(),this.Je=Hm(),this.He=Hm(),this.Ye=new wn(tt),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new KD,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Nn(tt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Nn(tt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||pe("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new KD),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Hm(){return new wn(Ie.comparator)}function GD(){return new wn(Ie.comparator)}const Ahe={asc:"ASCENDING",desc:"DESCENDING"},khe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Phe={and:"AND",or:"OR"};class Nhe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function AI(t,e){return t.useProto3Json||aE(e)?e:{value:e}}function ov(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _B(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function xhe(t,e){return ov(t,e.toTimestamp())}function Vi(t){return bt(!!t,49232),Be.fromTimestamp(function(n){const s=wl(n);return new jt(s.seconds,s.nanos)}(t))}function lA(t,e){return kI(t,e).canonicalString()}function kI(t,e){const n=function(r){return new Xt(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function yB(t){const e=Xt.fromString(t);return bt(TB(e),10190,{key:e.toString()}),e}function PI(t,e){return lA(t.databaseId,e.path)}function yT(t,e){const n=yB(e);if(n.get(1)!==t.databaseId.projectId)throw new ye(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ye(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ie(wB(n))}function vB(t,e){return lA(t.databaseId,e)}function Dhe(t){const e=yB(t);return e.length===4?Xt.emptyPath():wB(e)}function NI(t){return new Xt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function wB(t){return bt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function QD(t,e,n){return{name:PI(t,e),fields:n.value.mapValue.fields}}function Ohe(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Pe(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(u,h){return u.useProto3Json?(bt(h===void 0||typeof h=="string",58123),Xn.fromBase64String(h||"")):(bt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Xn.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=u.code===void 0?re.UNKNOWN:pB(u.code);return new ye(h,u.message||"")}(o);n=new mB(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=yT(t,s.document.name),i=Vi(s.document.updateTime),o=s.document.createTime?Vi(s.document.createTime):Be.min(),a=new js({mapValue:{fields:s.document.fields}}),c=hs.newFoundDocument(r,i,o,a),u=s.targetIds||[],h=s.removedTargetIds||[];n=new P_(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=yT(t,s.document),i=s.readTime?Vi(s.readTime):Be.min(),o=hs.newNoDocument(r,i),a=s.removedTargetIds||[];n=new P_([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=yT(t,s.document),i=s.removedTargetIds||[];n=new P_([],i,r,null)}else{if(!("filter"in e))return Pe(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new The(r,i),a=s.targetId;n=new gB(a,o)}}return n}function Lhe(t,e){let n;if(e instanceof cm)n={update:QD(t,e.key,e.value)};else if(e instanceof iA)n={delete:PI(t,e.key)};else if(e instanceof Ml)n={update:QD(t,e.key,e.data),updateMask:zhe(e.fieldMask)};else{if(!(e instanceof whe))return Pe(16599,{Vt:e.type});n={verify:PI(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const a=o.transform;if(a instanceof wg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Eg)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof bg)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof iv)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Pe(20930,{transform:o.transform})}(0,s))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:xhe(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Pe(27497)}(t,e.precondition)),n}function Mhe(t,e){return t&&t.length>0?(bt(e!==void 0,14353),t.map(n=>function(r,i){let o=r.updateTime?Vi(r.updateTime):Vi(i);return o.isEqual(Be.min())&&(o=Vi(i)),new _he(o,r.transformResults||[])}(n,e))):[]}function Vhe(t,e){return{documents:[vB(t,e.path)]}}function Fhe(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=vB(t,r);const i=function(u){if(u.length!==0)return bB(Wi.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(h=>function(p){return{field:Vu(p.field),direction:Bhe(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=AI(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ft:n,parent:r}}function Uhe(t){let e=Dhe(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){bt(s===1,65062);const h=n.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(d){const p=EB(d);return p instanceof Wi&&Jq(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(p=>function(w){return new rv(Fu(w.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(d){let p;return p=typeof d=="object"?d.value:d,aE(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(d){const p=!!d.before,m=d.values||[];return new sv(m,p)}(n.startAt));let u=null;return n.endAt&&(u=function(d){const p=!d.before,m=d.values||[];return new sv(m,p)}(n.endAt)),nhe(e,r,o,i,a,"F",c,u)}function qhe(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe(28987,{purpose:r})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function EB(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=Fu(n.unaryFilter.field);return kn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=Fu(n.unaryFilter.field);return kn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Fu(n.unaryFilter.field);return kn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Fu(n.unaryFilter.field);return kn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}}(t):t.fieldFilter!==void 0?function(n){return kn.create(Fu(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Wi.create(n.compositeFilter.filters.map(s=>EB(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}}(n.compositeFilter.op))}(t):Pe(30097,{filter:t})}function Bhe(t){return Ahe[t]}function jhe(t){return khe[t]}function $he(t){return Phe[t]}function Vu(t){return{fieldPath:t.canonicalString()}}function Fu(t){return Gn.fromServerFormat(t.fieldPath)}function bB(t){return t instanceof kn?function(n){if(n.op==="=="){if(MD(n.value))return{unaryFilter:{field:Vu(n.field),op:"IS_NAN"}};if(LD(n.value))return{unaryFilter:{field:Vu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(MD(n.value))return{unaryFilter:{field:Vu(n.field),op:"IS_NOT_NAN"}};if(LD(n.value))return{unaryFilter:{field:Vu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vu(n.field),op:jhe(n.op),value:n.value}}}(t):t instanceof Wi?function(n){const s=n.getFilters().map(r=>bB(r));return s.length===1?s[0]:{compositeFilter:{op:$he(n.op),filters:s}}}(t):Pe(54877,{filter:t})}function zhe(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function TB(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,n,s,r,i=Be.min(),o=Be.min(),a=Xn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Oa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Oa(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Oa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Oa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hhe{constructor(e){this.yt=e}}function Whe(t){const e=Uhe({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?RI(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Khe{constructor(){this.Cn=new Ghe}addToCollectionParentIndex(e,n){return this.Cn.add(n),te.resolve()}getCollectionParents(e,n){return te.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return te.resolve()}deleteFieldIndex(e,n){return te.resolve()}deleteAllFieldIndexes(e){return te.resolve()}createTargetIndexes(e,n){return te.resolve()}getDocumentsMatchingTarget(e,n){return te.resolve(null)}getIndexType(e,n){return te.resolve(0)}getFieldIndexes(e,n){return te.resolve([])}getNextCollectionGroupToUpdate(e){return te.resolve(null)}getMinOffset(e,n){return te.resolve(vl.min())}getMinOffsetFromCollectionGroup(e,n){return te.resolve(vl.min())}updateCollectionGroup(e,n,s){return te.resolve()}updateIndexEntries(e,n){return te.resolve()}}class Ghe{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new Nn(Xt.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Nn(Xt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},CB=41943040;class Bs{static withCacheSize(e){return new Bs(e,Bs.DEFAULT_COLLECTION_PERCENTILE,Bs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bs.DEFAULT_COLLECTION_PERCENTILE=10,Bs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bs.DEFAULT=new Bs(CB,Bs.DEFAULT_COLLECTION_PERCENTILE,Bs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bs.DISABLED=new Bs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Lh(0)}static cr(){return new Lh(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD="LruGarbageCollector",Qhe=1048576;function JD([t,e],[n,s]){const r=tt(t,n);return r===0?tt(e,s):r}class Yhe{constructor(e){this.Ir=e,this.buffer=new Nn(JD),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();JD(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Xhe{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(XD,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){rd(n)?pe(XD,"Ignoring IndexedDB error during garbage collection: ",n):await sd(n)}await this.Vr(3e5)})}}class Jhe{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return te.resolve(oE.ce);const s=new Yhe(n);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),te.resolve(YD)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),YD):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,i,o,a,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(e,r))).next(d=>(s=d,a=Date.now(),this.removeTargets(e,s,n))).next(d=>(i=d,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(d=>(u=Date.now(),Lu()<=Xe.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),te.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:d})))}}function Zhe(t,e){return new Jhe(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ede{constructor(){this.changes=new cu(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,hs.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?te.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tde{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nde{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&bp(s.mutation,r,ir.empty(),jt.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,st()).next(()=>s))}getLocalViewOfDocuments(e,n,s=st()){const r=wc();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=xf();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=wc();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,st()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=ta();const o=Ep(),a=function(){return Ep()}();return n.forEach((c,u)=>{const h=s.get(u.key);r.has(u.key)&&(h===void 0||h.mutation instanceof Ml)?i=i.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),bp(h.mutation,u,h.mutation.getFieldMask(),jt.now())):o.set(u.key,ir.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,h)=>o.set(u,h)),n.forEach((u,h)=>a.set(u,new tde(h,o.get(u)??null))),a))}recalculateAndSaveOverlays(e,n){const s=Ep();let r=new wn((o,a)=>o-a),i=st();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let h=s.get(c)||ir.empty();h=a.applyToLocalView(u,h),s.set(c,h);const d=(r.get(a.batchId)||st()).add(c);r=r.insert(a.batchId,d)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,h=c.value,d=oB();h.forEach(p=>{if(!i.has(p)){const m=dB(n.get(p),s.get(p));m!==null&&d.set(p,m),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return te.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(o){return Ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):she(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):te.resolve(wc());let a=mg,c=i;return o.next(u=>te.forEach(u,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(h)?te.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,st())).next(h=>({batchId:a,changes:iB(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ie(n)).next(s=>{let r=xf();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let o=xf();return this.indexManager.getCollectionParents(e,i).next(a=>te.forEach(a,c=>{const u=function(d,p){return new cE(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r))).next(o=>{i.forEach((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,hs.newInvalidDocument(h)))});let a=xf();return o.forEach((c,u)=>{const h=i.get(c);h!==void 0&&bp(h.mutation,u,ir.empty(),jt.now()),dE(n,u)&&(a=a.insert(c,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sde{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return te.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Vi(r.createTime)}}(n)),te.resolve()}getNamedQuery(e,n){return te.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(r){return{name:r.name,query:Whe(r.bundledQuery),readTime:Vi(r.readTime)}}(n)),te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rde{constructor(){this.overlays=new wn(Ie.comparator),this.qr=new Map}getOverlay(e,n){return te.resolve(this.overlays.get(n))}getOverlays(e,n){const s=wc();return te.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.St(e,n,i)}),te.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),te.resolve()}getOverlaysForCollection(e,n,s){const r=wc(),i=n.length+1,o=new Ie(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return te.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new wn((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let h=i.get(u.largestBatchId);h===null&&(h=wc(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=wc(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=r)););return te.resolve(a)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new bhe(n,s));let i=this.qr.get(n);i===void 0&&(i=st(),this.qr.set(n,i)),this.qr.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ide{constructor(){this.sessionToken=Xn.EMPTY_BYTE_STRING}getSessionToken(e){return te.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(){this.Qr=new Nn(Mn.$r),this.Ur=new Nn(Mn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new Mn(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Gr(new Mn(e,n))}zr(e,n){e.forEach(s=>this.removeReference(s,n))}jr(e){const n=new Ie(new Xt([])),s=new Mn(n,e),r=new Mn(n,e+1),i=[];return this.Ur.forEachInRange([s,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Ie(new Xt([])),s=new Mn(n,e),r=new Mn(n,e+1);let i=st();return this.Ur.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Mn(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Mn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Ie.comparator(e.key,n.key)||tt(e.Yr,n.Yr)}static Kr(e,n){return tt(e.Yr,n.Yr)||Ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ode{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Nn(Mn.$r)}checkEmpty(e){return te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ehe(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new Mn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return te.resolve(o)}lookupMutationBatch(e,n){return te.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),i=r<0?0:r;return te.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return te.resolve(this.mutationQueue.length===0?ZR:this.tr-1)}getAllMutationBatches(e){return te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Mn(n,0),r=new Mn(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],o=>{const a=this.Xr(o.Yr);i.push(a)}),te.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Nn(tt);return n.forEach(r=>{const i=new Mn(r,0),o=new Mn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{s=s.add(a.Yr)})}),te.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;Ie.isDocumentKey(i)||(i=i.child(""));const o=new Mn(new Ie(i),0);let a=new Nn(tt);return this.Zr.forEachWhile(c=>{const u=c.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(a=a.add(c.Yr)),!0)},o),te.resolve(this.ti(a))}ti(e){const n=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){bt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return te.forEach(n.mutations,r=>{const i=new Mn(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,n){const s=new Mn(n,0),r=this.Zr.firstAfterOrEqual(s);return te.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,te.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ade{constructor(e){this.ri=e,this.docs=function(){return new wn(Ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return te.resolve(s?s.document.mutableCopy():hs.newInvalidDocument(n))}getEntries(e,n){let s=ta();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():hs.newInvalidDocument(r))}),te.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=ta();const o=n.path,a=new Ie(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Oue(Due(h),s)<=0||(r.has(h.key)||dE(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return te.resolve(i)}getAllFromCollectionGroup(e,n,s,r){Pe(9500)}ii(e,n){return te.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new lde(this)}getSize(e){return te.resolve(this.size)}}class lde extends ede{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),te.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cde{constructor(e){this.persistence=e,this.si=new cu(n=>nA(n),sA),this.lastRemoteSnapshotVersion=Be.min(),this.highestTargetId=0,this.oi=0,this._i=new cA,this.targetCount=0,this.ai=Lh.ur()}forEachTarget(e,n){return this.si.forEach((s,r)=>n(r)),te.resolve()}getLastRemoteSnapshotVersion(e){return te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),te.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),te.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Lh(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,te.resolve()}updateTargetData(e,n){return this.Pr(n),te.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,te.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),te.waitFor(i).next(()=>r)}getTargetCount(e){return te.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return te.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),te.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),te.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),te.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return te.resolve(s)}containsKey(e,n){return te.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IB{constructor(e,n){this.ui={},this.overlays={},this.ci=new oE(0),this.li=!1,this.li=!0,this.hi=new ide,this.referenceDelegate=e(this),this.Pi=new cde(this),this.indexManager=new Khe,this.remoteDocumentCache=function(r){return new ade(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new Hhe(n),this.Ii=new sde(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new rde,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new ode(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){pe("MemoryPersistence","Starting transaction:",e);const r=new ude(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,n){return te.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,n)))}}class ude extends Mue{constructor(e){super(),this.currentSequenceNumber=e}}class uA{constructor(e){this.persistence=e,this.Ri=new cA,this.Vi=null}static mi(e){return new uA(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),te.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),te.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),te.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return te.forEach(this.fi,s=>{const r=Ie.fromPath(s);return this.gi(e,r).next(i=>{i||n.removeEntry(r,Be.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return te.or([()=>te.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class av{constructor(e,n){this.persistence=e,this.pi=new cu(s=>Uue(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=Zhe(this,n)}static mi(e,n){return new av(e,n)}Ei(){}di(e){return te.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}wr(e){let n=0;return this.pr(e,s=>{n++}).next(()=>n)}pr(e,n){return te.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?te.resolve():n(r)))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,n).next(a=>{a||(s++,i.removeEntry(o,Be.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),te.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),te.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),te.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),te.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=R_(e.data.value)),n}br(e,n,s){return te.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return te.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=st(),r=st();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new hA(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hde{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dde{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return Zoe()?8:Vue(ys())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new hde;return this.Ss(e,n,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)})}).next(()=>i.result)}bs(e,n,s,r){return s.documentReadCount<this.fs?(Lu()<=Xe.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",Mu(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),te.resolve()):(Lu()<=Xe.DEBUG&&pe("QueryEngine","Query:",Mu(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Lu()<=Xe.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",Mu(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Mi(n))):te.resolve())}ys(e,n){if(qD(n))return te.resolve(null);let s=Mi(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=RI(n,null,"F"),s=Mi(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=st(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(c=>{const u=this.Ds(n,a);return this.Cs(n,u,o,c.readTime)?this.ys(e,RI(n,null,"F")):this.vs(e,u,n,c)}))})))}ws(e,n,s,r){return qD(n)||r.isEqual(Be.min())?te.resolve(null):this.ps.getDocuments(e,s).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,s,r)?te.resolve(null):(Lu()<=Xe.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Mu(n)),this.vs(e,o,n,xue(r,mg)).next(a=>a))})}Ds(e,n){let s=new Nn(sB(e));return n.forEach((r,i)=>{dE(e,i)&&(s=s.add(i))}),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,n,s){return Lu()<=Xe.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",Mu(n)),this.ps.getDocumentsMatchingQuery(e,n,vl.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA="LocalStore",fde=3e8;class pde{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new wn(tt),this.xs=new cu(i=>nA(i),sA),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nde(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function gde(t,e,n,s){return new pde(t,e,n,s)}async function SB(t,e){const n=He(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let c=st();for(const u of r){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of i){a.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(s,c).next(u=>({Ls:u,removedBatchIds:o,addedBatchIds:a}))})})}function mde(t,e){const n=He(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(a,c,u,h){const d=u.batch,p=d.keys();let m=te.resolve();return p.forEach(w=>{m=m.next(()=>h.getEntry(c,w)).next(R=>{const k=u.docVersions.get(w);bt(k!==null,48541),R.version.compareTo(k)<0&&(d.applyToRemoteDocument(R,u),R.isValidDocument()&&(R.setReadTime(u.commitVersion),h.addEntry(R)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let c=st();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function RB(t){const e=He(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function _de(t,e){const n=He(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const a=[];e.targetChanges.forEach((h,d)=>{const p=r.get(d);if(!p)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,d).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,d)));let m=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?m=m.withResumeToken(Xn.EMPTY_BYTE_STRING,Be.min()).withLastLimboFreeSnapshotVersion(Be.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,s)),r=r.insert(d,m),function(R,k,O){return R.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=fde?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(p,m,h)&&a.push(n.Pi.updateTargetData(i,m))});let c=ta(),u=st();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(yde(i,o,e.documentUpdates).next(h=>{c=h.ks,u=h.qs})),!s.isEqual(Be.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(d=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(h)}return te.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.Ms=r,i))}function yde(t,e,n){let s=st(),r=st();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=ta();return n.forEach((a,c)=>{const u=i.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(Be.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):pe(dA,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{ks:o,qs:r}})}function vde(t,e){const n=He(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=ZR),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function wde(t,e){const n=He(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Pi.getTargetData(s,e).next(i=>i?(r=i,te.resolve(r)):n.Pi.allocateTargetId(s).next(o=>(r=new Oa(e,o,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s})}async function xI(t,e,n){const s=He(t),r=s.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!rd(o))throw o;pe(dA,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function ZD(t,e,n){const s=He(t);let r=Be.min(),i=st();return s.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,h){const d=He(c),p=d.xs.get(h);return p!==void 0?te.resolve(d.Ms.get(p)):d.Pi.getTargetData(u,h)}(s,o,Mi(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,e,n?r:Be.min(),n?i:st())).next(a=>(Ede(s,ihe(e),a),{documents:a,Qs:i})))}function Ede(t,e,n){let s=t.Os.get(e)||Be.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Os.set(e,s)}class eO{constructor(){this.activeTargetIds=hhe()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bde{constructor(){this.Mo=new eO,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new eO,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tde{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO="ConnectivityMonitor";class nO{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(tO,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(tO,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wm=null;function DI(){return Wm===null?Wm=function(){return 268435456+Math.round(2147483648*Math.random())}():Wm++,"0x"+Wm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT="RestConnection",Cde={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ide{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===tv?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,i){const o=DI(),a=this.zo(e,n.toUriEncodedString());pe(vT,`Sending RPC '${e}' ${o}:`,a,s);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,r,i);const{host:u}=new URL(a),h=Yi(u);return this.Jo(e,a,c,s,h).then(d=>(pe(vT,`Received RPC '${e}' ${o}: `,d),d),d=>{throw Nh(vT,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",s),d})}Ho(e,n,s,r,i,o){return this.Go(e,n,s,r,i)}jo(e,n,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+nd}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,n){const s=Cde[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sde{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zn="WebChannelConnection";class Rde extends Ide{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,i){const o=DI();return new Promise((a,c)=>{const u=new xq;u.setWithCredentials(!0),u.listenOnce(Dq.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case S_.NO_ERROR:const d=u.getResponseJson();pe(Zn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case S_.TIMEOUT:pe(Zn,`RPC '${e}' ${o} timed out`),c(new ye(re.DEADLINE_EXCEEDED,"Request time out"));break;case S_.HTTP_ERROR:const p=u.getStatus();if(pe(Zn,`RPC '${e}' ${o} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const w=m?.error;if(w&&w.status&&w.message){const R=function(O){const M=O.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(M)>=0?M:re.UNKNOWN}(w.status);c(new ye(R,w.message))}else c(new ye(re.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new ye(re.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{pe(Zn,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(r);pe(Zn,`RPC '${e}' ${o} sending request:`,r),u.send(n,"POST",h,s,15)})}T_(e,n,s){const r=DI(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Mq(),a=Lq(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,n,s),c.encodeInitMessageHeaders=!0;const h=i.join("");pe(Zn,`Creating RPC '${e}' stream ${r}: ${h}`,c);const d=o.createWebChannel(h,c);this.I_(d);let p=!1,m=!1;const w=new Sde({Yo:k=>{m?pe(Zn,`Not sending because RPC '${e}' stream ${r} is closed:`,k):(p||(pe(Zn,`Opening RPC '${e}' stream ${r} transport.`),d.open(),p=!0),pe(Zn,`RPC '${e}' stream ${r} sending:`,k),d.send(k))},Zo:()=>d.close()}),R=(k,O,M)=>{k.listen(O,F=>{try{M(F)}catch(q){setTimeout(()=>{throw q},0)}})};return R(d,Nf.EventType.OPEN,()=>{m||(pe(Zn,`RPC '${e}' stream ${r} transport opened.`),w.o_())}),R(d,Nf.EventType.CLOSE,()=>{m||(m=!0,pe(Zn,`RPC '${e}' stream ${r} transport closed`),w.a_(),this.E_(d))}),R(d,Nf.EventType.ERROR,k=>{m||(m=!0,Nh(Zn,`RPC '${e}' stream ${r} transport errored. Name:`,k.name,"Message:",k.message),w.a_(new ye(re.UNAVAILABLE,"The operation could not be completed")))}),R(d,Nf.EventType.MESSAGE,k=>{if(!m){const O=k.data[0];bt(!!O,16349);const M=O,F=M?.error||M[0]?.error;if(F){pe(Zn,`RPC '${e}' stream ${r} received error:`,F);const q=F.status;let H=function(v){const y=gn[v];if(y!==void 0)return pB(y)}(q),J=F.message;H===void 0&&(H=re.INTERNAL,J="Unknown error status: "+q+" with message "+F.message),m=!0,w.a_(new ye(H,J)),d.close()}else pe(Zn,`RPC '${e}' stream ${r} received:`,O),w.u_(O)}}),R(a,Oq.STAT_EVENT,k=>{k.stat===wI.PROXY?pe(Zn,`RPC '${e}' stream ${r} detected buffering proxy`):k.stat===wI.NOPROXY&&pe(Zn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{w.__()},0),w}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function wT(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(t){return new Nhe(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&pe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sO="PersistentStream";class kB{constructor(e,n,s,r,i,o,a,c){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new AB(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===re.RESOURCE_EXHAUSTED?(ea(n.toString()),ea("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===n&&this.G_(s,r)},s=>{e(()=>{const r=new ye(re.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return pe(sO,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(pe(sO,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ade extends kB{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Ohe(this.serializer,e),s=function(i){if(!("targetChange"in i))return Be.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Be.min():o.readTime?Vi(o.readTime):Be.min()}(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=NI(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=SI(c)?{documents:Vhe(i,c)}:{query:Fhe(i,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=_B(i,o.resumeToken);const u=AI(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(Be.min())>0){a.readTime=ov(i,o.snapshotVersion.toTimestamp());const u=AI(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const s=qhe(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=NI(this.serializer),n.removeTarget=e,this.q_(n)}}class kde extends kB{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return bt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,bt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){bt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=Mhe(e.writeResults,e.commitTime),s=Vi(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=NI(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>Lhe(this.serializer,s))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pde{}class Nde extends Pde{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ye(re.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,kI(n,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ye(re.UNKNOWN,i.toString())})}Ho(e,n,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,kI(n,s),r,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ye(re.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class xde{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ea(n),this.aa=!1):pe("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc="RemoteStore";class Dde{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{uu(this)&&(pe(Yc,"Restarting streams for network reachability change."),await async function(c){const u=He(c);u.Ea.add(4),await hm(u),u.Ra.set("Unknown"),u.Ea.delete(4),await _E(u)}(this))})}),this.Ra=new xde(s,r)}}async function _E(t){if(uu(t))for(const e of t.da)await e(!0)}async function hm(t){for(const e of t.da)await e(!1)}function PB(t,e){const n=He(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),mA(n)?gA(n):id(n).O_()&&pA(n,e))}function fA(t,e){const n=He(t),s=id(n);n.Ia.delete(e),s.O_()&&NB(n,e),n.Ia.size===0&&(s.O_()?s.L_():uu(n)&&n.Ra.set("Unknown"))}function pA(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Be.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}id(t).Y_(e)}function NB(t,e){t.Va.Ue(e),id(t).Z_(e)}function gA(t){t.Va=new Rhe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),id(t).start(),t.Ra.ua()}function mA(t){return uu(t)&&!id(t).x_()&&t.Ia.size>0}function uu(t){return He(t).Ea.size===0}function xB(t){t.Va=void 0}async function Ode(t){t.Ra.set("Online")}async function Lde(t){t.Ia.forEach((e,n)=>{pA(t,e)})}async function Mde(t,e){xB(t),mA(t)?(t.Ra.ha(e),gA(t)):t.Ra.set("Unknown")}async function Vde(t,e,n){if(t.Ra.set("Online"),e instanceof mB&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const a of i.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))}(t,e)}catch(s){pe(Yc,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await lv(t,s)}else if(e instanceof P_?t.Va.Ze(e):e instanceof gB?t.Va.st(e):t.Va.tt(e),!n.isEqual(Be.min()))try{const s=await RB(t.localStore);n.compareTo(s)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(u);h&&i.Ia.set(u,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(Xn.EMPTY_BYTE_STRING,h.snapshotVersion)),NB(i,c);const d=new Oa(h.target,c,u,h.sequenceNumber);pA(i,d)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(s){pe(Yc,"Failed to raise snapshot:",s),await lv(t,s)}}async function lv(t,e,n){if(!rd(e))throw e;t.Ea.add(1),await hm(t),t.Ra.set("Offline"),n||(n=()=>RB(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{pe(Yc,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await _E(t)})}function DB(t,e){return e().catch(n=>lv(t,n,e))}async function yE(t){const e=He(t),n=Tl(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ZR;for(;Fde(e);)try{const r=await vde(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,Ude(e,r)}catch(r){await lv(e,r)}OB(e)&&LB(e)}function Fde(t){return uu(t)&&t.Ta.length<10}function Ude(t,e){t.Ta.push(e);const n=Tl(t);n.O_()&&n.X_&&n.ea(e.mutations)}function OB(t){return uu(t)&&!Tl(t).x_()&&t.Ta.length>0}function LB(t){Tl(t).start()}async function qde(t){Tl(t).ra()}async function Bde(t){const e=Tl(t);for(const n of t.Ta)e.ea(n.mutations)}async function jde(t,e,n){const s=t.Ta.shift(),r=oA.from(s,e,n);await DB(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await yE(t)}async function $de(t,e){e&&Tl(t).X_&&await async function(s,r){if(function(o){return Che(o)&&o!==re.ABORTED}(r.code)){const i=s.Ta.shift();Tl(s).B_(),await DB(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await yE(s)}}(t,e),OB(t)&&LB(t)}async function rO(t,e){const n=He(t);n.asyncQueue.verifyOperationInProgress(),pe(Yc,"RemoteStore received new credentials");const s=uu(n);n.Ea.add(3),await hm(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await _E(n)}async function zde(t,e){const n=He(t);e?(n.Ea.delete(2),await _E(n)):e||(n.Ea.add(2),await hm(n),n.Ra.set("Unknown"))}function id(t){return t.ma||(t.ma=function(n,s,r){const i=He(n);return i.sa(),new Ade(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:Ode.bind(null,t),t_:Lde.bind(null,t),r_:Mde.bind(null,t),H_:Vde.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),mA(t)?gA(t):t.Ra.set("Unknown")):(await t.ma.stop(),xB(t))})),t.ma}function Tl(t){return t.fa||(t.fa=function(n,s,r){const i=He(n);return i.sa(),new kde(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:qde.bind(null,t),r_:$de.bind(null,t),ta:Bde.bind(null,t),na:jde.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await yE(t)):(await t.fa.stop(),t.Ta.length>0&&(pe(Yc,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Ga,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new _A(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ye(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function yA(t,e){if(ea("AsyncQueue",`${e}: ${t}`),rd(t))return new ye(re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{static emptySet(e){return new oh(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||Ie.comparator(n.key,s.key):(n,s)=>Ie.comparator(n.key,s.key),this.keyedMap=xf(),this.sortedSet=new wn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof oh)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new oh;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(){this.ga=new wn(Ie.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Pe(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,s)=>{e.push(s)}),e}}class Mh{constructor(e,n,s,r,i,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,r,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Mh(e,n,oh.emptySet(n),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hE(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hde{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Wde{constructor(){this.queries=oO(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const r=He(n),i=r.queries;r.queries=oO(),i.forEach((o,a)=>{for(const c of a.Sa)c.onError(s)})})(this,new ye(re.ABORTED,"Firestore shutting down"))}}function oO(){return new cu(t=>nB(t),hE)}async function MB(t,e){const n=He(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new Hde,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await n.onListen(r,!0);break;case 1:i.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const a=yA(o,`Initialization of query '${Mu(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&vA(n)}async function VB(t,e){const n=He(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function Kde(t,e){const n=He(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(r)&&(s=!0);o.wa=r}}s&&vA(n)}function Gde(t,e,n){const s=He(t),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(n);s.queries.delete(e)}function vA(t){t.Ca.forEach(e=>{e.next()})}var OI,aO;(aO=OI||(OI={})).Ma="default",aO.Cache="cache";class FB{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Mh(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Mh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==OI.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UB{constructor(e){this.key=e}}class qB{constructor(e){this.key=e}}class Qde{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=st(),this.mutatedKeys=st(),this.eu=sB(e),this.tu=new oh(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new iO,r=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,d)=>{const p=r.get(h),m=dE(this.query,d)?d:null,w=!!p&&this.mutatedKeys.has(p.key),R=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let k=!1;p&&m?p.data.isEqual(m.data)?w!==R&&(s.track({type:3,doc:m}),k=!0):this.su(p,m)||(s.track({type:2,doc:m}),k=!0,(c&&this.eu(m,c)>0||u&&this.eu(m,u)<0)&&(a=!0)):!p&&m?(s.track({type:0,doc:m}),k=!0):p&&!m&&(s.track({type:1,doc:p}),k=!0,(c||u)&&(a=!0)),k&&(m?(o=o.add(m),i=R?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),s.track({type:1,doc:h})}return{tu:o,iu:s,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,d)=>function(m,w){const R=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe(20277,{Rt:k})}};return R(m)-R(w)}(h.type,d.type)||this.eu(h.doc,d.doc)),this.ou(s),r=r??!1;const a=n&&!r?this._u():[],c=this.Xa.size===0&&this.current&&!r?1:0,u=c!==this.Za;return this.Za=c,o.length!==0||u?{snapshot:new Mh(this.query,e.tu,i,o,e.mutatedKeys,c===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new iO,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=st(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const n=[];return e.forEach(s=>{this.Xa.has(s)||n.push(new qB(s))}),this.Xa.forEach(s=>{e.has(s)||n.push(new UB(s))}),n}cu(e){this.Ya=e.Qs,this.Xa=st();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Mh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const wA="SyncEngine";class Yde{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class Xde{constructor(e){this.key=e,this.hu=!1}}class Jde{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new cu(a=>nB(a),hE),this.Iu=new Map,this.Eu=new Set,this.du=new wn(Ie.comparator),this.Au=new Map,this.Ru=new cA,this.Vu={},this.mu=new Map,this.fu=Lh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Zde(t,e,n=!0){const s=WB(t);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await BB(s,e,n,!0),r}async function efe(t,e){const n=WB(t);await BB(n,e,!0,!1)}async function BB(t,e,n,s){const r=await wde(t.localStore,Mi(e)),i=r.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return s&&(a=await tfe(t,e,i,o==="current",r.resumeToken)),t.isPrimaryClient&&n&&PB(t.remoteStore,r),a}async function tfe(t,e,n,s,r){t.pu=(d,p,m)=>async function(R,k,O,M){let F=k.view.ru(O);F.Cs&&(F=await ZD(R.localStore,k.query,!1).then(({documents:I})=>k.view.ru(I,F)));const q=M&&M.targetChanges.get(k.targetId),H=M&&M.targetMismatches.get(k.targetId)!=null,J=k.view.applyChanges(F,R.isPrimaryClient,q,H);return cO(R,k.targetId,J.au),J.snapshot}(t,d,p,m);const i=await ZD(t.localStore,e,!0),o=new Qde(e,i.Qs),a=o.ru(i.documents),c=um.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),u=o.applyChanges(a,t.isPrimaryClient,c);cO(t,n,u.au);const h=new Yde(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function nfe(t,e,n){const s=He(t),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(o=>!hE(o,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await xI(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&fA(s.remoteStore,r.targetId),LI(s,r.targetId)}).catch(sd)):(LI(s,r.targetId),await xI(s.localStore,r.targetId,!0))}async function sfe(t,e){const n=He(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),fA(n.remoteStore,s.targetId))}async function rfe(t,e,n){const s=hfe(t);try{const r=await function(o,a){const c=He(o),u=jt.now(),h=a.reduce((m,w)=>m.add(w.key),st());let d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let w=ta(),R=st();return c.Ns.getEntries(m,h).next(k=>{w=k,w.forEach((O,M)=>{M.isValidDocument()||(R=R.add(O))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,w)).next(k=>{d=k;const O=[];for(const M of a){const F=vhe(M,d.get(M.key).overlayedDocument);F!=null&&O.push(new Ml(M.key,F,Qq(F.value.mapValue),ri.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,O,a)}).next(k=>{p=k;const O=k.applyToLocalDocumentSet(d,R);return c.documentOverlayCache.saveOverlays(m,k.batchId,O)})}).then(()=>({batchId:p.batchId,changes:iB(d)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,a,c){let u=o.Vu[o.currentUser.toKey()];u||(u=new wn(tt)),u=u.insert(a,c),o.Vu[o.currentUser.toKey()]=u}(s,r.batchId,n),await dm(s,r.changes),await yE(s.remoteStore)}catch(r){const i=yA(r,"Failed to persist write");n.reject(i)}}async function jB(t,e){const n=He(t);try{const s=await _de(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.Au.get(i);o&&(bt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?bt(o.hu,14607):r.removedDocuments.size>0&&(bt(o.hu,42227),o.hu=!1))}),await dm(n,s,e)}catch(s){await sd(s)}}function lO(t,e,n){const s=He(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const c=He(o);c.onlineState=a;let u=!1;c.queries.forEach((h,d)=>{for(const p of d.Sa)p.va(a)&&(u=!0)}),u&&vA(c)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function ife(t,e,n){const s=He(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new wn(Ie.comparator);o=o.insert(i,hs.newNoDocument(i,Be.min()));const a=st().add(i),c=new gE(Be.min(),new Map,new wn(tt),o,a);await jB(s,c),s.du=s.du.remove(i),s.Au.delete(e),EA(s)}else await xI(s.localStore,e,!1).then(()=>LI(s,e,n)).catch(sd)}async function ofe(t,e){const n=He(t),s=e.batch.batchId;try{const r=await mde(n.localStore,e);zB(n,s,null),$B(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await dm(n,r)}catch(r){await sd(r)}}async function afe(t,e,n){const s=He(t);try{const r=await function(o,a){const c=He(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,a).next(d=>(bt(d!==null,37113),h=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(s.localStore,e);zB(s,e,n),$B(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await dm(s,r)}catch(r){await sd(r)}}function $B(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function zB(t,e,n){const s=He(t);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function LI(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(s=>{t.Ru.containsKey(s)||HB(t,s)})}function HB(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(fA(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),EA(t))}function cO(t,e,n){for(const s of n)s instanceof UB?(t.Ru.addReference(s.key,e),lfe(t,s)):s instanceof qB?(pe(wA,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||HB(t,s.key)):Pe(19791,{wu:s})}function lfe(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(pe(wA,"New document in limbo: "+n),t.Eu.add(s),EA(t))}function EA(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Ie(Xt.fromString(e)),s=t.fu.next();t.Au.set(s,new Xde(n)),t.du=t.du.insert(n,s),PB(t.remoteStore,new Oa(Mi(uE(n.path)),s,"TargetPurposeLimboResolution",oE.ce))}}async function dm(t,e,n){const s=He(t),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((a,c)=>{o.push(s.pu(c,e,n).then(u=>{if((u||n)&&s.isPrimaryClient){const h=u?!u.fromCache:n?.targetChanges.get(c.targetId)?.current;s.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){r.push(u);const h=hA.As(c.targetId,u);i.push(h)}}))}),await Promise.all(o),s.Pu.H_(r),await async function(c,u){const h=He(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>te.forEach(u,p=>te.forEach(p.Es,m=>h.persistence.referenceDelegate.addReference(d,p.targetId,m)).next(()=>te.forEach(p.ds,m=>h.persistence.referenceDelegate.removeReference(d,p.targetId,m)))))}catch(d){if(!rd(d))throw d;pe(dA,"Failed to update sequence numbers: "+d)}for(const d of u){const p=d.targetId;if(!d.fromCache){const m=h.Ms.get(p),w=m.snapshotVersion,R=m.withLastLimboFreeSnapshotVersion(w);h.Ms=h.Ms.insert(p,R)}}}(s.localStore,i))}async function cfe(t,e){const n=He(t);if(!n.currentUser.isEqual(e)){pe(wA,"User change. New user:",e.toKey());const s=await SB(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(c=>{c.reject(new ye(re.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await dm(n,s.Ls)}}function ufe(t,e){const n=He(t),s=n.Au.get(e);if(s&&s.hu)return st().add(s.key);{let r=st();const i=n.Iu.get(e);if(!i)return r;for(const o of i){const a=n.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function WB(t){const e=He(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jB.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ufe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ife.bind(null,e),e.Pu.H_=Kde.bind(null,e.eventManager),e.Pu.yu=Gde.bind(null,e.eventManager),e}function hfe(t){const e=He(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ofe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=afe.bind(null,e),e}class cv{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mE(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return gde(this.persistence,new dde,e.initialUser,this.serializer)}Cu(e){return new IB(uA.mi,this.serializer)}Du(e){return new bde}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cv.provider={build:()=>new cv};class dfe extends cv{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){bt(this.persistence.referenceDelegate instanceof av,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new Xhe(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Bs.withCacheSize(this.cacheSizeBytes):Bs.DEFAULT;return new IB(s=>av.mi(s,n),this.serializer)}}class MI{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>lO(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=cfe.bind(null,this.syncEngine),await zde(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Wde}()}createDatastore(e){const n=mE(e.databaseInfo.databaseId),s=function(i){return new Rde(i)}(e.databaseInfo);return function(i,o,a,c){return new Nde(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,r,i,o,a){return new Dde(s,r,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>lO(this.syncEngine,n,0),function(){return nO.v()?new nO:new Tde}())}createSyncEngine(e,n){return function(r,i,o,a,c,u,h){const d=new Jde(r,i,o,a,c,u);return h&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await async function(n){const s=He(n);pe(Yc,"RemoteStore shutting down."),s.Ea.add(5),await hm(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}MI.provider={build:()=>new MI};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ea("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl="FirestoreClient";class ffe{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=is.UNAUTHENTICATED,this.clientId=XR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{pe(Cl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(pe(Cl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ga;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=yA(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function ET(t,e){t.asyncQueue.verifyOperationInProgress(),pe(Cl,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await SB(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function uO(t,e){t.asyncQueue.verifyOperationInProgress();const n=await pfe(t);pe(Cl,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>rO(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>rO(e.remoteStore,r)),t._onlineComponents=e}async function pfe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){pe(Cl,"Using user provided OfflineComponentProvider");try{await ET(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===re.FAILED_PRECONDITION||r.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;Nh("Error using user provided cache. Falling back to memory cache: "+n),await ET(t,new cv)}}else pe(Cl,"Using default OfflineComponentProvider"),await ET(t,new dfe(void 0));return t._offlineComponents}async function GB(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(pe(Cl,"Using user provided OnlineComponentProvider"),await uO(t,t._uninitializedComponentsProvider._online)):(pe(Cl,"Using default OnlineComponentProvider"),await uO(t,new MI))),t._onlineComponents}function gfe(t){return GB(t).then(e=>e.syncEngine)}async function VI(t){const e=await GB(t),n=e.eventManager;return n.onListen=Zde.bind(null,e.syncEngine),n.onUnlisten=nfe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=efe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=sfe.bind(null,e.syncEngine),n}function mfe(t,e,n={}){const s=new Ga;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,u){const h=new KB({next:p=>{h.Nu(),o.enqueueAndForget(()=>VB(i,d));const m=p.docs.has(a);!m&&p.fromCache?u.reject(new ye(re.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&c&&c.source==="server"?u.reject(new ye(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),d=new FB(uE(a.path),h,{includeMetadataChanges:!0,qa:!0});return MB(i,d)}(await VI(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QB(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YB="firestore.googleapis.com",dO=!0;class fO{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ye(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=YB,this.ssl=dO}else this.host=e.host,this.ssl=e.ssl??dO;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=CB;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Qhe)throw new ye(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Nue("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QB(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ye(re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ye(re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ye(re.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class bA{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fO({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ye(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ye(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fO(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new wue;switch(s.type){case"firstParty":return new Cue(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ye(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=hO.get(n);s&&(pe("ComponentProvider","Removing Datastore"),hO.delete(n),s.terminate())}(this),Promise.resolve()}}function _fe(t,e,n,s={}){t=si(t,bA);const r=Yi(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;r&&(Jw(`https://${a}`),Zw("Firestore",!0)),i.host!==YB&&i.host!==a&&Nh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:a,ssl:r,emulatorOptions:s};if(!_l(c,o)&&(t._setSettings(c),s.mockUserToken)){let u,h;if(typeof s.mockUserToken=="string")u=s.mockUserToken,h=is.MOCK_USER;else{u=MR(s.mockUserToken,t._app?.options.projectId);const d=s.mockUserToken.sub||s.mockUserToken.user_id;if(!d)throw new ye(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new is(d)}t._authCredentials=new Eue(new Fq(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new vE(this.firestore,e,this._query)}}class yn{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yn(this.firestore,e,this._key)}toJSON(){return{type:yn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(lm(n,yn._jsonSchema))return new yn(e,s||null,new Ie(Xt.fromString(n.referencePath)))}}yn._jsonSchemaVersion="firestore/documentReference/1.0",yn._jsonSchema={type:_n("string",yn._jsonSchemaVersion),referencePath:_n("string")};class Tg extends vE{constructor(e,n,s){super(e,n,uE(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yn(this.firestore,null,new Ie(e))}withConverter(e){return new Tg(this.firestore,e,this._path)}}function yfe(t,e,...n){if(t=St(t),arguments.length===1&&(e=XR.newId()),Pue("doc","path",e),t instanceof bA){const s=Xt.fromString(e,...n);return RD(s),new yn(t,null,new Ie(s))}{if(!(t instanceof yn||t instanceof Tg))throw new ye(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Xt.fromString(e,...n));return RD(s),new yn(t.firestore,t instanceof Tg?t.converter:null,new Ie(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO="AsyncQueue";class gO{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new AB(this,"async_queue_retry"),this._c=()=>{const s=wT();s&&pe(pO,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=wT();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=wT();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Ga;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!rd(e))throw e;pe(pO,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,ea("INTERNAL UNHANDLED ERROR: ",mO(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=_A.createAndSchedule(this,e,n,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&Pe(47125,{Pc:mO(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function mO(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _O(t){return function(n,s){if(typeof n!="object"||n===null)return!1;const r=n;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Xc extends bA{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new gO,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gO(e),this._firestoreClient=void 0,await e}}}function XB(t,e){const n=typeof t=="object"?t:nE(),s=typeof t=="string"?t:tv,r=rm(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=LR("firestore");i&&_fe(r,...i)}return r}function TA(t){if(t._terminated)throw new ye(re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||vfe(t),t._firestoreClient}function vfe(t){const e=t._freezeSettings(),n=function(r,i,o,a){return new jue(r,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,QB(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new ffe(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(r){const i=r?._online.build();return{_offline:r?._offline.build(i),_online:i}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fr(Xn.fromBase64String(e))}catch(n){throw new ye(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new fr(Xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:fr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(lm(e,fr._jsonSchema))return fr.fromBase64String(e.bytes)}}fr._jsonSchemaVersion="firestore/bytes/1.0",fr._jsonSchema={type:_n("string",fr._jsonSchemaVersion),bytes:_n("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ye(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ye(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ye(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tt(this._lat,e._lat)||tt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fi._jsonSchemaVersion}}static fromJSON(e){if(lm(e,Fi._jsonSchema))return new Fi(e.latitude,e.longitude)}}Fi._jsonSchemaVersion="firestore/geoPoint/1.0",Fi._jsonSchema={type:_n("string",Fi._jsonSchemaVersion),latitude:_n("number"),longitude:_n("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Ui._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(lm(e,Ui._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Ui(e.vectorValues);throw new ye(re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ui._jsonSchemaVersion="firestore/vectorValue/1.0",Ui._jsonSchema={type:_n("string",Ui._jsonSchemaVersion),vectorValues:_n("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wfe=/^__.*__$/;class Efe{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new Ml(e,this.data,this.fieldMask,n,this.fieldTransforms):new cm(e,this.data,n,this.fieldTransforms)}}class JB{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new Ml(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ZB(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe(40011,{Ac:t})}}class CA{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new CA({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return uv(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ZB(this.Ac)&&wfe.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class bfe{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||mE(e)}Cc(e,n,s,r=!1){return new CA({Ac:e,methodName:n,Dc:s,path:Gn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ej(t){const e=t._freezeSettings(),n=mE(t._databaseId);return new bfe(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Tfe(t,e,n,s,r,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,r);SA("Data must be an object, but it was:",o,s);const a=tj(s,o);let c,u;if(i.merge)c=new ir(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const d of i.mergeFields){const p=FI(e,d,n);if(!o.contains(p))throw new ye(re.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);sj(h,p)||h.push(p)}c=new ir(h),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new Efe(new js(a),c,u)}class bE extends EE{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bE}}class IA extends EE{_toFieldTransform(e){return new ghe(e.path,new wg)}isEqual(e){return e instanceof IA}}function Cfe(t,e,n,s){const r=t.Cc(1,e,n);SA("Data must be an object, but it was:",r,s);const i=[],o=js.empty();Ll(s,(c,u)=>{const h=RA(e,c,n);u=St(u);const d=r.yc(h);if(u instanceof bE)i.push(h);else{const p=TE(u,d);p!=null&&(i.push(h),o.set(h,p))}});const a=new ir(i);return new JB(o,a,r.fieldTransforms)}function Ife(t,e,n,s,r,i){const o=t.Cc(1,e,n),a=[FI(e,s,n)],c=[r];if(i.length%2!=0)throw new ye(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(FI(e,i[p])),c.push(i[p+1]);const u=[],h=js.empty();for(let p=a.length-1;p>=0;--p)if(!sj(u,a[p])){const m=a[p];let w=c[p];w=St(w);const R=o.yc(m);if(w instanceof bE)u.push(m);else{const k=TE(w,R);k!=null&&(u.push(m),h.set(m,k))}}const d=new ir(u);return new JB(h,d,o.fieldTransforms)}function TE(t,e){if(nj(t=St(t)))return SA("Unsupported field value:",e,t),tj(t,e);if(t instanceof EE)return function(s,r){if(!ZB(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const a of s){let c=TE(a,r.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(s,r){if((s=St(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return dhe(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=jt.fromDate(s);return{timestampValue:ov(r.serializer,i)}}if(s instanceof jt){const i=new jt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:ov(r.serializer,i)}}if(s instanceof Fi)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof fr)return{bytesValue:_B(r.serializer,s._byteString)};if(s instanceof yn){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:lA(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Ui)return function(o,a){return{mapValue:{fields:{[Kq]:{stringValue:Gq},[nv]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return rA(a.serializer,u)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${JR(s)}`)}(t,e)}function tj(t,e){const n={};return Bq(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ll(t,(s,r)=>{const i=TE(r,e.mc(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function nj(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof jt||t instanceof Fi||t instanceof fr||t instanceof yn||t instanceof EE||t instanceof Ui)}function SA(t,e,n){if(!nj(n)||!Uq(n)){const s=JR(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function FI(t,e,n){if((e=St(e))instanceof wE)return e._internalPath;if(typeof e=="string")return RA(t,e);throw uv("Field path arguments must be of type string or ",t,!1,void 0,n)}const Sfe=new RegExp("[~\\*/\\[\\]]");function RA(t,e,n){if(e.search(Sfe)>=0)throw uv(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new wE(...e.split("."))._internalPath}catch{throw uv(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function uv(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new ye(re.INVALID_ARGUMENT,a+t+c)}function sj(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new yn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Rfe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ij("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Rfe extends rj{data(){return super.data()}}function ij(t,e){return typeof e=="string"?RA(t,e):e instanceof wE?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Afe(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ye(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kfe{convertValue(e,n="none"){switch(bl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return fn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(El(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Pe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Ll(e,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertVectorValue(e){const n=e.fields?.[nv].arrayValue?.values?.map(s=>fn(s.doubleValue));return new Ui(n)}convertGeoPoint(e){return new Fi(fn(e.latitude),fn(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=lE(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(_g(e));default:return null}}convertTimestamp(e){const n=wl(e);return new jt(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=Xt.fromString(e);bt(TB(s),9688,{name:e});const r=new yg(s.get(1),s.get(3)),i=new Ie(s.popFirst(5));return r.isEqual(n)||ea(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pfe(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class Of{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Oc extends rj{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new N_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(ij("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ye(re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Oc._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Oc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Oc._jsonSchema={type:_n("string",Oc._jsonSchemaVersion),bundleSource:_n("string","DocumentSnapshot"),bundleName:_n("string"),bundle:_n("string")};class N_ extends Oc{data(e={}){return super.data(e)}}class ah{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Of(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new N_(this._firestore,this._userDataWriter,s.key,s,new Of(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ye(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const c=new N_(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Of(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new N_(r._firestore,r._userDataWriter,a.doc.key,a.doc,new Of(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:Nfe(a.type),doc:c,oldIndex:u,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ye(re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ah._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=XR.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Nfe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(t){t=si(t,yn);const e=si(t.firestore,Xc);return mfe(TA(e),t._key).then(n=>aj(e,t,n))}ah._jsonSchemaVersion="firestore/querySnapshot/1.0",ah._jsonSchema={type:_n("string",ah._jsonSchemaVersion),bundleSource:_n("string","QuerySnapshot"),bundleName:_n("string"),bundle:_n("string")};class oj extends kfe{constructor(e){super(),this.firestore=e}convertBytes(e){return new fr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,n)}}function vO(t,e,n){t=si(t,yn);const s=si(t.firestore,Xc),r=Pfe(t.converter,e,n);return AA(s,[Tfe(ej(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,ri.none())])}function Pve(t,e,n,...s){t=si(t,yn);const r=si(t.firestore,Xc),i=ej(r);let o;return o=typeof(e=St(e))=="string"||e instanceof wE?Ife(i,"updateDoc",t._key,e,n,s):Cfe(i,"updateDoc",t._key,e),AA(r,[o.toMutation(t._key,ri.exists(!0))])}function Nve(t){return AA(si(t.firestore,Xc),[new iA(t._key,ri.none())])}function xve(t,...e){t=St(t);let n={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||_O(e[s])||(n=e[s++]);const r={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(_O(e[s])){const c=e[s];e[s]=c.next?.bind(c),e[s+1]=c.error?.bind(c),e[s+2]=c.complete?.bind(c)}let i,o,a;if(t instanceof yn)o=si(t.firestore,Xc),a=uE(t._key.path),i={next:c=>{e[s]&&e[s](aj(o,t,c))},error:e[s+1],complete:e[s+2]};else{const c=si(t,vE);o=si(c.firestore,Xc),a=c._query;const u=new oj(o);i={next:h=>{e[s]&&e[s](new ah(o,u,c,h))},error:e[s+1],complete:e[s+2]},Afe(t._query)}return function(u,h,d,p){const m=new KB(p),w=new FB(h,m,d);return u.asyncQueue.enqueueAndForget(async()=>MB(await VI(u),w)),()=>{m.Nu(),u.asyncQueue.enqueueAndForget(async()=>VB(await VI(u),w))}}(TA(o),a,r,i)}function AA(t,e){return function(s,r){const i=new Ga;return s.asyncQueue.enqueueAndForget(async()=>rfe(await gfe(s),r,i)),i.promise}(TA(t),e)}function aj(t,e,n){const s=n.docs.get(e._key),r=new oj(t);return new Oc(t,r,e._key,s,new Of(n.hasPendingWrites,n.fromCache),e.converter)}function bT(){return new IA("serverTimestamp")}(function(e,n=!0){(function(r){nd=r})(Ol),yl(new Xo("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),a=new Xc(new bue(s.getProvider("auth-internal")),new Iue(o,s.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ye(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yg(u.options.projectId,h)}(o,r),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),yr(TD,CD,e),yr(TD,CD,"esm2020")})();var xfe="firebase",Dfe="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yr(xfe,Dfe,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj="firebasestorage.googleapis.com",cj="storageBucket",Ofe=120*1e3,Lfe=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un extends Xi{constructor(e,n,s=0){super(TT(e),`Firebase Storage: ${n} (${TT(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,un.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return TT(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ln;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ln||(ln={}));function TT(t){return"storage/"+t}function kA(){const t="An unknown error occurred, please check the error payload for server response.";return new un(ln.UNKNOWN,t)}function Mfe(t){return new un(ln.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function Vfe(t){return new un(ln.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Ffe(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new un(ln.UNAUTHENTICATED,t)}function Ufe(){return new un(ln.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function qfe(t){return new un(ln.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Bfe(){return new un(ln.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function jfe(){return new un(ln.CANCELED,"User canceled the upload/download.")}function $fe(t){return new un(ln.INVALID_URL,"Invalid URL '"+t+"'.")}function zfe(t){return new un(ln.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Hfe(){return new un(ln.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+cj+"' property when initializing the app?")}function Wfe(){return new un(ln.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Kfe(){return new un(ln.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Gfe(t){return new un(ln.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function UI(t){return new un(ln.INVALID_ARGUMENT,t)}function uj(){return new un(ln.APP_DELETED,"The Firebase app was deleted.")}function Qfe(t){return new un(ln.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Tp(t,e){return new un(ln.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function mf(t){throw new un(ln.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=Ms.makeFromUrl(e,n)}catch{return new Ms(e,"")}if(s.path==="")return s;throw zfe(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(q){q.path.charAt(q.path.length-1)==="/"&&(q.path_=q.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function u(q){q.path_=decodeURIComponent(q.path)}const h="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${d}/${h}/b/${r}/o${p}`,"i"),w={bucket:1,path:3},R=n===lj?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",O=new RegExp(`^https?://${R}/${r}/${k}`,"i"),F=[{regex:a,indices:c,postModify:i},{regex:m,indices:w,postModify:u},{regex:O,indices:{bucket:1,path:2},postModify:u}];for(let q=0;q<F.length;q++){const H=F[q],J=H.regex.exec(e);if(J){const I=J[H.indices.bucket];let v=J[H.indices.path];v||(v=""),s=new Ms(I,v),H.postModify(s);break}}if(s==null)throw $fe(e);return s}}class Yfe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xfe(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function c(){return a===2}let u=!1;function h(...k){u||(u=!0,e.apply(null,k))}function d(k){r=setTimeout(()=>{r=null,t(m,c())},k)}function p(){i&&clearTimeout(i)}function m(k,...O){if(u){p();return}if(k){p(),h.call(null,k,...O);return}if(c()||o){p(),h.call(null,k,...O);return}s<64&&(s*=2);let F;a===1?(a=2,F=0):F=(s+Math.random())*1e3,d(F)}let w=!1;function R(k){w||(w=!0,p(),!u&&(r!==null?(k||(a=2),clearTimeout(r),d(0)):k||(a=1)))}return d(0),i=setTimeout(()=>{o=!0,R(!0)},n),R}function Jfe(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zfe(t){return t!==void 0}function epe(t){return typeof t=="object"&&!Array.isArray(t)}function PA(t){return typeof t=="string"||t instanceof String}function wO(t){return NA()&&t instanceof Blob}function NA(){return typeof Blob<"u"}function qI(t,e,n,s){if(s<e)throw UI(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw UI(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fm(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function hj(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var Lc;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Lc||(Lc={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tpe(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class npe{constructor(e,n,s,r,i,o,a,c,u,h,d,p=!0,m=!1){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=d,this.retry=p,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,R)=>{this.resolve_=w,this.reject_=R,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Km(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Lc.NO_ERROR,c=i.getStatus();if(!a||tpe(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Lc.ABORT;s(!1,new Km(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;s(!0,new Km(u,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());Zfe(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=kA();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?uj():jfe();o(c)}else{const c=Bfe();o(c)}};this.canceled_?n(!1,new Km(!1,null,!0)):this.backoffId_=Xfe(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Jfe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Km{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function spe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function rpe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function ipe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ope(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function ape(t,e,n,s,r,i,o=!0,a=!1){const c=hj(t.urlParams),u=t.url+c,h=Object.assign({},t.headers);return ipe(h,e),spe(h,n),rpe(h,i),ope(h,s),new npe(u,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lpe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function cpe(...t){const e=lpe();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(NA())return new Blob(t);throw new un(ln.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function upe(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hpe(t){if(typeof atob>"u")throw Gfe("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class CT{constructor(e,n){this.data=e,this.contentType=n||null}}function dj(t,e){switch(t){case Hr.RAW:return new CT(fj(e));case Hr.BASE64:case Hr.BASE64URL:return new CT(pj(t,e));case Hr.DATA_URL:return new CT(fpe(e),ppe(e))}throw kA()}function fj(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=t.charCodeAt(++n);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function dpe(t){let e;try{e=decodeURIComponent(t)}catch{throw Tp(Hr.DATA_URL,"Malformed data URL.")}return fj(e)}function pj(t,e){switch(t){case Hr.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Tp(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Hr.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Tp(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=hpe(e)}catch(r){throw r.message.includes("polyfill")?r:Tp(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class gj{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Tp(Hr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=gpe(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function fpe(t){const e=new gj(t);return e.base64?pj(Hr.BASE64,e.rest):dpe(e.rest)}function ppe(t){return new gj(t).contentType}function gpe(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,n){let s=0,r="";wO(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(wO(this.data_)){const s=this.data_,r=upe(s,e,n);return r===null?null:new xa(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new xa(s,!0)}}static getBlob(...e){if(NA()){const n=e.map(s=>s instanceof xa?s.data_:s);return new xa(cpe.apply(null,n))}else{const n=e.map(o=>PA(o)?dj(Hr.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new xa(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(t){let e;try{e=JSON.parse(t)}catch{return null}return epe(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mpe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function _pe(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function mj(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ype(t,e){return e}class Cs{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||ype}}let Gm=null;function vpe(t){return!PA(t)||t.length<2?t:mj(t)}function _j(){if(Gm)return Gm;const t=[];t.push(new Cs("bucket")),t.push(new Cs("generation")),t.push(new Cs("metageneration")),t.push(new Cs("name","fullPath",!0));function e(i,o){return vpe(o)}const n=new Cs("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new Cs("size");return r.xform=s,t.push(r),t.push(new Cs("timeCreated")),t.push(new Cs("updated")),t.push(new Cs("md5Hash",null,!0)),t.push(new Cs("cacheControl",null,!0)),t.push(new Cs("contentDisposition",null,!0)),t.push(new Cs("contentEncoding",null,!0)),t.push(new Cs("contentLanguage",null,!0)),t.push(new Cs("contentType",null,!0)),t.push(new Cs("metadata","customMetadata",!0)),Gm=t,Gm}function wpe(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new Ms(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function Epe(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return wpe(s,t),s}function yj(t,e,n){const s=xA(e);return s===null?null:Epe(t,s,n)}function bpe(t,e,n,s){const r=xA(e);if(r===null||!PA(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const h=t.bucket,d=t.fullPath,p="/b/"+o(h)+"/o/"+o(d),m=fm(p,n,s),w=hj({alt:"media",token:u});return m+w})[0]}function Tpe(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO="prefixes",bO="items";function Cpe(t,e,n){const s={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[EO])for(const r of n[EO]){const i=r.replace(/\/$/,""),o=t._makeStorageReference(new Ms(e,i));s.prefixes.push(o)}if(n[bO])for(const r of n[bO]){const i=t._makeStorageReference(new Ms(e,r.name));s.items.push(i)}return s}function Ipe(t,e,n){const s=xA(n);return s===null?null:Cpe(t,e,s)}class CE{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(t){if(!t)throw kA()}function Spe(t,e){function n(s,r){const i=yj(t,r,e);return DA(i!==null),i}return n}function Rpe(t,e){function n(s,r){const i=Ipe(t,e,r);return DA(i!==null),i}return n}function Ape(t,e){function n(s,r){const i=yj(t,r,e);return DA(i!==null),bpe(i,r,t.host,t._protocol)}return n}function OA(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=Ufe():r=Ffe():n.getStatus()===402?r=Vfe(t.bucket):n.getStatus()===403?r=qfe(t.path):r=s,r.status=n.getStatus(),r.serverResponse=s.serverResponse,r}return e}function vj(t){const e=OA(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=Mfe(t.path)),i.serverResponse=r.serverResponse,i}return n}function kpe(t,e,n,s,r){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n.length>0&&(i.delimiter=n),s&&(i.pageToken=s),r&&(i.maxResults=r);const o=e.bucketOnlyServerUrl(),a=fm(o,t.host,t._protocol),c="GET",u=t.maxOperationRetryTime,h=new CE(a,c,Rpe(t,e.bucket),u);return h.urlParams=i,h.errorHandler=OA(e),h}function Ppe(t,e,n){const s=e.fullServerUrl(),r=fm(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new CE(r,i,Ape(t,n),o);return a.errorHandler=vj(e),a}function Npe(t,e){const n=e.fullServerUrl(),s=fm(n,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function o(c,u){}const a=new CE(s,r,o,i);return a.successCodes=[200,204],a.errorHandler=vj(e),a}function xpe(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Dpe(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=xpe(null,e)),s}function Ope(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let F="";for(let q=0;q<2;q++)F=F+Math.random().toString().slice(2);return F}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const u=Dpe(e,s,r),h=Tpe(u,n),d="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+c+"--",m=xa.getBlob(d,s,p);if(m===null)throw Wfe();const w={name:u.fullPath},R=fm(i,t.host,t._protocol),k="POST",O=t.maxUploadRetryTime,M=new CE(R,k,Spe(t,n),O);return M.urlParams=w,M.headers=o,M.body=m.uploadData(),M.errorHandler=OA(e),M}class Lpe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Lc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Lc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Lc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r,i){if(this.sent_)throw mf("cannot .send() more than once");if(Yi(e)&&s&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw mf("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw mf("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw mf("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw mf("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Mpe extends Lpe{initXhr(){this.xhr_.responseType="text"}}function IE(){return new Mpe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n){this._service=e,n instanceof Ms?this._location=n:this._location=Ms.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Jc(e,n)}get root(){const e=new Ms(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return mj(this._location.path)}get storage(){return this._service}get parent(){const e=mpe(this._location.path);if(e===null)return null;const n=new Ms(this._location.bucket,e);return new Jc(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Qfe(e)}}function Vpe(t,e,n){t._throwIfRoot("uploadBytes");const s=Ope(t.storage,t._location,_j(),new xa(e,!0),n);return t.storage.makeRequestWithTokens(s,IE).then(r=>({metadata:r,ref:t}))}function Fpe(t,e,n=Hr.RAW,s){t._throwIfRoot("uploadString");const r=dj(n,e),i={...s};return i.contentType==null&&r.contentType!=null&&(i.contentType=r.contentType),Vpe(t,r.data,i)}function Upe(t){const e={prefixes:[],items:[]};return wj(t,e).then(()=>e)}async function wj(t,e,n){const r=await qpe(t,{pageToken:n});e.prefixes.push(...r.prefixes),e.items.push(...r.items),r.nextPageToken!=null&&await wj(t,e,r.nextPageToken)}function qpe(t,e){e!=null&&typeof e.maxResults=="number"&&qI("options.maxResults",1,1e3,e.maxResults);const n=e||{},s=kpe(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(s,IE)}function Bpe(t){t._throwIfRoot("getDownloadURL");const e=Ppe(t.storage,t._location,_j());return t.storage.makeRequestWithTokens(e,IE).then(n=>{if(n===null)throw Kfe();return n})}function jpe(t){t._throwIfRoot("deleteObject");const e=Npe(t.storage,t._location);return t.storage.makeRequestWithTokens(e,IE)}function $pe(t,e){const n=_pe(t._location.path,e),s=new Ms(t._location.bucket,n);return new Jc(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zpe(t){return/^[A-Za-z]+:\/\//.test(t)}function Hpe(t,e){return new Jc(t,e)}function Ej(t,e){if(t instanceof LA){const n=t;if(n._bucket==null)throw Hfe();const s=new Jc(n,n._bucket);return e!=null?Ej(s,e):s}else return e!==void 0?$pe(t,e):t}function Wpe(t,e){if(e&&zpe(e)){if(t instanceof LA)return Hpe(t,e);throw UI("To use ref(service, url), the first argument must be a Storage instance.")}else return Ej(t,e)}function TO(t,e){const n=e?.[cj];return n==null?null:Ms.makeFromBucketSpec(n,t)}function Kpe(t,e,n,s={}){t.host=`${e}:${n}`;const r=Yi(e);r&&(Jw(`https://${t.host}/b`),Zw("Storage",!0)),t._isUsingEmulator=!0,t._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(t._overrideAuthToken=typeof i=="string"?i:MR(i,t.app.options.projectId))}class LA{constructor(e,n,s,r,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=lj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Ofe,this._maxUploadRetryTime=Lfe,this._requests=new Set,r!=null?this._bucket=Ms.makeFromBucketSpec(r,this._host):this._bucket=TO(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ms.makeFromBucketSpec(this._url,e):this._bucket=TO(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){qI("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){qI("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Jc(this,e)}_makeRequest(e,n,s,r,i=!0){if(this._deleted)return new Yfe(uj());{const o=ape(e,this._appId,s,r,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const CO="@firebase/storage",IO="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bj="storage";function Dve(t,e,n,s){return t=St(t),Fpe(t,e,n,s)}function Ove(t){return t=St(t),Upe(t)}function Lve(t){return t=St(t),Bpe(t)}function Mve(t){return t=St(t),jpe(t)}function Vve(t,e){return t=St(t),Wpe(t,e)}function Gpe(t=nE(),e){t=St(t);const s=rm(t,bj).getImmediate({identifier:e}),r=LR("storage");return r&&Qpe(s,...r),s}function Qpe(t,e,n,s={}){Kpe(t,e,n,s)}function Ype(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new LA(n,s,r,e,Ol)}function Xpe(){yl(new Xo(bj,Ype,"PUBLIC").setMultipleInstances(!0)),yr(CO,IO,""),yr(CO,IO,"esm2020")}Xpe();var SO={};const RO="@firebase/database",AO="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tj="";function Jpe(t){Tj=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zpe{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),An(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:fg(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ege{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return aa(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Zpe(e)}}catch{}return new ege},Ec=Cj("localStorage"),tge=Cj("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh=new tE("@firebase/database"),nge=function(){let t=1;return function(){return t++}}(),Ij=function(t){const e=hae(t),n=new aae;n.update(e);const s=n.digest();return OR.encodeByteArray(s)},pm=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=pm.apply(null,s):typeof s=="object"?e+=An(s):e+=s,e+=" "}return e};let Cp=null,kO=!0;const sge=function(t,e){he(!0,"Can't turn on custom loggers persistently."),lh.logLevel=Xe.VERBOSE,Cp=lh.log.bind(lh)},ds=function(...t){if(kO===!0&&(kO=!1,Cp===null&&tge.get("logging_enabled")===!0&&sge()),Cp){const e=pm.apply(null,t);Cp(e)}},gm=function(t){return function(...e){ds(t,...e)}},BI=function(...t){const e="FIREBASE INTERNAL ERROR: "+pm(...t);lh.error(e)},na=function(...t){const e=`FIREBASE FATAL ERROR: ${pm(...t)}`;throw lh.error(e),new Error(e)},Hs=function(...t){const e="FIREBASE WARNING: "+pm(...t);lh.warn(e)},rge=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Hs("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Sj=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},ige=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Vh="[MIN_NAME]",Zc="[MAX_NAME]",od=function(t,e){if(t===e)return 0;if(t===Vh||e===Zc)return-1;if(e===Vh||t===Zc)return 1;{const n=PO(t),s=PO(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},oge=function(t,e){return t===e?0:t<e?-1:1},_f=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+An(e))},MA=function(t){if(typeof t!="object"||t===null)return An(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=An(e[s]),n+=":",n+=MA(t[e[s]]);return n+="}",n},Rj=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let r=0;r<n;r+=e)r+e>n?s.push(t.substring(r,n)):s.push(t.substring(r,r+e));return s};function Ks(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const Aj=function(t){he(!Sj(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let r,i,o,a,c;t===0?(i=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),i=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-s-n))));const u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(r?1:0),u.reverse();const h=u.join("");let d="";for(c=0;c<64;c+=8){let p=parseInt(h.substr(c,8),2).toString(16);p.length===1&&(p="0"+p),d=d+p}return d.toLowerCase()},age=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},lge=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function cge(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const uge=new RegExp("^-?(0*)\\d{1,10}$"),hge=-2147483648,dge=2147483647,PO=function(t){if(uge.test(t)){const e=Number(t);if(e>=hge&&e<=dge)return e}return null},ad=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Hs("Exception was thrown by user callback.",n),e},Math.floor(0))}},fge=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ip=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pge{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,er(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){Hs(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gge{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ds("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Hs(e)}}class x_{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}x_.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="5",kj="v",Pj="s",Nj="r",xj="f",Dj=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Oj="ls",Lj="p",jI="ac",Mj="websocket",Vj="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e,n,s,r,i=!1,o="",a=!1,c=!1,u=null){this.secure=n,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ec.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ec.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function mge(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Uj(t,e,n){he(typeof e=="string","typeof type must == string"),he(typeof n=="object","typeof params must == object");let s;if(e===Mj)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Vj)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);mge(t)&&(n.ns=t.namespace);const r=[];return Ks(n,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ge{constructor(){this.counters_={}}incrementCounter(e,n=1){aa(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return qoe(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT={},ST={};function FA(t){const e=t.toString();return IT[e]||(IT[e]=new _ge),IT[e]}function yge(t,e){const n=t.toString();return ST[n]||(ST[n]=e()),ST[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vge{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&ad(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NO="start",wge="close",Ege="pLPCommand",bge="pRTLPCB",qj="id",Bj="pw",jj="ser",Tge="cb",Cge="seg",Ige="ts",Sge="d",Rge="dframe",$j=1870,zj=30,Age=$j-zj,kge=25e3,Pge=3e4;class Bu{constructor(e,n,s,r,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=gm(e),this.stats_=FA(n),this.urlFn=c=>(this.appCheckToken&&(c[jI]=this.appCheckToken),Uj(n,Vj,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new vge(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Pge)),ige(()=>{if(this.isClosed_)return;this.scriptTagHolder=new UA((...i)=>{const[o,a,c,u,h]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===NO)this.id=a,this.password=c;else if(o===wge)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[NO]="t",s[jj]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[Tge]=this.scriptTagHolder.uniqueCallbackIdentifier),s[kj]=VA,this.transportSessionId&&(s[Pj]=this.transportSessionId),this.lastSessionId&&(s[Oj]=this.lastSessionId),this.applicationId&&(s[Lj]=this.applicationId),this.appCheckToken&&(s[jI]=this.appCheckToken),typeof location<"u"&&location.hostname&&Dj.test(location.hostname)&&(s[Nj]=xj);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Bu.forceAllow_=!0}static forceDisallow(){Bu.forceDisallow_=!0}static isAvailable(){return Bu.forceAllow_?!0:!Bu.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!age()&&!lge()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=An(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=$9(n),r=Rj(s,Age);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[Rge]="t",s[qj]=e,s[Bj]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=An(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class UA{constructor(e,n,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=nge(),window[Ege+this.uniqueCallbackIdentifier]=e,window[bge+this.uniqueCallbackIdentifier]=n,this.myIFrame=UA.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ds("frame writing exception"),a.stack&&ds(a.stack),ds(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ds("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[qj]=this.myID,e[Bj]=this.myPW,e[jj]=this.currentSerial;let n=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+zj+s.length<=$j;){const o=this.pendingSegs.shift();s=s+"&"+Cge+r+"="+o.seg+"&"+Ige+r+"="+o.ts+"&"+Sge+r+"="+o.d,r++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(s,Math.floor(kge)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{ds("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nge=16384,xge=45e3;let hv=null;typeof MozWebSocket<"u"?hv=MozWebSocket:typeof WebSocket<"u"&&(hv=WebSocket);class Ur{constructor(e,n,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=gm(this.connId),this.stats_=FA(n),this.connURL=Ur.connectionURL_(n,o,a,r,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,r,i){const o={};return o[kj]=VA,typeof location<"u"&&location.hostname&&Dj.test(location.hostname)&&(o[Nj]=xj),n&&(o[Pj]=n),s&&(o[Oj]=s),r&&(o[jI]=r),i&&(o[Lj]=i),Uj(e,Mj,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ec.set("previous_websocket_failure",!0);try{let s;Joe(),this.mySock=new hv(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){Ur.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&hv!==null&&!Ur.forceDisallow_}static previouslyFailed(){return Ec.isInMemoryStorage||Ec.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ec.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=fg(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(he(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=An(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=Rj(n,Nge);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(xge))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ur.responsesRequiredToBeHealthy=2;Ur.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{static get ALL_TRANSPORTS(){return[Bu,Ur]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Ur&&Ur.isAvailable();let s=n&&!Ur.previouslyFailed();if(e.webSocketOnly&&(n||Hs("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Ur];else{const r=this.transports_=[];for(const i of Cg.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);Cg.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Cg.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dge=6e4,Oge=5e3,Lge=10*1024,Mge=100*1024,RT="t",xO="d",Vge="s",DO="r",Fge="e",OO="o",LO="a",MO="n",VO="p",Uge="h";class qge{constructor(e,n,s,r,i,o,a,c,u,h){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=gm("c:"+this.id+":"),this.transportManager_=new Cg(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Ip(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Mge?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Lge?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(RT in e){const n=e[RT];n===LO?this.upgradeIfSecondaryHealthy_():n===DO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===OO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=_f("t",e),s=_f("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:VO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:LO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:MO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=_f("t",e),s=_f("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=_f(RT,e);if(xO in e){const s=e[xO];if(n===Uge){const r={...s};this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===MO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Vge?this.onConnectionShutdown_(s):n===DO?this.onReset_(s):n===Fge?BI("Server Error: "+s):n===OO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):BI("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),VA!==s&&Hs("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),Ip(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Dge))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ip(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Oge))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:VO,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ec.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj{put(e,n,s,r){}merge(e,n,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wj{constructor(e){this.allowedEvents_=e,this.listeners_={},he(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const r=this.getInitialEvent(e);r&&n.apply(s,r)}off(e,n,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===n&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){he(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv extends Wj{static getInstance(){return new dv}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!VR()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return he(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO=32,UO=768;class Nt{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ft(){return new Nt("")}function Ke(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Il(t){return t.pieces_.length-t.pieceNum_}function Lt(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Nt(t.pieces_,e)}function Kj(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Bge(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Gj(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Qj(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Nt(e,0)}function Pn(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Nt)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&n.push(s[r])}return new Nt(n,0)}function Ze(t){return t.pieceNum_>=t.pieces_.length}function Vs(t,e){const n=Ke(t),s=Ke(e);if(n===null)return e;if(n===s)return Vs(Lt(t),Lt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function qA(t,e){if(Il(t)!==Il(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function Wr(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Il(t)>Il(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class jge{constructor(e,n){this.errorPrefix_=n,this.parts_=Gj(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=eE(this.parts_[s]);Yj(this)}}function $ge(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=eE(e),Yj(t)}function zge(t){const e=t.parts_.pop();t.byteLength_-=eE(e),t.parts_.length>0&&(t.byteLength_-=1)}function Yj(t){if(t.byteLength_>UO)throw new Error(t.errorPrefix_+"has a key path longer than "+UO+" bytes ("+t.byteLength_+").");if(t.parts_.length>FO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+FO+") or object contains a cycle "+hc(t))}function hc(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA extends Wj{static getInstance(){return new BA}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return he(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf=1e3,Hge=300*1e3,qO=30*1e3,Wge=1.3,Kge=3e4,Gge="server_kill",BO=3;class Uo extends Hj{constructor(e,n,s,r,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=Uo.nextPersistentConnectionId_++,this.log_=gm("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=yf,this.maxReconnectDelay_=Hge,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");BA.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&dv.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const r=++this.requestNumber_,i={r,a:e,b:n};this.log_(An(i)),he(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const n=new Xw,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),he(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),he(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,u=a.s;Uo.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&aa(e,"w")){const s=kh(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Hs(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||oae(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=qO)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=iae(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),he(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,n)}sendUnlisten_(e,n,s,r){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,r){const i={p:n,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,s,r){this.putInternal("p",e,n,s,r)}merge(e,n,s,r){this.putInternal("m",e,n,s,r)}putInternal(e,n,s,r,i){this.initConnection_();const o={p:n,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+An(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):BI("Unrecognized action received from server: "+An(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){he(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=yf,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=yf,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Kge&&(this.reconnectDelay_=yf),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Wge)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Uo.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,s())},u=function(d){he(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:c,sendRequest:u};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,p]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?ds("getToken() completed but was canceled"):(ds("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=p&&p.token,a=new qge(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,m=>{Hs(m+" ("+this.repoInfo_.toString()+")"),this.interrupt(Gge)},i))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&Hs(d),c())}}}interrupt(e){ds("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ds("Resuming connection for reason: "+e),delete this.interruptReasons_[e],hI(this.interruptReasons_)&&(this.reconnectDelay_=yf,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(i=>MA(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const s=new Nt(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(n),i.delete(n),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,n){ds("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=BO&&(this.reconnectDelay_=qO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){ds("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=BO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Tj.replace(/\./g,"-")]=1,VR()?e["framework.cordova"]=1:G9()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=dv.getInstance().currentlyOnline();return hI(this.interruptReasons_)&&e}}Uo.nextPersistentConnectionId_=0;Uo.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Qe(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new Qe(Vh,e),r=new Qe(Vh,n);return this.compare(s,r)!==0}minPost(){return Qe.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qm;class Xj extends SE{static get __EMPTY_NODE(){return Qm}static set __EMPTY_NODE(e){Qm=e}compare(e,n){return od(e.name,n.name)}isDefinedOn(e){throw Zh("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Qe.MIN}maxPost(){return new Qe(Zc,Qm)}makePost(e,n){return he(typeof e=="string","KeyIndex indexValue must always be a string."),new Qe(e,Qm)}toString(){return".key"}}const ch=new Xj;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,n,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Vn{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??Vn.RED,this.left=r??$s.EMPTY_NODE,this.right=i??$s.EMPTY_NODE}copy(e,n,s,r,i){return new Vn(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return $s.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,r;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return $s.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Vn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Vn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Vn.RED=!0;Vn.BLACK=!1;class Qge{copy(e,n,s,r,i){return this}insert(e,n,s){return new Vn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class $s{constructor(e,n=$s.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new $s(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Vn.BLACK,null,null))}remove(e){return new $s(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Vn.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,r=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ym(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Ym(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Ym(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Ym(this.root_,null,this.comparator_,!0,e)}}$s.EMPTY_NODE=new Qge;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yge(t,e){return od(t.name,e.name)}function jA(t,e){return od(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $I;function Xge(t){$I=t}const Jj=function(t){return typeof t=="number"?"number:"+Aj(t):"string:"+t},Zj=function(t){if(t.isLeafNode()){const e=t.val();he(typeof e=="string"||typeof e=="number"||typeof e=="object"&&aa(e,".sv"),"Priority must be a string or number.")}else he(t===$I||t.isEmpty(),"priority of unexpected type.");he(t===$I||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jO;class On{static set __childrenNodeConstructor(e){jO=e}static get __childrenNodeConstructor(){return jO}constructor(e,n=On.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,he(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Zj(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new On(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:On.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ze(e)?this:Ke(e)===".priority"?this.priorityNode_:On.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:On.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=Ke(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(he(s!==".priority"||Il(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,On.__childrenNodeConstructor.EMPTY_NODE.updateChild(Lt(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Jj(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=Aj(this.value_):e+=this.value_,this.lazyHash_=Ij(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===On.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof On.__childrenNodeConstructor?-1:(he(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,r=On.VALUE_TYPE_ORDER.indexOf(n),i=On.VALUE_TYPE_ORDER.indexOf(s);return he(r>=0,"Unknown leaf type: "+n),he(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}On.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e3,t3;function Jge(t){e3=t}function Zge(t){t3=t}class eme extends SE{compare(e,n){const s=e.node.getPriority(),r=n.node.getPriority(),i=s.compareTo(r);return i===0?od(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Qe.MIN}maxPost(){return new Qe(Zc,new On("[PRIORITY-POST]",t3))}makePost(e,n){const s=e3(e);return new Qe(n,new On("[PRIORITY-POST]",s))}toString(){return".priority"}}const sn=new eme;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tme=Math.log(2);class nme{constructor(e){const n=i=>parseInt(Math.log(i)/tme,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const fv=function(t,e,n,s){t.sort(e);const r=function(c,u){const h=u-c;let d,p;if(h===0)return null;if(h===1)return d=t[c],p=n?n(d):d,new Vn(p,d.node,Vn.BLACK,null,null);{const m=parseInt(h/2,10)+c,w=r(c,m),R=r(m+1,u);return d=t[m],p=n?n(d):d,new Vn(p,d.node,Vn.BLACK,w,R)}},i=function(c){let u=null,h=null,d=t.length;const p=function(w,R){const k=d-w,O=d;d-=w;const M=r(k+1,O),F=t[k],q=n?n(F):F;m(new Vn(q,F.node,R,null,M))},m=function(w){u?(u.left=w,u=w):(h=w,u=w)};for(let w=0;w<c.count;++w){const R=c.nextBitIsOne(),k=Math.pow(2,c.count-(w+1));R?p(k,Vn.BLACK):(p(k,Vn.BLACK),p(k,Vn.RED))}return h},o=new nme(t.length),a=i(o);return new $s(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AT;const wu={};class Vo{static get Default(){return he(wu&&sn,"ChildrenNode.ts has not been loaded"),AT=AT||new Vo({".priority":wu},{".priority":sn}),AT}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=kh(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof $s?n:null}hasIndex(e){return aa(this.indexSet_,e.toString())}addIndex(e,n){he(e!==ch,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=n.getIterator(Qe.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=fv(s,e.getCompare()):a=wu;const c=e.toString(),u={...this.indexSet_};u[c]=e;const h={...this.indexes_};return h[c]=a,new Vo(h,u)}addToIndexes(e,n){const s=Wy(this.indexes_,(r,i)=>{const o=kh(this.indexSet_,i);if(he(o,"Missing index implementation for "+i),r===wu)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(Qe.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),fv(a,o.getCompare())}else return wu;else{const a=n.get(e.name);let c=r;return a&&(c=c.remove(new Qe(e.name,a))),c.insert(e,e.node)}});return new Vo(s,this.indexSet_)}removeFromIndexes(e,n){const s=Wy(this.indexes_,r=>{if(r===wu)return r;{const i=n.get(e.name);return i?r.remove(new Qe(e.name,i)):r}});return new Vo(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vf;class Ae{static get EMPTY_NODE(){return vf||(vf=new Ae(new $s(jA),null,Vo.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Zj(this.priorityNode_),this.children_.isEmpty()&&he(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||vf}updatePriority(e){return this.children_.isEmpty()?this:new Ae(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?vf:n}}getChild(e){const n=Ke(e);return n===null?this:this.getImmediateChild(n).getChild(Lt(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(he(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new Qe(e,n);let r,i;n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?vf:this.priorityNode_;return new Ae(r,o,i)}}updateChild(e,n){const s=Ke(e);if(s===null)return n;{he(Ke(e)!==".priority"||Il(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(Lt(e),n);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,r=0,i=!0;if(this.forEachChild(sn,(o,a)=>{n[o]=a.val(e),s++,i&&Ae.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Jj(this.getPriority().val())+":"),this.forEachChild(sn,(n,s)=>{const r=s.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":Ij(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new Qe(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new Qe(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new Qe(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,Qe.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,Qe.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===mm?-1:0}withIndex(e){if(e===ch||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Ae(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===ch||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(sn),r=n.getIterator(sn);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===ch?null:this.indexMap_.get(e.toString())}}Ae.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class sme extends Ae{constructor(){super(new $s(jA),Ae.EMPTY_NODE,Vo.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ae.EMPTY_NODE}isEmpty(){return!1}}const mm=new sme;Object.defineProperties(Qe,{MIN:{value:new Qe(Vh,Ae.EMPTY_NODE)},MAX:{value:new Qe(Zc,mm)}});Xj.__EMPTY_NODE=Ae.EMPTY_NODE;On.__childrenNodeConstructor=Ae;Xge(mm);Zge(mm);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rme=!0;function Un(t,e=null){if(t===null)return Ae.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),he(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new On(n,Un(e))}if(!(t instanceof Array)&&rme){const n=[];let s=!1;if(Ks(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=Un(a);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),n.push(new Qe(o,c)))}}),n.length===0)return Ae.EMPTY_NODE;const i=fv(n,Yge,o=>o.name,jA);if(s){const o=fv(n,sn.getCompare());return new Ae(i,Un(e),new Vo({".priority":o},{".priority":sn}))}else return new Ae(i,Un(e),Vo.Default)}else{let n=Ae.EMPTY_NODE;return Ks(t,(s,r)=>{if(aa(t,s)&&s.substring(0,1)!=="."){const i=Un(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(s,i))}}),n.updatePriority(Un(e))}}Jge(Un);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ime extends SE{constructor(e){super(),this.indexPath_=e,he(!Ze(e)&&Ke(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),r=this.extractChild(n.node),i=s.compareTo(r);return i===0?od(e.name,n.name):i}makePost(e,n){const s=Un(e),r=Ae.EMPTY_NODE.updateChild(this.indexPath_,s);return new Qe(n,r)}maxPost(){const e=Ae.EMPTY_NODE.updateChild(this.indexPath_,mm);return new Qe(Zc,e)}toString(){return Gj(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ome extends SE{compare(e,n){const s=e.node.compareTo(n.node);return s===0?od(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Qe.MIN}maxPost(){return Qe.MAX}makePost(e,n){const s=Un(e);return new Qe(n,s)}toString(){return".value"}}const ame=new ome;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n3(t){return{type:"value",snapshotNode:t}}function Fh(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ig(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Sg(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function lme(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e){this.index_=e}updateChild(e,n,s,r,i,o){he(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(r).equals(s.getChild(r))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Ig(n,a)):he(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Fh(n,s)):o.trackChildChange(Sg(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(sn,(r,i)=>{n.hasChild(r)||s.trackChildChange(Ig(r,i))}),n.isLeafNode()||n.forEachChild(sn,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(Sg(r,i,o))}else s.trackChildChange(Fh(r,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Ae.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e){this.indexedFilter_=new $A(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Rg.getStartPost_(e),this.endPost_=Rg.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,r,i,o){return this.matches(new Qe(n,s))||(s=Ae.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,r,i,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=Ae.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(Ae.EMPTY_NODE);const i=this;return n.forEachChild(sn,(o,a)=>{i.matches(new Qe(o,a))||(r=r.updateImmediateChild(o,Ae.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cme{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Rg(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,r,i,o){return this.rangedFilter_.matches(new Qe(n,s))||(s=Ae.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,r,i,o):this.fullLimitUpdateChild_(e,n,s,i,o)}updateFullNode(e,n,s){let r;if(n.isLeafNode()||n.isEmpty())r=Ae.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=Ae.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(Ae.EMPTY_NODE);let i;this.reverse_?i=r.getReverseIterator(this.index_):i=r.getIterator(this.index_);let o=0;for(;i.hasNext();){const a=i.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,Ae.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,r,i){let o;if(this.reverse_){const d=this.index_.getCompare();o=(p,m)=>d(m,p)}else o=this.index_.getCompare();const a=e;he(a.numChildren()===this.limit_,"");const c=new Qe(n,s),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(a.hasChild(n)){const d=a.getImmediateChild(n);let p=r.getChildAfterChild(this.index_,u,this.reverse_);for(;p!=null&&(p.name===n||a.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);const m=p==null?1:o(p,c);if(h&&!s.isEmpty()&&m>=0)return i?.trackChildChange(Sg(n,s,d)),a.updateImmediateChild(n,s);{i?.trackChildChange(Ig(n,d));const R=a.updateImmediateChild(n,Ae.EMPTY_NODE);return p!=null&&this.rangedFilter_.matches(p)?(i?.trackChildChange(Fh(p.name,p.node)),R.updateImmediateChild(p.name,p.node)):R}}else return s.isEmpty()?e:h&&o(u,c)>=0?(i!=null&&(i.trackChildChange(Ig(u.name,u.node)),i.trackChildChange(Fh(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(u.name,Ae.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=sn}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return he(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return he(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Vh}hasEnd(){return this.endSet_}getIndexEndValue(){return he(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return he(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zc}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return he(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===sn}copy(){const e=new zA;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function ume(t){return t.loadsAllData()?new $A(t.getIndex()):t.hasLimit()?new cme(t):new Rg(t)}function $O(t){const e={};if(t.isDefault())return e;let n;if(t.index_===sn?n="$priority":t.index_===ame?n="$value":t.index_===ch?n="$key":(he(t.index_ instanceof ime,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=An(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=An(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+An(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=An(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+An(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function zO(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==sn&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv extends Hj{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(he(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=gm("p:rest:"),this.listens_={}}listen(e,n,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=pv.getListenId_(e,s),a={};this.listens_[o]=a;const c=$O(e._queryParams);this.restRequest_(i+".json",c,(u,h)=>{let d=h;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(i,d,!1,s),kh(this.listens_,o)===a){let p;u?u===401?p="permission_denied":p="rest_error:"+u:p="ok",r(p,null)}})}unlisten(e,n){const s=pv.getListenId_(e,n);delete this.listens_[s]}get(e){const n=$O(e._queryParams),s=e._path.toString(),r=new Xw;return this.restRequest_(s+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(n.auth=r.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ed(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=fg(a.responseText)}catch{Hs("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,c)}else a.status!==401&&a.status!==404&&Hs("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hme{constructor(){this.rootNode_=Ae.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(){return{value:null,children:new Map}}function s3(t,e,n){if(Ze(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=Ke(e);t.children.has(s)||t.children.set(s,gv());const r=t.children.get(s);e=Lt(e),s3(r,e,n)}}function zI(t,e,n){t.value!==null?n(e,t.value):dme(t,(s,r)=>{const i=new Nt(e.toString()+"/"+s);zI(r,i,n)})}function dme(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fme{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&Ks(this.last_,(s,r)=>{n[s]=n[s]-r}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HO=10*1e3,pme=30*1e3,gme=300*1e3;class mme{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new fme(e);const s=HO+(pme-HO)*Math.random();Ip(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Ks(e,(r,i)=>{i>0&&aa(this.statsToReport_,r)&&(n[r]=i,s=!0)}),s&&this.server_.reportStats(n),Ip(this.reportStats_.bind(this),Math.floor(Math.random()*2*gme))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kr;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Kr||(Kr={}));function r3(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function HA(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function WA(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=Kr.ACK_USER_WRITE,this.source=r3()}operationForChild(e){if(Ze(this.path)){if(this.affectedTree.value!=null)return he(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Nt(e));return new mv(ft(),n,this.revert)}}else return he(Ke(this.path)===e,"operationForChild called for unrelated child."),new mv(Lt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,n){this.source=e,this.path=n,this.type=Kr.LISTEN_COMPLETE}operationForChild(e){return Ze(this.path)?new Ag(this.source,ft()):new Ag(this.source,Lt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=Kr.OVERWRITE}operationForChild(e){return Ze(this.path)?new eu(this.source,ft(),this.snap.getImmediateChild(e)):new eu(this.source,Lt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=Kr.MERGE}operationForChild(e){if(Ze(this.path)){const n=this.children.subtree(new Nt(e));return n.isEmpty()?null:n.value?new eu(this.source,ft(),n.value):new kg(this.source,ft(),n)}else return he(Ke(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new kg(this.source,Lt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ze(e))return this.isFullyInitialized()&&!this.filtered_;const n=Ke(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _me{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function yme(t,e,n,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(lme(o.childName,o.snapshotNode))}),wf(t,r,"child_removed",e,s,n),wf(t,r,"child_added",e,s,n),wf(t,r,"child_moved",i,s,n),wf(t,r,"child_changed",e,s,n),wf(t,r,"value",e,s,n),r}function wf(t,e,n,s,r,i){const o=s.filter(a=>a.type===n);o.sort((a,c)=>wme(t,a,c)),o.forEach(a=>{const c=vme(t,a,i);r.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,t.query_))})})}function vme(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function wme(t,e,n){if(e.childName==null||n.childName==null)throw Zh("Should only compare child_ events.");const s=new Qe(e.childName,e.snapshotNode),r=new Qe(n.childName,n.snapshotNode);return t.index_.compare(s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(t,e){return{eventCache:t,serverCache:e}}function Sp(t,e,n,s){return RE(new Sl(e,n,s),t.serverCache)}function i3(t,e,n,s){return RE(t.eventCache,new Sl(e,n,s))}function _v(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function tu(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kT;const Eme=()=>(kT||(kT=new $s(oge)),kT);class qt{static fromObject(e){let n=new qt(null);return Ks(e,(s,r)=>{n=n.set(new Nt(s),r)}),n}constructor(e,n=Eme()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ft(),value:this.value};if(Ze(e))return null;{const s=Ke(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(Lt(e),n);return i!=null?{path:Pn(new Nt(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ze(e))return this;{const n=Ke(e),s=this.children.get(n);return s!==null?s.subtree(Lt(e)):new qt(null)}}set(e,n){if(Ze(e))return new qt(n,this.children);{const s=Ke(e),i=(this.children.get(s)||new qt(null)).set(Lt(e),n),o=this.children.insert(s,i);return new qt(this.value,o)}}remove(e){if(Ze(e))return this.children.isEmpty()?new qt(null):new qt(null,this.children);{const n=Ke(e),s=this.children.get(n);if(s){const r=s.remove(Lt(e));let i;return r.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,r),this.value===null&&i.isEmpty()?new qt(null):new qt(this.value,i)}else return this}}get(e){if(Ze(e))return this.value;{const n=Ke(e),s=this.children.get(n);return s?s.get(Lt(e)):null}}setTree(e,n){if(Ze(e))return n;{const s=Ke(e),i=(this.children.get(s)||new qt(null)).setTree(Lt(e),n);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new qt(this.value,o)}}fold(e){return this.fold_(ft(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(Pn(e,r),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,ft(),n)}findOnPath_(e,n,s){const r=this.value?s(n,this.value):!1;if(r)return r;if(Ze(e))return null;{const i=Ke(e),o=this.children.get(i);return o?o.findOnPath_(Lt(e),Pn(n,i),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ft(),n)}foreachOnPath_(e,n,s){if(Ze(e))return this;{this.value&&s(n,this.value);const r=Ke(e),i=this.children.get(r);return i?i.foreachOnPath_(Lt(e),Pn(n,r),s):new qt(null)}}foreach(e){this.foreach_(ft(),e)}foreach_(e,n){this.children.inorderTraversal((s,r)=>{r.foreach_(Pn(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e){this.writeTree_=e}static empty(){return new ii(new qt(null))}}function Rp(t,e,n){if(Ze(e))return new ii(new qt(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=Vs(r,e);return i=i.updateChild(o,n),new ii(t.writeTree_.set(r,i))}else{const r=new qt(n),i=t.writeTree_.setTree(e,r);return new ii(i)}}}function WO(t,e,n){let s=t;return Ks(n,(r,i)=>{s=Rp(s,Pn(e,r),i)}),s}function KO(t,e){if(Ze(e))return ii.empty();{const n=t.writeTree_.setTree(e,new qt(null));return new ii(n)}}function HI(t,e){return hu(t,e)!=null}function hu(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Vs(n.path,e)):null}function GO(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(sn,(s,r)=>{e.push(new Qe(s,r))}):t.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new Qe(s,r.value))}),e}function Ya(t,e){if(Ze(e))return t;{const n=hu(t,e);return n!=null?new ii(new qt(n)):new ii(t.writeTree_.subtree(e))}}function WI(t){return t.writeTree_.isEmpty()}function Uh(t,e){return o3(ft(),t.writeTree_,e)}function o3(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(he(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):n=o3(Pn(t,r),i,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Pn(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AE(t,e){return u3(e,t)}function bme(t,e,n,s,r){he(s>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:r}),r&&(t.visibleWrites=Rp(t.visibleWrites,e,n)),t.lastWriteId=s}function Tme(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function Cme(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);he(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let r=s.visible,i=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&Ime(a,s.path)?r=!1:Wr(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return Sme(t),!0;if(s.snap)t.visibleWrites=KO(t.visibleWrites,s.path);else{const a=s.children;Ks(a,c=>{t.visibleWrites=KO(t.visibleWrites,Pn(s.path,c))})}return!0}else return!1}function Ime(t,e){if(t.snap)return Wr(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Wr(Pn(t.path,n),e))return!0;return!1}function Sme(t){t.visibleWrites=a3(t.allWrites,Rme,ft()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function Rme(t){return t.visible}function a3(t,e,n){let s=ii.empty();for(let r=0;r<t.length;++r){const i=t[r];if(e(i)){const o=i.path;let a;if(i.snap)Wr(n,o)?(a=Vs(n,o),s=Rp(s,a,i.snap)):Wr(o,n)&&(a=Vs(o,n),s=Rp(s,ft(),i.snap.getChild(a)));else if(i.children){if(Wr(n,o))a=Vs(n,o),s=WO(s,a,i.children);else if(Wr(o,n))if(a=Vs(o,n),Ze(a))s=WO(s,ft(),i.children);else{const c=kh(i.children,Ke(a));if(c){const u=c.getChild(Lt(a));s=Rp(s,ft(),u)}}}else throw Zh("WriteRecord should have .snap or .children")}}return s}function l3(t,e,n,s,r){if(!s&&!r){const i=hu(t.visibleWrites,e);if(i!=null)return i;{const o=Ya(t.visibleWrites,e);if(WI(o))return n;if(n==null&&!HI(o,ft()))return null;{const a=n||Ae.EMPTY_NODE;return Uh(o,a)}}}else{const i=Ya(t.visibleWrites,e);if(!r&&WI(i))return n;if(!r&&n==null&&!HI(i,ft()))return null;{const o=function(u){return(u.visible||r)&&(!s||!~s.indexOf(u.writeId))&&(Wr(u.path,e)||Wr(e,u.path))},a=a3(t.allWrites,o,e),c=n||Ae.EMPTY_NODE;return Uh(a,c)}}}function Ame(t,e,n){let s=Ae.EMPTY_NODE;const r=hu(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(sn,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(n){const i=Ya(t.visibleWrites,e);return n.forEachChild(sn,(o,a)=>{const c=Uh(Ya(i,new Nt(o)),a);s=s.updateImmediateChild(o,c)}),GO(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=Ya(t.visibleWrites,e);return GO(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function kme(t,e,n,s,r){he(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=Pn(e,n);if(HI(t.visibleWrites,i))return null;{const o=Ya(t.visibleWrites,i);return WI(o)?r.getChild(n):Uh(o,r.getChild(n))}}function Pme(t,e,n,s){const r=Pn(e,n),i=hu(t.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(n)){const o=Ya(t.visibleWrites,r);return Uh(o,s.getNode().getImmediateChild(n))}else return null}function Nme(t,e){return hu(t.visibleWrites,e)}function xme(t,e,n,s,r,i,o){let a;const c=Ya(t.visibleWrites,e),u=hu(c,ft());if(u!=null)a=u;else if(n!=null)a=Uh(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],d=o.getCompare(),p=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let m=p.getNext();for(;m&&h.length<r;)d(m,s)!==0&&h.push(m),m=p.getNext();return h}else return[]}function Dme(){return{visibleWrites:ii.empty(),allWrites:[],lastWriteId:-1}}function yv(t,e,n,s){return l3(t.writeTree,t.treePath,e,n,s)}function KA(t,e){return Ame(t.writeTree,t.treePath,e)}function QO(t,e,n,s){return kme(t.writeTree,t.treePath,e,n,s)}function vv(t,e){return Nme(t.writeTree,Pn(t.treePath,e))}function Ome(t,e,n,s,r,i){return xme(t.writeTree,t.treePath,e,n,s,r,i)}function GA(t,e,n){return Pme(t.writeTree,t.treePath,e,n)}function c3(t,e){return u3(Pn(t.treePath,e),t.writeTree)}function u3(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lme{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;he(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),he(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(s,Sg(s,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(s,Ig(s,r.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(s,Fh(s,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(s,Sg(s,e.snapshotNode,r.oldSnap));else throw Zh("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mme{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const h3=new Mme;class QA{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Sl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return GA(this.writes_,e,s)}}getChildAfterChild(e,n,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:tu(this.viewCache_),i=Ome(this.writes_,r,n,1,s,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vme(t){return{filter:t}}function Fme(t,e){he(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),he(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Ume(t,e,n,s,r){const i=new Lme;let o,a;if(n.type===Kr.OVERWRITE){const u=n;u.source.fromUser?o=KI(t,e,u.path,u.snap,s,r,i):(he(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Ze(u.path),o=wv(t,e,u.path,u.snap,s,r,a,i))}else if(n.type===Kr.MERGE){const u=n;u.source.fromUser?o=Bme(t,e,u.path,u.children,s,r,i):(he(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=GI(t,e,u.path,u.children,s,r,a,i))}else if(n.type===Kr.ACK_USER_WRITE){const u=n;u.revert?o=zme(t,e,u.path,s,r,i):o=jme(t,e,u.path,u.affectedTree,s,r,i)}else if(n.type===Kr.LISTEN_COMPLETE)o=$me(t,e,n.path,s,i);else throw Zh("Unknown operation type: "+n.type);const c=i.getChanges();return qme(e,o,c),{viewCache:o,changes:c}}function qme(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=_v(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&n.push(n3(_v(e)))}}function d3(t,e,n,s,r,i){const o=e.eventCache;if(vv(s,n)!=null)return e;{let a,c;if(Ze(n))if(he(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=tu(e),h=u instanceof Ae?u:Ae.EMPTY_NODE,d=KA(s,h);a=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const u=yv(s,tu(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const u=Ke(n);if(u===".priority"){he(Il(n)===1,"Can't have a priority with additional path components");const h=o.getNode();c=e.serverCache.getNode();const d=QO(s,n,h,c);d!=null?a=t.filter.updatePriority(h,d):a=o.getNode()}else{const h=Lt(n);let d;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();const p=QO(s,n,o.getNode(),c);p!=null?d=o.getNode().getImmediateChild(u).updateChild(h,p):d=o.getNode().getImmediateChild(u)}else d=GA(s,u,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),u,d,h,r,i):a=o.getNode()}}return Sp(e,a,o.isFullyInitialized()||Ze(n),t.filter.filtersNodes())}}function wv(t,e,n,s,r,i,o,a){const c=e.serverCache;let u;const h=o?t.filter:t.filter.getIndexedFilter();if(Ze(n))u=h.updateFullNode(c.getNode(),s,null);else if(h.filtersNodes()&&!c.isFiltered()){const m=c.getNode().updateChild(n,s);u=h.updateFullNode(c.getNode(),m,null)}else{const m=Ke(n);if(!c.isCompleteForPath(n)&&Il(n)>1)return e;const w=Lt(n),k=c.getNode().getImmediateChild(m).updateChild(w,s);m===".priority"?u=h.updatePriority(c.getNode(),k):u=h.updateChild(c.getNode(),m,k,w,h3,null)}const d=i3(e,u,c.isFullyInitialized()||Ze(n),h.filtersNodes()),p=new QA(r,d,i);return d3(t,d,n,r,p,a)}function KI(t,e,n,s,r,i,o){const a=e.eventCache;let c,u;const h=new QA(r,e,i);if(Ze(n))u=t.filter.updateFullNode(e.eventCache.getNode(),s,o),c=Sp(e,u,!0,t.filter.filtersNodes());else{const d=Ke(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),s),c=Sp(e,u,a.isFullyInitialized(),a.isFiltered());else{const p=Lt(n),m=a.getNode().getImmediateChild(d);let w;if(Ze(p))w=s;else{const R=h.getCompleteChild(d);R!=null?Kj(p)===".priority"&&R.getChild(Qj(p)).isEmpty()?w=R:w=R.updateChild(p,s):w=Ae.EMPTY_NODE}if(m.equals(w))c=e;else{const R=t.filter.updateChild(a.getNode(),d,w,p,h,o);c=Sp(e,R,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function YO(t,e){return t.eventCache.isCompleteForChild(e)}function Bme(t,e,n,s,r,i,o){let a=e;return s.foreach((c,u)=>{const h=Pn(n,c);YO(e,Ke(h))&&(a=KI(t,a,h,u,r,i,o))}),s.foreach((c,u)=>{const h=Pn(n,c);YO(e,Ke(h))||(a=KI(t,a,h,u,r,i,o))}),a}function XO(t,e,n){return n.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function GI(t,e,n,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;Ze(n)?u=s:u=new qt(null).setTree(n,s);const h=e.serverCache.getNode();return u.children.inorderTraversal((d,p)=>{if(h.hasChild(d)){const m=e.serverCache.getNode().getImmediateChild(d),w=XO(t,m,p);c=wv(t,c,new Nt(d),w,r,i,o,a)}}),u.children.inorderTraversal((d,p)=>{const m=!e.serverCache.isCompleteForChild(d)&&p.value===null;if(!h.hasChild(d)&&!m){const w=e.serverCache.getNode().getImmediateChild(d),R=XO(t,w,p);c=wv(t,c,new Nt(d),R,r,i,o,a)}}),c}function jme(t,e,n,s,r,i,o){if(vv(r,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(Ze(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return wv(t,e,n,c.getNode().getChild(n),r,i,a,o);if(Ze(n)){let u=new qt(null);return c.getNode().forEachChild(ch,(h,d)=>{u=u.set(new Nt(h),d)}),GI(t,e,n,u,r,i,a,o)}else return e}else{let u=new qt(null);return s.foreach((h,d)=>{const p=Pn(n,h);c.isCompleteForPath(p)&&(u=u.set(h,c.getNode().getChild(p)))}),GI(t,e,n,u,r,i,a,o)}}function $me(t,e,n,s,r){const i=e.serverCache,o=i3(e,i.getNode(),i.isFullyInitialized()||Ze(n),i.isFiltered());return d3(t,o,n,s,h3,r)}function zme(t,e,n,s,r,i){let o;if(vv(s,n)!=null)return e;{const a=new QA(s,e,r),c=e.eventCache.getNode();let u;if(Ze(n)||Ke(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=yv(s,tu(e));else{const d=e.serverCache.getNode();he(d instanceof Ae,"serverChildren would be complete if leaf node"),h=KA(s,d)}h=h,u=t.filter.updateFullNode(c,h,i)}else{const h=Ke(n);let d=GA(s,h,e.serverCache);d==null&&e.serverCache.isCompleteForChild(h)&&(d=c.getImmediateChild(h)),d!=null?u=t.filter.updateChild(c,h,d,Lt(n),a,i):e.eventCache.getNode().hasChild(h)?u=t.filter.updateChild(c,h,Ae.EMPTY_NODE,Lt(n),a,i):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=yv(s,tu(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,i)))}return o=e.serverCache.isFullyInitialized()||vv(s,ft())!=null,Sp(e,u,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hme{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new $A(s.getIndex()),i=ume(s);this.processor_=Vme(i);const o=n.serverCache,a=n.eventCache,c=r.updateFullNode(Ae.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Ae.EMPTY_NODE,a.getNode(),null),h=new Sl(c,o.isFullyInitialized(),r.filtersNodes()),d=new Sl(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=RE(d,h),this.eventGenerator_=new _me(this.query_)}get query(){return this.query_}}function Wme(t){return t.viewCache_.serverCache.getNode()}function Kme(t){return _v(t.viewCache_)}function Gme(t,e){const n=tu(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Ze(e)&&!n.getImmediateChild(Ke(e)).isEmpty())?n.getChild(e):null}function JO(t){return t.eventRegistrations_.length===0}function Qme(t,e){t.eventRegistrations_.push(e)}function ZO(t,e,n){const s=[];if(n){he(e==null,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return s}function eL(t,e,n,s){e.type===Kr.MERGE&&e.source.queryId!==null&&(he(tu(t.viewCache_),"We should always have a full cache before handling merges"),he(_v(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,i=Ume(t.processor_,r,e,n,s);return Fme(t.processor_,i.viewCache),he(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,f3(t,i.changes,i.viewCache.eventCache.getNode(),null)}function Yme(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(sn,(i,o)=>{s.push(Fh(i,o))}),n.isFullyInitialized()&&s.push(n3(n.getNode())),f3(t,s,n.getNode(),e)}function f3(t,e,n,s){const r=s?[s]:t.eventRegistrations_;return yme(t.eventGenerator_,e,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ev;class p3{constructor(){this.views=new Map}}function Xme(t){he(!Ev,"__referenceConstructor has already been defined"),Ev=t}function Jme(){return he(Ev,"Reference.ts has not been loaded"),Ev}function Zme(t){return t.views.size===0}function YA(t,e,n,s){const r=e.source.queryId;if(r!==null){const i=t.views.get(r);return he(i!=null,"SyncTree gave us an op for an invalid query."),eL(i,e,n,s)}else{let i=[];for(const o of t.views.values())i=i.concat(eL(o,e,n,s));return i}}function g3(t,e,n,s,r){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=yv(n,r?s:null),c=!1;a?c=!0:s instanceof Ae?(a=KA(n,s),c=!1):(a=Ae.EMPTY_NODE,c=!1);const u=RE(new Sl(a,c,!1),new Sl(s,r,!1));return new Hme(e,u)}return o}function e_e(t,e,n,s,r,i){const o=g3(t,e,s,r,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Qme(o,n),Yme(o,n)}function t_e(t,e,n,s){const r=e._queryIdentifier,i=[];let o=[];const a=Rl(t);if(r==="default")for(const[c,u]of t.views.entries())o=o.concat(ZO(u,n,s)),JO(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||i.push(u.query));else{const c=t.views.get(r);c&&(o=o.concat(ZO(c,n,s)),JO(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!Rl(t)&&i.push(new(Jme())(e._repo,e._path)),{removed:i,events:o}}function m3(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Xa(t,e){let n=null;for(const s of t.views.values())n=n||Gme(s,e);return n}function _3(t,e){if(e._queryParams.loadsAllData())return kE(t);{const s=e._queryIdentifier;return t.views.get(s)}}function y3(t,e){return _3(t,e)!=null}function Rl(t){return kE(t)!=null}function kE(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bv;function n_e(t){he(!bv,"__referenceConstructor has already been defined"),bv=t}function s_e(){return he(bv,"Reference.ts has not been loaded"),bv}let r_e=1;class tL{constructor(e){this.listenProvider_=e,this.syncPointTree_=new qt(null),this.pendingWriteTree_=Dme(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function v3(t,e,n,s,r){return bme(t.pendingWriteTree_,e,n,s,r),r?ym(t,new eu(r3(),e,n)):[]}function bc(t,e,n=!1){const s=Tme(t.pendingWriteTree_,e);if(Cme(t.pendingWriteTree_,e)){let i=new qt(null);return s.snap!=null?i=i.set(ft(),!0):Ks(s.children,o=>{i=i.set(new Nt(o),!0)}),ym(t,new mv(s.path,i,n))}else return[]}function _m(t,e,n){return ym(t,new eu(HA(),e,n))}function i_e(t,e,n){const s=qt.fromObject(n);return ym(t,new kg(HA(),e,s))}function o_e(t,e){return ym(t,new Ag(HA(),e))}function a_e(t,e,n){const s=JA(t,n);if(s){const r=ZA(s),i=r.path,o=r.queryId,a=Vs(i,e),c=new Ag(WA(o),a);return ek(t,i,c)}else return[]}function Tv(t,e,n,s,r=!1){const i=e._path,o=t.syncPointTree_.get(i);let a=[];if(o&&(e._queryIdentifier==="default"||y3(o,e))){const c=t_e(o,e,n,s);Zme(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const u=c.removed;if(a=c.events,!r){const h=u.findIndex(p=>p._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(i,(p,m)=>Rl(m));if(h&&!d){const p=t.syncPointTree_.subtree(i);if(!p.isEmpty()){const m=u_e(p);for(let w=0;w<m.length;++w){const R=m[w],k=R.query,O=T3(t,R);t.listenProvider_.startListening(Ap(k),Pg(t,k),O.hashFn,O.onComplete)}}}!d&&u.length>0&&!s&&(h?t.listenProvider_.stopListening(Ap(e),null):u.forEach(p=>{const m=t.queryToTagMap.get(PE(p));t.listenProvider_.stopListening(Ap(p),m)}))}h_e(t,u)}return a}function w3(t,e,n,s){const r=JA(t,s);if(r!=null){const i=ZA(r),o=i.path,a=i.queryId,c=Vs(o,e),u=new eu(WA(a),c,n);return ek(t,o,u)}else return[]}function l_e(t,e,n,s){const r=JA(t,s);if(r){const i=ZA(r),o=i.path,a=i.queryId,c=Vs(o,e),u=qt.fromObject(n),h=new kg(WA(a),c,u);return ek(t,o,h)}else return[]}function QI(t,e,n,s=!1){const r=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(r,(p,m)=>{const w=Vs(p,r);i=i||Xa(m,w),o=o||Rl(m)});let a=t.syncPointTree_.get(r);a?(o=o||Rl(a),i=i||Xa(a,ft())):(a=new p3,t.syncPointTree_=t.syncPointTree_.set(r,a));let c;i!=null?c=!0:(c=!1,i=Ae.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((m,w)=>{const R=Xa(w,ft());R&&(i=i.updateImmediateChild(m,R))}));const u=y3(a,e);if(!u&&!e._queryParams.loadsAllData()){const p=PE(e);he(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");const m=d_e();t.queryToTagMap.set(p,m),t.tagToQueryMap.set(m,p)}const h=AE(t.pendingWriteTree_,r);let d=e_e(a,e,n,h,i,c);if(!u&&!o&&!s){const p=_3(a,e);d=d.concat(f_e(t,e,p))}return d}function XA(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=Vs(o,e),u=Xa(a,c);if(u)return u});return l3(r,e,i,n,!0)}function c_e(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(u,h)=>{const d=Vs(u,n);s=s||Xa(h,d)});let r=t.syncPointTree_.get(n);r?s=s||Xa(r,ft()):(r=new p3,t.syncPointTree_=t.syncPointTree_.set(n,r));const i=s!=null,o=i?new Sl(s,!0,!1):null,a=AE(t.pendingWriteTree_,e._path),c=g3(r,e,a,i?o.getNode():Ae.EMPTY_NODE,i);return Kme(c)}function ym(t,e){return E3(e,t.syncPointTree_,null,AE(t.pendingWriteTree_,ft()))}function E3(t,e,n,s){if(Ze(t.path))return b3(t,e,n,s);{const r=e.get(ft());n==null&&r!=null&&(n=Xa(r,ft()));let i=[];const o=Ke(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const u=n?n.getImmediateChild(o):null,h=c3(s,o);i=i.concat(E3(a,c,u,h))}return r&&(i=i.concat(YA(r,t,s,n))),i}}function b3(t,e,n,s){const r=e.get(ft());n==null&&r!=null&&(n=Xa(r,ft()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,u=c3(s,o),h=t.operationForChild(o);h&&(i=i.concat(b3(h,a,c,u)))}),r&&(i=i.concat(YA(r,t,s,n))),i}function T3(t,e){const n=e.query,s=Pg(t,n);return{hashFn:()=>(Wme(e)||Ae.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?a_e(t,n._path,s):o_e(t,n._path);{const i=cge(r,n);return Tv(t,n,null,i)}}}}function Pg(t,e){const n=PE(e);return t.queryToTagMap.get(n)}function PE(t){return t._path.toString()+"$"+t._queryIdentifier}function JA(t,e){return t.tagToQueryMap.get(e)}function ZA(t){const e=t.indexOf("$");return he(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Nt(t.substr(0,e))}}function ek(t,e,n){const s=t.syncPointTree_.get(e);he(s,"Missing sync point for query tag that we're tracking");const r=AE(t.pendingWriteTree_,e);return YA(s,n,r,null)}function u_e(t){return t.fold((e,n,s)=>{if(n&&Rl(n))return[kE(n)];{let r=[];return n&&(r=m3(n)),Ks(s,(i,o)=>{r=r.concat(o)}),r}})}function Ap(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(s_e())(t._repo,t._path):t}function h_e(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const r=PE(s),i=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(i)}}}function d_e(){return r_e++}function f_e(t,e,n){const s=e._path,r=Pg(t,e),i=T3(t,n),o=t.listenProvider_.startListening(Ap(e),r,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(s);if(r)he(!Rl(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((u,h,d)=>{if(!Ze(u)&&h&&Rl(h))return[kE(h).query];{let p=[];return h&&(p=p.concat(m3(h).map(m=>m.query))),Ks(d,(m,w)=>{p=p.concat(w)}),p}});for(let u=0;u<c.length;++u){const h=c[u];t.listenProvider_.stopListening(Ap(h),Pg(t,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new tk(n)}node(){return this.node_}}class nk{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Pn(this.path_,e);return new nk(this.syncTree_,n)}node(){return XA(this.syncTree_,this.path_)}}const p_e=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},nL=function(t,e,n){if(!t||typeof t!="object")return t;if(he(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return g_e(t[".sv"],e,n);if(typeof t[".sv"]=="object")return m_e(t[".sv"],e);he(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},g_e=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:he(!1,"Unexpected server value: "+t)}},m_e=function(t,e,n){t.hasOwnProperty("increment")||he(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&he(!1,"Unexpected increment value: "+s);const r=e.node();if(he(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},__e=function(t,e,n,s){return sk(e,new nk(n,t),s)},C3=function(t,e,n){return sk(t,new tk(e),n)};function sk(t,e,n){const s=t.getPriority().val(),r=nL(s,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=nL(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new On(a,Un(r)):t}else{const o=t;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new On(r))),o.forEachChild(sn,(a,c)=>{const u=sk(c,e.getImmediateChild(a),n);u!==c&&(i=i.updateImmediateChild(a,u))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function ik(t,e){let n=e instanceof Nt?e:new Nt(e),s=t,r=Ke(n);for(;r!==null;){const i=kh(s.node.children,r)||{children:{},childCount:0};s=new rk(r,s,i),n=Lt(n),r=Ke(n)}return s}function ld(t){return t.node.value}function I3(t,e){t.node.value=e,YI(t)}function S3(t){return t.node.childCount>0}function y_e(t){return ld(t)===void 0&&!S3(t)}function NE(t,e){Ks(t.node.children,(n,s)=>{e(new rk(n,t,s))})}function R3(t,e,n,s){n&&e(t),NE(t,r=>{R3(r,e,!0)})}function v_e(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function vm(t){return new Nt(t.parent===null?t.name:vm(t.parent)+"/"+t.name)}function YI(t){t.parent!==null&&w_e(t.parent,t.name,t)}function w_e(t,e,n){const s=y_e(n),r=aa(t.node.children,e);s&&r?(delete t.node.children[e],t.node.childCount--,YI(t)):!s&&!r&&(t.node.children[e]=n.node,t.node.childCount++,YI(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_e=/[\[\].#$\/\u0000-\u001F\u007F]/,b_e=/[\[\].#$\u0000-\u001F\u007F]/,PT=10*1024*1024,A3=function(t){return typeof t=="string"&&t.length!==0&&!E_e.test(t)},k3=function(t){return typeof t=="string"&&t.length!==0&&!b_e.test(t)},T_e=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),k3(t)},C_e=function(t,e,n,s){ok(FR(t,"value"),e,n)},ok=function(t,e,n){const s=n instanceof Nt?new jge(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+hc(s));if(typeof e=="function")throw new Error(t+"contains a function "+hc(s)+" with contents = "+e.toString());if(Sj(e))throw new Error(t+"contains "+e.toString()+" "+hc(s));if(typeof e=="string"&&e.length>PT/3&&eE(e)>PT)throw new Error(t+"contains a string greater than "+PT+" utf8 bytes "+hc(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(Ks(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!A3(o)))throw new Error(t+" contains an invalid key ("+o+") "+hc(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);$ge(s,o),ok(t,a,s),zge(s)}),r&&i)throw new Error(t+' contains ".value" child '+hc(s)+" in addition to actual children.")}},P3=function(t,e,n,s){if(!k3(n))throw new Error(FR(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},I_e=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),P3(t,e,n)},N3=function(t,e){if(Ke(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},S_e=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!A3(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!T_e(n))throw new Error(FR(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_e{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ak(t,e){let n=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();n!==null&&!qA(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(r)}n&&t.eventLists_.push(n)}function x3(t,e,n){ak(t,n),D3(t,s=>qA(s,e))}function Ki(t,e,n){ak(t,n),D3(t,s=>Wr(s,e)||Wr(e,s))}function D3(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const r=t.eventLists_[s];if(r){const i=r.path;e(i)?(A_e(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function A_e(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();Cp&&ds("event: "+n.toString()),ad(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_e="repo_interrupt",P_e=25;class N_e{constructor(e,n,s,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new R_e,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=gv(),this.transactionQueueTree_=new rk,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function x_e(t,e,n){if(t.stats_=FA(t.repoInfo_),t.forceRestClient_||fge())t.server_=new pv(t.repoInfo_,(s,r,i,o)=>{sL(t,s,r,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>rL(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{An(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new Uo(t.repoInfo_,e,(s,r,i,o)=>{sL(t,s,r,i,o)},s=>{rL(t,s)},s=>{O_e(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=yge(t.repoInfo_,()=>new mme(t.stats_,t.server_)),t.infoData_=new hme,t.infoSyncTree_=new tL({startListening:(s,r,i,o)=>{let a=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(a=_m(t.infoSyncTree_,s._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),ck(t,"connected",!1),t.serverSyncTree_=new tL({startListening:(s,r,i,o)=>(t.server_.listen(s,i,r,(a,c)=>{const u=o(a,c);Ki(t.eventQueue_,s._path,u)}),[]),stopListening:(s,r)=>{t.server_.unlisten(s,r)}})}function D_e(t){const n=t.infoData_.getNode(new Nt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function lk(t){return p_e({timestamp:D_e(t)})}function sL(t,e,n,s,r){t.dataUpdateCount++;const i=new Nt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(s){const c=Wy(n,u=>Un(u));o=l_e(t.serverSyncTree_,i,c,r)}else{const c=Un(n);o=w3(t.serverSyncTree_,i,c,r)}else if(s){const c=Wy(n,u=>Un(u));o=i_e(t.serverSyncTree_,i,c)}else{const c=Un(n);o=_m(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=DE(t,i)),Ki(t.eventQueue_,a,o)}function rL(t,e){ck(t,"connected",e),e===!1&&V_e(t)}function O_e(t,e){Ks(e,(n,s)=>{ck(t,n,s)})}function ck(t,e,n){const s=new Nt("/.info/"+e),r=Un(n);t.infoData_.updateSnapshot(s,r);const i=_m(t.infoSyncTree_,s,r);Ki(t.eventQueue_,s,i)}function O3(t){return t.nextWriteId_++}function L_e(t,e,n){const s=c_e(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(r=>{const i=Un(r).withIndex(e._queryParams.getIndex());QI(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=_m(t.serverSyncTree_,e._path,i);else{const a=Pg(t.serverSyncTree_,e);o=w3(t.serverSyncTree_,e._path,i,a)}return Ki(t.eventQueue_,e._path,o),Tv(t.serverSyncTree_,e,n,null,!0),i},r=>(xE(t,"get for query "+An(e)+" failed: "+r),Promise.reject(new Error(r))))}function M_e(t,e,n,s,r){xE(t,"set",{path:e.toString(),value:n,priority:s});const i=lk(t),o=Un(n,s),a=XA(t.serverSyncTree_,e),c=C3(o,a,i),u=O3(t),h=v3(t.serverSyncTree_,e,c,u,!0);ak(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(p,m)=>{const w=p==="ok";w||Hs("set at "+e+" failed: "+p);const R=bc(t.serverSyncTree_,u,!w);Ki(t.eventQueue_,e,R),B_e(t,r,p,m)});const d=U3(t,e);DE(t,d),Ki(t.eventQueue_,d,[])}function V_e(t){xE(t,"onDisconnectEvents");const e=lk(t),n=gv();zI(t.onDisconnect_,ft(),(r,i)=>{const o=__e(r,i,t.serverSyncTree_,e);s3(n,r,o)});let s=[];zI(n,ft(),(r,i)=>{s=s.concat(_m(t.serverSyncTree_,r,i));const o=U3(t,r);DE(t,o)}),t.onDisconnect_=gv(),Ki(t.eventQueue_,ft(),s)}function F_e(t,e,n){let s;Ke(e._path)===".info"?s=QI(t.infoSyncTree_,e,n):s=QI(t.serverSyncTree_,e,n),x3(t.eventQueue_,e._path,s)}function U_e(t,e,n){let s;Ke(e._path)===".info"?s=Tv(t.infoSyncTree_,e,n):s=Tv(t.serverSyncTree_,e,n),x3(t.eventQueue_,e._path,s)}function q_e(t){t.persistentConnection_&&t.persistentConnection_.interrupt(k_e)}function xE(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ds(n,...e)}function B_e(t,e,n,s){e&&ad(()=>{if(n==="ok")e(null);else{const r=(n||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function L3(t,e,n){return XA(t.serverSyncTree_,e,n)||Ae.EMPTY_NODE}function uk(t,e=t.transactionQueueTree_){if(e||OE(t,e),ld(e)){const n=V3(t,e);he(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&j_e(t,vm(e),n)}else S3(e)&&NE(e,n=>{uk(t,n)})}function j_e(t,e,n){const s=n.map(u=>u.currentWriteId),r=L3(t,e,s);let i=r;const o=r.hash();for(let u=0;u<n.length;u++){const h=n[u];he(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const d=Vs(e,h.path);i=i.updateChild(d,h.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,u=>{xE(t,"transaction put response",{path:c.toString(),status:u});let h=[];if(u==="ok"){const d=[];for(let p=0;p<n.length;p++)n[p].status=2,h=h.concat(bc(t.serverSyncTree_,n[p].currentWriteId)),n[p].onComplete&&d.push(()=>n[p].onComplete(null,!0,n[p].currentOutputSnapshotResolved)),n[p].unwatcher();OE(t,ik(t.transactionQueueTree_,e)),uk(t,t.transactionQueueTree_),Ki(t.eventQueue_,e,h);for(let p=0;p<d.length;p++)ad(d[p])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Hs("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}DE(t,e)}},o)}function DE(t,e){const n=M3(t,e),s=vm(n),r=V3(t,n);return $_e(t,r,s),s}function $_e(t,e,n){if(e.length===0)return;const s=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],u=Vs(n,c.path);let h=!1,d;if(he(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)h=!0,d=c.abortReason,r=r.concat(bc(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=P_e)h=!0,d="maxretry",r=r.concat(bc(t.serverSyncTree_,c.currentWriteId,!0));else{const p=L3(t,c.path,o);c.currentInputSnapshot=p;const m=e[a].update(p.val());if(m!==void 0){ok("transaction failed: Data returned ",m,c.path);let w=Un(m);typeof m=="object"&&m!=null&&aa(m,".priority")||(w=w.updatePriority(p.getPriority()));const k=c.currentWriteId,O=lk(t),M=C3(w,p,O);c.currentOutputSnapshotRaw=w,c.currentOutputSnapshotResolved=M,c.currentWriteId=O3(t),o.splice(o.indexOf(k),1),r=r.concat(v3(t.serverSyncTree_,c.path,M,c.currentWriteId,c.applyLocally)),r=r.concat(bc(t.serverSyncTree_,k,!0))}else h=!0,d="nodata",r=r.concat(bc(t.serverSyncTree_,c.currentWriteId,!0))}Ki(t.eventQueue_,n,r),r=[],h&&(e[a].status=2,function(p){setTimeout(p,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(d),!1,null))))}OE(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)ad(s[a]);uk(t,t.transactionQueueTree_)}function M3(t,e){let n,s=t.transactionQueueTree_;for(n=Ke(e);n!==null&&ld(s)===void 0;)s=ik(s,n),e=Lt(e),n=Ke(e);return s}function V3(t,e){const n=[];return F3(t,e,n),n.sort((s,r)=>s.order-r.order),n}function F3(t,e,n){const s=ld(e);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);NE(e,r=>{F3(t,r,n)})}function OE(t,e){const n=ld(e);if(n){let s=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[s]=n[r],s++);n.length=s,I3(e,n.length>0?n:void 0)}NE(e,s=>{OE(t,s)})}function U3(t,e){const n=vm(M3(t,e)),s=ik(t.transactionQueueTree_,e);return v_e(s,r=>{NT(t,r)}),NT(t,s),R3(s,r=>{NT(t,r)}),n}function NT(t,e){const n=ld(e);if(n){const s=[];let r=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(he(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(he(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(bc(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?I3(e,void 0):n.length=i+1,Ki(t.eventQueue_,vm(e),r);for(let o=0;o<s.length;o++)ad(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_e(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let r=n[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function H_e(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Hs(`Invalid query segment '${n}' in query '${t}'`)}return e}const iL=function(t,e){const n=W_e(t),s=n.namespace;n.domain==="firebase.com"&&na(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&na("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||rge();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Fj(n.host,n.secure,s,r,e,"",s!==n.subdomain),path:new Nt(n.pathString)}},W_e=function(t){let e="",n="",s="",r="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let h=t.indexOf("/");h===-1&&(h=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(h,d)),h<d&&(r=z_e(t.substring(h,d)));const p=H_e(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const m=e.slice(0,u);if(m.toLowerCase()==="localhost")n="localhost";else if(m.split(".").length<=2)n=m;else{const w=e.indexOf(".");s=e.substring(0,w).toLowerCase(),n=e.substring(w+1),i=s}"ns"in p&&(i=p.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_e{constructor(e,n,s,r){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+An(this.snapshot.exportVal())}}class G_e{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return he(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e,n,s,r){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=r}get key(){return Ze(this._path)?null:Kj(this._path)}get ref(){return new la(this._repo,this._path)}get _queryIdentifier(){const e=zO(this._queryParams),n=MA(e);return n==="{}"?"default":n}get _queryObject(){return zO(this._queryParams)}isEqual(e){if(e=St(e),!(e instanceof hk))return!1;const n=this._repo===e._repo,s=qA(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+Bge(this._path)}}class la extends hk{constructor(e,n){super(e,n,new zA,!1)}get parent(){const e=Qj(this._path);return e===null?null:new la(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Ng{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Nt(e),s=XI(this.ref,e);return new Ng(this._node.getChild(n),s,sn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,r)=>e(new Ng(r,XI(this.ref,s),sn)))}hasChild(e){const n=new Nt(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Fve(t,e){return t=St(t),t._checkNotDeleted("ref"),e!==void 0?XI(t._root,e):t._root}function XI(t,e){return t=St(t),Ke(t._path)===null?I_e("child","path",e):P3("child","path",e),new la(t._repo,Pn(t._path,e))}function Uve(t){return N3("remove",t._path),Q_e(t,null)}function Q_e(t,e){t=St(t),N3("set",t._path),C_e("set",e,t._path);const n=new Xw;return M_e(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function qve(t){t=St(t);const e=new q3(()=>{}),n=new LE(e);return L_e(t._repo,t,n).then(s=>new Ng(s,new la(t._repo,t._path),t._queryParams.getIndex()))}class LE{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new K_e("value",this,new Ng(e.snapshotNode,new la(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new G_e(this,e,n):null}matches(e){return e instanceof LE?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Y_e(t,e,n,s,r){const i=new q3(n,void 0),o=new LE(i);return F_e(t._repo,t,o),()=>U_e(t._repo,t,o)}function Bve(t,e,n,s){return Y_e(t,"value",e)}Xme(la);n_e(la);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_e="FIREBASE_DATABASE_EMULATOR_HOST",JI={};let J_e=!1;function Z_e(t,e,n,s){const r=e.lastIndexOf(":"),i=e.substring(0,r),o=Yi(i);t.repoInfo_=new Fj(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function eye(t,e,n,s,r){let i=s||t.options.databaseURL;i===void 0&&(t.options.projectId||na("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ds("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=iL(i,r),a=o.repoInfo,c;typeof process<"u"&&SO&&(c=SO[X_e]),c?(i=`http://${c}?ns=${a.namespace}`,o=iL(i,r),a=o.repoInfo):o.repoInfo.secure;const u=new gge(t.name,t.options,e);S_e("Invalid Firebase Database URL",o),Ze(o.path)||na("Database URL must point to the root of a Firebase Database (not including a child path).");const h=nye(a,t,u,new pge(t,n));return new sye(h,t)}function tye(t,e){const n=JI[e];(!n||n[t.key]!==t)&&na(`Database ${e}(${t.repoInfo_}) has already been deleted.`),q_e(t),delete n[t.key]}function nye(t,e,n,s){let r=JI[e.name];r||(r={},JI[e.name]=r);let i=r[t.toURLString()];return i&&na("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new N_e(t,J_e,n,s),r[t.toURLString()]=i,i}class sye{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(x_e(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new la(this._repo,ft())),this._rootInternal}_delete(){return this._rootInternal!==null&&(tye(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&na("Cannot call "+e+" on a deleted database.")}}function rye(t=nE(),e){const n=rm(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=LR("database");s&&iye(n,...s)}return n}function iye(t,e,n,s={}){t=St(t),t._checkNotDeleted("useEmulator");const r=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(r===t._repoInternal.repoInfo_.host&&_l(s,i.repoInfo_.emulatorOptions))return;na("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&na('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new x_(x_.OWNER);else if(s.mockUserToken){const a=typeof s.mockUserToken=="string"?s.mockUserToken:MR(s.mockUserToken,t.app.options.projectId);o=new x_(a)}Yi(e)&&(Jw(e),Zw("Database",!0)),Z_e(i,r,s,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oye(t){Jpe(Ol),yl(new Xo("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return eye(s,r,i,n)},"PUBLIC").setMultipleInstances(!0)),yr(RO,AO,t),yr(RO,AO,"esm2020")}Uo.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Uo.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};oye();var rc={};const Cn={apiKey:rc.FIREBASE_API_KEY||"AIzaSyC2RcDl7MRYRKMkX2szBsF67a9jHub0VV4",authDomain:rc.FIREBASE_AUTH_DOMAIN||"slide-view-91a09.firebaseapp.com",projectId:rc.FIREBASE_PROJECT_ID||"slide-view-91a09",storageBucket:rc.FIREBASE_STORAGE_BUCKET||"slide-view-91a09.appspot.com",messagingSenderId:rc.FIREBASE_MESSAGING_SENDER_ID||"951171862827",appId:rc.FIREBASE_APP_ID||"1:951171862827:web:14701b2a5f1cba5b96756e",databaseURL:rc.FIREBASE_DATABASE_URL||"https://slide-view-91a09-default-rtdb.asia-southeast1.firebasedatabase.app/"};console.log("🔐 Firebase 설정 확인:",{apiKey:Cn.apiKey?"설정됨":"설정 안됨",authDomain:Cn.authDomain?"설정됨":"설정 안됨",projectId:Cn.projectId?"설정됨":"설정 안됨",storageBucket:Cn.storageBucket?"설정됨":"설정 안됨",messagingSenderId:Cn.messagingSenderId?"설정됨":"설정 안됨",appId:Cn.appId?"설정됨":"설정 안됨",databaseURL:Cn.databaseURL?"설정됨":"없음"});console.log("🔐 Firebase 설정 값 확인:",{apiKey:Cn.apiKey?`${Cn.apiKey.substring(0,10)}...`:"없음",authDomain:Cn.authDomain,projectId:Cn.projectId,databaseURL:Cn.databaseURL?"설정됨":"없음"});(!Cn.apiKey||!Cn.authDomain||!Cn.projectId)&&console.warn("⚠️ Firebase 설정이 완전하지 않습니다. 환경 변수를 확인해주세요.");let tn,en,Tc,ZI,eS;Cn.apiKey&&Cn.authDomain&&Cn.projectId?(tn=J9(Cn),en=yue(tn),Tc=new No,ZI=XB(tn),eS=Gpe(tn),rye(tn)):(console.warn("⚠️ Firebase가 초기화되지 않았습니다. 일부 기능(인증, 투표 등)이 작동하지 않을 수 있습니다."),en=null,Tc=null,ZI=null,eS=null);const jve=Object.freeze(Object.defineProperty({__proto__:null,get auth(){return en},get db(){return ZI},get firebaseApp(){return tn},get googleProvider(){return Tc},get storage(){return eS}},Symbol.toStringTag,{value:"Module"}));function aye(){return _r(R9)}const Ft=gl(null),pi=gl(!0),Xm=gl(null);let Eu=null,oL=!1;function lye(){const t=aye(),e=tn?XB(tn):null;e?console.log("✅ Firestore 초기화 완료"):console.error("❌ Firestore가 초기화되지 않았습니다."),tn?console.log("✅ Firebase 설정 완료"):console.warn("⚠️ Firebase가 설정되지 않았습니다. 일부 기능이 제한될 수 있습니다.");const n=async c=>{if(!e)throw console.log("⚠️ Firestore가 초기화되지 않았습니다."),new Error("Firestore is not initialized.");const u=3;let h=0;for(;h<u;)try{console.log("🔍 사용자 정보 확인 중:",c.email,`(시도 ${h+1}/${u})`);const d=yfe(e,"users",c.uid),p=await yO(d);if(p.exists()){const m=p.data();return console.log("✅ 기존 사용자 발견:",m),await vO(d,{lastLoginAt:bT()},{merge:!0}),{...c,role:m.role||"student"}}else{console.log("🆕 새 사용자 등록 시작:",c.email);const m=!1,w=["place.coach@gmail.com","jplee@milestonz.com"],R=w.includes(c.email||"");console.log("🔍 관리자 이메일 확인:",{userEmail:c.email,adminEmails:w,isAdminEmail:R});const k={uid:c.uid,email:c.email,displayName:c.displayName,photoURL:c.photoURL,role:R?"admin":"student",createdAt:bT(),lastLoginAt:bT()};console.log("💾 새 사용자 정보 저장 중:",k),await vO(d,k),console.log("✅ 새 사용자 등록 완료:",c.email);const O=await yO(d);if(O.exists())console.log("✅ 사용자 등록 확인 완료:",O.data());else throw console.error("❌ 사용자 등록 확인 실패: 문서가 존재하지 않음"),new Error("사용자 등록이 완료되지 않았습니다.");return{...c,role:R?"admin":"student"}}}catch(d){if(h++,console.error(`❌ Firestore 접근 오류 (시도 ${h}/${u}):`,d),console.error("❌ 오류 코드:",d.code),console.error("❌ 오류 메시지:",d.message),d.code==="permission-denied")throw console.error("❌ Firestore 권한 오류. 사용자 등록이 불가능합니다."),console.error("❌ 오류 상세 정보:",{code:d.code,message:d.message,firebaseApp:!!tn,db:!!e,auth:!!en,userUid:c.uid,userEmail:c.email}),new Error("Firebase 프로젝트 설정을 확인해주세요. Firestore가 활성화되어 있고 Security Rules가 올바르게 설정되어 있는지 확인하세요.");if(h<u)console.log(`⏳ ${h*1e3}ms 후 재시도...`),await new Promise(p=>setTimeout(p,h*1e3));else throw console.error("❌ 모든 재시도 실패. 사용자 등록이 불가능합니다."),new Error("사용자 정보를 저장할 수 없습니다. 잠시 후 다시 시도해주세요.")}return{...c,role:"student"}},s=async()=>{if(!pi.value){pi.value=!0,Xm.value=null;try{if(!en||!Tc)throw new Error("Firebase is not configured.");const c=await Rce(en,Tc);console.log("✅ Google 로그인 팝업 성공:",c.user.email);try{if(tn&&e)Ft.value=await n(c.user),console.log("✅ 로그인 후 사용자 역할 설정 완료:",Ft.value.role);else{console.log("⚠️ Firebase가 초기화되지 않아 인증을 완료할 수 없습니다."),Ft.value=null,en&&await gf(en),t.notify({type:"warning",message:"Firebase 설정을 확인해주세요. 로그인할 수 없습니다.",timeout:5e3}),pi.value=!1;return}console.log("✅ 로그인 후 인증 상태 업데이트 완료:",{isAuthenticated:!!Ft.value,userRole:Ft.value?.role,userEmail:Ft.value?.email})}catch(u){console.error("❌ 로그인 후 사용자 역할 가져오기 실패:",u),Ft.value=null,en&&await gf(en),t.notify({type:"warning",message:"Firebase 설정 또는 권한 오류로 로그인할 수 없습니다.",timeout:5e3}),pi.value=!1;return}pi.value=!1,t.notify({type:"positive",message:"로그인에 성공했습니다!",timeout:2e3})}catch(c){console.error("❌ Google 로그인 팝업 실패:",c),Xm.value=c.message,t.notify({type:"negative",message:"로그인을 시작할 수 없습니다."}),pi.value=!1}}},r=async()=>{if(console.log("🔍 useAuth: logout 함수 호출됨"),console.log("🔍 useAuth: auth 객체 확인:",!!en),!en){console.log("❌ useAuth: auth 객체가 없음");return}try{Eu&&(console.log("🔍 useAuth: Firestore 리스너 정리"),Eu(),Eu=null),console.log("🔍 useAuth: Firebase signOut 실행"),await gf(en),console.log("✅ useAuth: Firebase signOut 성공"),Ft.value=null,console.log("✅ useAuth: 사용자 상태 초기화 완료"),console.log("✅ 로그아웃 성공")}catch(c){console.error("❌ useAuth: 로그아웃 실패:",c),t.notify({type:"negative",message:"로그아웃 중 오류가 발생했습니다."})}},i=()=>{if(!oL){if(oL=!0,console.log("🔐 Firebase 초기화 상태 확인:",{firebaseApp:!!tn,auth:!!en,db:!!e}),!en){console.log("⚠️ Firebase Auth가 초기화되지 않음"),pi.value=!1;return}console.log("🔐 Firebase Auth 초기화 시작"),Eu=ace(en,async c=>{if(console.log("🔄 onAuthStateChanged 실행. 사용자:",c?c.email:"없음"),c)if(console.log("✅ 인증된 사용자 감지:",{uid:c.uid,email:c.email,displayName:c.displayName,emailVerified:c.emailVerified}),tn&&e)try{Ft.value=await n(c),console.log("✅ 사용자 역할 설정 완료:",Ft.value.role),console.log("✅ 인증 상태 업데이트 완료:",{isAuthenticated:!!Ft.value,userRole:Ft.value?.role,userEmail:Ft.value?.email})}catch(u){console.error("❌ 사용자 역할 가져오기 실패:",u),console.error("❌ 오류 코드:",u.code),console.error("❌ 오류 메시지:",u.message),Ft.value=null,en&&await gf(en),Xm.value=u.message,t.notify({type:"warning",message:"사용자 등록/권한 확인 실패로 로그인할 수 없습니다. 관리자에게 문의하세요.",timeout:5e3}),pi.value=!1;return}else console.log("⚠️ Firebase가 초기화되지 않아 사용자 역할을 가져올 수 없습니다."),Ft.value=null,en&&await gf(en),t.notify({type:"warning",message:"Firebase 설정이 필요합니다. 로그인할 수 없습니다.",timeout:5e3});else console.log("ℹ️ 인증되지 않은 사용자"),Ft.value=null,console.log("✅ 인증 해제 상태 업데이트 완료");pi.value=!1})}};RR(()=>{Eu&&Eu()});const o=()=>{console.log("🔍 현재 사용자 정보:",{user:Ft.value,isAuthenticated:!!Ft.value,userRole:Ft.value?.role,firebaseApp:!!tn,firestore:!!e})},a=()=>(console.log("🔧 Firebase 설정 상태 확인:"),console.log("  - Firebase App:",!!tn),console.log("  - Firebase Auth:",!!en),console.log("  - Firestore DB:",!!e),console.log("  - Google Provider:",!!Tc),tn&&console.log("  - Firebase Config:",{apiKey:tn.options.apiKey?"설정됨":"설정 안됨",authDomain:tn.options.authDomain?"설정됨":"설정 안됨",projectId:tn.options.projectId?"설정됨":"설정 안됨",storageBucket:tn.options.storageBucket?"설정됨":"설정 안됨"}),{firebaseApp:!!tn,auth:!!en,db:!!e,googleProvider:!!Tc});return{user:Ee(()=>Ft.value),loading:Ee(()=>pi.value),error:Ee(()=>Xm.value),isAuthenticated:Ee(()=>!!Ft.value),displayName:Ee(()=>Ft.value?.displayName||"사용자"),email:Ee(()=>Ft.value?.email||""),photoURL:Ee(()=>Ft.value?.photoURL||""),isFirebaseConfigured:Ee(()=>!!tn),userRole:Ee(()=>Ft.value?.role||"unknown"),signInWithGoogle:s,logout:r,initAuth:i,debugUserInfo:o,checkFirebaseConfig:a}}const cye={id:"app"},uye=qw({__name:"App",setup(t){const{initAuth:e,isAuthenticated:n,userRole:s,loading:r,debugUserInfo:i}=lye(),o=Loe(),a=Moe();return IR(()=>{e()}),fp([n,s,r],([c,u,h])=>{h||(console.log(`인증 상태 감시: isAuthenticated=${c}, userRole=${u}, loading=${h}`),console.log(`현재 경로: ${a.path}`),i(),c?u==="admin"?(console.log("관리자로 확인됨. 현재 경로 유지."),(a.path==="/login"||a.path.startsWith("/study")&&a.name!=="StudentView")&&o.push("/")):u==="student"&&(a.path.startsWith("/study")||(console.log("학생으로 확인됨. 학생 페이지로 이동합니다."),o.push("/study/default"))):a.path.startsWith("/study")?console.log("미인증 사용자가 학생 페이지 접근. 로그인 페이지로 이동합니다."):console.log("미인증 사용자. 현재 경로 유지."))}),(c,u)=>{const h=Pse("router-view");return a9(),lre("div",cye,[Ls(h)])}}}),hye=t=>t,dye=hye,fye=[{path:"/",component:()=>os(()=>import("./MainLayout-Bwj2wsFm.js"),__vite__mapDeps([22,23,24,25,26,27,28,29,30,31,32,33,34,35])),children:[{path:"",component:()=>os(()=>import("./IndexPage-CFs49cf4.js"),__vite__mapDeps([36,23,24,25,32,37,30,31,38,34,39]))},{path:"survey-results",component:()=>os(()=>import("./SurveyResults-DvN0U2_L.js"),__vite__mapDeps([40,28,25,23,24,27,41,37,42,43]))}]},{path:"/logout",component:()=>os(()=>import("./LogoutPage-CtCownZv.js"),__vite__mapDeps([44,24,25,32,37,26,45]))},{path:"/poll-result",component:()=>os(()=>import("./PollResultPage-BsZ27FdJ.js"),__vite__mapDeps([46,28,25,37,42,43,47]))},{path:"/study/:courseId",component:()=>os(()=>import("./StudentView-EHbgIK-q.js"),__vite__mapDeps([48,23,24,25,27,29,26,30,31,32,28,33,38,37,41,42,43,49])),beforeEnter:(t,e,n)=>{const s=localStorage.getItem("isGuestMode")==="true",r=localStorage.getItem("guestUserId"),i=s&&r,o=!0,a=localStorage.getItem("enableStudentMode")==="true",c=o;console.log("🔍 라우터 가드 디버깅:",{isGuestMode:s,guestUserId:r,isGuestAuthenticated:i,envStudentMode:o,localStudentMode:a,isStudentModeEnabled:c,courseId:t.params.courseId,localStorage:{isGuestMode:localStorage.getItem("isGuestMode"),guestUserId:localStorage.getItem("guestUserId"),enableStudentMode:localStorage.getItem("enableStudentMode")}});{console.log("✅ 학생 페이지 접근 허용:",{isGuestAuthenticated:i,isStudentModeEnabled:c,courseId:t.params.courseId}),n();return}}},{path:"/:catchAll(.*)*",component:()=>os(()=>import("./ErrorNotFound-C3eQr692.js"),[])}],xT=dye(function(){return Doe({scrollBehavior:()=>({left:0,top:0}),routes:fye,history:loe("/")})});async function pye(t,e){const n=t(uye);n.use(Nie,e);const s=Zg(typeof xT=="function"?await xT({}):xT);return{app:n,router:s}}const tS={xs:18,sm:24,md:32,lg:38,xl:46},dk={size:String};function fk(t,e=tS){return Ee(()=>t.size!==void 0?{fontSize:t.size in e?`${e[t.size]}px`:t.size}:null)}function gye(t,e){return t!==void 0&&t()||e}function $ve(t,e){if(t!==void 0){const n=t();if(n!=null)return n.slice()}return e}function Lf(t,e){return t!==void 0?e.concat(t()):e}function mye(t,e){return t===void 0?e:e!==void 0?e.concat(t()):t()}function zve(t,e,n,s,r,i){e.key=s+r;const o=Ve(t,e,n);return r===!0?x6(o,i()):o}const aL="0 0 24 24",DT=t=>t,OT=t=>`ionicons ${t}`,B3={"mdi-":t=>`mdi ${t}`,"icon-":DT,"bt-":t=>`bt ${t}`,"eva-":t=>`eva ${t}`,"ion-md":OT,"ion-ios":OT,"ion-logo":OT,"iconfont ":DT,"ti-":t=>`themify-icon ${t}`,"bi-":t=>`bootstrap-icons ${t}`,"i-":DT},j3={o_:"-outlined",r_:"-round",s_:"-sharp"},$3={sym_o_:"-outlined",sym_r_:"-rounded",sym_s_:"-sharp"},_ye=new RegExp("^("+Object.keys(B3).join("|")+")"),yye=new RegExp("^("+Object.keys(j3).join("|")+")"),lL=new RegExp("^("+Object.keys($3).join("|")+")"),vye=/^[Mm]\s?[-+]?\.?\d/,wye=/^img:/,Eye=/^svguse:/,bye=/^ion-/,Tye=/^(fa-(classic|sharp|solid|regular|light|brands|duotone|thin)|[lf]a[srlbdk]?) /,Cv=nm({name:"QIcon",props:{...dk,tag:{type:String,default:"i"},name:String,color:String,left:Boolean,right:Boolean},setup(t,{slots:e}){const{proxy:{$q:n}}=lu(),s=fk(t),r=Ee(()=>"q-icon"+(t.left===!0?" on-left":"")+(t.right===!0?" on-right":"")+(t.color!==void 0?` text-${t.color}`:"")),i=Ee(()=>{let o,a=t.name;if(a==="none"||!a)return{none:!0};if(n.iconMapFn!==null){const h=n.iconMapFn(a);if(h!==void 0)if(h.icon!==void 0){if(a=h.icon,a==="none"||!a)return{none:!0}}else return{cls:h.cls,content:h.content!==void 0?h.content:" "}}if(vye.test(a)===!0){const[h,d=aL]=a.split("|");return{svg:!0,viewBox:d,nodes:h.split("&&").map(p=>{const[m,w,R]=p.split("@@");return Ve("path",{style:w,d:m,transform:R})})}}if(wye.test(a)===!0)return{img:!0,src:a.substring(4)};if(Eye.test(a)===!0){const[h,d=aL]=a.split("|");return{svguse:!0,src:h.substring(7),viewBox:d}}let c=" ";const u=a.match(_ye);if(u!==null)o=B3[u[1]](a);else if(Tye.test(a)===!0)o=a;else if(bye.test(a)===!0)o=`ionicons ion-${n.platform.is.ios===!0?"ios":"md"}${a.substring(3)}`;else if(lL.test(a)===!0){o="notranslate material-symbols";const h=a.match(lL);h!==null&&(a=a.substring(6),o+=$3[h[1]]),c=a}else{o="notranslate material-icons";const h=a.match(yye);h!==null&&(a=a.substring(2),o+=j3[h[1]]),c=a}return{cls:o,content:c}});return()=>{const o={class:r.value,style:s.value,"aria-hidden":"true"};return i.value.none===!0?Ve(t.tag,o,gye(e.default)):i.value.img===!0?Ve(t.tag,o,Lf(e.default,[Ve("img",{src:i.value.src})])):i.value.svg===!0?Ve(t.tag,o,Lf(e.default,[Ve("svg",{viewBox:i.value.viewBox||"0 0 24 24"},i.value.nodes)])):i.value.svguse===!0?Ve(t.tag,o,Lf(e.default,[Ve("svg",{viewBox:i.value.viewBox},[Ve("use",{"xlink:href":i.value.src})])])):(i.value.cls!==void 0&&(o.class+=" "+i.value.cls),Ve(t.tag,o,Lf(e.default,[i.value.content])))}}}),Cye=nm({name:"QAvatar",props:{...dk,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(t,{slots:e}){const n=fk(t),s=Ee(()=>"q-avatar"+(t.color?` bg-${t.color}`:"")+(t.textColor?` text-${t.textColor} q-chip--colored`:"")+(t.square===!0?" q-avatar--square":t.rounded===!0?" rounded-borders":"")),r=Ee(()=>t.fontSize?{fontSize:t.fontSize}:null);return()=>{const i=t.icon!==void 0?[Ve(Cv,{name:t.icon})]:void 0;return Ve("div",{class:s.value,style:n.value},[Ve("div",{class:"q-avatar__content row flex-center overflow-hidden",style:r.value},mye(e.default,i))])}}}),Iye={size:{type:[String,Number],default:"1em"},color:String};function Sye(t){return{cSize:Ee(()=>t.size in tS?`${tS[t.size]}px`:t.size),classes:Ee(()=>"q-spinner"+(t.color?` text-${t.color}`:""))}}const z3=nm({name:"QSpinner",props:{...Iye,thickness:{type:Number,default:5}},setup(t){const{cSize:e,classes:n}=Sye(t);return()=>Ve("svg",{class:n.value+" q-spinner-mat",width:e.value,height:e.value,viewBox:"25 25 50 50"},[Ve("circle",{class:"path",cx:"50",cy:"50",r:"20",fill:"none",stroke:"currentColor","stroke-width":t.thickness,"stroke-miterlimit":"10"})])}});function Rye(t,e){const n=t.style;for(const s in e)n[s]=e[s]}function Hve(t){if(t==null)return;if(typeof t=="string")try{return document.querySelector(t)||void 0}catch{return}const e=Nc(t);if(e)return e.$el||e}function Wve(t,e){if(t==null||t.contains(e)===!0)return!0;for(let n=t.nextElementSibling;n!==null;n=n.nextElementSibling)if(n.contains(e))return!0;return!1}function Aye(t,e=250){let n=!1,s;return function(){return n===!1&&(n=!0,setTimeout(()=>{n=!1},e),s=t.apply(this,arguments)),s}}function cL(t,e,n,s){n.modifiers.stop===!0&&T9(t);const r=n.modifiers.color;let i=n.modifiers.center;i=i===!0||s===!0;const o=document.createElement("span"),a=document.createElement("span"),c=uie(t),{left:u,top:h,width:d,height:p}=e.getBoundingClientRect(),m=Math.sqrt(d*d+p*p),w=m/2,R=`${(d-m)/2}px`,k=i?R:`${c.left-u-w}px`,O=`${(p-m)/2}px`,M=i?O:`${c.top-h-w}px`;a.className="q-ripple__inner",Rye(a,{height:`${m}px`,width:`${m}px`,transform:`translate3d(${k},${M},0) scale3d(.2,.2,1)`,opacity:0}),o.className=`q-ripple${r?" text-"+r:""}`,o.setAttribute("dir","ltr"),o.appendChild(a),e.appendChild(o);const F=()=>{o.remove(),clearTimeout(q)};n.abort.push(F);let q=setTimeout(()=>{a.classList.add("q-ripple__inner--enter"),a.style.transform=`translate3d(${R},${O},0) scale3d(1,1,1)`,a.style.opacity=.2,q=setTimeout(()=>{a.classList.remove("q-ripple__inner--enter"),a.classList.add("q-ripple__inner--leave"),a.style.opacity=0,q=setTimeout(()=>{o.remove(),n.abort.splice(n.abort.indexOf(F),1)},275)},250)},50)}function uL(t,{modifiers:e,value:n,arg:s}){const r=Object.assign({},t.cfg.ripple,e,n);t.modifiers={early:r.early===!0,stop:r.stop===!0,center:r.center===!0,color:r.color||s,keyCodes:[].concat(r.keyCodes||13)}}const kye=cie({name:"ripple",beforeMount(t,e){const n=e.instance.$.appContext.config.globalProperties.$q.config||{};if(n.ripple===!1)return;const s={cfg:n,enabled:e.value!==!1,modifiers:{},abort:[],start(r){s.enabled===!0&&r.qSkipRipple!==!0&&r.type===(s.modifiers.early===!0?"pointerdown":"click")&&cL(r,t,s,r.qKeyEvent===!0)},keystart:Aye(r=>{s.enabled===!0&&r.qSkipRipple!==!0&&aI(r,s.modifiers.keyCodes)===!0&&r.type===`key${s.modifiers.early===!0?"down":"up"}`&&cL(r,t,s,!0)},300)};uL(s,e),t.__qripple=s,hie(s,"main",[[t,"pointerdown","start","passive"],[t,"click","start","passive"],[t,"keydown","keystart","passive"],[t,"keyup","keystart","passive"]])},updated(t,e){if(e.oldValue!==e.value){const n=t.__qripple;n!==void 0&&(n.enabled=e.value!==!1,n.enabled===!0&&Object(e.value)===e.value&&uL(n,e))}},beforeUnmount(t){const e=t.__qripple;e!==void 0&&(e.abort.forEach(n=>{n()}),die(e,"main"),delete t._qripple)}}),H3={left:"start",center:"center",right:"end",between:"between",around:"around",evenly:"evenly",stretch:"stretch"},Pye=Object.keys(H3),Nye={align:{type:String,validator:t=>Pye.includes(t)}};function xye(t){return Ee(()=>{const e=t.align===void 0?t.vertical===!0?"stretch":"left":t.align;return`${t.vertical===!0?"items":"justify"}-${H3[e]}`})}function Kve(t){if(Object(t.$parent)===t.$parent)return t.$parent;let{parent:e}=t.$;for(;Object(e)===e;){if(Object(e.proxy)===e.proxy)return e.proxy;e=e.parent}}function Dye(t){return t.appContext.config.globalProperties.$router!==void 0}function Gve(t){return t.isUnmounted===!0||t.isDeactivated===!0}function hL(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}function dL(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Oye(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(Array.isArray(r)===!1||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function fL(t,e){return Array.isArray(e)===!0?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function Lye(t,e){return Array.isArray(t)===!0?fL(t,e):Array.isArray(e)===!0?fL(e,t):t===e}function Mye(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(Lye(t[n],e[n])===!1)return!1;return!0}const W3={to:[String,Object],replace:Boolean,href:String,target:String,disable:Boolean},Qve={...W3,exact:Boolean,activeClass:{type:String,default:"q-router-link--active"},exactActiveClass:{type:String,default:"q-router-link--exact-active"}};function Vye({fallbackTag:t,useDisableForRouterLinkProps:e=!0}={}){const n=lu(),{props:s,proxy:r,emit:i}=n,o=Dye(n),a=Ee(()=>s.disable!==!0&&s.href!==void 0),c=Ee(e===!0?()=>o===!0&&s.disable!==!0&&a.value!==!0&&s.to!==void 0&&s.to!==null&&s.to!=="":()=>o===!0&&a.value!==!0&&s.to!==void 0&&s.to!==null&&s.to!==""),u=Ee(()=>c.value===!0?M(s.to):null),h=Ee(()=>u.value!==null),d=Ee(()=>a.value===!0||h.value===!0),p=Ee(()=>s.type==="a"||d.value===!0?"a":s.tag||t||"div"),m=Ee(()=>a.value===!0?{href:s.href,target:s.target}:h.value===!0?{href:u.value.href,target:s.target}:{}),w=Ee(()=>{if(h.value===!1)return-1;const{matched:H}=u.value,{length:J}=H,I=H[J-1];if(I===void 0)return-1;const v=r.$route.matched;if(v.length===0)return-1;const y=v.findIndex(dL.bind(null,I));if(y!==-1)return y;const C=hL(H[J-2]);return J>1&&hL(I)===C&&v[v.length-1].path!==C?v.findIndex(dL.bind(null,H[J-2])):y}),R=Ee(()=>h.value===!0&&w.value!==-1&&Oye(r.$route.params,u.value.params)),k=Ee(()=>R.value===!0&&w.value===r.$route.matched.length-1&&Mye(r.$route.params,u.value.params)),O=Ee(()=>h.value===!0?k.value===!0?` ${s.exactActiveClass} ${s.activeClass}`:s.exact===!0?"":R.value===!0?` ${s.activeClass}`:"":"");function M(H){try{return r.$router.resolve(H)}catch{}return null}function F(H,{returnRouterError:J,to:I=s.to,replace:v=s.replace}={}){if(s.disable===!0)return H.preventDefault(),Promise.resolve(!1);if(H.metaKey||H.altKey||H.ctrlKey||H.shiftKey||H.button!==void 0&&H.button!==0||s.target==="_blank")return Promise.resolve(!1);H.preventDefault();const y=r.$router[v===!0?"replace":"push"](I);return J===!0?y:y.then(()=>{}).catch(()=>{})}function q(H){if(h.value===!0){const J=I=>F(H,I);i("click",H,J),H.defaultPrevented!==!0&&J()}else i("click",H)}return{hasRouterLink:h,hasHrefLink:a,hasLink:d,linkTag:p,resolvedLink:u,linkIsActive:R,linkIsExactActive:k,linkClass:O,linkAttrs:m,getLink:M,navigateToRouterLink:F,navigateOnClick:q}}const pL={none:0,xs:4,sm:8,md:16,lg:24,xl:32},Fye={xs:8,sm:10,md:14,lg:20,xl:24},Uye=["button","submit","reset"],qye=/[^\s]\/[^\s]/,Bye=["flat","outline","push","unelevated"];function jye(t,e){return t.flat===!0?"flat":t.outline===!0?"outline":t.push===!0?"push":t.unelevated===!0?"unelevated":e}const $ye={...dk,...W3,type:{type:String,default:"button"},label:[Number,String],icon:String,iconRight:String,...Bye.reduce((t,e)=>(t[e]=Boolean)&&t,{}),square:Boolean,rounded:Boolean,glossy:Boolean,size:String,fab:Boolean,fabMini:Boolean,padding:String,color:String,textColor:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,tabindex:[Number,String],ripple:{type:[Boolean,Object],default:!0},align:{...Nye.align,default:"center"},stack:Boolean,stretch:Boolean,loading:{type:Boolean,default:null},disable:Boolean},zye={...$ye,round:Boolean};function Hye(t){const e=fk(t,Fye),n=xye(t),{hasRouterLink:s,hasLink:r,linkTag:i,linkAttrs:o,navigateOnClick:a}=Vye({fallbackTag:"button"}),c=Ee(()=>{const k=t.fab===!1&&t.fabMini===!1?e.value:{};return t.padding!==void 0?Object.assign({},k,{padding:t.padding.split(/\s+/).map(O=>O in pL?pL[O]+"px":O).join(" "),minWidth:"0",minHeight:"0"}):k}),u=Ee(()=>t.rounded===!0||t.fab===!0||t.fabMini===!0),h=Ee(()=>t.disable!==!0&&t.loading!==!0),d=Ee(()=>h.value===!0?t.tabindex||0:-1),p=Ee(()=>jye(t,"standard")),m=Ee(()=>{const k={tabindex:d.value};return r.value===!0?Object.assign(k,o.value):Uye.includes(t.type)===!0&&(k.type=t.type),i.value==="a"?(t.disable===!0?k["aria-disabled"]="true":k.href===void 0&&(k.role="button"),s.value!==!0&&qye.test(t.type)===!0&&(k.type=t.type)):t.disable===!0&&(k.disabled="",k["aria-disabled"]="true"),t.loading===!0&&t.percentage!==void 0&&Object.assign(k,{role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":t.percentage}),k}),w=Ee(()=>{let k;t.color!==void 0?t.flat===!0||t.outline===!0?k=`text-${t.textColor||t.color}`:k=`bg-${t.color} text-${t.textColor||"white"}`:t.textColor&&(k=`text-${t.textColor}`);const O=t.round===!0?"round":`rectangle${u.value===!0?" q-btn--rounded":t.square===!0?" q-btn--square":""}`;return`q-btn--${p.value} q-btn--${O}`+(k!==void 0?" "+k:"")+(h.value===!0?" q-btn--actionable q-focusable q-hoverable":t.disable===!0?" disabled":"")+(t.fab===!0?" q-btn--fab":t.fabMini===!0?" q-btn--fab-mini":"")+(t.noCaps===!0?" q-btn--no-uppercase":"")+(t.dense===!0?" q-btn--dense":"")+(t.stretch===!0?" no-border-radius self-stretch":"")+(t.glossy===!0?" glossy":"")+(t.square?" q-btn--square":"")}),R=Ee(()=>n.value+(t.stack===!0?" column":" row")+(t.noWrap===!0?" no-wrap text-no-wrap":"")+(t.loading===!0?" q-btn__content--hidden":""));return{classes:w,style:c,innerClasses:R,attributes:m,hasLink:r,linkTag:i,navigateOnClick:a,isActionable:h}}const{passiveCapture:ur}=Kc;let bu=null,Tu=null,Cu=null;const Wye=nm({name:"QBtn",props:{...zye,percentage:Number,darkPercentage:Boolean,onTouchstart:[Function,Array]},emits:["click","keydown","mousedown","keyup"],setup(t,{slots:e,emit:n}){const{proxy:s}=lu(),{classes:r,style:i,innerClasses:o,attributes:a,hasLink:c,linkTag:u,navigateOnClick:h,isActionable:d}=Hye(t),p=gl(null),m=gl(null);let w=null,R,k=null;const O=Ee(()=>t.label!==void 0&&t.label!==null&&t.label!==""),M=Ee(()=>t.disable===!0||t.ripple===!1?!1:{keyCodes:c.value===!0?[13,32]:[13],...t.ripple===!0?{}:t.ripple}),F=Ee(()=>({center:t.round})),q=Ee(()=>{const K=Math.max(0,Math.min(100,t.percentage));return K>0?{transition:"transform 0.6s",transform:`translateX(${K-100}%)`}:{}}),H=Ee(()=>{if(t.loading===!0)return{onMousedown:E,onTouchstart:E,onClick:E,onKeydown:E,onKeyup:E};if(d.value===!0){const K={onClick:I,onKeydown:v,onMousedown:C};if(s.$q.platform.has.touch===!0){const oe=t.onTouchstart!==void 0?"":"Passive";K[`onTouchstart${oe}`]=y}return K}return{onClick:vu}}),J=Ee(()=>({ref:p,class:"q-btn q-btn-item non-selectable no-outline "+r.value,style:i.value,...a.value,...H.value}));function I(K){if(p.value!==null){if(K!==void 0){if(K.defaultPrevented===!0)return;const oe=document.activeElement;if(t.type==="submit"&&oe!==document.body&&p.value.contains(oe)===!1&&oe.contains(p.value)===!1){K.qAvoidFocus!==!0&&p.value.focus();const ge=()=>{document.removeEventListener("keydown",vu,!0),document.removeEventListener("keyup",ge,ur),p.value?.removeEventListener("blur",ge,ur)};document.addEventListener("keydown",vu,!0),document.addEventListener("keyup",ge,ur),p.value.addEventListener("blur",ge,ur)}}h(K)}}function v(K){p.value!==null&&(n("keydown",K),aI(K,[13,32])===!0&&Tu!==p.value&&(Tu!==null&&T(),K.defaultPrevented!==!0&&(K.qAvoidFocus!==!0&&p.value.focus(),Tu=p.value,p.value.classList.add("q-btn--active"),document.addEventListener("keyup",S,!0),p.value.addEventListener("blur",S,ur)),vu(K)))}function y(K){p.value!==null&&(n("touchstart",K),K.defaultPrevented!==!0&&(bu!==p.value&&(bu!==null&&T(),bu=p.value,w=K.target,w.addEventListener("touchcancel",S,ur),w.addEventListener("touchend",S,ur)),R=!0,k!==null&&clearTimeout(k),k=setTimeout(()=>{k=null,R=!1},200)))}function C(K){p.value!==null&&(K.qSkipRipple=R===!0,n("mousedown",K),K.defaultPrevented!==!0&&Cu!==p.value&&(Cu!==null&&T(),Cu=p.value,p.value.classList.add("q-btn--active"),document.addEventListener("mouseup",S,ur)))}function S(K){if(p.value!==null&&!(K?.type==="blur"&&document.activeElement===p.value)){if(K?.type==="keyup"){if(Tu===p.value&&aI(K,[13,32])===!0){const oe=new MouseEvent("click",K);oe.qKeyEvent=!0,K.defaultPrevented===!0&&oI(oe),K.cancelBubble===!0&&T9(oe),p.value.dispatchEvent(oe),vu(K),K.qKeyEvent=!0}n("keyup",K)}T()}}function T(K){const oe=m.value;K!==!0&&(bu===p.value||Cu===p.value)&&oe!==null&&oe!==document.activeElement&&(oe.setAttribute("tabindex",-1),oe.focus()),bu===p.value&&(w!==null&&(w.removeEventListener("touchcancel",S,ur),w.removeEventListener("touchend",S,ur)),bu=w=null),Cu===p.value&&(document.removeEventListener("mouseup",S,ur),Cu=null),Tu===p.value&&(document.removeEventListener("keyup",S,!0),p.value?.removeEventListener("blur",S,ur),Tu=null),p.value?.classList.remove("q-btn--active")}function E(K){vu(K),K.qSkipRipple=!0}return SR(()=>{T(!0)}),Object.assign(s,{click:K=>{d.value===!0&&I(K)}}),()=>{let K=[];t.icon!==void 0&&K.push(Ve(Cv,{name:t.icon,left:t.stack!==!0&&O.value===!0,role:"img"})),O.value===!0&&K.push(Ve("span",{class:"block"},[t.label])),K=Lf(e.default,K),t.iconRight!==void 0&&t.round===!1&&K.push(Ve(Cv,{name:t.iconRight,right:t.stack!==!0&&O.value===!0,role:"img"}));const oe=[Ve("span",{class:"q-focus-helper",ref:m})];return t.loading===!0&&t.percentage!==void 0&&oe.push(Ve("span",{class:"q-btn__progress absolute-full overflow-hidden"+(t.darkPercentage===!0?" q-btn__progress--dark":"")},[Ve("span",{class:"q-btn__progress-indicator fit block",style:q.value})])),oe.push(Ve("span",{class:"q-btn__content text-center col items-center q-anchor--skip "+o.value},K)),t.loading!==null&&oe.push(Ve(Are,{name:"q-transition--fade"},()=>t.loading===!0?[Ve("span",{key:"loading",class:"absolute-full flex flex-center"},e.loading!==void 0?e.loading():[Ve(z3)])]:null)),x6(Ve(u.value,J.value,oe),[[kye,M.value,void 0,F.value]])}}});let Kye=1,Gye=document.body;function Qye(t,e){const n=document.createElement("div");if(n.id=e!==void 0?`q-portal--${e}--${Kye++}`:t,$y.globalNodes!==void 0){const s=$y.globalNodes.class;s!==void 0&&(n.className=s)}return Gye.appendChild(n),n}function Yve(t){t.remove()}let Yye=0;const D_={},O_={},Lr={},K3={},Xye=/^\s*$/,G3=[],Jye=[void 0,null,!0,!1,""],pk=["top-left","top-right","bottom-left","bottom-right","top","bottom","left","right","center"],Zye=["top-left","top-right","bottom-left","bottom-right"],Mf={positive:{icon:t=>t.iconSet.type.positive,color:"positive"},negative:{icon:t=>t.iconSet.type.negative,color:"negative"},warning:{icon:t=>t.iconSet.type.warning,color:"warning",textColor:"dark"},info:{icon:t=>t.iconSet.type.info,color:"info"},ongoing:{group:!1,timeout:0,spinner:!0,color:"grey-8"}};function Q3(t,e,n){if(!t)return Ef("parameter required");let s;const r={textColor:"white"};if(t.ignoreDefaults!==!0&&Object.assign(r,D_),ug(t)===!1&&(r.type&&Object.assign(r,Mf[r.type]),t={message:t}),Object.assign(r,Mf[t.type||r.type],t),typeof r.icon=="function"&&(r.icon=r.icon(e)),r.spinner?(r.spinner===!0&&(r.spinner=z3),r.spinner=Zg(r.spinner)):r.spinner=!1,r.meta={hasMedia:!!(r.spinner!==!1||r.icon||r.avatar),hasText:gL(r.message)||gL(r.caption)},r.position){if(pk.includes(r.position)===!1)return Ef("wrong position",t)}else r.position="bottom";if(Jye.includes(r.timeout)===!0)r.timeout=5e3;else{const c=Number(r.timeout);if(isNaN(c)||c<0)return Ef("wrong timeout",t);r.timeout=Number.isFinite(c)?c:0}r.timeout===0?r.progress=!1:r.progress===!0&&(r.meta.progressClass="q-notification__progress"+(r.progressClass?` ${r.progressClass}`:""),r.meta.progressStyle={animationDuration:`${r.timeout+1e3}ms`});const i=(Array.isArray(t.actions)===!0?t.actions:[]).concat(t.ignoreDefaults!==!0&&Array.isArray(D_.actions)===!0?D_.actions:[]).concat(Array.isArray(Mf[t.type]?.actions)===!0?Mf[t.type].actions:[]),{closeBtn:o}=r;if(o&&i.push({label:typeof o=="string"?o:e.lang.label.close}),r.actions=i.map(({handler:c,noDismiss:u,...h})=>({flat:!0,...h,onClick:typeof c=="function"?()=>{c(),u!==!0&&a()}:()=>{a()}})),r.multiLine===void 0&&(r.multiLine=r.actions.length>1),Object.assign(r.meta,{class:`q-notification row items-stretch q-notification--${r.multiLine===!0?"multi-line":"standard"}`+(r.color!==void 0?` bg-${r.color}`:"")+(r.textColor!==void 0?` text-${r.textColor}`:"")+(r.classes!==void 0?` ${r.classes}`:""),wrapperClass:"q-notification__wrapper col relative-position border-radius-inherit "+(r.multiLine===!0?"column no-wrap justify-center":"row items-center"),contentClass:"q-notification__content row items-center"+(r.multiLine===!0?"":" col"),leftClass:r.meta.hasText===!0?"additional":"single",attrs:{role:"alert",...r.attrs}}),r.group===!1?(r.group=void 0,r.meta.group=void 0):((r.group===void 0||r.group===!0)&&(r.group=[r.message,r.caption,r.multiline].concat(r.actions.map(c=>`${c.label}*${c.icon}`)).join("|")),r.meta.group=r.group+"|"+r.position),r.actions.length===0?r.actions=void 0:r.meta.actionsClass="q-notification__actions row items-center "+(r.multiLine===!0?"justify-end":"col-auto")+(r.meta.hasMedia===!0?" q-notification__actions--with-media":""),n!==void 0){n.notif.meta.timer&&(clearTimeout(n.notif.meta.timer),n.notif.meta.timer=void 0),r.meta.uid=n.notif.meta.uid;const c=Lr[r.position].value.indexOf(n.notif);Lr[r.position].value[c]=r}else{const c=O_[r.meta.group];if(c===void 0){if(r.meta.uid=Yye++,r.meta.badge=1,["left","right","center"].indexOf(r.position)!==-1)Lr[r.position].value.splice(Math.floor(Lr[r.position].value.length/2),0,r);else{const u=r.position.indexOf("top")!==-1?"unshift":"push";Lr[r.position].value[u](r)}r.group!==void 0&&(O_[r.meta.group]=r)}else{if(c.meta.timer&&(clearTimeout(c.meta.timer),c.meta.timer=void 0),r.badgePosition!==void 0){if(Zye.includes(r.badgePosition)===!1)return Ef("wrong badgePosition",t)}else r.badgePosition=`top-${r.position.indexOf("left")!==-1?"right":"left"}`;r.meta.uid=c.meta.uid,r.meta.badge=c.meta.badge+1,r.meta.badgeClass=`q-notification__badge q-notification__badge--${r.badgePosition}`+(r.badgeColor!==void 0?` bg-${r.badgeColor}`:"")+(r.badgeTextColor!==void 0?` text-${r.badgeTextColor}`:"")+(r.badgeClass?` ${r.badgeClass}`:"");const u=Lr[r.position].value.indexOf(c);Lr[r.position].value[u]=O_[r.meta.group]=r}}const a=()=>{eve(r),s=void 0};if(r.timeout>0&&(r.meta.timer=setTimeout(()=>{r.meta.timer=void 0,a()},r.timeout+1e3)),r.group!==void 0)return c=>{c!==void 0?Ef("trying to update a grouped one which is forbidden",t):a()};if(s={dismiss:a,config:t,notif:r},n!==void 0){Object.assign(n,s);return}return c=>{if(s!==void 0)if(c===void 0)s.dismiss();else{const u=Object.assign({},s.config,c,{group:!1,position:r.position});Q3(u,e,s)}}}function eve(t){t.meta.timer&&(clearTimeout(t.meta.timer),t.meta.timer=void 0);const e=Lr[t.position].value.indexOf(t);if(e!==-1){t.group!==void 0&&delete O_[t.meta.group];const n=G3[""+t.meta.uid];if(n){const{width:s,height:r}=getComputedStyle(n);n.style.left=`${n.offsetLeft}px`,n.style.width=s,n.style.height=r}Lr[t.position].value.splice(e,1),typeof t.onDismiss=="function"&&t.onDismiss()}}function gL(t){return t!=null&&Xye.test(t)!==!0}function Ef(t,e){return console.error(`Notify: ${t}`,e),!1}function tve(){return nm({name:"QNotifications",devtools:{hide:!0},setup(){return()=>Ve("div",{class:"q-notifications"},pk.map(t=>Ve(Gre,{key:t,class:K3[t],tag:"div",name:`q-notification--${t}`},()=>Lr[t].value.map(e=>{const n=e.meta,s=[];if(n.hasMedia===!0&&(e.spinner!==!1?s.push(Ve(e.spinner,{class:"q-notification__spinner q-notification__spinner--"+n.leftClass,color:e.spinnerColor,size:e.spinnerSize})):e.icon?s.push(Ve(Cv,{class:"q-notification__icon q-notification__icon--"+n.leftClass,name:e.icon,color:e.iconColor,size:e.iconSize,role:"img"})):e.avatar&&s.push(Ve(Cye,{class:"q-notification__avatar q-notification__avatar--"+n.leftClass},()=>Ve("img",{src:e.avatar,"aria-hidden":"true"})))),n.hasText===!0){let i;const o={class:"q-notification__message col"};if(e.html===!0)o.innerHTML=e.caption?`<div>${e.message}</div><div class="q-notification__caption">${e.caption}</div>`:e.message;else{const a=[e.message];i=e.caption?[Ve("div",a),Ve("div",{class:"q-notification__caption"},[e.caption])]:a}s.push(Ve("div",o,i))}const r=[Ve("div",{class:n.contentClass},s)];return e.progress===!0&&r.push(Ve("div",{key:`${n.uid}|p|${n.badge}`,class:n.progressClass,style:n.progressStyle})),e.actions!==void 0&&r.push(Ve("div",{class:n.actionsClass},e.actions.map(i=>Ve(Wye,i)))),n.badge>1&&r.push(Ve("div",{key:`${n.uid}|${n.badge}`,class:e.meta.badgeClass,style:e.badgeStyle},[n.badge])),Ve("div",{ref:i=>{G3[""+n.uid]=i},key:n.uid,class:n.class,...n.attrs},[Ve("div",{class:n.wrapperClass},r)])}))))}})}const nve={setDefaults(t){ug(t)===!0&&Object.assign(D_,t)},registerType(t,e){ug(e)===!0&&(Mf[t]=e)},install({$q:t,parentApp:e}){if(t.notify=this.create=n=>Q3(n,t),t.notify.setDefaults=this.setDefaults,t.notify.registerType=this.registerType,t.config.notify!==void 0&&this.setDefaults(t.config.notify),this.__installed!==!0){pk.forEach(s=>{Lr[s]=gl([]);const r=["left","center","right"].includes(s)===!0?"center":s.indexOf("top")!==-1?"top":"bottom",i=s.indexOf("left")!==-1?"start":s.indexOf("right")!==-1?"end":"center",o=["left","right"].includes(s)?`items-${s==="left"?"start":"end"} justify-center`:s==="center"?"flex-center":`items-${i}`;K3[s]=`q-notifications__list q-notifications__list--${r} fixed column no-wrap ${o}`});const n=Qye("q-notify");Aie(tve(),e).mount(n)}}},sve={config:{},plugins:{Notify:nve}},rve="/";async function ive({app:t,router:e},n){let s=!1;const r=a=>{try{return e.resolve(a).href}catch{}return Object(a)===a?null:a},i=a=>{if(s=!0,typeof a=="string"&&/^https?:\/\//.test(a)){window.location.href=a;return}const c=r(a);c!==null&&(window.location.href=c)},o=window.location.href.replace(window.location.origin,"");for(let a=0;s===!1&&a<n.length;a++)try{await n[a]({app:t,router:e,ssrContext:null,redirect:i,urlPath:o,publicPath:rve})}catch(c){if(c&&c.url){i(c.url);return}console.error("[Quasar] boot error:",c);return}s!==!0&&(t.use(e),t.mount("#q-app"))}pye(E9,sve).then(t=>{const[e,n]=Promise.allSettled!==void 0?["allSettled",s=>s.map(r=>{if(r.status==="rejected"){console.error("[Quasar] boot error:",r.reason);return}return r.value.default})]:["all",s=>s.map(r=>r.default)];return Promise[e]([os(()=>import("./pinia-F5TpqEXP.js"),__vite__mapDeps([50,31]))]).then(s=>{const r=n(s).filter(i=>typeof i=="function");ive(t,r)})});export{Hu as $,ng as A,Rz as B,sz as C,N4 as D,Vv as E,F5 as F,oc as G,Xz as H,Fv as I,mV as J,Dg as K,bS as L,kM as M,Pv as N,x4 as O,Qt as P,P4 as Q,Eo as R,yte as S,_te as T,TS as U,k4 as V,su as W,kl as X,F4 as Y,jo as Z,os as _,gV as a,Py as a$,vte as a0,Lg as a1,W_ as a2,Qr as a3,IS as a4,hh as a5,tl as a6,lM as a7,iM as a8,oM as a9,Ute as aA,zf as aB,Jte as aC,Zz as aD,U4 as aE,q4 as aF,Ru as aG,p2 as aH,FV as aI,xV as aJ,e2 as aK,n2 as aL,YV as aM,h2 as aN,iC as aO,VV as aP,XV as aQ,$S as aR,m2 as aS,i2 as aT,t2 as aU,Ao as aV,rl as aW,Ci as aX,Ro as aY,So as aZ,BS as a_,qu as aa,WM as ab,Gte as ac,t_ as ad,XM as ae,pS as af,cM as ag,yS as ah,K_ as ai,xz as aj,QM as ak,W4 as al,eV as am,sH as an,nH as ao,dh as ap,Nw as aq,xw as ar,lt as as,_2 as at,Ete as au,HM as av,GM as aw,Uz as ax,KM as ay,Vz as az,Bh as b,Cv as b$,FF as b0,kC as b1,KY as b2,PC as b3,Ny as b4,gJ as b5,hJ as b6,WY as b7,f_ as b8,fJ as b9,Jh as bA,cve as bB,Qn as bC,th as bD,ut as bE,fp as bF,R6 as bG,hve as bH,Zg as bI,Ee as bJ,Fne as bK,uve as bL,_r as bM,pve as bN,nm as bO,lu as bP,Ve as bQ,gye as bR,Ive as bS,bve as bT,Tve as bU,Hve as bV,Rye as bW,dk as bX,fk as bY,zve as bZ,kye as b_,dJ as ba,pJ as bb,GY as bc,G4 as bd,z4 as be,H4 as bf,G$ as bg,H_ as bh,Y4 as bi,Fz as bj,el as bk,Xte as bl,fne as bm,Jz as bn,B4 as bo,Kte as bp,O4 as bq,f$ as br,qh as bs,p5 as bt,qn as bu,Ic as bv,IL as bw,p$ as bx,V$ as by,gl as bz,D4 as c,uie as c$,mye as c0,vu as c1,qw as c2,lre as c3,u9 as c4,Ls as c5,a9 as c6,Wye as c7,T9 as c8,Oi as c9,ZI as cA,yfe as cB,Pve as cC,bT as cD,Lve as cE,Ove as cF,Mve as cG,vO as cH,yO as cI,xve as cJ,Nve as cK,Qve as cL,Vye as cM,aI as cN,$ve as cO,lye as cP,Q_e as cQ,qve as cR,pR as cS,gR as cT,Nc as cU,Uve as cV,x6 as cW,cie as cX,die as cY,Eve as cZ,hie as c_,Ww as ca,oI as cb,IR as cc,Moe as cd,cre as ce,mse as cf,gve as cg,Vne as ch,dre as ci,Loe as cj,aye as ck,Wc as cl,SR as cm,cg as cn,Kc as co,v_ as cp,RR as cq,Lf as cr,tn as cs,rye as ct,Bve as cu,Fve as cv,_ie as cw,eS as cx,Vve as cy,Dve as cz,eH as d,vve as d0,fie as d1,Ese as d2,wse as d3,Gve as d4,Cve as d5,ug as d6,yue as d7,Mr as d8,fve as d9,yq as dA,ka as dB,Pa as dC,No as dD,Gc as dE,Na as dF,oce as dG,uce as dH,hue as dI,Tq as dJ,Jle as dK,xle as dL,lD as dM,bce as dN,Yle as dO,ace as dP,ice as dQ,wle as dR,Lle as dS,Rce as dT,gf as dU,Iye as dV,Sye as dW,lve as dX,jve as dY,Cye as da,_ve as db,Are as dc,b6 as dd,mve as de,z3 as df,Pse as dg,Tse as dh,Wve as di,oT as dj,Cse as dk,z6 as dl,Dye as dm,Iie as dn,Rve as dp,Sve as dq,yve as dr,iI as ds,Kve as dt,dve as du,Qye as dv,Yve as dw,wve as dx,Nye as dy,xye as dz,Fte as e,VM as f,or as g,hS as h,AM as i,GL as j,Q4 as k,Ma as l,NM as m,uM as n,be as o,Oe as p,bL as q,lR as r,i5 as s,Nv as t,mS as u,Mv as v,hr as w,j4 as x,nne as y,gs as z};
